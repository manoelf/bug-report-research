{"bugs": {"678560": {"comments": [{"creator": "khuey@kylehuey.com", "time": "2011-08-12T18:21:21Z", "creation_time": "2011-08-12T18:21:21Z", "author": "khuey@kylehuey.com", "is_private": false, "id": 5650468, "count": 0, "text": "Created attachment 552702\nPatch\n\nThis is limited to files in the cwd, but that's good enough for me ATM.  We can always change it later if needed.", "bug_id": 678560, "tags": [], "attachment_id": 552702, "raw_text": "This is limited to files in the cwd, but that's good enough for me ATM.  We can always change it later if needed."}, {"bug_id": 678560, "text": "What is it needed for?", "tags": [], "raw_text": "What is it needed for?", "attachment_id": null, "author": "martijn.martijn@gmail.com", "creator": "martijn.martijn@gmail.com", "time": "2011-08-12T18:28:51Z", "creation_time": "2011-08-12T18:28:51Z", "is_private": false, "id": 5650497, "count": 1}, {"tags": [], "bug_id": 678560, "text": "Writing a test for bug 673742.", "raw_text": "Writing a test for bug 673742.", "attachment_id": null, "author": "khuey@kylehuey.com", "creation_time": "2011-08-12T18:29:48Z", "time": "2011-08-12T18:29:48Z", "creator": "khuey@kylehuey.com", "count": 2, "id": 5650500, "is_private": false}, {"is_private": false, "id": 5650533, "count": 3, "author": "josh@joshmatthews.net", "creator": "josh@joshmatthews.net", "time": "2011-08-12T18:39:33Z", "creation_time": "2011-08-12T18:39:33Z", "raw_text": "No profile access can occur in specialpowers.js since we don't have a profile in the content process.", "attachment_id": null, "tags": [], "text": "No profile access can occur in specialpowers.js since we don't have a profile in the content process.", "bug_id": 678560}, {"raw_text": "(In reply to Josh Matthews [:jdm] from comment #3)\n> No profile access can occur in specialpowers.js since we don't have a\n> profile in the content process.\n\nI don't understand how that's relevant.", "attachment_id": null, "tags": [], "text": "(In reply to Josh Matthews [:jdm] from comment #3)\n> No profile access can occur in specialpowers.js since we don't have a\n> profile in the content process.\n\nI don't understand how that's relevant.", "bug_id": 678560, "is_private": false, "id": 5650544, "count": 4, "author": "khuey@kylehuey.com", "creator": "khuey@kylehuey.com", "time": "2011-08-12T18:42:35Z", "creation_time": "2011-08-12T18:42:35Z"}, {"raw_text": "Maybe we should name this getDOMFile? :) (khuey is implementing a way to create DOM File objects.)", "attachment_id": null, "tags": [], "bug_id": 678560, "text": "Maybe we should name this getDOMFile? :) (khuey is implementing a way to create DOM File objects.)", "is_private": false, "id": 5650554, "count": 5, "author": "ted@mielczarek.org", "creator": "ted@mielczarek.org", "creation_time": "2011-08-12T18:44:48Z", "time": "2011-08-12T18:44:48Z"}, {"tags": [], "bug_id": 678560, "text": "(In reply to Ted Mielczarek [:ted, :luser] from comment #5)\n> Maybe we should name this getDOMFile? :) (khuey is implementing a way to\n> create DOM File objects.)\n\nSure, I don't care.  We'll never be able to return an nsIFile here though, so I just figured it was unnecessary.", "attachment_id": null, "raw_text": "(In reply to Ted Mielczarek [:ted, :luser] from comment #5)\n> Maybe we should name this getDOMFile? :) (khuey is implementing a way to\n> create DOM File objects.)\n\nSure, I don't care.  We'll never be able to return an nsIFile here though, so I just figured it was unnecessary.", "creator": "khuey@kylehuey.com", "time": "2011-08-12T18:48:58Z", "creation_time": "2011-08-12T18:48:58Z", "author": "khuey@kylehuey.com", "is_private": false, "id": 5650571, "count": 6}, {"text": "(In reply to Kyle Huey [:khuey] (khuey@mozilla.com) from comment #4)\n> (In reply to Josh Matthews [:jdm] from comment #3)\n> > No profile access can occur in specialpowers.js since we don't have a\n> > profile in the content process.\n> \n> I don't understand how that's relevant.\n\nWhoops, I saw a directory service get and just assumed it was ProfD.", "bug_id": 678560, "tags": [], "raw_text": "(In reply to Kyle Huey [:khuey] (khuey@mozilla.com) from comment #4)\n> (In reply to Josh Matthews [:jdm] from comment #3)\n> > No profile access can occur in specialpowers.js since we don't have a\n> > profile in the content process.\n> \n> I don't understand how that's relevant.\n\nWhoops, I saw a directory service get and just assumed it was ProfD.", "attachment_id": null, "author": "josh@joshmatthews.net", "time": "2011-08-12T18:49:15Z", "creation_time": "2011-08-12T18:49:15Z", "creator": "josh@joshmatthews.net", "id": 5650572, "count": 7, "is_private": false}, {"tags": [], "bug_id": 678560, "text": "Comment on attachment 552702\nPatch\n\nReview of attachment 552702:\n-----------------------------------------------------------------\n\nI have one big hangup with this patch, below. Also, make sure you update the docs at:\nhttps://developer.mozilla.org/en/SpecialPowers\n\nand this could probably use a simple test in test_SpecialPowersExtension:\nhttp://mxr.mozilla.org/mozilla-central/source/testing/mochitest/tests/test_SpecialPowersExtension.html?force=1\n\n::: testing/mochitest/specialpowers/content/specialpowers.js\n@@ +390,5 @@\n> +\n> +  getFile: function(path) {\n> +    var file = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n> +               .getService(Components.interfaces.nsIProperties)\n> +               .get(\"CurWorkD\", Components.interfaces.nsIFile);\n\nCurWorkD is probably $objdir/_tests/testing/mochitest in a local build, and $builddir/mochitest in a packaged build. I'm not sure that that's the best place to make paths relative to. I think I'd prefer either:\na) Relative to tests/ underneath that directory, so you'd wind up using getFile($relativesrcdir/file) or\nb) Relative to the directory containing the current test, so you could just getFile(\"foo\") for files in the same directory. This is probably more of a pain to handle (you might have to parse this.window.location out), but seems like the easiest for test authors to use.", "raw_text": "Review of attachment 552702:\n-----------------------------------------------------------------\n\nI have one big hangup with this patch, below. Also, make sure you update the docs at:\nhttps://developer.mozilla.org/en/SpecialPowers\n\nand this could probably use a simple test in test_SpecialPowersExtension:\nhttp://mxr.mozilla.org/mozilla-central/source/testing/mochitest/tests/test_SpecialPowersExtension.html?force=1\n\n::: testing/mochitest/specialpowers/content/specialpowers.js\n@@ +390,5 @@\n> +\n> +  getFile: function(path) {\n> +    var file = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n> +               .getService(Components.interfaces.nsIProperties)\n> +               .get(\"CurWorkD\", Components.interfaces.nsIFile);\n\nCurWorkD is probably $objdir/_tests/testing/mochitest in a local build, and $builddir/mochitest in a packaged build. I'm not sure that that's the best place to make paths relative to. I think I'd prefer either:\na) Relative to tests/ underneath that directory, so you'd wind up using getFile($relativesrcdir/file) or\nb) Relative to the directory containing the current test, so you could just getFile(\"foo\") for files in the same directory. This is probably more of a pain to handle (you might have to parse this.window.location out), but seems like the easiest for test authors to use.", "attachment_id": 552702, "author": "ted@mielczarek.org", "creation_time": "2011-08-15T16:54:40Z", "time": "2011-08-15T16:54:40Z", "creator": "ted@mielczarek.org", "count": 8, "id": 5654402, "is_private": false}]}}, "comments": {}}