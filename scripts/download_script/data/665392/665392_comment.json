{"bugs": {"665392": {"comments": [{"attachment_id": 540352, "tags": [], "creator": "netrolller.3d@gmail.com", "is_private": false, "creation_time": "2011-06-19T23:13:10Z", "raw_text": "When transform=\"translate(x, y)\" is applied to an element that is animated using animateMotion along a curved path (e.g. a B\u00e9zier curve), with rotate=\"auto\" set, the animation flickers severely and does not follow the prescribed path.\nIt seems that the transformation is wrongly taken into account when rotating the animated element (the element is first translated, then the translated element is rotated around the canvas's origin; instead of rotating first, then translating the rotated element).\n\nReproduction steps: Open the attached testcase.\n\nExpected results: Green square moves along the black B\u00e9zier curve.\n\nActual results: Green square jumps off the curve, and does some acrobatics in mid-air, before following what appears to be a translated copy of the black curve.", "time": "2011-06-19T23:13:10Z", "author": "netrolller.3d@gmail.com", "text": "Created attachment 540352\nTestcase. Green square doesn't follow the black curve.\n\nWhen transform=\"translate(x, y)\" is applied to an element that is animated using animateMotion along a curved path (e.g. a B\u00e9zier curve), with rotate=\"auto\" set, the animation flickers severely and does not follow the prescribed path.\nIt seems that the transformation is wrongly taken into account when rotating the animated element (the element is first translated, then the translated element is rotated around the canvas's origin; instead of rotating first, then translating the rotated element).\n\nReproduction steps: Open the attached testcase.\n\nExpected results: Green square moves along the black B\u00e9zier curve.\n\nActual results: Green square jumps off the curve, and does some acrobatics in mid-air, before following what appears to be a translated copy of the black curve.", "count": 0, "id": 5541701, "bug_id": 665392}, {"tags": [], "attachment_id": null, "creation_time": "2011-09-07T17:44:15Z", "is_private": false, "creator": "netrolller.3d@gmail.com", "time": "2011-09-07T17:44:15Z", "raw_text": "Bump! Still a bug in Firefox 6.0.1", "id": 5705338, "bug_id": 665392, "author": "netrolller.3d@gmail.com", "count": 1, "text": "Bump! Still a bug in Firefox 6.0.1"}, {"tags": [], "time": "2011-09-14T05:42:33Z", "raw_text": "I can reproduce this on today's nightly:\nMozilla/5.0 (X11; Linux x86_64; rv:9.0a1) Gecko/20110913 Firefox/9.0a1\n\nChromium and Opera both get it right.\n\nFirefox gets un-wonky if I make any of the following tweaks:\n - move the |translate| attribute up to a <g> ancestor\n...or...\n - remove the rotate attribute (or change it to (rotate=\"0\")\n\nAs noted in comment 0, we must be applying the rotation and the transform attribute in the wrong order, or something like that.", "attachment_id": null, "id": 5716577, "bug_id": 665392, "creation_time": "2011-09-14T05:42:33Z", "is_private": false, "creator": "dholbert@mozilla.com", "count": 2, "text": "I can reproduce this on today's nightly:\nMozilla/5.0 (X11; Linux x86_64; rv:9.0a1) Gecko/20110913 Firefox/9.0a1\n\nChromium and Opera both get it right.\n\nFirefox gets un-wonky if I make any of the following tweaks:\n - move the |translate| attribute up to a <g> ancestor\n...or...\n - remove the rotate attribute (or change it to (rotate=\"0\")\n\nAs noted in comment 0, we must be applying the rotation and the transform attribute in the wrong order, or something like that.", "author": "dholbert@mozilla.com"}, {"raw_text": "Here's a testcase with a straight path and a fixed rotate-angle.\n\nWe've got identical animations on near-identical rects -- they only differ in that the red rect's transform is set via its <g> parent instead of on the <rect>.", "time": "2011-09-14T14:48:50Z", "text": "Created attachment 560153\ntestcase 2: no red should show\n\nHere's a testcase with a straight path and a fixed rotate-angle.\n\nWe've got identical animations on near-identical rects -- they only differ in that the red rect's transform is set via its <g> parent instead of on the <rect>.", "count": 3, "author": "dholbert@mozilla.com", "bug_id": 665392, "id": 5716901, "attachment_id": 560153, "tags": [], "creator": "dholbert@mozilla.com", "creation_time": "2011-09-14T14:48:50Z", "is_private": false}, {"tags": [], "attachment_id": 560176, "is_private": false, "creation_time": "2011-09-14T17:03:35Z", "creator": "dholbert@mozilla.com", "time": "2011-09-14T17:03:35Z", "raw_text": "I think I just got the matrix multiplication backwards here (back in bug 436418 which added animateMotion support).\n\nAttached patch (with test) fixes this.  Will request review soon; I want to do one sanity-check in GDB first.", "id": 5717096, "bug_id": 665392, "text": "Created attachment 560176\nfix v1\n\nI think I just got the matrix multiplication backwards here (back in bug 436418 which added animateMotion support).\n\nAttached patch (with test) fixes this.  Will request review soon; I want to do one sanity-check in GDB first.", "count": 4, "author": "dholbert@mozilla.com"}, {"creator": "dholbert@mozilla.com", "text": "Comment on attachment 560176\nfix v1\n\nYup, sanity confirmed.  (I wanted to double-check that the matrix we're prepending to already includes the parent's transform (and it does, by way of nsSVGPathGeometryFrame::GetCanvasTM)).\n\nRequesting review.", "count": 5, "author": "dholbert@mozilla.com", "id": 5717379, "bug_id": 665392, "creation_time": "2011-09-14T19:03:25Z", "is_private": false, "time": "2011-09-14T19:03:25Z", "raw_text": "Yup, sanity confirmed.  (I wanted to double-check that the matrix we're prepending to already includes the parent's transform (and it does, by way of nsSVGPathGeometryFrame::GetCanvasTM)).\n\nRequesting review.", "attachment_id": 560176, "tags": []}, {"creation_time": "2011-09-15T22:44:33Z", "is_private": false, "id": 5719411, "bug_id": 665392, "author": "dholbert@mozilla.com", "count": 6, "text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/c3bf76213a6c", "creator": "dholbert@mozilla.com", "tags": [], "attachment_id": null, "raw_text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/c3bf76213a6c", "time": "2011-09-15T22:44:33Z"}, {"tags": [], "attachment_id": null, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/c3bf76213a6c", "time": "2011-09-16T14:26:42Z", "is_private": false, "creation_time": "2011-09-16T14:26:42Z", "bug_id": 665392, "id": 5720111, "author": "ehsan.akhgari@gmail.com", "text": "https://hg.mozilla.org/mozilla-central/rev/c3bf76213a6c", "count": 7, "creator": "ehsan.akhgari@gmail.com"}, {"raw_text": "Daniel, I think you're going to need to back this out. This change makes us fail http://www.w3.org/Graphics/SVG/Test/20061213/htmlEmbedHarness/full-animate-elem-24-t.html which we passed before.\n\nWebkit are changing to what we used to do before your patch (https://bugs.webkit.org/show_bug.cgi?id=67601)\n\nThe whole situation is a mess I'm afraid: http://lists.w3.org/Archives/Public/www-svg/2010Dec/0033.html", "time": "2011-09-17T08:44:22Z", "id": 5721294, "bug_id": 665392, "author": "longsonr@gmail.com", "count": 8, "text": "Daniel, I think you're going to need to back this out. This change makes us fail http://www.w3.org/Graphics/SVG/Test/20061213/htmlEmbedHarness/full-animate-elem-24-t.html which we passed before.\n\nWebkit are changing to what we used to do before your patch (https://bugs.webkit.org/show_bug.cgi?id=67601)\n\nThe whole situation is a mess I'm afraid: http://lists.w3.org/Archives/Public/www-svg/2010Dec/0033.html", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-09-17T08:44:22Z", "creator": "longsonr@gmail.com"}, {"raw_text": "D'oh!  Note to self: remember to check in a version of that w3c testcase...\n\nI'm just about to leave on a weeklong camping trip, so I can't investigate thoroughly at the moment, but I've backed out as you suggest:\n  https://hg.mozilla.org/mozilla-central/rev/06445f55f009", "time": "2011-09-17T16:20:24Z", "id": 5721529, "bug_id": 665392, "text": "D'oh!  Note to self: remember to check in a version of that w3c testcase...\n\nI'm just about to leave on a weeklong camping trip, so I can't investigate thoroughly at the moment, but I've backed out as you suggest:\n  https://hg.mozilla.org/mozilla-central/rev/06445f55f009", "count": 9, "author": "dholbert@mozilla.com", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-09-17T16:20:24Z", "creator": "dholbert@mozilla.com"}, {"time": "2011-09-17T20:59:46Z", "raw_text": "This seems to work better in Opera.  Both test cases attached to the bug pass and the W3C test noted in comment 8 passes as well.", "author": "wgianopoulos@gmail.com", "text": "This seems to work better in Opera.  Both test cases attached to the bug pass and the W3C test noted in comment 8 passes as well.", "count": 10, "id": 5721674, "bug_id": 665392, "attachment_id": null, "tags": [], "creator": "wgianopoulos@gmail.com", "is_private": false, "creation_time": "2011-09-17T20:59:46Z"}, {"author": "longsonr@gmail.com", "text": "See http://lists.w3.org/Archives/Public/www-svg/2011Jun/0004.html and other w3c posts for more information.", "count": 11, "creator": "longsonr@gmail.com", "creation_time": "2011-09-17T21:21:20Z", "is_private": false, "bug_id": 665392, "id": 5721684, "attachment_id": null, "raw_text": "See http://lists.w3.org/Archives/Public/www-svg/2011Jun/0004.html and other w3c posts for more information.", "time": "2011-09-17T21:21:20Z", "tags": []}, {"tags": [], "raw_text": "Is anyone still working on this bug? I've filed this almost 2 years ago as part of a series, but it appears to have been abandoned after an initial failed fix...", "attachment_id": null, "time": "2013-06-04T00:56:06Z", "creation_time": "2013-06-04T00:56:06Z", "is_private": false, "bug_id": 665392, "id": 7493504, "count": 12, "text": "Is anyone still working on this bug? I've filed this almost 2 years ago as part of a series, but it appears to have been abandoned after an initial failed fix...", "author": "netrolller.3d@gmail.com", "creator": "netrolller.3d@gmail.com"}, {"attachment_id": null, "tags": [], "creator": "dholbert@mozilla.com", "is_private": false, "creation_time": "2013-06-04T04:35:01Z", "time": "2013-06-04T04:35:01Z", "raw_text": "I'm not actively working on it, no.  --> Unassigning, to reflect reality.\n\nAnd actually, as Robert hinted at in comment 8, Webkit intentionally switched to (roughly) match the Gecko behavior on this (to pass an test from the official testsuite).  So: since Opera is switching to (webkit-based) Blink, then very soon all SMIL-supporting browsers will be consistent on this.\n\nI don't have the time at the moment to dig into the spec or the thread from comment 8 / comment 12 to be absolutely sure whether our current behavior on this is per spec or not, but I think there's a good chance it is...", "count": 13, "text": "I'm not actively working on it, no.  --> Unassigning, to reflect reality.\n\nAnd actually, as Robert hinted at in comment 8, Webkit intentionally switched to (roughly) match the Gecko behavior on this (to pass an test from the official testsuite).  So: since Opera is switching to (webkit-based) Blink, then very soon all SMIL-supporting browsers will be consistent on this.\n\nI don't have the time at the moment to dig into the spec or the thread from comment 8 / comment 12 to be absolutely sure whether our current behavior on this is per spec or not, but I think there's a good chance it is...", "author": "dholbert@mozilla.com", "bug_id": 665392, "id": 7493966}]}}, "comments": {}}