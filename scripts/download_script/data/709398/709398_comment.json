{"bugs": {"709398": {"comments": [{"id": 5905714, "attachment_id": 580582, "raw_text": "###!!! ABORT: negative scaling factors must be handled manually: 'aScale >= 0.0f', file nsCoord.h, line 138", "creation_time": "2011-12-10T00:14:15Z", "author": "jruderman@gmail.com", "text": "Created attachment 580582\ntestcase (asserts fatally when loaded)\n\n###!!! ABORT: negative scaling factors must be handled manually: 'aScale >= 0.0f', file nsCoord.h, line 138", "time": "2011-12-10T00:14:15Z", "tags": [], "is_private": false, "creator": "jruderman@gmail.com", "bug_id": 709398, "count": 0}, {"id": 5905715, "raw_text": "", "attachment_id": 580583, "bug_id": 709398, "tags": [], "time": "2011-12-10T00:14:54Z", "text": "Created attachment 580583\nstack trace", "author": "jruderman@gmail.com", "creation_time": "2011-12-10T00:14:54Z", "count": 1, "creator": "jruderman@gmail.com", "is_private": false}, {"id": 7285667, "raw_text": "https://tbpl.mozilla.org/?tree=Try&rev=8da8879637d8", "attachment_id": 734275, "tags": [], "bug_id": 709398, "time": "2013-04-06T18:22:39Z", "text": "Created attachment 734275\nfix+test\n\nhttps://tbpl.mozilla.org/?tree=Try&rev=8da8879637d8", "author": "MatsPalmgren_bugz@use.startmail.com", "creation_time": "2013-04-06T18:22:39Z", "count": 2, "creator": "MatsPalmgren_bugz@use.startmail.com", "is_private": false}, {"id": 7287071, "raw_text": "Review of attachment 734275:\n-----------------------------------------------------------------\n\nWouldn't it make more sense to fix this in nsCSSRendering::ComputeBackgroundPositioningArea?", "attachment_id": 734275, "tags": [], "time": "2013-04-07T23:12:56Z", "bug_id": 709398, "text": "Comment on attachment 734275\nfix+test\n\nReview of attachment 734275:\n-----------------------------------------------------------------\n\nWouldn't it make more sense to fix this in nsCSSRendering::ComputeBackgroundPositioningArea?", "author": "roc@ocallahan.org", "creation_time": "2013-04-07T23:12:56Z", "count": 3, "creator": "roc@ocallahan.org", "is_private": false}, {"attachment_id": 734940, "raw_text": "OK.  The only other caller of ComputeBackgroundPositioningArea\nis nsDisplayBackgroundImage::GetPositioningArea() and I figured the\nmIsThemed path should be consistent with the non-mIsThemed path so\nI clamped that too.\n\nhttps://tbpl.mozilla.org/?tree=Try&rev=e813a1025a29", "id": 7292145, "is_private": false, "creator": "MatsPalmgren_bugz@use.startmail.com", "count": 4, "creation_time": "2013-04-09T02:02:40Z", "author": "MatsPalmgren_bugz@use.startmail.com", "text": "Created attachment 734940\nfix+test, v2\n\nOK.  The only other caller of ComputeBackgroundPositioningArea\nis nsDisplayBackgroundImage::GetPositioningArea() and I figured the\nmIsThemed path should be consistent with the non-mIsThemed path so\nI clamped that too.\n\nhttps://tbpl.mozilla.org/?tree=Try&rev=e813a1025a29", "tags": [], "bug_id": 709398, "time": "2013-04-09T02:02:40Z"}, {"attachment_id": 734940, "raw_text": "Review of attachment 734940:\n-----------------------------------------------------------------\n\n::: layout/base/nsCSSRendering.cpp\n@@ +4601,5 @@\n>  nsSize\n>  nsImageRenderer::ComputeSize(const nsStyleBackground::Size& aLayerSize,\n>                               const nsSize& aBgPositioningArea)\n>  {\n> +  MOZ_ASSERT(aBgPositioningArea.width >= 0 && aBgPositioningArea.height >= 0);\n\nI think this should be non-fatal. It doesn't matter much if it's negative here I think.\n\n::: layout/base/nsDisplayList.cpp\n@@ +2023,5 @@\n>  {\n>    if (mIsThemed) {\n> +    nsRect bgRect(ToReferenceFrame(), mFrame->GetSize());\n> +    bgRect.width = std::max(0, bgRect.width);\n> +    bgRect.height = std::max(0, bgRect.height);\n\nWhy is this necessary? Frame sizes should never be negative. Do we have known situations where frame sizes go negative?", "id": 7292152, "is_private": false, "creator": "roc@ocallahan.org", "count": 5, "creation_time": "2013-04-09T02:05:53Z", "author": "roc@ocallahan.org", "text": "Comment on attachment 734940\nfix+test, v2\n\nReview of attachment 734940:\n-----------------------------------------------------------------\n\n::: layout/base/nsCSSRendering.cpp\n@@ +4601,5 @@\n>  nsSize\n>  nsImageRenderer::ComputeSize(const nsStyleBackground::Size& aLayerSize,\n>                               const nsSize& aBgPositioningArea)\n>  {\n> +  MOZ_ASSERT(aBgPositioningArea.width >= 0 && aBgPositioningArea.height >= 0);\n\nI think this should be non-fatal. It doesn't matter much if it's negative here I think.\n\n::: layout/base/nsDisplayList.cpp\n@@ +2023,5 @@\n>  {\n>    if (mIsThemed) {\n> +    nsRect bgRect(ToReferenceFrame(), mFrame->GetSize());\n> +    bgRect.width = std::max(0, bgRect.width);\n> +    bgRect.height = std::max(0, bgRect.height);\n\nWhy is this necessary? Frame sizes should never be negative. Do we have known situations where frame sizes go negative?", "tags": [], "bug_id": 709398, "time": "2013-04-09T02:05:53Z"}]}}, "comments": {}}