{"bugs": {"637597": {"comments": [{"is_private": false, "time": "2011-03-01T09:36:36Z", "attachment_id": null, "text": "User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_6; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.102 Safari/534.13\nBuild Identifier: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0b12) Gecko/20100101 Firefox/4.0b12\n\nTranslate element inside scaled element. During the change for ~1sec all elements inside the scaled parent are drawn wrong. This may result in child elements appearing 1px smaller or larger of single lines left on the edge.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Go to http://limejs.digitalfruit.ee/ff4/d_ff4_scale_bug.htm\n2. Look at the source\n3.\nActual Results:  \nWeird artifact happen during the move.\n\nUsually: red and green box appear 1px bigger during the move. This is specially annoying for the red box that is supposed to be completely static.\n\nOn one machine: In addition to resize issues bottom line of green box still remains on 400px. So there is a red box, a green box and a green line on the screen. This does not go away after 1 sec.\n\nExpected Results:  \nGreen box should move 200px up. Red box should remain unchanged.\n\nDoes not appear on Firefox3.6 or in any other browser.\n\nAppears both mac and windows.\n\nAlso appears if moved with transitions. Then appears as long as the duration of the transition.\n\nSeems that only appear when moved with -moz-transform: translate(). Ok if moved with left/top.\n\nFirst it seemed to me that resize happened when scale_factor*element_size was a value where round(num)!=ceil(num). But not sure any more as I have seen different result on different machines.", "creation_time": "2011-03-01T09:36:36Z", "raw_text": "User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_6; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.102 Safari/534.13\nBuild Identifier: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0b12) Gecko/20100101 Firefox/4.0b12\n\nTranslate element inside scaled element. During the change for ~1sec all elements inside the scaled parent are drawn wrong. This may result in child elements appearing 1px smaller or larger of single lines left on the edge.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Go to http://limejs.digitalfruit.ee/ff4/d_ff4_scale_bug.htm\n2. Look at the source\n3.\nActual Results:  \nWeird artifact happen during the move.\n\nUsually: red and green box appear 1px bigger during the move. This is specially annoying for the red box that is supposed to be completely static.\n\nOn one machine: In addition to resize issues bottom line of green box still remains on 400px. So there is a red box, a green box and a green line on the screen. This does not go away after 1 sec.\n\nExpected Results:  \nGreen box should move 200px up. Red box should remain unchanged.\n\nDoes not appear on Firefox3.6 or in any other browser.\n\nAppears both mac and windows.\n\nAlso appears if moved with transitions. Then appears as long as the duration of the transition.\n\nSeems that only appear when moved with -moz-transform: translate(). Ok if moved with left/top.\n\nFirst it seemed to me that resize happened when scale_factor*element_size was a value where round(num)!=ceil(num). But not sure any more as I have seen different result on different machines.", "id": 5311061, "bug_id": 637597, "creator": "tonistiigi@gmail.com", "count": 0, "tags": [], "author": "tonistiigi@gmail.com"}, {"id": 5312346, "raw_text": "Probably bug 635373.", "creation_time": "2011-03-01T19:12:16Z", "text": "Probably bug 635373.", "creator": "roc@ocallahan.org", "count": 1, "tags": [], "bug_id": 637597, "author": "roc@ocallahan.org", "is_private": false, "time": "2011-03-01T19:12:16Z", "attachment_id": null}, {"count": 2, "creator": "tonistiigi@gmail.com", "tags": [], "bug_id": 637597, "creation_time": "2011-03-02T08:01:42Z", "text": "This was marked as probably same as bug 635373 \"Small artifacts appear then disappear with hardware acceleration\" . Just to clear that this one also appeared when I turned hardware acceleration OFF from the preferences and restarted Firefox.", "id": 5314508, "raw_text": "This was marked as probably same as bug 635373 \"Small artifacts appear then disappear with hardware acceleration\" . Just to clear that this one also appeared when I turned hardware acceleration OFF from the preferences and restarted Firefox.", "author": "tonistiigi@gmail.com", "time": "2011-03-02T08:01:42Z", "is_private": false, "attachment_id": null}, {"raw_text": "I can reproduce it on Linux x86-64, with no HW acceleration.\nRegression window:  2010-08-01-03 -- 2010-08-02-03\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=070d9d46d88b&tochange=a4d86c3a3494", "id": 5314950, "text": "I can reproduce it on Linux x86-64, with no HW acceleration.\nRegression window:  2010-08-01-03 -- 2010-08-02-03\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=070d9d46d88b&tochange=a4d86c3a3494", "creation_time": "2011-03-02T13:27:01Z", "bug_id": 637597, "count": 3, "creator": "MatsPalmgren_bugz@use.startmail.com", "tags": [], "author": "MatsPalmgren_bugz@use.startmail.com", "is_private": false, "time": "2011-03-02T13:27:01Z", "attachment_id": null}, {"time": "2011-03-02T13:30:20Z", "is_private": false, "attachment_id": null, "bug_id": 637597, "tags": [], "creator": "MatsPalmgren_bugz@use.startmail.com", "count": 4, "raw_text": "The behavior is slightly different in 2010-08-02-03 though;\nthe red box has sharp edges at first then is blurred then sharp again.\nI'll try to find the second regression range when it changed to the\ncurrent behavior.", "id": 5314960, "text": "The behavior is slightly different in 2010-08-02-03 though;\nthe red box has sharp edges at first then is blurred then sharp again.\nI'll try to find the second regression range when it changed to the\ncurrent behavior.", "creation_time": "2011-03-02T13:30:20Z", "author": "MatsPalmgren_bugz@use.startmail.com"}, {"count": 5, "creator": "MatsPalmgren_bugz@use.startmail.com", "time": "2011-03-02T13:47:00Z", "tags": [], "bug_id": 637597, "id": 5314986, "raw_text": "The second regression range:  2010-11-07-03 -- 2010-11-08-04\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=8cbe83542596&tochange=a0826dcd6228", "creation_time": "2011-03-02T13:47:00Z", "is_private": false, "text": "The second regression range:  2010-11-07-03 -- 2010-11-08-04\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=8cbe83542596&tochange=a0826dcd6228", "attachment_id": null, "author": "MatsPalmgren_bugz@use.startmail.com"}, {"bug_id": 637597, "time": "2011-03-02T13:48:14Z", "count": 6, "creator": "MatsPalmgren_bugz@use.startmail.com", "tags": [], "raw_text": "", "id": 5314987, "text": "Created attachment 516245\nReporter's testcase", "is_private": false, "creation_time": "2011-03-02T13:48:14Z", "author": "MatsPalmgren_bugz@use.startmail.com", "attachment_id": 516245}, {"tags": [], "creator": "tonistiigi@gmail.com", "count": 7, "bug_id": 637597, "id": 5388091, "raw_text": "This bug is marked as dependent from bug 635373 which is now marked as fixed. It still appears on latest Minefield(01/04)", "creation_time": "2011-04-02T07:22:33Z", "text": "This bug is marked as dependent from bug 635373 which is now marked as fixed. It still appears on latest Minefield(01/04)", "author": "tonistiigi@gmail.com", "time": "2011-04-02T07:22:33Z", "is_private": false, "attachment_id": null}, {"time": "2011-04-06T06:46:01Z", "is_private": false, "attachment_id": null, "bug_id": 637597, "creator": "roc@ocallahan.org", "count": 8, "tags": [], "text": "The problem here is almost certainly a difference in rendering between an inactive transform and an active transform. The latter uses an intermediate temporary surface and the former does not. In the latter case elements b1 and b2 are rendered to temporary buffers which are then transformed by the GPU, and their edges are aliased by GPU compositing. In the former case the elements are transformed via cairo and their edges are snapped by our normal snapping algorithm, which is different.\n\nSome of the symptoms described above have been fixed by bug 635373 or other bugs. The only symptom I see now is the boxes appearing to change size by 1px temporarily.\n\nI'm not sure we can do much here without breaking other things.", "creation_time": "2011-04-06T06:46:01Z", "raw_text": "The problem here is almost certainly a difference in rendering between an inactive transform and an active transform. The latter uses an intermediate temporary surface and the former does not. In the latter case elements b1 and b2 are rendered to temporary buffers which are then transformed by the GPU, and their edges are aliased by GPU compositing. In the former case the elements are transformed via cairo and their edges are snapped by our normal snapping algorithm, which is different.\n\nSome of the symptoms described above have been fixed by bug 635373 or other bugs. The only symptom I see now is the boxes appearing to change size by 1px temporarily.\n\nI'm not sure we can do much here without breaking other things.", "id": 5391986, "author": "roc@ocallahan.org"}, {"author": "tonistiigi@gmail.com", "bug_id": 637597, "creator": "tonistiigi@gmail.com", "tags": [], "count": 9, "raw_text": "Are you saying that this will probably never get fixed? This is a major feature for RIAs and games. Nobody is going to use an application that flickers all the time. Might as well call all CSS transformations part unusable. Similar issue is also when parent node is rotated(aliasing difference). At the moment a feature has been made 50% faster(layers framework) by not supporting it any more. There should at least be a way to turn off this new fancy GPU rendering until it gets reasonably stable.", "id": 5392010, "text": "Are you saying that this will probably never get fixed? This is a major feature for RIAs and games. Nobody is going to use an application that flickers all the time. Might as well call all CSS transformations part unusable. Similar issue is also when parent node is rotated(aliasing difference). At the moment a feature has been made 50% faster(layers framework) by not supporting it any more. There should at least be a way to turn off this new fancy GPU rendering until it gets reasonably stable.", "creation_time": "2011-04-06T07:19:48Z", "attachment_id": null, "time": "2011-04-06T07:19:48Z", "is_private": false}, {"id": 5395293, "raw_text": "That's an exaggeration. Most uses of transforms don't have a problem here. Making the software renderer and the GPU compositor match their rendering exactly is not feasible.", "is_private": false, "creation_time": "2011-04-07T22:43:55Z", "text": "That's an exaggeration. Most uses of transforms don't have a problem here. Making the software renderer and the GPU compositor match their rendering exactly is not feasible.", "tags": [], "creator": "roc@ocallahan.org", "time": "2011-04-07T22:43:55Z", "count": 10, "bug_id": 637597, "attachment_id": null, "author": "roc@ocallahan.org"}, {"creation_time": "2011-04-08T07:16:16Z", "text": "Its not. Whole point of CSS transforms is that you can set a transformation matrix for the element. As far as I can see this feature only works if only translation segments of this matrix are filled. That means 2 out of 6. Same way would be to say one can set an elements width but only in ranges 10-60, 110-140, 190-210 etc.\n\nI'm not saying this is easy. I'm sure its very hard but you should advertise it as a feature or force it to all webpages unless it is really working.\n\nI don't wish to be rude. Its just very hard for me to explain why I can't fix the code that worked perfectly in FF3 and even works in browsers like IE9 but does not work in FF4 that should be that best browser to use at the moment.", "id": 5396103, "raw_text": "Its not. Whole point of CSS transforms is that you can set a transformation matrix for the element. As far as I can see this feature only works if only translation segments of this matrix are filled. That means 2 out of 6. Same way would be to say one can set an elements width but only in ranges 10-60, 110-140, 190-210 etc.\n\nI'm not saying this is easy. I'm sure its very hard but you should advertise it as a feature or force it to all webpages unless it is really working.\n\nI don't wish to be rude. Its just very hard for me to explain why I can't fix the code that worked perfectly in FF3 and even works in browsers like IE9 but does not work in FF4 that should be that best browser to use at the moment.", "tags": [], "count": 11, "creator": "tonistiigi@gmail.com", "bug_id": 637597, "author": "tonistiigi@gmail.com", "is_private": false, "time": "2011-04-08T07:16:16Z", "attachment_id": null}, {"time": "2011-04-28T04:07:25Z", "creator": "roc@ocallahan.org", "tags": [], "count": 12, "bug_id": 637597, "is_private": false, "creation_time": "2011-04-28T04:07:25Z", "text": "(In reply to comment #11)\n> As far as I can see this feature only works if only\n> translation segments of this matrix are filled. \n\nNope. Lots of pages use transforms and work great. You have hit an edge case that is particularly hard to handle.\n\nHowever, the work in bug 637852 should fix this.", "id": 5436481, "raw_text": "(In reply to comment #11)\n> As far as I can see this feature only works if only\n> translation segments of this matrix are filled. \n\nNope. Lots of pages use transforms and work great. You have hit an edge case that is particularly hard to handle.\n\nHowever, the work in bug 637852 should fix this.", "attachment_id": null, "author": "roc@ocallahan.org"}, {"attachment_id": null, "author": "tonistiigi@gmail.com", "is_private": false, "creation_time": "2011-04-28T12:23:12Z", "text": "Just letting everybody know that I have found a workaround. On every animationframe(or timeout) when transforms change switch document.body transform style between \"scale(1,1)\" and \"\". I guess this forces redraw and layers framework isn't used. I'm sure its very bad for performance(probably same as FF3.6) but at least it works.", "id": 5436891, "raw_text": "Just letting everybody know that I have found a workaround. On every animationframe(or timeout) when transforms change switch document.body transform style between \"scale(1,1)\" and \"\". I guess this forces redraw and layers framework isn't used. I'm sure its very bad for performance(probably same as FF3.6) but at least it works.", "tags": [], "time": "2011-04-28T12:23:12Z", "count": 13, "creator": "tonistiigi@gmail.com", "bug_id": 637597}, {"author": "roc@ocallahan.org", "count": 14, "tags": [], "creator": "roc@ocallahan.org", "bug_id": 637597, "id": 5553332, "raw_text": "Should have been fixed in bug 637852. Please retest on a nightly build.", "creation_time": "2011-06-24T06:14:14Z", "text": "Should have been fixed in bug 637852. Please retest on a nightly build.", "attachment_id": null, "time": "2011-06-24T06:14:14Z", "is_private": false}, {"text": "It turns out that this was never fixed in fact.  The original bug is reproducible on Mac at least.  Timothy also said that he can repro it using basic layers.\n\nSee bug 10209 comment 141 onwards...", "creation_time": "2011-09-29T17:28:10Z", "raw_text": "It turns out that this was never fixed in fact.  The original bug is reproducible on Mac at least.  Timothy also said that he can repro it using basic layers.\n\nSee bug 10209 comment 141 onwards...", "id": 5746600, "bug_id": 637597, "count": 15, "tags": [], "creator": "ehsan.akhgari@gmail.com", "author": "ehsan.akhgari@gmail.com", "is_private": false, "time": "2011-09-29T17:28:10Z", "attachment_id": null}, {"attachment_id": null, "time": "2011-09-29T21:46:01Z", "is_private": false, "author": "ehsan.akhgari@gmail.com", "tags": [], "count": 16, "creator": "ehsan.akhgari@gmail.com", "bug_id": 637597, "id": 5747708, "raw_text": "Note that I have marked the test for this bug as random: https://hg.mozilla.org/mozilla-central/rev/d5ec6fead55b", "creation_time": "2011-09-29T21:46:01Z", "text": "Note that I have marked the test for this bug as random: https://hg.mozilla.org/mozilla-central/rev/d5ec6fead55b"}]}}, "comments": {}}