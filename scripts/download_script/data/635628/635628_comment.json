{"comments": {}, "bugs": {"635628": {"comments": [{"id": 5293207, "time": "2011-02-20T20:43:30Z", "tags": [], "creation_time": "2011-02-20T20:43:30Z", "bug_id": 635628, "raw_text": "Kerberos / GSSAPI authentication may fail due to various reasons, it may be advertised but not be configured on the server's side, or the user doesn't have it set up correctly. This was initially fixed in bug 491202 for the old account wizard, but apparently the redesign to provide more detailed menu options in bug 525238 voided that fix. Both the current TB 3.1.x account wizard and the redesign per bug 549045 enforce Kerberos / GSSAPI as security mechanism even\nif normal password would be available as a fallback.\n\nThe suggestion is to fall back to password-based authentication if Kerberos fails in the \"Create Account\" step for account verification. The related discussion in prior bugs is reiterated below for reference.\n\n(Quoting bug 549045 comment #165 of 2011-02-20)\n> \n> While the server name, ports, and connection encryption where guessed correctly\n> in the 2nd scenario, I ran into a regression of bug 491202 (no fallback to\n> password authentication when Kerberos/GSSAPI is advertised but not configured).\n> After going to \"Manual Config\" and changing to \"Normal Password\", retesting\n> and account creation was successful (switching to \"Autodetect\" just gave me\n> Kerberos again, so that didn't help).\n> \n> On a side note, the initial error message of \"user name or password are wrong\"\n> didn't reflect that the Kerberos-ticket failed and may be misleading for the\n> unsuspecting user. This actually seems to be a regression from bug 525238\n> rather as I see the same behavior in the 3.1.8 release build, so this would\n> probably be a candidate for a separate bug either way.\n\n(Quoting bug 491202 comment #54 of 2009-11-21)\n> First, note all this does not affect configs fetched from our database or the\n> ISP. Below is only about guessed configs.\n> \n> I'm working on this code in bug 495412.\n> \n> I notice that - during config guessing - we do not fall back to plaintext auth\n> unless we have SSL/STARTTLS - during verification.\n> <http://hg.mozilla.org/comm-central/annotate/54c135ebb58c/mailnews/base/prefs/content/accountcreation/verifyConfig.js#l227>\n> However, we don't have any problem with using plaintext auth on insecure\n> connections when the server never advertises any secure auth (like GSSAPI or\n> MD5). That doesn't make sense.\n> \n> In other words, a server that has no SSL and does not support encrypted\n> passwords nor Kerberos will work, we'll set up the account (after a warning).\n> A server that has no SSL and does not support encrypted passwords, but\n> advertises \"GSSAPI\", but GSSAPI/Kerberos fails during verification (because\n> it's not set up on client or server), we'll fail entirely and can't set up the\n> account, and even claim the username/password is wrong.\n> I think the second scenario is no less secure than the first. Therefore, I\n> think we should allow that - if we warn(ed) the user.\n> \n> Is that OK, if I change it like that?\n\nI'm not sure why I didn't respond to the latter question, I either missed it or must have assumed that it was directed towards Blake.", "is_private": false, "count": 0, "text": "Kerberos / GSSAPI authentication may fail due to various reasons, it may be advertised but not be configured on the server's side, or the user doesn't have it set up correctly. This was initially fixed in bug 491202 for the old account wizard, but apparently the redesign to provide more detailed menu options in bug 525238 voided that fix. Both the current TB 3.1.x account wizard and the redesign per bug 549045 enforce Kerberos / GSSAPI as security mechanism even\nif normal password would be available as a fallback.\n\nThe suggestion is to fall back to password-based authentication if Kerberos fails in the \"Create Account\" step for account verification. The related discussion in prior bugs is reiterated below for reference.\n\n(Quoting bug 549045 comment #165 of 2011-02-20)\n> \n> While the server name, ports, and connection encryption where guessed correctly\n> in the 2nd scenario, I ran into a regression of bug 491202 (no fallback to\n> password authentication when Kerberos/GSSAPI is advertised but not configured).\n> After going to \"Manual Config\" and changing to \"Normal Password\", retesting\n> and account creation was successful (switching to \"Autodetect\" just gave me\n> Kerberos again, so that didn't help).\n> \n> On a side note, the initial error message of \"user name or password are wrong\"\n> didn't reflect that the Kerberos-ticket failed and may be misleading for the\n> unsuspecting user. This actually seems to be a regression from bug 525238\n> rather as I see the same behavior in the 3.1.8 release build, so this would\n> probably be a candidate for a separate bug either way.\n\n(Quoting bug 491202 comment #54 of 2009-11-21)\n> First, note all this does not affect configs fetched from our database or the\n> ISP. Below is only about guessed configs.\n> \n> I'm working on this code in bug 495412.\n> \n> I notice that - during config guessing - we do not fall back to plaintext auth\n> unless we have SSL/STARTTLS - during verification.\n> <http://hg.mozilla.org/comm-central/annotate/54c135ebb58c/mailnews/base/prefs/content/accountcreation/verifyConfig.js#l227>\n> However, we don't have any problem with using plaintext auth on insecure\n> connections when the server never advertises any secure auth (like GSSAPI or\n> MD5). That doesn't make sense.\n> \n> In other words, a server that has no SSL and does not support encrypted\n> passwords nor Kerberos will work, we'll set up the account (after a warning).\n> A server that has no SSL and does not support encrypted passwords, but\n> advertises \"GSSAPI\", but GSSAPI/Kerberos fails during verification (because\n> it's not set up on client or server), we'll fail entirely and can't set up the\n> account, and even claim the username/password is wrong.\n> I think the second scenario is no less secure than the first. Therefore, I\n> think we should allow that - if we warn(ed) the user.\n> \n> Is that OK, if I change it like that?\n\nI'm not sure why I didn't respond to the latter question, I either missed it or must have assumed that it was directed towards Blake.", "author": "rsx11m.pub@gmail.com", "creator": "rsx11m.pub@gmail.com", "attachment_id": null}, {"tags": [], "raw_text": "I think I saw this today, too, on an Exchange server.", "creation_time": "2012-01-20T19:30:31Z", "bug_id": 635628, "is_private": false, "id": 5996106, "time": "2012-01-20T19:30:31Z", "creator": "blog@tessarakt.de", "attachment_id": null, "count": 1, "text": "I think I saw this today, too, on an Exchange server.", "author": "blog@tessarakt.de"}]}}}