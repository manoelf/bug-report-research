{"bugs": {"651060": {"comments": [{"creation_time": "2011-04-19T09:25:28Z", "creator": "cjones.bugs@gmail.com", "text": "Rob notes that\n\nFor JPEG images, we could also decode to YCbCr format (i.e. skip the final\nYCbCr-to-RGB conversion in the imglib decoder), and do the final YCbCr\nconversion using the GPU at draw time. That would save half the memory since\nJPEG subsamples Cb/Cr. We already have all the layer-side support for this.", "attachment_id": null, "id": 5418064, "author": "cjones.bugs@gmail.com", "bug_id": 651060, "raw_text": "Rob notes that\n\nFor JPEG images, we could also decode to YCbCr format (i.e. skip the final\nYCbCr-to-RGB conversion in the imglib decoder), and do the final YCbCr\nconversion using the GPU at draw time. That would save half the memory since\nJPEG subsamples Cb/Cr. We already have all the layer-side support for this.", "count": 0, "time": "2011-04-19T09:25:28Z", "tags": [], "is_private": false}, {"time": "2011-10-14T18:04:36Z", "is_private": false, "tags": [], "raw_text": "Color correction makes this more difficult because we would need to do color correction on draw instead of decode. Mobile doesn't use color correction so it's not a problem there.\n\nI think we would also probably only want to do this for large images, but that would need to be measured.\n\nThe memory win is probably the most appealing part of this, so it might even be interesting to investigate doing this even without using the GPU, at the same time I wouldn't rush to work on this without more evidence that it will provide big wins.", "bug_id": 651060, "count": 1, "attachment_id": null, "id": 5783235, "creator": "jmuizelaar@mozilla.com", "text": "Color correction makes this more difficult because we would need to do color correction on draw instead of decode. Mobile doesn't use color correction so it's not a problem there.\n\nI think we would also probably only want to do this for large images, but that would need to be measured.\n\nThe memory win is probably the most appealing part of this, so it might even be interesting to investigate doing this even without using the GPU, at the same time I wouldn't rush to work on this without more evidence that it will provide big wins.", "author": "jmuizelaar@mozilla.com", "creation_time": "2011-10-14T18:04:36Z"}, {"time": "2011-10-14T18:32:41Z", "count": 2, "bug_id": 651060, "author": "siarhei.siamashka@gmail.com", "creator": "siarhei.siamashka@gmail.com", "is_private": false, "tags": [], "raw_text": "As somebody mentioned on irc some time ago, it should be possible to first do \"decode -> YCbCr-to-RGB -> color correction -> RGB-to-YCbCr\" (which can be possibly optimized to less stages), and then \"YCbCr-to-RGB\" when drawing (using NEON or GPU). This way we still have color correction and memory saving.", "attachment_id": null, "id": 5783304, "text": "As somebody mentioned on irc some time ago, it should be possible to first do \"decode -> YCbCr-to-RGB -> color correction -> RGB-to-YCbCr\" (which can be possibly optimized to less stages), and then \"YCbCr-to-RGB\" when drawing (using NEON or GPU). This way we still have color correction and memory saving.", "creation_time": "2011-10-14T18:32:41Z"}, {"raw_text": "(In reply to Siarhei Siamashka from comment #2)\n> As somebody mentioned on irc some time ago, it should be possible to first\n> do \"decode -> YCbCr-to-RGB -> color correction -> RGB-to-YCbCr\" (which can\n> be possibly optimized to less stages), and then \"YCbCr-to-RGB\" when drawing\n> (using NEON or GPU). This way we still have color correction and memory\n> saving.\n\nOr just do color correction at GPU-conversion-time, as a suffix to YCbCr-to-RGB.\n\nThere's no reason we have to do this at draw time, either. Bug 750994 is an optimization to do GPU-size texture conversions at upload time.", "tags": [], "is_private": false, "creation_time": "2012-05-02T02:23:07Z", "text": "(In reply to Siarhei Siamashka from comment #2)\n> As somebody mentioned on irc some time ago, it should be possible to first\n> do \"decode -> YCbCr-to-RGB -> color correction -> RGB-to-YCbCr\" (which can\n> be possibly optimized to less stages), and then \"YCbCr-to-RGB\" when drawing\n> (using NEON or GPU). This way we still have color correction and memory\n> saving.\n\nOr just do color correction at GPU-conversion-time, as a suffix to YCbCr-to-RGB.\n\nThere's no reason we have to do this at draw time, either. Bug 750994 is an optimization to do GPU-size texture conversions at upload time.", "id": 6271323, "attachment_id": null, "bug_id": 651060, "count": 3, "time": "2012-05-02T02:23:07Z", "creator": "jgilbert@mozilla.com", "author": "jgilbert@mozilla.com"}, {"attachment_id": null, "id": 6273209, "text": "Not to suggest that this isn't a worthwhile cause, but I don't think this should block bug 683284.  Bug 683284 comment 1 says \"I'd like this bug to only address bugs where our behaviour is a clearly wrong compared to other browsers.\"", "creation_time": "2012-05-02T17:27:56Z", "is_private": false, "tags": [], "raw_text": "Not to suggest that this isn't a worthwhile cause, but I don't think this should block bug 683284.  Bug 683284 comment 1 says \"I'd like this bug to only address bugs where our behaviour is a clearly wrong compared to other browsers.\"", "creator": "justin.lebar+bug@gmail.com", "author": "justin.lebar+bug@gmail.com", "time": "2012-05-02T17:27:56Z", "bug_id": 651060, "count": 4}, {"creation_time": "2014-06-03T00:14:20Z", "author": "berrkl@reallymymail.com", "id": 8874003, "attachment_id": null, "creator": "berrkl@reallymymail.com", "text": "IE11 does this: https://blogs.msdn.com/b/ie/archive/2013/09/12/using-hardware-to-decode-and-load-jpg-images-up-to-45-faster-in-internet-explorer-11.aspx\n\nHigh quality image downsampling also can be done in subsampled YCbCr space (just treat each channel separately, maybe doing just luma and not bothering with chroma).", "count": 5, "raw_text": "IE11 does this: https://blogs.msdn.com/b/ie/archive/2013/09/12/using-hardware-to-decode-and-load-jpg-images-up-to-45-faster-in-internet-explorer-11.aspx\n\nHigh quality image downsampling also can be done in subsampled YCbCr space (just treat each channel separately, maybe doing just luma and not bothering with chroma).", "bug_id": 651060, "is_private": false, "tags": [], "time": "2014-06-03T00:14:20Z"}, {"time": "2014-06-05T02:00:34Z", "is_private": false, "tags": [], "raw_text": "I would like to do some experiments on this bug for evaluating the benefit and cost on Firefox OS.", "bug_id": 651060, "count": 6, "id": 8886690, "attachment_id": null, "text": "I would like to do some experiments on this bug for evaluating the benefit and cost on Firefox OS.", "creator": "ctai@mozilla.com", "author": "ctai@mozilla.com", "creation_time": "2014-06-05T02:00:34Z"}]}}, "comments": {}}