{"comments": {}, "bugs": {"642402": {"comments": [{"attachment_id": null, "creator": "jara.karel@gmail.com", "author": "jara.karel@gmail.com", "count": 0, "text": "User-Agent:       Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0\n\nI think that this must be a bug in Firefox 4 because in Chrome this definitely works perfect. The problem is that if I have an synchronous XHR on onkeyup, then if you are writing characters too quickly, they are not actually written. Those characters which were typed during the XHR being processed are not there.\n\nI\u2019m adding link to this video. http://www.screenr.com/V3Q\nThis is my own script where there is XHR on onkeyup which looks up the database for existence of the string written. If the string already exists in DB, it makes the input text go red. I wrote words acknowledge, acrobat, analysis, adaptation, across and then once more analysis. As you can see, there are characters missing, they were not registered because of ongoing XHR.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Place a synchronous XHR on onkeyup of an input field.\n2. Write characters in that input field.\nActual Results:  \nSome characters are not registered.\n\nExpected Results:  \nEvery single character typed should be registered and written in the field, at least with delay but should be there.", "is_private": false, "tags": [], "bug_id": 642402, "creation_time": "2011-03-17T10:24:11Z", "raw_text": "User-Agent:       Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0\n\nI think that this must be a bug in Firefox 4 because in Chrome this definitely works perfect. The problem is that if I have an synchronous XHR on onkeyup, then if you are writing characters too quickly, they are not actually written. Those characters which were typed during the XHR being processed are not there.\n\nI\u2019m adding link to this video. http://www.screenr.com/V3Q\nThis is my own script where there is XHR on onkeyup which looks up the database for existence of the string written. If the string already exists in DB, it makes the input text go red. I wrote words acknowledge, acrobat, analysis, adaptation, across and then once more analysis. As you can see, there are characters missing, they were not registered because of ongoing XHR.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Place a synchronous XHR on onkeyup of an input field.\n2. Write characters in that input field.\nActual Results:  \nSome characters are not registered.\n\nExpected Results:  \nEvery single character typed should be registered and written in the field, at least with delay but should be there.", "id": 5350394, "time": "2011-03-17T10:24:11Z"}, {"count": 1, "text": "smaug, do we suppress key events entirely during a sync xhr, or just queue them up?\n\nKarel, per current HTML5 spec I think key input during a sync XHR is supposed to be ignored, fwiw.", "id": 5352561, "time": "2011-03-18T02:04:43Z", "author": "bzbarsky@mit.edu", "tags": [], "creator": "bzbarsky@mit.edu", "bug_id": 642402, "creation_time": "2011-03-18T02:04:43Z", "raw_text": "smaug, do we suppress key events entirely during a sync xhr, or just queue them up?\n\nKarel, per current HTML5 spec I think key input during a sync XHR is supposed to be ignored, fwiw.", "is_private": false, "attachment_id": null}, {"text": "If some keydown/press/up 'transaction' is being prosessed, events related\nto that are queued. But new keydown/press/up 'transactions' aren't.\nThat was added just to not break some existing web site.\nI'd like to get rid of even that, since while XHR is running, we just shouldn't\nqueue/process any key events, IMO.\n\n(Well, actually I'd like to allow sync XHR only in Workers)\n\nI can't now find my tests for xhr+keyevents, but at some point\nwebkit did queue all the events, but the event ordering was wrong\n(keyup and keypress events were randomly in wrong order, IIRC)", "count": 2, "author": "bugs@pettay.fi", "creator": "bugs@pettay.fi", "attachment_id": null, "time": "2011-03-18T10:35:35Z", "id": 5352976, "creation_time": "2011-03-18T10:35:35Z", "bug_id": 642402, "raw_text": "If some keydown/press/up 'transaction' is being prosessed, events related\nto that are queued. But new keydown/press/up 'transactions' aren't.\nThat was added just to not break some existing web site.\nI'd like to get rid of even that, since while XHR is running, we just shouldn't\nqueue/process any key events, IMO.\n\n(Well, actually I'd like to allow sync XHR only in Workers)\n\nI can't now find my tests for xhr+keyevents, but at some point\nwebkit did queue all the events, but the event ordering was wrong\n(keyup and keypress events were randomly in wrong order, IIRC)", "tags": [], "is_private": false}, {"id": 5352983, "time": "2011-03-18T10:48:05Z", "is_private": false, "tags": [], "creation_time": "2011-03-18T10:48:05Z", "bug_id": 642402, "raw_text": "Well, OK. The thing is that I\u2019ve been playing around with this and trying to\nuse sync XHR because when I used async, there comes a problem that when I\u2019ve\nwritten the whole word, I can never know, which of the XHR results comes last\nand therefore is shown. I\u2019ve experienced that when I wrote the whole word\n\u201canalysis\u201d, which is in my database and so should show red, it remained black\nbecause the last result that came wasn\u2019t for \u201canalysis\u201d but e.g. for \u201canalys\u201d\nwhich of course is not in DB, so the input field text remained black. I know\nthat this is not forum for solving problems of my own applications but I think\nthat this might be another bug because it never happened in Chrome, Opera, IE\nor any other browser that I tried that the result of some former async XHR\nwould come after the last one and therefore overwrite it. Of course, by their\nnature, async XHRs might not give results in order in which they were\ntriggered. But why this happens only in Firefox? Do you think I should file a\nbug on this or is it my problem?", "author": "jara.karel@gmail.com", "text": "Well, OK. The thing is that I\u2019ve been playing around with this and trying to\nuse sync XHR because when I used async, there comes a problem that when I\u2019ve\nwritten the whole word, I can never know, which of the XHR results comes last\nand therefore is shown. I\u2019ve experienced that when I wrote the whole word\n\u201canalysis\u201d, which is in my database and so should show red, it remained black\nbecause the last result that came wasn\u2019t for \u201canalysis\u201d but e.g. for \u201canalys\u201d\nwhich of course is not in DB, so the input field text remained black. I know\nthat this is not forum for solving problems of my own applications but I think\nthat this might be another bug because it never happened in Chrome, Opera, IE\nor any other browser that I tried that the result of some former async XHR\nwould come after the last one and therefore overwrite it. Of course, by their\nnature, async XHRs might not give results in order in which they were\ntriggered. But why this happens only in Firefox? Do you think I should file a\nbug on this or is it my problem?", "count": 3, "attachment_id": null, "creator": "jara.karel@gmail.com"}, {"is_private": false, "tags": [], "raw_text": "Ok, if the problem doesn't happen in any other browsers, we may need to\nchange our behavior.\n \nBut still about sync XHR. You do know that it is bad for user experience?\nWhat if the network connection has problems and each sync XHR takes 10\nseconds.\nYou could use async XHR and just abort() the ones which aren't needed anymore.\nOr keep some list of XHRs in your page and listen load events only from the\nmost recent XHR.", "bug_id": 642402, "creation_time": "2011-03-18T10:56:38Z", "id": 5352991, "time": "2011-03-18T10:56:38Z", "attachment_id": null, "creator": "bugs@pettay.fi", "author": "bugs@pettay.fi", "text": "Ok, if the problem doesn't happen in any other browsers, we may need to\nchange our behavior.\n \nBut still about sync XHR. You do know that it is bad for user experience?\nWhat if the network connection has problems and each sync XHR takes 10\nseconds.\nYou could use async XHR and just abort() the ones which aren't needed anymore.\nOr keep some list of XHRs in your page and listen load events only from the\nmost recent XHR.", "count": 4}, {"id": 5353175, "time": "2011-03-18T13:51:52Z", "is_private": false, "tags": [], "raw_text": "Just tested, even the latest Chrome seems to mess up with event ordering pretty\nbadly, so any complex scrips couldn't rely on keyevent to work properly\nwith sync XHR either.\n\nAnd Opera has similar problems, but it seems to change event ordering in a \ndifferent way.", "creation_time": "2011-03-18T13:51:52Z", "bug_id": 642402, "author": "bugs@pettay.fi", "count": 5, "text": "Just tested, even the latest Chrome seems to mess up with event ordering pretty\nbadly, so any complex scrips couldn't rely on keyevent to work properly\nwith sync XHR either.\n\nAnd Opera has similar problems, but it seems to change event ordering in a \ndifferent way.", "attachment_id": null, "creator": "bugs@pettay.fi"}]}}}