{"bugs": {"384444": {"comments": [{"creator": "petrkovak@centrum.cz", "attachment_id": null, "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; cs; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; cs; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\n\nWeek ago I found out strange behavior in my Altap Salamander 2.5 ( http://www.altap.cz/download.html#sal25 ) - most of the commands stopped working, freezing system until I hit ctrl+alt+del - in addition, this combination worked only after some time, like 30 secs. That unfreezed Salamander and task was completed without problem. I was investigating this for some time and found out that uninstalling Firefox 2 stopped this behavior. After some experiments I found out there is strange process named firefox.exe, with very low memory consumtion (1-3 MB RAM and 3-5 MB virtual memory) but with 100% CPU usage. When I killed the process, it was back running in half a minute. I noticed there is a process named msmsrs.exe that started few seconds before this strange firefox.exe popped in and it ends as soon as strange firefox.exe is started. Registry scan revealed only one connection to msmsrs.exe - c:\\program files\\drivers\\msmsrs.exe . When I killed strange firefox.exe again, I moved msmrsr.exe to another directory and deleted its registry values (msmsrs was constantly adding this registry again when it was left intact and in original directory). It seems thats all I needed to do to get my computer cleared again. As I am not the only one using my PC, I was unable to find out where this infection came from.\n\nI found out this behavior:\n1) After execution, this program coppies itself into c:\\program files\\drivers dir.\n2) It adds itself into registry, registry values included in zip file.\n3) It uses Firefox to secretly connect to internet (most probably IP 89.53.39.44), clearly to avoid firewall detection.\n4) Task manager reports this program (or, firefox.exe that is started by this program) uses 100% of CPU.\n5) When registry values are deleted, it adds them again.\n6) If this program or firefox.exe is killed, it runs itself again in half a minute (aproximately).\n7) c:\\program files\\drivers contained only two files - msmsrs.exe and klog.dat (sounds like keylogger, which, of course, can be quite dangereous). I am not adding this klog.dat file because I don't know what it contains and I fear it can contain private informations - if it will be needed for you to analyze this program, I will concider adding it on your demand.\n\nI don't know what this program really does, but it clearly has dangerous behavior typical for spyware/malware - unfortunately my BitDefender Plus antivirus did not noticed it and its firewall was worthless because msmsrs.exe used Firefox to connect.\n\nHope it helps. I sent copy of this report to SOFTWIN company (creators of BitDefender) for their analysis as well.\n\nPetr Kovarik, Czech Republic\n\nP.S.: I don't see a way to include file in this bug report, as this is critical part of my bug report, I would like to be informed how to add it, if possible, via email or ICQ 299505018.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Run msmsrs.exe (warning - dangerous software!!!)\n2. Notice second firefox.exe process in task manager.\n3.", "time": "2007-06-14T16:48:27Z", "id": 3215918, "bug_id": 384444, "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; cs; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; cs; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\n\nWeek ago I found out strange behavior in my Altap Salamander 2.5 ( http://www.altap.cz/download.html#sal25 ) - most of the commands stopped working, freezing system until I hit ctrl+alt+del - in addition, this combination worked only after some time, like 30 secs. That unfreezed Salamander and task was completed without problem. I was investigating this for some time and found out that uninstalling Firefox 2 stopped this behavior. After some experiments I found out there is strange process named firefox.exe, with very low memory consumtion (1-3 MB RAM and 3-5 MB virtual memory) but with 100% CPU usage. When I killed the process, it was back running in half a minute. I noticed there is a process named msmsrs.exe that started few seconds before this strange firefox.exe popped in and it ends as soon as strange firefox.exe is started. Registry scan revealed only one connection to msmsrs.exe - c:\\program files\\drivers\\msmsrs.exe . When I killed strange firefox.exe again, I moved msmrsr.exe to another directory and deleted its registry values (msmsrs was constantly adding this registry again when it was left intact and in original directory). It seems thats all I needed to do to get my computer cleared again. As I am not the only one using my PC, I was unable to find out where this infection came from.\n\nI found out this behavior:\n1) After execution, this program coppies itself into c:\\program files\\drivers dir.\n2) It adds itself into registry, registry values included in zip file.\n3) It uses Firefox to secretly connect to internet (most probably IP 89.53.39.44), clearly to avoid firewall detection.\n4) Task manager reports this program (or, firefox.exe that is started by this program) uses 100% of CPU.\n5) When registry values are deleted, it adds them again.\n6) If this program or firefox.exe is killed, it runs itself again in half a minute (aproximately).\n7) c:\\program files\\drivers contained only two files - msmsrs.exe and klog.dat (sounds like keylogger, which, of course, can be quite dangereous). I am not adding this klog.dat file because I don't know what it contains and I fear it can contain private informations - if it will be needed for you to analyze this program, I will concider adding it on your demand.\n\nI don't know what this program really does, but it clearly has dangerous behavior typical for spyware/malware - unfortunately my BitDefender Plus antivirus did not noticed it and its firewall was worthless because msmsrs.exe used Firefox to connect.\n\nHope it helps. I sent copy of this report to SOFTWIN company (creators of BitDefender) for their analysis as well.\n\nPetr Kovarik, Czech Republic\n\nP.S.: I don't see a way to include file in this bug report, as this is critical part of my bug report, I would like to be informed how to add it, if possible, via email or ICQ 299505018.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Run msmsrs.exe (warning - dangerous software!!!)\n2. Notice second firefox.exe process in task manager.\n3.", "count": 0, "author": "petrkovak@centrum.cz", "creation_time": "2007-06-14T16:48:27Z", "tags": [], "is_private": false}, {"creator": "petrkovak@centrum.cz", "attachment_id": null, "text": "I tried \"add an attachment\" option, but zip file is about 1.2 MB large and Bugzilla refuses to add it. Where can I send it to?", "count": 1, "bug_id": 384444, "id": 3215934, "time": "2007-06-14T16:58:02Z", "raw_text": "I tried \"add an attachment\" option, but zip file is about 1.2 MB large and Bugzilla refuses to add it. Where can I send it to?", "creation_time": "2007-06-14T16:58:02Z", "tags": [], "author": "petrkovak@centrum.cz", "is_private": false}, {"author": "crowderbt@gmail.com", "creator": "crowderbt@gmail.com", "attachment_id": null, "creation_time": "2007-06-14T17:00:37Z", "tags": [], "raw_text": "By the memory footprint alone, I'm quiet sure that the firefox.exe you're seeing here is not OUR firefox.exe, and that this is not our bug.  Nor is it a security issue for us.  What you have here is some sort of trojan or other malware totally unrelated to Firefox or Mozilla, but using the firefox name for its process identification (probably to make you more likely to ignore it?).", "time": "2007-06-14T17:00:37Z", "is_private": false, "id": 3215936, "bug_id": 384444, "text": "By the memory footprint alone, I'm quiet sure that the firefox.exe you're seeing here is not OUR firefox.exe, and that this is not our bug.  Nor is it a security issue for us.  What you have here is some sort of trojan or other malware totally unrelated to Firefox or Mozilla, but using the firefox name for its process identification (probably to make you more likely to ignore it?).", "count": 2}, {"id": 3216003, "time": "2007-06-14T17:36:42Z", "raw_text": "I thought so. But - uninstalling Firefox solves the problem - msmsrs.exe will not find it and can't run it and this problem is avoided. Also, BitDefender should have found out that process named as firefox.exe is trying to access internet and it is *not* the same firefox.exe that is in my whitelist. Of course I can be mislead by using name of the program I know, but firewall and antivirus tools are different matter. So, I am sorry but I think I have to reopen this bug. If you are really sure that I am wrong, close it again, but I have to assure you I am *not* a PC noob. I am working for a software company as a Unix administrator. It doesn't say much about my Windows experience level, but really, I would not post this \"bug\" unless I was sure (as much as I can be without good analysing tools and experience in using them, which I do not have) something is using Firefox. Even Firefox itself when I try to uninstall it says that I have to close it before I can uninstall it - but my normal Firefox was closed! That was the first thing that pointed me in this direction and told me something is wrong here.", "count": 3, "text": "I thought so. But - uninstalling Firefox solves the problem - msmsrs.exe will not find it and can't run it and this problem is avoided. Also, BitDefender should have found out that process named as firefox.exe is trying to access internet and it is *not* the same firefox.exe that is in my whitelist. Of course I can be mislead by using name of the program I know, but firewall and antivirus tools are different matter. So, I am sorry but I think I have to reopen this bug. If you are really sure that I am wrong, close it again, but I have to assure you I am *not* a PC noob. I am working for a software company as a Unix administrator. It doesn't say much about my Windows experience level, but really, I would not post this \"bug\" unless I was sure (as much as I can be without good analysing tools and experience in using them, which I do not have) something is using Firefox. Even Firefox itself when I try to uninstall it says that I have to close it before I can uninstall it - but my normal Firefox was closed! That was the first thing that pointed me in this direction and told me something is wrong here.", "bug_id": 384444, "attachment_id": null, "creator": "petrkovak@centrum.cz", "is_private": false, "author": "petrkovak@centrum.cz", "tags": [], "creation_time": "2007-06-14T17:36:42Z"}, {"is_private": false, "author": "jo.hermans@gmail.com", "creation_time": "2007-06-14T17:41:09Z", "tags": [], "id": 3216014, "raw_text": "On <http://www.forospyware.com/archive/t-92783.html> (sorry, in Spanish), I\nfound that it might have been the PerfectKeylog.IA spyware.", "time": "2007-06-14T17:41:09Z", "count": 4, "text": "On <http://www.forospyware.com/archive/t-92783.html> (sorry, in Spanish), I\nfound that it might have been the PerfectKeylog.IA spyware.", "bug_id": 384444, "attachment_id": null, "creator": "jo.hermans@gmail.com"}, {"is_private": false, "author": "petrkovak@centrum.cz", "tags": [], "creation_time": "2007-06-16T06:05:19Z", "id": 3217825, "raw_text": "OK, I have continued in my investigation how this program got to my PC and finally I found it's source. Link on the end of this comment points to torrent file, which, when you use it with program like bittorent, utorrent or similar, will download 1.2 MB file which is msmsrs.exe - it has only different name.\nBTW, tell me, why someone like (probably) my brother  thinks they can simply get working serial for purely online-played game? I don't get it...\n\nhttp://isohunt.com/download/19582385/", "time": "2007-06-16T06:05:19Z", "count": 5, "text": "OK, I have continued in my investigation how this program got to my PC and finally I found it's source. Link on the end of this comment points to torrent file, which, when you use it with program like bittorent, utorrent or similar, will download 1.2 MB file which is msmsrs.exe - it has only different name.\nBTW, tell me, why someone like (probably) my brother  thinks they can simply get working serial for purely online-played game? I don't get it...\n\nhttp://isohunt.com/download/19582385/", "bug_id": 384444, "attachment_id": null, "creator": "petrkovak@centrum.cz"}, {"creation_time": "2007-06-18T01:09:07Z", "tags": [], "author": "gavin.sharp@gmail.com", "is_private": false, "creator": "gavin.sharp@gmail.com", "attachment_id": null, "text": "If third party malicious software is installed on your computer, there isn't much we can do about it. This isn't a Firefox bug.", "count": 6, "bug_id": 384444, "id": 3219150, "raw_text": "If third party malicious software is installed on your computer, there isn't much we can do about it. This isn't a Firefox bug.", "time": "2007-06-18T01:09:07Z"}, {"attachment_id": null, "creator": "petrkovak@centrum.cz", "count": 7, "text": "Well, I don't see into Firefox programming, I posted this \"bug\" because I didn't know if there is a bug in Firefox code that allows such behavior. I remind you, msmsrs.exe is using Firefox, not IE, Opera or anything else and it don't work without Firefox. In a world where IE is still dominating internet browser, its interesting to know that. I am perfectly aware that without outside \"help\", Firefox would not act that way, but it's the same for many security threats, people will always try to find weaknesses in someone else's software.\nI hoped that you will find how it was done and prevent further attacks from msmrsr.exe and similar programs using this weakness, so Firefox can be more secure. Seems I was wrong.", "bug_id": 384444, "id": 3222441, "raw_text": "Well, I don't see into Firefox programming, I posted this \"bug\" because I didn't know if there is a bug in Firefox code that allows such behavior. I remind you, msmsrs.exe is using Firefox, not IE, Opera or anything else and it don't work without Firefox. In a world where IE is still dominating internet browser, its interesting to know that. I am perfectly aware that without outside \"help\", Firefox would not act that way, but it's the same for many security threats, people will always try to find weaknesses in someone else's software.\nI hoped that you will find how it was done and prevent further attacks from msmrsr.exe and similar programs using this weakness, so Firefox can be more secure. Seems I was wrong.", "time": "2007-06-20T14:12:40Z", "creation_time": "2007-06-20T14:12:40Z", "tags": [], "author": "petrkovak@centrum.cz", "is_private": false}, {"count": 8, "text": "Petr: There isn't an inherent flaw in firefox that allows it to be used this way, and in fact I am quite certain that what you're seeing it another process masquerading itself as firefox.  It probably chooses not to masquerade as firefox when you uninstall firefox, because masquerading as software which you don't have installed on your system wouldn't be as effective in deceiving you into believing your system was uncompromised.\n\nThere is nothing we can fix here; if your system has been compromised by a trojan or a virus, no amount of code we write can save you.  Even if the firefox application itself -were- being used, a program running on your compromised system could easily patch the firefox binary to behave in -any- way.  This is not a \"weakness in Mozilla software\", but the simple reality of what it means to have your system compromised.  You sound discouraged and upset, and I can understand why; but there is no extra layer of safety that can be added by firefox here.  The best we can do is to work to make sure your system is less easily compromised in the future -- we can't really help you much once it has been compromised.  That is more the domain of anti-virus software.", "bug_id": 384444, "id": 3222483, "time": "2007-06-20T15:03:01Z", "raw_text": "Petr: There isn't an inherent flaw in firefox that allows it to be used this way, and in fact I am quite certain that what you're seeing it another process masquerading itself as firefox.  It probably chooses not to masquerade as firefox when you uninstall firefox, because masquerading as software which you don't have installed on your system wouldn't be as effective in deceiving you into believing your system was uncompromised.\n\nThere is nothing we can fix here; if your system has been compromised by a trojan or a virus, no amount of code we write can save you.  Even if the firefox application itself -were- being used, a program running on your compromised system could easily patch the firefox binary to behave in -any- way.  This is not a \"weakness in Mozilla software\", but the simple reality of what it means to have your system compromised.  You sound discouraged and upset, and I can understand why; but there is no extra layer of safety that can be added by firefox here.  The best we can do is to work to make sure your system is less easily compromised in the future -- we can't really help you much once it has been compromised.  That is more the domain of anti-virus software.", "creator": "crowderbt@gmail.com", "attachment_id": null, "is_private": false, "creation_time": "2007-06-20T15:03:01Z", "tags": [], "author": "crowderbt@gmail.com"}, {"author": "petrkovak@centrum.cz", "creation_time": "2007-06-21T05:05:02Z", "tags": [], "is_private": false, "attachment_id": null, "creator": "petrkovak@centrum.cz", "id": 3223339, "raw_text": "Oh, really, trust me, I am not discouradged or even worse, upset - I posted this \"bug\" only to inform you and if it was possible, to make Firefox more secure. If you say it has nothing to do with Firefox, I don't have any reason not to believe you and good thing is, I haven't found any Firefox Security bug to fix - thats good message, one less vulnerability to wory about and I am glad it ended this way.\nThe only reason I can feel upset is that my BitDefender is not reacting to this danger even when I sent them complete information and program. BitDefender is usually quite good and react fast to new threats. Also I would like to find out how msmsrsr.exe avoided not only antivirus but even firewall - it looks like it doesn't even perform checks to find out if allowed process has same signatures, hash or any other test firewall can do to be sure program is the same as the one in whitelist.\nBut all of this is only my problem and its more in a \"it's interesting, lets look how it works\" way then being upset. OK, I have wrote more then enough, time to move on and stop eating your time reading this and even more time answering, good luck in bug hunting!", "time": "2007-06-21T05:05:02Z", "text": "Oh, really, trust me, I am not discouradged or even worse, upset - I posted this \"bug\" only to inform you and if it was possible, to make Firefox more secure. If you say it has nothing to do with Firefox, I don't have any reason not to believe you and good thing is, I haven't found any Firefox Security bug to fix - thats good message, one less vulnerability to wory about and I am glad it ended this way.\nThe only reason I can feel upset is that my BitDefender is not reacting to this danger even when I sent them complete information and program. BitDefender is usually quite good and react fast to new threats. Also I would like to find out how msmsrsr.exe avoided not only antivirus but even firewall - it looks like it doesn't even perform checks to find out if allowed process has same signatures, hash or any other test firewall can do to be sure program is the same as the one in whitelist.\nBut all of this is only my problem and its more in a \"it's interesting, lets look how it works\" way then being upset. OK, I have wrote more then enough, time to move on and stop eating your time reading this and even more time answering, good luck in bug hunting!", "count": 9, "bug_id": 384444}]}}, "comments": {}}