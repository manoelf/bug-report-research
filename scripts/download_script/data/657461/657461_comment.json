{"bugs": {"657461": {"comments": [{"attachment_id": null, "creator": "tnikkel@gmail.com", "author": "tnikkel@gmail.com", "text": "If I click in an empty space in a google calendar to create a new event the caret in the box where the event name is to go is sometimes only drawn partially. It depends on the zoom level (try zooming in a few times) and the location you click in the calendar (try clicking in a bunch of different places).\n\nRegression range from nightlies\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=7d90da136b2c&tochange=fe3f7889918b\n\nMaybe bug 644428 or bug 646382.", "count": 0, "is_private": false, "tags": [], "bug_id": 657461, "creation_time": "2011-05-16T20:55:40Z", "raw_text": "If I click in an empty space in a google calendar to create a new event the caret in the box where the event name is to go is sometimes only drawn partially. It depends on the zoom level (try zooming in a few times) and the location you click in the calendar (try clicking in a bunch of different places).\n\nRegression range from nightlies\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=7d90da136b2c&tochange=fe3f7889918b\n\nMaybe bug 644428 or bug 646382.", "id": 5473273, "time": "2011-05-16T20:55:40Z"}, {"attachment_id": null, "is_private": false, "bug_id": 657461, "creation_time": "2011-05-16T22:12:25Z", "raw_text": "a7056f19b2aa is the first bad changeset, so bug 646382.", "tags": [], "creator": "tnikkel@gmail.com", "time": "2011-05-16T22:12:25Z", "author": "tnikkel@gmail.com", "id": 5473493, "count": 1, "text": "a7056f19b2aa is the first bad changeset, so bug 646382."}, {"creator": "ehsan.akhgari@gmail.com", "attachment_id": null, "text": "OK, here's what's happening.  In the testcase for bug 646382, the BR frame is put on the baseline because we're not in the standards compliance mode, so the value that we return from GetBaseline ends up being correct.  In the testcase here, however, the document is in standards compliance mode, and the BR frame ends up at the top of the line, so the baseline value returned (0) is not correct, which causes us to invalidate the wrong line.\n\nThe fix is to change the behavior based on the BR_USING_CENTERED_FONT_BASELINE flag.  It's tricky though, since by the time that the first GetBaseline call is made to get the caret rect, the BR frame has not been reflowed yet, so that bit would always be unset.  I looked into copying the logic of BRFrame::Reflow which determines when to set that bit, but that is also hard, since we don't have an nsLineLayout object around...  I'm not sure what a solution would look like.", "count": 2, "author": "ehsan.akhgari@gmail.com", "raw_text": "OK, here's what's happening.  In the testcase for bug 646382, the BR frame is put on the baseline because we're not in the standards compliance mode, so the value that we return from GetBaseline ends up being correct.  In the testcase here, however, the document is in standards compliance mode, and the BR frame ends up at the top of the line, so the baseline value returned (0) is not correct, which causes us to invalidate the wrong line.\n\nThe fix is to change the behavior based on the BR_USING_CENTERED_FONT_BASELINE flag.  It's tricky though, since by the time that the first GetBaseline call is made to get the caret rect, the BR frame has not been reflowed yet, so that bit would always be unset.  I looked into copying the logic of BRFrame::Reflow which determines when to set that bit, but that is also hard, since we don't have an nsLineLayout object around...  I'm not sure what a solution would look like.", "creation_time": "2011-06-14T00:00:40Z", "bug_id": 657461, "tags": [], "is_private": false, "time": "2011-06-14T00:00:40Z", "id": 5530307}, {"count": 3, "text": "Created attachment 539336\nWIP\n\nThe WIP patch that I have so far...", "author": "ehsan.akhgari@gmail.com", "creator": "ehsan.akhgari@gmail.com", "attachment_id": 539336, "id": 5532592, "time": "2011-06-14T22:11:25Z", "tags": [], "raw_text": "The WIP patch that I have so far...", "bug_id": 657461, "creation_time": "2011-06-14T22:11:25Z", "is_private": false}]}}, "comments": {}}