{"comments": {}, "bugs": {"700808": {"comments": [{"raw_text": "Currently all the Composer/Composition strings live in editor/ui/locales. In the jar file there is an ifdef MOZ_SUITE, for strings that are Composer only.\n\nHowever, due to the way 1l0n works, the rule is that ifdefs don't work for l10n. Therefore any locale that localises Thunderbird, has to localise *all* the editor/ui/locales files.\n\nIf we move these files to a different directory, then I think there are the following benefits:\n\n- Removes some of the potential confusion (that I have every time I review a patch there) of what a particular file belongs to (composition versus composer).\n- Removes just under 300 strings from the ones that localisers have to do for Thunderbird.\n- Ensures that Thunderbird doesn't ship a set of files (the redundant localised ones) that it doesn't need to.\n\nI've currently gone for editor/composer, as that seems to keep them in approximately the same place, works with the tools, but does the necessary separation.\n\nI think this patch is probably final, but I'm offering it up for feedback first.\n\nIf we land this, I'd propose that I would organise a script to go through the localisers directories and do a hg move of the appropriate files - either one they can run themselves, or one we do automatically when it reaches aurora.", "attachment_id": 573007, "id": 5835412, "count": 0, "is_private": false, "creator": "standard8@mozilla.com", "text": "Created attachment 573007\nProposed fix\n\nCurrently all the Composer/Composition strings live in editor/ui/locales. In the jar file there is an ifdef MOZ_SUITE, for strings that are Composer only.\n\nHowever, due to the way 1l0n works, the rule is that ifdefs don't work for l10n. Therefore any locale that localises Thunderbird, has to localise *all* the editor/ui/locales files.\n\nIf we move these files to a different directory, then I think there are the following benefits:\n\n- Removes some of the potential confusion (that I have every time I review a patch there) of what a particular file belongs to (composition versus composer).\n- Removes just under 300 strings from the ones that localisers have to do for Thunderbird.\n- Ensures that Thunderbird doesn't ship a set of files (the redundant localised ones) that it doesn't need to.\n\nI've currently gone for editor/composer, as that seems to keep them in approximately the same place, works with the tools, but does the necessary separation.\n\nI think this patch is probably final, but I'm offering it up for feedback first.\n\nIf we land this, I'd propose that I would organise a script to go through the localisers directories and do a hg move of the appropriate files - either one they can run themselves, or one we do automatically when it reaches aurora.", "time": "2011-11-08T22:26:11Z", "bug_id": 700808, "tags": [], "creation_time": "2011-11-08T22:26:11Z", "author": "standard8@mozilla.com"}, {"raw_text": "I'm not really happy with moving around strings without moving the files that use them as well.", "attachment_id": null, "id": 5836701, "count": 1, "creator": "kairo@kairo.at", "is_private": false, "tags": [], "time": "2011-11-09T12:37:24Z", "bug_id": 700808, "text": "I'm not really happy with moving around strings without moving the files that use them as well.", "author": "kairo@kairo.at", "creation_time": "2011-11-09T12:37:24Z"}, {"raw_text": "We can move the content files as well if necessary, that shouldn't be too much effort as I think they are already ifdeffed as well.", "attachment_id": null, "id": 5836723, "creator": "standard8@mozilla.com", "is_private": false, "tags": [], "time": "2011-11-09T12:52:03Z", "text": "We can move the content files as well if necessary, that shouldn't be too much effort as I think they are already ifdeffed as well.", "author": "standard8@mozilla.com", "creation_time": "2011-11-09T12:52:03Z", "count": 2, "bug_id": 700808}, {"bug_id": 700808, "count": 3, "tags": [], "time": "2011-11-09T12:57:29Z", "text": "(In reply to Mark Banner (:standard8) from comment #2)\n> We can move the content files as well if necessary, that shouldn't be too\n> much effort as I think they are already ifdeffed as well.\n\nThat would be good and much cleaner (also would make things easier when editing the files as we'd see easily which files affect Thunderbird and which don't).", "author": "kairo@kairo.at", "creation_time": "2011-11-09T12:57:29Z", "creator": "kairo@kairo.at", "is_private": false, "id": 5836739, "raw_text": "(In reply to Mark Banner (:standard8) from comment #2)\n> We can move the content files as well if necessary, that shouldn't be too\n> much effort as I think they are already ifdeffed as well.\n\nThat would be good and much cleaner (also would make things easier when editing the files as we'd see easily which files affect Thunderbird and which don't).", "attachment_id": null}, {"author": "l10n@mozilla.com", "creation_time": "2011-11-09T15:00:50Z", "tags": [], "bug_id": 700808, "time": "2011-11-09T15:00:50Z", "text": "Comment on attachment 573007\nProposed fix\n\nReview of attachment 573007:\n-----------------------------------------------------------------\n\nLooks good to me in theory, I don't really have a opinion on the bug itself.\n\nYou probably want to patch all of the l10n.ini files, the plain l10n.ini as well as aurora and beta ones, as the change in directories will be moving through the channels along with the l10n.ini files. I.e., changing l10n-aurora.ini on comm-central doesn't affect things, but it does the right thing once comm-central migrates to comm-aurora all by itself.\n\nI guess we could hg remove the 1.9.2 and miramar ones now, too.", "creator": "l10n@mozilla.com", "is_private": false, "count": 4, "id": 5836949, "attachment_id": 573007, "raw_text": "Review of attachment 573007:\n-----------------------------------------------------------------\n\nLooks good to me in theory, I don't really have a opinion on the bug itself.\n\nYou probably want to patch all of the l10n.ini files, the plain l10n.ini as well as aurora and beta ones, as the change in directories will be moving through the channels along with the l10n.ini files. I.e., changing l10n-aurora.ini on comm-central doesn't affect things, but it does the right thing once comm-central migrates to comm-aurora all by itself.\n\nI guess we could hg remove the 1.9.2 and miramar ones now, too."}, {"attachment_id": null, "raw_text": "", "id": 5874537, "creator": "iannbugzilla@gmail.com", "is_private": false, "count": 5, "author": "iannbugzilla@gmail.com", "creation_time": "2011-11-27T21:00:02Z", "bug_id": 700808, "tags": [], "time": "2011-11-27T21:00:02Z", "text": "*** Bug 698618 has been marked as a duplicate of this bug. ***"}, {"raw_text": "As Robert suggested could the relevant xul/js files be moved too.", "attachment_id": 573007, "id": 5874604, "count": 6, "creator": "iannbugzilla@gmail.com", "is_private": false, "bug_id": 700808, "tags": [], "time": "2011-11-27T22:43:48Z", "text": "Comment on attachment 573007\nProposed fix\n\nAs Robert suggested could the relevant xul/js files be moved too.", "author": "iannbugzilla@gmail.com", "creation_time": "2011-11-27T22:43:48Z"}, {"is_private": false, "creator": "neil@httl.net", "creation_time": "2012-01-11T16:54:57Z", "author": "neil@httl.net", "text": "(In reply to Mark Banner from comment #0)\n> However, due to the way 1l0n works, the rule is that ifdefs don't work for l10n.\nPresumably this is because it's unclear which files are needed for Thunderbird, rather than any technical reason.", "time": "2012-01-11T16:54:57Z", "tags": [], "attachment_id": null, "raw_text": "(In reply to Mark Banner from comment #0)\n> However, due to the way 1l0n works, the rule is that ifdefs don't work for l10n.\nPresumably this is because it's unclear which files are needed for Thunderbird, rather than any technical reason.", "id": 5972315, "count": 7, "bug_id": 700808}, {"author": "standard8@mozilla.com", "creation_time": "2012-01-11T22:08:26Z", "tags": [], "time": "2012-01-11T22:08:26Z", "text": "(In reply to neil@parkwaycc.co.uk from comment #7)\n> (In reply to Mark Banner from comment #0)\n> > However, due to the way 1l0n works, the rule is that ifdefs don't work for l10n.\n> Presumably this is because it's unclear which files are needed for\n> Thunderbird, rather than any technical reason.\n\nNo its a technical reason. compare-locales works on directory basis, l10n repacks works on a directory basis, localisers work on a directory basis etc etc (I certainly remember seeing a few years ago that localisations don't do ifdefs, and that's still true).", "creator": "standard8@mozilla.com", "is_private": false, "id": 5973511, "attachment_id": null, "raw_text": "(In reply to neil@parkwaycc.co.uk from comment #7)\n> (In reply to Mark Banner from comment #0)\n> > However, due to the way 1l0n works, the rule is that ifdefs don't work for l10n.\n> Presumably this is because it's unclear which files are needed for\n> Thunderbird, rather than any technical reason.\n\nNo its a technical reason. compare-locales works on directory basis, l10n repacks works on a directory basis, localisers work on a directory basis etc etc (I certainly remember seeing a few years ago that localisations don't do ifdefs, and that's still true).", "bug_id": 700808, "count": 8}, {"creator": "l10n@mozilla.com", "is_private": false, "count": 9, "author": "l10n@mozilla.com", "creation_time": "2012-01-11T22:26:32Z", "bug_id": 700808, "time": "2012-01-11T22:26:32Z", "tags": [], "text": "We're trying to keep our file formats out there as simple as possible, so that the folks that build infrastructure for localizers out there can handle it.\n\nThat kinda rules out preprocessing our files, in particular if it's totally unclear what a tool like narro should actually do.\n\nOn a more meta level, we're localizing the source. So the localization of a source file would have to not just localize the strings, but the logic as well. That's pretty steep, in particular as there's little to gain in general. Like, worst case you're shipping a few dozens extra strings, right? compared to a dozen MB download, that's not worth it.", "attachment_id": null, "raw_text": "We're trying to keep our file formats out there as simple as possible, so that the folks that build infrastructure for localizers out there can handle it.\n\nThat kinda rules out preprocessing our files, in particular if it's totally unclear what a tool like narro should actually do.\n\nOn a more meta level, we're localizing the source. So the localization of a source file would have to not just localize the strings, but the logic as well. That's pretty steep, in particular as there's little to gain in general. Like, worst case you're shipping a few dozens extra strings, right? compared to a dozen MB download, that's not worth it.", "id": 5973598}, {"count": 10, "bug_id": 700808, "attachment_id": null, "raw_text": "(In reply to Axel Hecht from comment #9)\n> That kinda rules out preprocessing our files\nI already knew that preprocessing dtd/properties files was a no-no, but only because of reasons that don't apply to jar.mn which isn't itself localised. I don't actually know how compare-locales or repacks work so it wasn't clear that they were unable to cope with a preprocessed jar.mn either.", "id": 5974055, "creator": "neil@httl.net", "is_private": false, "author": "neil@httl.net", "creation_time": "2012-01-12T00:56:03Z", "tags": [], "time": "2012-01-12T00:56:03Z", "text": "(In reply to Axel Hecht from comment #9)\n> That kinda rules out preprocessing our files\nI already knew that preprocessing dtd/properties files was a no-no, but only because of reasons that don't apply to jar.mn which isn't itself localised. I don't actually know how compare-locales or repacks work so it wasn't clear that they were unable to cope with a preprocessed jar.mn either."}, {"author": "l10n@mozilla.com", "creation_time": "2012-01-12T18:54:07Z", "tags": [], "time": "2012-01-12T18:54:07Z", "bug_id": 700808, "text": "Taking it more to the meta level, we're localizing the source, and not something as it may or may not be built. So processing, inside a particular file, or selecting particular parts of the tree, just don't happen.\n\nTechnically, compare-locales works on a module basis, that is, anything in foo/bar/locales/en-US/** is localized, given that l10n.ini references foo/bar.\njar.mn are going through the preprocessor, so you can only ship those files in part.\n\nThe l10n dashboard and the l10n-merge logic won't know about those details of your build, though.", "creator": "l10n@mozilla.com", "is_private": false, "count": 11, "id": 5975993, "attachment_id": null, "raw_text": "Taking it more to the meta level, we're localizing the source, and not something as it may or may not be built. So processing, inside a particular file, or selecting particular parts of the tree, just don't happen.\n\nTechnically, compare-locales works on a module basis, that is, anything in foo/bar/locales/en-US/** is localized, given that l10n.ini references foo/bar.\njar.mn are going through the preprocessor, so you can only ship those files in part.\n\nThe l10n dashboard and the l10n-merge logic won't know about those details of your build, though."}, {"raw_text": "I'm not working on this at the moment, but I'd love to see it improved for localisers.", "attachment_id": null, "id": 6847592, "creator": "standard8@mozilla.com", "is_private": false, "time": "2012-11-23T12:46:16Z", "tags": [], "text": "I'm not working on this at the moment, but I'd love to see it improved for localisers.", "author": "standard8@mozilla.com", "creation_time": "2012-11-23T12:46:16Z", "count": 12, "bug_id": 700808}]}}}