{"bugs": {"1630925": {"comments": [{"creator": "fbraun@mozilla.com", "time": "2020-04-17T10:58:54Z", "is_private": false, "bug_id": 1630925, "tags": [], "text": "This e-mail was sent to our dev-security mailing list, with a patch attached:\n\n> Hi , dev-security@lists.mozilla.org\n> \n> I found a bug in function NSS_CMSSignedData_GetSignerInfo, sigd->signerInfos not judged !NULL before use. It cause core dump.\n> \n> NSSCMSSignerInfo *\n> NSS_CMSSignedData_GetSignerInfo(NSSCMSSignedData *sigd, int i)\n> {\n>     if (!sigd) {\n>         PORT_SetError(SEC_ERROR_INVALID_ARGS);\n>         return NULL;\n>     }\n>     return sigd->signerInfos[i];\n> }\n> \n> \n> Signed-off-by: zhujianwei7 <zhujianwei7@huawei.com>\n> ---\n>\n> ```\n> diff -uNr nss/lib/smime/cmssigdata.c nss.fix/lib/smime/cmssigdata.c\n> --- nss/lib/smime/cmssigdata.c  2018-12-01 06:41:31.000000000 +0800\n> +++ nss.fix/lib/smime/cmssigdata.c  2020-04-08 08:20:28.931050077 +0800\n> @@ -476,7 +476,7 @@\n>  NSSCMSSignerInfo *\n>  NSS_CMSSignedData_GetSignerInfo(NSSCMSSignedData *sigd, int i)\n>  {\n> -    if (!sigd) {\n> +    if (!sigd || !sigd->signerInfos) {\n>          PORT_SetError(SEC_ERROR_INVALID_ARGS);\n>          return NULL;\n>      }\n> ```", "count": 0, "creation_time": "2020-04-17T10:58:54Z", "id": 14761200, "author": "fbraun@mozilla.com", "attachment_id": null, "raw_text": "This e-mail was sent to our dev-security mailing list, with a patch attached:\n\n> Hi , dev-security@lists.mozilla.org\n> \n> I found a bug in function NSS_CMSSignedData_GetSignerInfo, sigd->signerInfos not judged !NULL before use. It cause core dump.\n> \n> NSSCMSSignerInfo *\n> NSS_CMSSignedData_GetSignerInfo(NSSCMSSignedData *sigd, int i)\n> {\n>     if (!sigd) {\n>         PORT_SetError(SEC_ERROR_INVALID_ARGS);\n>         return NULL;\n>     }\n>     return sigd->signerInfos[i];\n> }\n> \n> \n> Signed-off-by: zhujianwei7 <zhujianwei7@huawei.com>\n> ---\n>\n> ```\n> diff -uNr nss/lib/smime/cmssigdata.c nss.fix/lib/smime/cmssigdata.c\n> --- nss/lib/smime/cmssigdata.c  2018-12-01 06:41:31.000000000 +0800\n> +++ nss.fix/lib/smime/cmssigdata.c  2020-04-08 08:20:28.931050077 +0800\n> @@ -476,7 +476,7 @@\n>  NSSCMSSignerInfo *\n>  NSS_CMSSignedData_GetSignerInfo(NSSCMSSignedData *sigd, int i)\n>  {\n> -    if (!sigd) {\n> +    if (!sigd || !sigd->signerInfos) {\n>          PORT_SetError(SEC_ERROR_INVALID_ARGS);\n>          return NULL;\n>      }\n> ```"}, {"creation_time": "2020-04-28T16:55:01Z", "count": 1, "raw_text": "Emailed reporter to ask how they'd like to be attributed, if they would.", "time": "2020-04-28T16:55:01Z", "creator": "jc@insufficient.coffee", "tags": [], "text": "Emailed reporter to ask how they'd like to be attributed, if they would.", "attachment_id": null, "id": 14784353, "author": "jc@insufficient.coffee", "is_private": false, "bug_id": 1630925}, {"creator": "jc@insufficient.coffee", "time": "2020-04-30T18:22:33Z", "tags": [], "bug_id": 1630925, "is_private": false, "creation_time": "2020-04-30T18:22:33Z", "count": 2, "text": "Created attachment 9144787\nBug 1630925 - Guard all instances of NSSCMSSignedData.signerInfos r=kjacobs", "attachment_id": 9144787, "raw_text": "", "id": 14789462, "author": "jc@insufficient.coffee"}, {"tags": [], "time": "2020-04-30T22:04:17Z", "creator": "jc@insufficient.coffee", "raw_text": "https://hg.mozilla.org/projects/nss/rev/bb4462a16de8ca52068ca1e83351b576b60f2410", "count": 3, "creation_time": "2020-04-30T22:04:17Z", "is_private": false, "bug_id": 1630925, "author": "jc@insufficient.coffee", "id": 14790204, "attachment_id": null, "text": "https://hg.mozilla.org/projects/nss/rev/bb4462a16de8ca52068ca1e83351b576b60f2410"}]}}, "comments": {}}