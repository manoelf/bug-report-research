{"comments": {}, "bugs": {"697936": {"comments": [{"is_private": false, "creation_time": "2011-10-28T05:45:41Z", "id": 5810768, "bug_id": 697936, "text": "Created attachment 570190\n\"Restore Windows\" dialog screenshot\n\nAfter a startup crash (or two?), OS X displays a dialog asking whether is should try again to restore the applications' windows (screenshot attached):\n\n==\n'The application \u201cNightlyDebug\u201d unexpectedly quit while trying to restore its windows.  Do you want to try to restore its windows again?'\n\n[Don't Restore Windows] [Restore Windows]\n==\n\nI believe this quote from the developer documentation is related to the dialog:\n\"All Cocoa window and view objects save basic information about their size and location, plus information about other attributes that might affect the way they are currently displayed.\" [1]\n\nI haven't notice any difference between the result of clicking the two buttons.  If there is no difference in the buttons because we haven't implemented some new Lion APIs then we should consider disabling this dialog to prevent confusion.  I'm adding our own startup crash detection in bug 294260 and it will be confusing for the user to see both dialogs.\n\nSupposedly this feature can be disabled per application using the following command[2]:\n defaults write com.postbox-inc.postbox NSQuitAlwaysKeepsWindows -int 0\n\nThis may be related to bug 639707 but I can't seem to find this OS X dialog explicitly documented to know for sure.\n\n[1] https://developer.apple.com/library/mac/#documentation/General/Conceptual/MOSXAppProgrammingGuide/CoreAppDesign/CoreAppDesign.html#//apple_ref/doc/uid/TP40010543-CH3-SW20 \"Writing Out the State of Your Windows and Custom Objects\"\n[2] http://support.postbox-inc.com/entries/20301018-can-t-start-postbox-on-os-x-lion-after-a-crash-blocked-by-restore-windows-dialog#overview", "count": 0, "author": "mozilla+bmo@noorenberghe.ca", "creator": "mozilla+bmo@noorenberghe.ca", "tags": [], "raw_text": "After a startup crash (or two?), OS X displays a dialog asking whether is should try again to restore the applications' windows (screenshot attached):\n\n==\n'The application \u201cNightlyDebug\u201d unexpectedly quit while trying to restore its windows.  Do you want to try to restore its windows again?'\n\n[Don't Restore Windows] [Restore Windows]\n==\n\nI believe this quote from the developer documentation is related to the dialog:\n\"All Cocoa window and view objects save basic information about their size and location, plus information about other attributes that might affect the way they are currently displayed.\" [1]\n\nI haven't notice any difference between the result of clicking the two buttons.  If there is no difference in the buttons because we haven't implemented some new Lion APIs then we should consider disabling this dialog to prevent confusion.  I'm adding our own startup crash detection in bug 294260 and it will be confusing for the user to see both dialogs.\n\nSupposedly this feature can be disabled per application using the following command[2]:\n defaults write com.postbox-inc.postbox NSQuitAlwaysKeepsWindows -int 0\n\nThis may be related to bug 639707 but I can't seem to find this OS X dialog explicitly documented to know for sure.\n\n[1] https://developer.apple.com/library/mac/#documentation/General/Conceptual/MOSXAppProgrammingGuide/CoreAppDesign/CoreAppDesign.html#//apple_ref/doc/uid/TP40010543-CH3-SW20 \"Writing Out the State of Your Windows and Custom Objects\"\n[2] http://support.postbox-inc.com/entries/20301018-can-t-start-postbox-on-os-x-lion-after-a-crash-blocked-by-restore-windows-dialog#overview", "attachment_id": 570190, "time": "2011-10-28T05:45:41Z"}, {"tags": [], "raw_text": "Do you have a way to reproduce this?\n\nIs the crash related to the dialog, or might any startup crash trigger this dialog?\n\nFor myself, I've never seen this dialog.  But I don't run very often on OS X Lion, and I'm not sure I've ever had an FF startup crash on Lion.", "attachment_id": null, "time": "2011-10-28T14:53:42Z", "is_private": false, "creation_time": "2011-10-28T14:53:42Z", "bug_id": 697936, "id": 5811357, "text": "Do you have a way to reproduce this?\n\nIs the crash related to the dialog, or might any startup crash trigger this dialog?\n\nFor myself, I've never seen this dialog.  But I don't run very often on OS X Lion, and I'm not sure I've ever had an FF startup crash on Lion.", "count": 1, "author": "smichaud@pobox.com", "creator": "smichaud@pobox.com"}, {"time": "2011-10-28T14:55:51Z", "raw_text": "Do you have a Breakpad ID for the crash that triggered this dialog?  (Yes, I think Breakpad is disabled in debug builds, but I'm asking just in case.)", "bug_id": 697936, "id": 5811361, "author": "smichaud@pobox.com", "text": "Do you have a Breakpad ID for the crash that triggered this dialog?  (Yes, I think Breakpad is disabled in debug builds, but I'm asking just in case.)", "count": 2, "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-10-28T14:55:51Z", "creator": "smichaud@pobox.com"}, {"raw_text": "(In reply to Steven Michaud from comment #1)\n> Do you have a way to reproduce this?\n\nI'm writing code (attached) to cause a crash in order to test my crash detection.\n\n> Is the crash related to the dialog, or might any startup crash trigger this\n> dialog?\n\nI don't think the crash is related to the dialog. This dialog conflicts with the crash detection I'm adding so I think we should either act specially after the OS detects a startup crash or disable this feature and let the startup crash detection in bug 294260 handle it.\n\n> For myself, I've never seen this dialog.  But I don't run very often on OS X\n> Lion, and I'm not sure I've ever had an FF startup crash on Lion.\n\nI'd never seen it either before forcing a startup crash.\n\n(In reply to Steven Michaud from comment #2)\n> Do you have a Breakpad ID for the crash that triggered this dialog?  (Yes, I\n> think Breakpad is disabled in debug builds, but I'm asking just in case.)\n\nThere's no crash report but you can try the patch or make your own crash to see what happens.\n\nOther than this dialog interfering with the UI added in bug 294260 I mostly wanted to make sure the team was aware of this OS feature so we can handle it appropriately.", "attachment_id": 575991, "time": "2011-11-21T23:17:51Z", "tags": [], "text": "Created attachment 575991\nForce crash with null pointer if FORCECRASH=1\n\n(In reply to Steven Michaud from comment #1)\n> Do you have a way to reproduce this?\n\nI'm writing code (attached) to cause a crash in order to test my crash detection.\n\n> Is the crash related to the dialog, or might any startup crash trigger this\n> dialog?\n\nI don't think the crash is related to the dialog. This dialog conflicts with the crash detection I'm adding so I think we should either act specially after the OS detects a startup crash or disable this feature and let the startup crash detection in bug 294260 handle it.\n\n> For myself, I've never seen this dialog.  But I don't run very often on OS X\n> Lion, and I'm not sure I've ever had an FF startup crash on Lion.\n\nI'd never seen it either before forcing a startup crash.\n\n(In reply to Steven Michaud from comment #2)\n> Do you have a Breakpad ID for the crash that triggered this dialog?  (Yes, I\n> think Breakpad is disabled in debug builds, but I'm asking just in case.)\n\nThere's no crash report but you can try the patch or make your own crash to see what happens.\n\nOther than this dialog interfering with the UI added in bug 294260 I mostly wanted to make sure the team was aware of this OS feature so we can handle it appropriately.", "count": 3, "author": "mozilla+bmo@noorenberghe.ca", "creator": "mozilla+bmo@noorenberghe.ca", "creation_time": "2011-11-21T23:17:51Z", "is_private": false, "id": 5863886, "bug_id": 697936}, {"is_private": false, "creation_time": "2011-11-22T17:54:45Z", "bug_id": 697936, "id": 5865802, "author": "smichaud@pobox.com", "text": "I've played with your patch on Lion, and have seen the dialog you report a few times, but not consistently.\n\nWhether I ever see the dialog seems to depend on how I build the tree.  And when I do see the dialog the browser never crashes (which is very weird).\n\nSo far I've only tested on OS X 10.7.2.  But (of course) I'll also need to test on other versions of OS X.\n\nI suspect it's going to take a long time to get to the bottom of this -- I suspect there are several different factors involved.  I'm not going to have that kind of time for a while.", "count": 4, "creator": "smichaud@pobox.com", "tags": [], "attachment_id": null, "raw_text": "I've played with your patch on Lion, and have seen the dialog you report a few times, but not consistently.\n\nWhether I ever see the dialog seems to depend on how I build the tree.  And when I do see the dialog the browser never crashes (which is very weird).\n\nSo far I've only tested on OS X 10.7.2.  But (of course) I'll also need to test on other versions of OS X.\n\nI suspect it's going to take a long time to get to the bottom of this -- I suspect there are several different factors involved.  I'm not going to have that kind of time for a while.", "time": "2011-11-22T17:54:45Z"}, {"creator": "smichaud@pobox.com", "creation_time": "2011-11-22T17:58:29Z", "is_private": false, "attachment_id": null, "tags": [], "author": "smichaud@pobox.com", "count": 5, "text": "Note that if you add the following to the browser's Info.plist, the FORCECRASH environment variable will be set whenever you run the browser by double-clicking on it:\n\n  <key>LSEnvironment</key>\n  <dict>\n  <key>FORCECRASH</key>\n  <string>1</string>\n  </dict>", "bug_id": 697936, "id": 5865821, "raw_text": "Note that if you add the following to the browser's Info.plist, the FORCECRASH environment variable will be set whenever you run the browser by double-clicking on it:\n\n  <key>LSEnvironment</key>\n  <dict>\n  <key>FORCECRASH</key>\n  <string>1</string>\n  </dict>", "time": "2011-11-22T17:58:29Z"}, {"creator": "smichaud@pobox.com", "author": "smichaud@pobox.com", "count": 6, "text": "Provisionally assigning this bug to myself, since it seems important.\n\nBut like I said I won't have time to work on it for a while.  So others should feel free to take it and work on it.", "id": 5865827, "bug_id": 697936, "creation_time": "2011-11-22T18:00:45Z", "is_private": false, "time": "2011-11-22T18:00:45Z", "attachment_id": null, "raw_text": "Provisionally assigning this bug to myself, since it seems important.\n\nBut like I said I won't have time to work on it for a while.  So others should feel free to take it and work on it.", "tags": []}]}}}