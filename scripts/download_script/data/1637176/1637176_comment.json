{"bugs": {"1637176": {"comments": [{"count": 0, "is_private": false, "raw_text": "```\n======================================================================\nFAIL: test_bilingual_enforce_translated (tests.migrate.test_context.TestMigrationContext)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/c/Users/Stas/Mozilla/fluent/fluent-migration/tests/migrate/test_context.py\", line 353, in test_bilingual_enforce_translated\n    expected\nAssertionError: {'bil[216 chars]ne, 'value': 'untranslated', 'type': 'TextElem[164 chars]ce'}} != {'bil[216 chars]ne, 'expression': {'span': None, 'value': '', [205 chars]ce'}}\nDiff is 1718 characters long. Set self.maxDiff to None to see it.\n\n----------------------------------------------------------------------\n```\nHere's the output after I set `maxDiff=None`:\n```\n======================================================================\nFAIL: test_bilingual_enforce_translated (tests.migrate.test_context.TestMigrationContext)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/c/Users/Stas/Mozilla/fluent/fluent-migration/tests/migrate/test_context.py\", line 354, in test_bilingual_enforce_translated\n    expected\nAssertionError: {'bil[216 chars]ne, 'value': 'untranslated', 'type': 'TextElem[164 chars]ce'}} != {'bil[216 chars]ne, 'expression': {'span': None, 'value': '', [205 chars]ce'}}\n  {'bilingual.ftl': {'body': [{'content': 'License',\n                               'span': None,\n                               'type': 'Comment'},\n                              {'attributes': [],\n                               'comment': {'content': 'This was untranslated',\n                                           'span': None,\n                                           'type': 'Comment'},\n                               'id': {'name': 'one',\n                                      'span': None,\n                                      'type': 'Identifier'},\n                               'span': None,\n                               'type': 'Message',\n-                              'value': {'elements': [{'span': None,\n+                              'value': {'elements': [{'expression': {'span': None,\n?                                                     +++++++++++++++\n\n+                                                                     'type': 'StringLiteral',\n+                                                                     'value': ''},\n+                                                      'span': None,\n-                                                      'type': 'TextElement',\n?                                                               ^ ^^^  ----\n\n+                                                      'type': 'Placeable'}],\n?                                                               ^^^^ ^^   ++\n\n-                                                      'value': 'untranslated'}],\n                                         'span': None,\n                                         'type': 'Pattern'}}],\n                     'span': None,\n                     'type': 'Resource'}}\n\n----------------------------------------------------------------------\n```", "text": "```\n======================================================================\nFAIL: test_bilingual_enforce_translated (tests.migrate.test_context.TestMigrationContext)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/c/Users/Stas/Mozilla/fluent/fluent-migration/tests/migrate/test_context.py\", line 353, in test_bilingual_enforce_translated\n    expected\nAssertionError: {'bil[216 chars]ne, 'value': 'untranslated', 'type': 'TextElem[164 chars]ce'}} != {'bil[216 chars]ne, 'expression': {'span': None, 'value': '', [205 chars]ce'}}\nDiff is 1718 characters long. Set self.maxDiff to None to see it.\n\n----------------------------------------------------------------------\n```\nHere's the output after I set `maxDiff=None`:\n```\n======================================================================\nFAIL: test_bilingual_enforce_translated (tests.migrate.test_context.TestMigrationContext)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/c/Users/Stas/Mozilla/fluent/fluent-migration/tests/migrate/test_context.py\", line 354, in test_bilingual_enforce_translated\n    expected\nAssertionError: {'bil[216 chars]ne, 'value': 'untranslated', 'type': 'TextElem[164 chars]ce'}} != {'bil[216 chars]ne, 'expression': {'span': None, 'value': '', [205 chars]ce'}}\n  {'bilingual.ftl': {'body': [{'content': 'License',\n                               'span': None,\n                               'type': 'Comment'},\n                              {'attributes': [],\n                               'comment': {'content': 'This was untranslated',\n                                           'span': None,\n                                           'type': 'Comment'},\n                               'id': {'name': 'one',\n                                      'span': None,\n                                      'type': 'Identifier'},\n                               'span': None,\n                               'type': 'Message',\n-                              'value': {'elements': [{'span': None,\n+                              'value': {'elements': [{'expression': {'span': None,\n?                                                     +++++++++++++++\n\n+                                                                     'type': 'StringLiteral',\n+                                                                     'value': ''},\n+                                                      'span': None,\n-                                                      'type': 'TextElement',\n?                                                               ^ ^^^  ----\n\n+                                                      'type': 'Placeable'}],\n?                                                               ^^^^ ^^   ++\n\n-                                                      'value': 'untranslated'}],\n                                         'span': None,\n                                         'type': 'Pattern'}}],\n                     'span': None,\n                     'type': 'Resource'}}\n\n----------------------------------------------------------------------\n```", "creation_time": "2020-05-12T08:18:47Z", "time": "2020-05-12T08:18:47Z", "author": "smalolepszy@gmail.com", "tags": [], "creator": "smalolepszy@gmail.com", "attachment_id": null, "id": 14813593, "bug_id": 1637176}, {"count": 1, "is_private": false, "raw_text": "The test expects the following result:\n\n```\n# License\n\n# This was untranslated\none = {\"\"}\n```\nThe actual output is:\n```\n# License\n\n# This was untranslated\none = untranslated\n```", "text": "The test expects the following result:\n\n```\n# License\n\n# This was untranslated\none = {\"\"}\n```\nThe actual output is:\n```\n# License\n\n# This was untranslated\none = untranslated\n```", "creation_time": "2020-05-12T08:29:59Z", "time": "2020-05-12T08:29:59Z", "author": "smalolepszy@gmail.com", "tags": [], "creator": "smalolepszy@gmail.com", "attachment_id": null, "id": 14813605, "bug_id": 1637176}, {"author": "l10n@mozilla.com", "tags": [], "creator": "l10n@mozilla.com", "attachment_id": null, "id": 14813642, "bug_id": 1637176, "count": 2, "is_private": false, "raw_text": "My suspicion is that you're having an old version of compare-locales in your tox environments. I've bumped that in https://hg.mozilla.org/l10n/fluent-migration/rev/bf12804fdfe3, but `tox.ini` doesn't mention `compare-locales` at all.", "creation_time": "2020-05-12T08:54:19Z", "time": "2020-05-12T08:54:19Z", "text": "My suspicion is that you're having an old version of compare-locales in your tox environments. I've bumped that in https://hg.mozilla.org/l10n/fluent-migration/rev/bf12804fdfe3, but `tox.ini` doesn't mention `compare-locales` at all."}, {"count": 3, "is_private": false, "raw_text": "The test fails for me both when I run `tox` as well as `python -m unittest discover`. I see `compare-locales` 7.6 in my env's `site-packages`.\n\nPerhaps this is Python 3.6 vs. 3.7? On Ubuntu (and WSL) I only have Python 3.6 available. Consequently, I modify `tox.ini` locally to read `py36`.", "creation_time": "2020-05-12T09:04:34Z", "text": "The test fails for me both when I run `tox` as well as `python -m unittest discover`. I see `compare-locales` 7.6 in my env's `site-packages`.\n\nPerhaps this is Python 3.6 vs. 3.7? On Ubuntu (and WSL) I only have Python 3.6 available. Consequently, I modify `tox.ini` locally to read `py36`.", "time": "2020-05-12T09:04:34Z", "author": "smalolepszy@gmail.com", "tags": [], "creator": "smalolepszy@gmail.com", "attachment_id": null, "id": 14813648, "bug_id": 1637176}, {"creator": "smalolepszy@gmail.com", "attachment_id": null, "author": "smalolepszy@gmail.com", "tags": [], "bug_id": 1637176, "id": 14813655, "count": 4, "raw_text": "I see the same failure on Python 3.7.", "time": "2020-05-12T09:10:11Z", "creation_time": "2020-05-12T09:10:11Z", "text": "I see the same failure on Python 3.7.", "is_private": false}, {"author": "l10n@mozilla.com", "tags": [], "creator": "l10n@mozilla.com", "attachment_id": null, "id": 14813759, "bug_id": 1637176, "count": 5, "is_private": false, "raw_text": "Meh, my bad, probably me that had an outdated version of compare-locales in his tox env.", "creation_time": "2020-05-12T10:42:56Z", "text": "Meh, my bad, probably me that had an outdated version of compare-locales in his tox env.", "time": "2020-05-12T10:42:56Z"}, {"bug_id": 1637176, "id": 14813790, "attachment_id": 9147566, "creator": "l10n@mozilla.com", "tags": [], "author": "l10n@mozilla.com", "text": "Created attachment 9147566\nBug 1637176, fix test failure, r=stas\n\n\nThis is a regression from https://hg.mozilla.org/l10n/fluent-migration/rev/bf12804fdfe33507684670726785bb45e5351b99.\nSo much for landing w/out bugs or review.\nRCA is probably an outdated version of compare-locales in my tox env.", "creation_time": "2020-05-12T11:04:24Z", "time": "2020-05-12T11:04:24Z", "raw_text": "\nThis is a regression from https://hg.mozilla.org/l10n/fluent-migration/rev/bf12804fdfe33507684670726785bb45e5351b99.\nSo much for landing w/out bugs or review.\nRCA is probably an outdated version of compare-locales in my tox env.", "is_private": false, "count": 6}, {"count": 7, "is_private": false, "raw_text": "This was fixed in https://hg.mozilla.org/l10n/fluent-migration/rev/48b21486ee5c, and is released.", "creation_time": "2020-05-13T21:52:26Z", "time": "2020-05-13T21:52:26Z", "text": "This was fixed in https://hg.mozilla.org/l10n/fluent-migration/rev/48b21486ee5c, and is released.", "author": "l10n@mozilla.com", "tags": [], "creator": "l10n@mozilla.com", "attachment_id": null, "id": 14817960, "bug_id": 1637176}]}}, "comments": {}}