{"bugs": {"703455": {"comments": [{"creator": "felipc@gmail.com", "is_private": false, "count": 0, "author": "felipc@gmail.com", "creation_time": "2011-11-18T01:14:44Z", "time": "2011-11-18T01:14:44Z", "bug_id": 703455, "tags": [], "text": "Whenever I load IRCCloud on my computer, Firefox hangs for about 5-10 seconds (with the Non-responding titlebar) and then returns and continue to working correctly. I can reproduce this every time.\n\nI attached a profiler and here are the top sampled functions:\n\n===========\ngfx3DMatrix::operator*                         33.3%\ngfxTextRun::AddGlyphRun                        6.2%\ngfxAlphaRecovery::GoodAlignmentLog2            4.4%\nJSScript::jitDataSize                          3.0%\njs::StringIsArrayIndex                         2.7%\nNS_CycleCollectorSuspect2_P                    1.7%\njs_GetTypeInferenceMemoryStats                 1.4%\njs_FindProperty                                1.3%\njs_ValueToSource                               1.2%\niswdigit                                       1.2%\ngfxTextRunFactory::Release                     1.2%\nJS_CallOnce                                    1.2%\nJSScript::dataSize                             1.2%\ngfxFont::ProvidesGetGlyph                      0.9%\ngfx3DMatrix::CanDraw2D                         0.9%\nRtlEnterCriticalSection                        0.8%\nmalloc                                         0.7%\njs_GCThingIsMarked                             0.7%\nstd::_Init_locks::operator=                    0.6%\nmozilla::gfx::BaseRect<\n  double,gfxRect,gfxPoint,gfxSize,gfxMargin    0.6%\n  >::Round\ngfxFontGroup::InitScriptRun                    0.6%\ngfxFontGroup::FontListLength                   0.6%\nWaitForMultipleObjectsEx                       0.6%\nRtlLeaveCriticalSection                        0.6%\nJS_GetTypeInferenceObjectStats                 0.6%\n===========\n\nAttaching the profiler unfortunately makes the Flash plugin loaded to crash, so it's not entirely clear this is the correct sampling, but I believe it's useful.\n\nSee also bug 703436, a similar prob. I saved the profiled data and can also reproduce the problem as needed.", "attachment_id": null, "raw_text": "Whenever I load IRCCloud on my computer, Firefox hangs for about 5-10 seconds (with the Non-responding titlebar) and then returns and continue to working correctly. I can reproduce this every time.\n\nI attached a profiler and here are the top sampled functions:\n\n===========\ngfx3DMatrix::operator*                         33.3%\ngfxTextRun::AddGlyphRun                        6.2%\ngfxAlphaRecovery::GoodAlignmentLog2            4.4%\nJSScript::jitDataSize                          3.0%\njs::StringIsArrayIndex                         2.7%\nNS_CycleCollectorSuspect2_P                    1.7%\njs_GetTypeInferenceMemoryStats                 1.4%\njs_FindProperty                                1.3%\njs_ValueToSource                               1.2%\niswdigit                                       1.2%\ngfxTextRunFactory::Release                     1.2%\nJS_CallOnce                                    1.2%\nJSScript::dataSize                             1.2%\ngfxFont::ProvidesGetGlyph                      0.9%\ngfx3DMatrix::CanDraw2D                         0.9%\nRtlEnterCriticalSection                        0.8%\nmalloc                                         0.7%\njs_GCThingIsMarked                             0.7%\nstd::_Init_locks::operator=                    0.6%\nmozilla::gfx::BaseRect<\n  double,gfxRect,gfxPoint,gfxSize,gfxMargin    0.6%\n  >::Round\ngfxFontGroup::InitScriptRun                    0.6%\ngfxFontGroup::FontListLength                   0.6%\nWaitForMultipleObjectsEx                       0.6%\nRtlLeaveCriticalSection                        0.6%\nJS_GetTypeInferenceObjectStats                 0.6%\n===========\n\nAttaching the profiler unfortunately makes the Flash plugin loaded to crash, so it's not entirely clear this is the correct sampling, but I believe it's useful.\n\nSee also bug 703436, a similar prob. I saved the profiled data and can also reproduce the problem as needed.", "id": 5857043}, {"is_private": false, "creator": "jaws@mozilla.com", "count": 1, "creation_time": "2011-11-18T07:48:25Z", "author": "jaws@mozilla.com", "text": "IRCCloud requires Flash on Firefox for \"web sockets\". On Chrome they use the native web sockets, but don't seem to have a timeline for adding support for MozWebSocket.", "tags": [], "time": "2011-11-18T07:48:25Z", "bug_id": 703455, "attachment_id": null, "raw_text": "IRCCloud requires Flash on Firefox for \"web sockets\". On Chrome they use the native web sockets, but don't seem to have a timeline for adding support for MozWebSocket.", "id": 5857569}, {"attachment_id": null, "raw_text": "I got a 4 second hang, which eventually caused an unresponsive script popup:\n  Script: https://irccloud.com/static/js/dep/jquery-1.6.2.min.js?v=a1a8cb16a060f6280a767187fd22e037:16\n\nWhen I loaded it a second time, I got 4 second-ish hang, an unresponsive script popup, then when I clicked through, it pinwheeled for another four second.  Looking in my error console, there was a 600ms CC, a 1641ms compartmental GC (!), a 600ms global GC, a 1236ms CC, 520ms compartmental GC, 426ms global GC, then it has settled down a bit.  I don't think all of that is during the initial loading, but at least some of it is.", "id": 5882092, "creator": "continuation@gmail.com", "is_private": false, "count": 2, "author": "continuation@gmail.com", "creation_time": "2011-11-30T15:24:52Z", "tags": [], "bug_id": 703455, "time": "2011-11-30T15:24:52Z", "text": "I got a 4 second hang, which eventually caused an unresponsive script popup:\n  Script: https://irccloud.com/static/js/dep/jquery-1.6.2.min.js?v=a1a8cb16a060f6280a767187fd22e037:16\n\nWhen I loaded it a second time, I got 4 second-ish hang, an unresponsive script popup, then when I clicked through, it pinwheeled for another four second.  Looking in my error console, there was a 600ms CC, a 1641ms compartmental GC (!), a 600ms global GC, a 1236ms CC, 520ms compartmental GC, 426ms global GC, then it has settled down a bit.  I don't think all of that is during the initial loading, but at least some of it is."}, {"text": "Marking as [Snappy:P3].  This is a complex webapp, so some slowness on starting it up seems like it may be expected.  From my crude measurements, it seems like a lot of the pauses could be GC and CC, and there's ongoing work in that area.  We should look at this once incremental GC and improved CC has landed, and we have better pause time analysis tools.", "time": "2011-12-01T21:09:35Z", "tags": [], "creation_time": "2011-12-01T21:09:35Z", "author": "continuation@gmail.com", "is_private": false, "creator": "continuation@gmail.com", "id": 5886338, "raw_text": "Marking as [Snappy:P3].  This is a complex webapp, so some slowness on starting it up seems like it may be expected.  From my crude measurements, it seems like a lot of the pauses could be GC and CC, and there's ongoing work in that area.  We should look at this once incremental GC and improved CC has landed, and we have better pause time analysis tools.", "attachment_id": null, "bug_id": 703455, "count": 3}, {"raw_text": "If comparing the performance of IRCCloud between Firefox and Chrome, it is important to note these lines in their JavaScript:\n\n>if (window.WebSocket && !window.MozWebSocket) {\n>    window.WEB_SOCKET_SUPPORT = true;\n>}\n>if (!window.WEB_SOCKET_SUPPORT) {\n>    // Global config\n>    WEB_SOCKET_SWF_LOCATION = '/static/js/lib/WebSocketMain.swf';\n>    WEB_SOCKET_DISABLE_AUTO_INITIALIZATION = true;\n>    dep.push('/static/js/dep/swfobject.js');\n>    lib.push('/static/js/lib/web_socket.js');\n>    app.push('/static/js/app/websocket.js');\n>}", "attachment_id": null, "id": 5894209, "count": 4, "is_private": false, "creator": "jaws@mozilla.com", "text": "If comparing the performance of IRCCloud between Firefox and Chrome, it is important to note these lines in their JavaScript:\n\n>if (window.WebSocket && !window.MozWebSocket) {\n>    window.WEB_SOCKET_SUPPORT = true;\n>}\n>if (!window.WEB_SOCKET_SUPPORT) {\n>    // Global config\n>    WEB_SOCKET_SWF_LOCATION = '/static/js/lib/WebSocketMain.swf';\n>    WEB_SOCKET_DISABLE_AUTO_INITIALIZATION = true;\n>    dep.push('/static/js/dep/swfobject.js');\n>    lib.push('/static/js/lib/web_socket.js');\n>    app.push('/static/js/app/websocket.js');\n>}", "tags": [], "bug_id": 703455, "time": "2011-12-06T07:02:00Z", "creation_time": "2011-12-06T07:02:00Z", "author": "jaws@mozilla.com"}, {"bug_id": 703455, "count": 5, "text": "You could try to profile it again or compare to Chrome with this:\n\nhttps://addons.mozilla.org/en-US/firefox/addon/websockets-for-irccloud/\n\nThis add-on basically just sets window.WEB_SOCKET_SUPPORT to true.", "tags": [], "time": "2011-12-10T18:46:40Z", "creation_time": "2011-12-10T18:46:40Z", "author": "ttaubert@mozilla.com", "is_private": false, "creator": "ttaubert@mozilla.com", "id": 5906564, "raw_text": "You could try to profile it again or compare to Chrome with this:\n\nhttps://addons.mozilla.org/en-US/firefox/addon/websockets-for-irccloud/\n\nThis add-on basically just sets window.WEB_SOCKET_SUPPORT to true.", "attachment_id": null}, {"id": 6183199, "attachment_id": null, "raw_text": "I ran the profiler today and uploaded the results here:\nhttp://varium.fantasytalesonline.com/cleopatra/?report=AMIfv97N0Gf83Zp-2xTIdSuP9EK-_StKAu9DL9m2MZOhK0Nej9H_hwDzqzkJQ1936IZ4lMVQG_KEWCZr5BYdeRYmSVLmcFRs7JwzKpt-U_DKPmWn1V8yEsL7PuqZYSm7YtN2dBexNsCcs_8cNFtZ5MyfBDzWE34-2A", "author": "jaws@mozilla.com", "creation_time": "2012-03-29T21:34:20Z", "tags": [], "bug_id": 703455, "time": "2012-03-29T21:34:20Z", "text": "I ran the profiler today and uploaded the results here:\nhttp://varium.fantasytalesonline.com/cleopatra/?report=AMIfv97N0Gf83Zp-2xTIdSuP9EK-_StKAu9DL9m2MZOhK0Nej9H_hwDzqzkJQ1936IZ4lMVQG_KEWCZr5BYdeRYmSVLmcFRs7JwzKpt-U_DKPmWn1V8yEsL7PuqZYSm7YtN2dBexNsCcs_8cNFtZ5MyfBDzWE34-2A", "creator": "jaws@mozilla.com", "is_private": false, "count": 6}, {"creator": "josh@joshmatthews.net", "is_private": false, "author": "josh@joshmatthews.net", "creation_time": "2012-03-29T22:07:51Z", "time": "2012-03-29T22:07:51Z", "tags": [], "text": "Darn, we're missing profiling labels for the big culprit(s) under the event handling code.", "attachment_id": null, "raw_text": "Darn, we're missing profiling labels for the big culprit(s) under the event handling code.", "id": 6183330, "count": 7, "bug_id": 703455}, {"author": "james@wheare.org", "creation_time": "2012-08-02T12:09:15Z", "tags": [], "time": "2012-08-02T12:09:15Z", "bug_id": 703455, "text": "IRCCloud supports WebSockets in FF natively now.", "creator": "james@wheare.org", "is_private": false, "count": 8, "id": 6526325, "attachment_id": null, "raw_text": "IRCCloud supports WebSockets in FF natively now."}, {"id": 8903771, "attachment_id": 8436963, "raw_text": "Despite comment 8 this is still happening for me on Fx 29.0.1 with the current version of IRCCloud.  I don't know if it's the same issue, but I get a nonresponsive script error with IRCCloud (see attached).  It's not when I first load the app, but rather when I re-open my laptop after it sleeps to restore my irc sessions.", "author": "cbeard@mozilla.org", "creation_time": "2014-06-09T14:57:54Z", "tags": [], "bug_id": 703455, "time": "2014-06-09T14:57:54Z", "text": "Created attachment 8436963\nirccloud.png\n\nDespite comment 8 this is still happening for me on Fx 29.0.1 with the current version of IRCCloud.  I don't know if it's the same issue, but I get a nonresponsive script error with IRCCloud (see attached).  It's not when I first load the app, but rather when I re-open my laptop after it sleeps to restore my irc sessions.", "creator": "cbeard@mozilla.org", "is_private": false, "count": 9}, {"author": "ttaubert@mozilla.com", "creation_time": "2014-06-10T11:29:57Z", "time": "2014-06-10T11:29:57Z", "bug_id": 703455, "tags": [], "text": "I have the same problem daily, coming out of suspend mode. I wonder whether it's an IRCCloud problem - i.e. whether it happens for Chrome, too. It might of course not be as visible due to Chrome's process separation.", "creator": "ttaubert@mozilla.com", "is_private": false, "count": 10, "id": 8909092, "attachment_id": null, "raw_text": "I have the same problem daily, coming out of suspend mode. I wonder whether it's an IRCCloud problem - i.e. whether it happens for Chrome, too. It might of course not be as visible due to Chrome's process separation."}, {"creation_time": "2014-06-10T11:48:50Z", "author": "james@wheare.org", "text": "We've only seen this on Firefox. There may indeed be something we can do to avoid it in Firefox, but unfortunately I haven't been able to get any useful debugging information on what's going on. More detail on where the bottleneck is, with a stacktrace would be extremely helpful.", "tags": [], "time": "2014-06-10T11:48:50Z", "is_private": false, "creator": "james@wheare.org", "id": 8909126, "attachment_id": null, "raw_text": "We've only seen this on Firefox. There may indeed be something we can do to avoid it in Firefox, but unfortunately I haven't been able to get any useful debugging information on what's going on. More detail on where the bottleneck is, with a stacktrace would be extremely helpful.", "bug_id": 703455, "count": 11}, {"creation_time": "2014-07-15T22:00:44Z", "author": "saurabhanandiit@gmail.com", "text": "I don't get any unresponsive scripts dialog, however tab switching hangs as soon as I load IRCCloud for the first time in my Nightly.", "time": "2014-07-15T22:00:44Z", "tags": [], "bug_id": 703455, "is_private": false, "creator": "saurabhanandiit@gmail.com", "count": 12, "id": 9058029, "attachment_id": null, "raw_text": "I don't get any unresponsive scripts dialog, however tab switching hangs as soon as I load IRCCloud for the first time in my Nightly."}, {"author": "saurabhanandiit@gmail.com", "creation_time": "2014-08-24T12:34:17Z", "tags": [], "time": "2014-08-24T12:34:17Z", "bug_id": 703455, "text": "I profiles using the built-in profiler and http://people.mozilla.org/~bgirard/cleopatra/#report=14e4dbcb001de34d2982636816d3deda25cbf70e is what I have. Maybe it helps.", "creator": "saurabhanandiit@gmail.com", "is_private": false, "count": 13, "id": 9222251, "attachment_id": null, "raw_text": "I profiles using the built-in profiler and http://people.mozilla.org/~bgirard/cleopatra/#report=14e4dbcb001de34d2982636816d3deda25cbf70e is what I have. Maybe it helps."}, {"author": "james@wheare.org", "creation_time": "2014-08-25T04:46:17Z", "tags": [], "bug_id": 703455, "time": "2014-08-25T04:46:17Z", "text": "Can anyone shed any light on that profiler, or how to read it as an author? (As opposed to a browser developer) It's indecipherable to me.", "creator": "james@wheare.org", "is_private": false, "count": 14, "id": 9223077, "attachment_id": null, "raw_text": "Can anyone shed any light on that profiler, or how to read it as an author? (As opposed to a browser developer) It's indecipherable to me."}, {"creator": "saurabhanandiit@gmail.com", "is_private": false, "author": "saurabhanandiit@gmail.com", "creation_time": "2014-08-25T08:49:55Z", "time": "2014-08-25T08:49:55Z", "tags": [], "text": "https://developer.mozilla.org/en-US/docs/Mozilla/Performance/Profiling_with_the_Built-in_Profiler#Understanding_Cleopatra_Profiles has some information. I'm not too familiar with this too, but other here or Benoit Girard might have more information.", "attachment_id": null, "raw_text": "https://developer.mozilla.org/en-US/docs/Mozilla/Performance/Profiling_with_the_Built-in_Profiler#Understanding_Cleopatra_Profiles has some information. I'm not too familiar with this too, but other here or Benoit Girard might have more information.", "id": 9223599, "count": 15, "bug_id": 703455}, {"bug_id": 703455, "count": 16, "id": 9224788, "attachment_id": null, "raw_text": "The profile here didn't capture a 10 second hang.\n\nTry collecting the profile again with profiler.interval set to 10 (reboot firefox). Then hit CTRL+SHIFT+2 right after the hang completes. The profile should then contain the hang.", "creation_time": "2014-08-25T15:32:46Z", "author": "b56girard@gmail.com", "text": "The profile here didn't capture a 10 second hang.\n\nTry collecting the profile again with profiler.interval set to 10 (reboot firefox). Then hit CTRL+SHIFT+2 right after the hang completes. The profile should then contain the hang.", "time": "2014-08-25T15:32:46Z", "tags": [], "is_private": false, "creator": "b56girard@gmail.com"}, {"attachment_id": null, "raw_text": "Posting the IRC discussion with djvj : http://logs.glob.uno/?c=mozilla%23jsapi#c460852", "id": 9225884, "is_private": false, "creator": "saurabhanandiit@gmail.com", "count": 17, "creation_time": "2014-08-25T18:57:08Z", "author": "saurabhanandiit@gmail.com", "text": "Posting the IRC discussion with djvj : http://logs.glob.uno/?c=mozilla%23jsapi#c460852", "time": "2014-08-25T18:57:08Z", "bug_id": 703455, "tags": []}, {"creator": "kvijayan@mozilla.com", "is_private": false, "author": "kvijayan@mozilla.com", "creation_time": "2014-08-27T15:34:15Z", "tags": [], "time": "2014-08-27T15:34:15Z", "text": "So, we are bailing out a LOT inside our self-hosted ArrayIndexOf, when the second argument to ArrayIndexOf is a non-primitive.  We should be catching this, updating typeinfo, and invalidating the IonScript so that we can re-compile the script in Ion with looser typeinfo.", "attachment_id": null, "raw_text": "So, we are bailing out a LOT inside our self-hosted ArrayIndexOf, when the second argument to ArrayIndexOf is a non-primitive.  We should be catching this, updating typeinfo, and invalidating the IonScript so that we can re-compile the script in Ion with looser typeinfo.", "id": 9236653, "count": 18, "bug_id": 703455}, {"count": 19, "bug_id": 703455, "is_private": false, "creator": "saurabhanandiit@gmail.com", "text": "So even after bug 1059426 being fixed, I still get the hangs. http://people.mozilla.org/~bgirard/cleopatra/#report=cfb764ce873c83aa10f7bbc0083e23d79d72f182 is another profile on the latest Nightly. BenWa, any idea what might be the issue now?", "time": "2014-10-04T09:23:26Z", "tags": [], "creation_time": "2014-10-04T09:23:26Z", "author": "saurabhanandiit@gmail.com", "raw_text": "So even after bug 1059426 being fixed, I still get the hangs. http://people.mozilla.org/~bgirard/cleopatra/#report=cfb764ce873c83aa10f7bbc0083e23d79d72f182 is another profile on the latest Nightly. BenWa, any idea what might be the issue now?", "attachment_id": null, "id": 9402658}, {"raw_text": "Long running JS with a ton of bailout. Back to you :djvj.", "attachment_id": null, "id": 9402663, "is_private": false, "creator": "b56girard@gmail.com", "text": "Long running JS with a ton of bailout. Back to you :djvj.", "time": "2014-10-04T09:54:00Z", "tags": [], "creation_time": "2014-10-04T09:54:00Z", "author": "b56girard@gmail.com", "count": 20, "bug_id": 703455}, {"raw_text": "Firefox is really slow for me today and I see lots of bailout and Ion activity here. Not sure if something changed since yesterday?\n\nhttp://people.mozilla.org/~bgirard/cleopatra/#report=5bd6633ced239b1c2de0ac72ca845327999006be", "attachment_id": null, "id": 9414128, "is_private": false, "creator": "ttaubert@mozilla.com", "text": "Firefox is really slow for me today and I see lots of bailout and Ion activity here. Not sure if something changed since yesterday?\n\nhttp://people.mozilla.org/~bgirard/cleopatra/#report=5bd6633ced239b1c2de0ac72ca845327999006be", "time": "2014-10-07T16:24:00Z", "tags": [], "creation_time": "2014-10-07T16:24:00Z", "author": "ttaubert@mozilla.com", "count": 21, "bug_id": 703455}, {"id": 9414132, "raw_text": "(In reply to Tim Taubert [:ttaubert] from comment #21)\n> Not sure if something changed since yesterday?\n\nJust noticed I'm running yesterday's Nightly (2014-10-06). Cant' remember having these problems yesterday though.", "attachment_id": null, "time": "2014-10-07T16:25:18Z", "bug_id": 703455, "tags": [], "text": "(In reply to Tim Taubert [:ttaubert] from comment #21)\n> Not sure if something changed since yesterday?\n\nJust noticed I'm running yesterday's Nightly (2014-10-06). Cant' remember having these problems yesterday though.", "author": "ttaubert@mozilla.com", "creation_time": "2014-10-07T16:25:18Z", "count": 22, "creator": "ttaubert@mozilla.com", "is_private": false}]}}, "comments": {}}