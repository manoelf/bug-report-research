{"comments": {}, "bugs": {"1637956": {"comments": [{"text": "I am testing MozPhab code.\nIt is working fine (pings are successfully submitted to telemetry).\n\nTesting metrics within the `mozphab.user` category is crashing the test process.\n\nmetrics.yaml\n```\nmozphab.user:\n  installation:\n    type: uuid\n    description: >\n        Unique identifier of each MozPhab installation.\n        A user might install the application on multiple machines/profiles.\n    lifetime: user\n    notification_emails:\n      - mozphab-telemetry@mozilla.com\n      - pzalewa@mozilla.com\n    bugs:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025\n    data_reviews:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025#c2\n    expires: never\n    send_in_pings:\n      - usage\n\n  id:\n    type: uuid\n    description: >\n        Unique identifier of each MozPhab user.\n    lifetime: user\n    notification_emails:\n      - mozphab-telemetry@mozilla.com\n      - pzalewa@mozilla.com\n    bugs:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025\n    data_reviews:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025#c2\n    expires: never\n    send_in_pings:\n      - usage\n```\ntest file.\n\nWorking code:\n```\n    assert \"10.0.18362\" == t.metrics.mozphab.environment.os_version.test_get_value()\n```\nCrashing code:\n```\n    assert t.metrics.mozphab.user.installation.test_has_value()\n```\nor\n```\n    assert \"install_id\" == t.metrics.mozphab.user.installation.test_get_value()\n```", "id": 14819307, "attachment_id": null, "creator": "pzalewa@mozilla.com", "creation_time": "2020-05-14T13:18:11Z", "tags": [], "bug_id": 1637956, "is_private": false, "count": 0, "author": "pzalewa@mozilla.com", "time": "2020-05-14T13:18:11Z", "raw_text": "I am testing MozPhab code.\nIt is working fine (pings are successfully submitted to telemetry).\n\nTesting metrics within the `mozphab.user` category is crashing the test process.\n\nmetrics.yaml\n```\nmozphab.user:\n  installation:\n    type: uuid\n    description: >\n        Unique identifier of each MozPhab installation.\n        A user might install the application on multiple machines/profiles.\n    lifetime: user\n    notification_emails:\n      - mozphab-telemetry@mozilla.com\n      - pzalewa@mozilla.com\n    bugs:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025\n    data_reviews:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025#c2\n    expires: never\n    send_in_pings:\n      - usage\n\n  id:\n    type: uuid\n    description: >\n        Unique identifier of each MozPhab user.\n    lifetime: user\n    notification_emails:\n      - mozphab-telemetry@mozilla.com\n      - pzalewa@mozilla.com\n    bugs:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025\n    data_reviews:\n      - https://bugzilla.mozilla.org/show_bug.cgi?id=1621025#c2\n    expires: never\n    send_in_pings:\n      - usage\n```\ntest file.\n\nWorking code:\n```\n    assert \"10.0.18362\" == t.metrics.mozphab.environment.os_version.test_get_value()\n```\nCrashing code:\n```\n    assert t.metrics.mozphab.user.installation.test_has_value()\n```\nor\n```\n    assert \"install_id\" == t.metrics.mozphab.user.installation.test_get_value()\n```"}, {"author": "mdroettboom@mozilla.com", "tags": [], "bug_id": 1637956, "is_private": false, "count": 1, "raw_text": "Do you have a branch with everything in place that I could test?", "time": "2020-05-14T14:17:12Z", "text": "Do you have a branch with everything in place that I could test?", "id": 14819431, "creation_time": "2020-05-14T14:17:12Z", "attachment_id": null, "creator": "mdroettboom@mozilla.com"}, {"text": "https://github.com/zalun/review/tree/telemetry_testing\n```\n$ pytest tests/test_telemetry.py::test_set_metrics\n```", "id": 14828175, "creator": "pzalewa@mozilla.com", "attachment_id": null, "creation_time": "2020-05-18T10:23:26Z", "tags": [], "bug_id": 1637956, "count": 2, "is_private": false, "author": "pzalewa@mozilla.com", "time": "2020-05-18T10:23:26Z", "raw_text": "https://github.com/zalun/review/tree/telemetry_testing\n```\n$ pytest tests/test_telemetry.py::test_set_metrics\n```"}, {"attachment_id": 9151750, "creator": "alessio.placitelli@gmail.com", "time": "2020-05-26T13:42:15Z", "raw_text": "Hey Piotr!\n\nI just checked this, looks like the testing API was behaving correctly: you were setting mocked `installation_id` and `user_code` that were not UUIDs, so the API was throwing.\n\nThis should make the test pass. I tried this locally and it works.\n\nNote that it's still a bug on our end for the API to silently throw and not show actionable messages, so we'll fix that on our end.", "creation_time": "2020-05-26T13:42:15Z", "count": 3, "is_private": false, "tags": [], "bug_id": 1637956, "author": "alessio.placitelli@gmail.com", "id": 14843813, "text": "Created attachment 9151750\nmoz-phab-testing.diff\n\nHey Piotr!\n\nI just checked this, looks like the testing API was behaving correctly: you were setting mocked `installation_id` and `user_code` that were not UUIDs, so the API was throwing.\n\nThis should make the test pass. I tried this locally and it works.\n\nNote that it's still a bug on our end for the API to silently throw and not show actionable messages, so we'll fix that on our end."}, {"time": "2020-05-26T15:46:21Z", "raw_text": "", "count": 4, "is_private": false, "bug_id": 1637956, "tags": [], "author": "alessio.placitelli@gmail.com", "creator": "alessio.placitelli@gmail.com", "attachment_id": 9151784, "creation_time": "2020-05-26T15:46:21Z", "id": 14844081, "text": "Created attachment 9151784\nGitHub Pull Request"}, {"time": "2020-05-27T09:49:42Z", "raw_text": "The test passes. Thank you", "count": 5, "is_private": false, "bug_id": 1637956, "tags": [], "author": "pzalewa@mozilla.com", "attachment_id": null, "creator": "pzalewa@mozilla.com", "creation_time": "2020-05-27T09:49:42Z", "id": 14845954, "text": "The test passes. Thank you"}]}}}