{"comments": {}, "bugs": {"693359": {"comments": [{"author": "brandon@hackmill.com", "creator": "brandon@hackmill.com", "bug_id": 693359, "id": 5771997, "tags": [], "count": 0, "is_private": false, "attachment_id": null, "time": "2011-10-10T17:54:42Z", "text": "In bug 255119 we stopped showing the response body after a redirect to a non-HTTP URL.  This bug is to investigate a related case where we show the response body after an empty Location header:\n\nHTTP/1.1 302 Moved Temporarily\nLocation: \n\n<script>alert(document.cookie);</script>\n\nIs this the correct behavior per HTTP and is it the \"correct\" thing to do for security?\n\nThis was reported to security@m.o by Clint Ruoho.", "raw_text": "In bug 255119 we stopped showing the response body after a redirect to a non-HTTP URL.  This bug is to investigate a related case where we show the response body after an empty Location header:\n\nHTTP/1.1 302 Moved Temporarily\nLocation: \n\n<script>alert(document.cookie);</script>\n\nIs this the correct behavior per HTTP and is it the \"correct\" thing to do for security?\n\nThis was reported to security@m.o by Clint Ruoho.", "creation_time": "2011-10-10T17:54:42Z"}, {"creator": "mcmanus@ducksong.com", "author": "mcmanus@ducksong.com", "text": "I'm not sure I see the point in this - the 'attacker' can just as easily issue a 200 or a valid but unreachable URL for the location header (where we would absolutely have to show the body).\n\nI am not sure why 255119 was given its sg rating. I fixed that bug because of its rating and the condition was a clear attempt to subevert - something that isn't clear here.  Perhaps jesse can comment on whether that logic applies to this as well.", "attachment_id": null, "time": "2011-10-10T19:08:18Z", "raw_text": "I'm not sure I see the point in this - the 'attacker' can just as easily issue a 200 or a valid but unreachable URL for the location header (where we would absolutely have to show the body).\n\nI am not sure why 255119 was given its sg rating. I fixed that bug because of its rating and the condition was a clear attempt to subevert - something that isn't clear here.  Perhaps jesse can comment on whether that logic applies to this as well.", "creation_time": "2011-10-10T19:08:18Z", "bug_id": 693359, "count": 1, "is_private": false, "tags": [], "id": 5772257}, {"author": "jruderman@gmail.com", "creator": "jruderman@gmail.com", "time": "2011-10-10T19:20:15Z", "attachment_id": null, "text": "Maybe the attack involves injecting line breaks into the Location field? In other words, a legitimate web app thinks it's redirecting to \"\\n\\n<script>...\". But header splitting bugs are pretty serious even without this specific browser behavior, IIRC.\n\nWe could ask Clint Ruoho, of course :)", "raw_text": "Maybe the attack involves injecting line breaks into the Location field? In other words, a legitimate web app thinks it's redirecting to \"\\n\\n<script>...\". But header splitting bugs are pretty serious even without this specific browser behavior, IIRC.\n\nWe could ask Clint Ruoho, of course :)", "creation_time": "2011-10-10T19:20:15Z", "bug_id": 693359, "id": 5772299, "is_private": false, "count": 2, "tags": []}, {"bug_id": 693359, "tags": [], "count": 3, "is_private": false, "id": 5776595, "text": "Can we just make the 3xx error page not render with the principal of the host it comes from?  That would address the document.cookie issue, I would hope...  Anything legitimate it would break?", "time": "2011-10-12T03:49:39Z", "attachment_id": null, "raw_text": "Can we just make the 3xx error page not render with the principal of the host it comes from?  That would address the document.cookie issue, I would hope...  Anything legitimate it would break?", "creation_time": "2011-10-12T03:49:39Z", "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu"}, {"creator": "bug-husbandry-bot@mozilla.bugs", "author": "bug-husbandry-bot@mozilla.bugs", "bug_id": 693359, "is_private": false, "count": 4, "tags": [], "id": 12659046, "text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "time": "2017-09-13T18:41:06Z", "attachment_id": null, "raw_text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "creation_time": "2017-09-13T18:41:06Z"}]}}}