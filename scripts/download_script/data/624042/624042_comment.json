{"comments": {}, "bugs": {"624042": {"comments": [{"creation_time": "2011-01-07T23:34:19Z", "tags": [], "text": "> /* this assumes that pLastPart is big enough to hold the *whole*\n>  * buffer!!! */\n> rv = (*context->update)(context->cipherInfo, pLastPart, &outlen,\n>    maxout, context->padBuf, context->blockSize);\n\nWe should remove the assumption; decrypt the last block into a separate tem buffer, check the padding, copy the decrypted data into pLastPart, and then zeroize the temp buffer.", "is_private": false, "id": 5183915, "count": 0, "time": "2011-01-07T23:34:19Z", "creator": "brian@briansmith.org", "attachment_id": null, "author": "brian@briansmith.org", "bug_id": 624042, "raw_text": "> /* this assumes that pLastPart is big enough to hold the *whole*\n>  * buffer!!! */\n> rv = (*context->update)(context->cipherInfo, pLastPart, &outlen,\n>    maxout, context->padBuf, context->blockSize);\n\nWe should remove the assumption; decrypt the last block into a separate tem buffer, check the padding, copy the decrypted data into pLastPart, and then zeroize the temp buffer."}, {"creation_time": "2012-05-04T23:47:09Z", "tags": [], "id": 6282059, "count": 1, "text": "bsmith: just to confirm my understanding: this bug will result in a\ndecryption failure but not a buffer overflow, right?  If pLastPart\ndoes not reserve room for the padding, the (*context->update)() call\nyou showed should fail.\n\nIf so, this bug isn't serious because without knowing the length of\nthe plaintext in advance, the caller has to use an output buffer\nlarge enough for a padding of only one byte.  I think most callers\nwill use an output buffer that's at least as long as the ciphertext.", "is_private": false, "creator": "wtc@google.com", "author": "wtc@google.com", "attachment_id": null, "time": "2012-05-04T23:47:09Z", "raw_text": "bsmith: just to confirm my understanding: this bug will result in a\ndecryption failure but not a buffer overflow, right?  If pLastPart\ndoes not reserve room for the padding, the (*context->update)() call\nyou showed should fail.\n\nIf so, this bug isn't serious because without knowing the length of\nthe plaintext in advance, the caller has to use an output buffer\nlarge enough for a padding of only one byte.  I think most callers\nwill use an output buffer that's at least as long as the ciphertext.", "bug_id": 624042}]}}}