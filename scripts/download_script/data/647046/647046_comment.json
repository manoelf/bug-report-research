{"bugs": {"647046": {"comments": [{"bug_id": 647046, "attachment_id": null, "tags": [], "creation_time": "2011-03-31T23:49:25Z", "id": 5385077, "is_private": false, "author": "ben.bucksch@beonex.com", "text": "When guessing a config, we first try the local part of the email address as IMAP/POP3 username, and if a login using that fails, we try using the full email address as username. -- If I'm reading the code right.\n\nWe should change this to try the full email address first. It contains more information, and all servers *can* support that. Many servers *do* converge to support, actually.\nAlso, RFC 6186, sec 4, para. 4 mandates (MUST) that.\n\nThe relevant code is verifyConfig.js (not guessConfig.js), and the calling code.", "creator": "ben.bucksch@beonex.com", "raw_text": "When guessing a config, we first try the local part of the email address as IMAP/POP3 username, and if a login using that fails, we try using the full email address as username. -- If I'm reading the code right.\n\nWe should change this to try the full email address first. It contains more information, and all servers *can* support that. Many servers *do* converge to support, actually.\nAlso, RFC 6186, sec 4, para. 4 mandates (MUST) that.\n\nThe relevant code is verifyConfig.js (not guessConfig.js), and the calling code.", "count": 0, "time": "2011-03-31T23:49:25Z"}, {"id": 9740145, "author": "ott@mirix.org", "time": "2014-12-30T05:30:48Z", "count": 1, "is_private": false, "text": "Created attachment 8542409\nautoconfig-use-email-address-as-default-username.patch\n\nRFC 6186 requires that the email address is first used as the username:\n\n  Once a suitable connection has been made, and any required protection\n  set up, the MUA will typically need to authenticate with the IMAP,\n  POP3, or SMTP (submission) server.  The details of that are governed\n  by the specific protocols themselves, though often times a \"user\n  identifier\" is required for some form of user/password\n  authentication.  When a user identifier is required, MUAs MUST first\n  use the full email address provided by the user, and if that results\n  in an authentication failure, SHOULD fall back to using the \"local-\n  part\" extracted from the email address.  This is in line with the\n  guidance outlined in Section 5.  If both these user identifiers\n  result in authentication failure, the MUA SHOULD prompt the user for\n  a valid identifier.\n\nverifyConfig tries the username first and if the username is not equal to the\nemail address, tries the email address as well. It would be possible to detect\nwhether the username is an email address and try both the email address and the\nlocal part of the email address as the username. However, this is non-intuitive\nand may leak private data. Therefore, verifyConfig should only try the username\ndisplayed in the wizard.", "bug_id": 647046, "raw_text": "RFC 6186 requires that the email address is first used as the username:\n\n  Once a suitable connection has been made, and any required protection\n  set up, the MUA will typically need to authenticate with the IMAP,\n  POP3, or SMTP (submission) server.  The details of that are governed\n  by the specific protocols themselves, though often times a \"user\n  identifier\" is required for some form of user/password\n  authentication.  When a user identifier is required, MUAs MUST first\n  use the full email address provided by the user, and if that results\n  in an authentication failure, SHOULD fall back to using the \"local-\n  part\" extracted from the email address.  This is in line with the\n  guidance outlined in Section 5.  If both these user identifiers\n  result in authentication failure, the MUA SHOULD prompt the user for\n  a valid identifier.\n\nverifyConfig tries the username first and if the username is not equal to the\nemail address, tries the email address as well. It would be possible to detect\nwhether the username is an email address and try both the email address and the\nlocal part of the email address as the username. However, this is non-intuitive\nand may leak private data. Therefore, verifyConfig should only try the username\ndisplayed in the wizard.", "creator": "ott@mirix.org", "tags": [], "creation_time": "2014-12-30T05:30:48Z", "attachment_id": 8542409}, {"count": 2, "time": "2014-12-30T08:19:39Z", "author": "jporterbugs@gmail.com", "is_private": false, "id": 9740423, "creator": "jporterbugs@gmail.com", "raw_text": "Setting f? so people see this.", "attachment_id": 8542409, "creation_time": "2014-12-30T08:19:39Z", "tags": [], "text": "Comment on attachment 8542409\nautoconfig-use-email-address-as-default-username.patch\n\nSetting f? so people see this.", "bug_id": 647046}, {"bug_id": 647046, "text": "Comment on attachment 8542409\nautoconfig-use-email-address-as-default-username.patch\n\nReview of attachment 8542409:\n-----------------------------------------------------------------\n\nMatthias: sorry for the awful delay on this.\n\nGiven that the RFC states we SHOULD fall back to local-part, I think we should do that. Why do you think that would leak information? non-intuitive or not, it's pretty common I think.", "tags": [], "creation_time": "2015-02-15T20:01:11Z", "attachment_id": 8542409, "raw_text": "Review of attachment 8542409:\n-----------------------------------------------------------------\n\nMatthias: sorry for the awful delay on this.\n\nGiven that the RFC states we SHOULD fall back to local-part, I think we should do that. Why do you think that would leak information? non-intuitive or not, it's pretty common I think.", "creator": "mkmelin+mozilla@iki.fi", "id": 9921464, "is_private": false, "author": "mkmelin+mozilla@iki.fi", "time": "2015-02-15T20:01:11Z", "count": 3}, {"text": "(In reply to Magnus Melin [:mkmelin] from comment #3)\n> Comment on attachment 8542409\n> autoconfig-use-email-address-as-default-username.patch\n> \n> Review of attachment 8542409:\n> -----------------------------------------------------------------\n> \n> Matthias: sorry for the awful delay on this.\n> \n> Given that the RFC states we SHOULD fall back to local-part, I think we\n> should do that. Why do you think that would leak information? non-intuitive\n> or not, it's pretty common I think.", "raw_text": "(In reply to Magnus Melin [:mkmelin] from comment #3)\n> Comment on attachment 8542409\n> autoconfig-use-email-address-as-default-username.patch\n> \n> Review of attachment 8542409:\n> -----------------------------------------------------------------\n> \n> Matthias: sorry for the awful delay on this.\n> \n> Given that the RFC states we SHOULD fall back to local-part, I think we\n> should do that. Why do you think that would leak information? non-intuitive\n> or not, it's pretty common I think.", "creator": "vseerror@lehigh.edu", "time": "2018-10-09T07:41:20Z", "count": 4, "bug_id": 647046, "tags": [], "creation_time": "2018-10-09T07:41:20Z", "attachment_id": null, "id": 13671316, "author": "vseerror@lehigh.edu", "is_private": false}, {"time": "2018-10-25T19:17:07Z", "count": 5, "raw_text": "As stated in the initial description, I agree we should try email address first, then try only username.\n\nThe patch doesn't do that, though. It never tries the username only. That would mean that we fail to log in to servers that worked so far. That needs to be fixed.\n\nThe emailWizard.js parts of the patch are fine with me. The verifyConfig.js part is not.\n\n----\n\nre leak: There is no leak of information. We derive the username from the email address. Even if the config contains the username, it is supposed to be for that server. Finally, this is the server that's supposed to handle the user's email. Once we're here, the user has already approved that the server is fine. Sending the username there is not an issue.", "creator": "ben.bucksch@beonex.com", "text": "Comment on attachment 8542409\nautoconfig-use-email-address-as-default-username.patch\n\nAs stated in the initial description, I agree we should try email address first, then try only username.\n\nThe patch doesn't do that, though. It never tries the username only. That would mean that we fail to log in to servers that worked so far. That needs to be fixed.\n\nThe emailWizard.js parts of the patch are fine with me. The verifyConfig.js part is not.\n\n----\n\nre leak: There is no leak of information. We derive the username from the email address. Even if the config contains the username, it is supposed to be for that server. Finally, this is the server that's supposed to handle the user's email. Once we're here, the user has already approved that the server is fine. Sending the username there is not an issue.", "author": "ben.bucksch@beonex.com", "is_private": false, "id": 13713154, "creation_time": "2018-10-25T19:17:07Z", "tags": [], "attachment_id": 8542409, "bug_id": 647046}, {"raw_text": "Also, need to adapt checkIncomingServerAlreadyExists()", "creator": "ben.bucksch@beonex.com", "text": "Also, need to adapt checkIncomingServerAlreadyExists()", "time": "2018-10-25T21:22:08Z", "count": 6, "tags": [], "creation_time": "2018-10-25T21:22:08Z", "attachment_id": null, "bug_id": 647046, "is_private": false, "author": "ben.bucksch@beonex.com", "id": 13713506}, {"bug_id": 647046, "text": "and checkOutgoingServerAlreadyExists(), both in createAccountInBackend.js", "creation_time": "2018-10-25T21:23:23Z", "tags": [], "attachment_id": null, "raw_text": "and checkOutgoingServerAlreadyExists(), both in createAccountInBackend.js", "creator": "ben.bucksch@beonex.com", "id": 13713512, "is_private": false, "time": "2018-10-25T21:23:23Z", "author": "ben.bucksch@beonex.com", "count": 7}]}}, "comments": {}}