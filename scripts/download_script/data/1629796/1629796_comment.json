{"bugs": {"1629796": {"comments": [{"count": 0, "tags": [], "time": "2020-04-14T09:18:16Z", "creator": "andrebargull@googlemail.com", "creation_time": "2020-04-14T09:18:16Z", "bug_id": 1629796, "attachment_id": null, "raw_text": "Implement the spec changes from <https://github.com/tc39/proposal-weakrefs/pull/187>.", "text": "Implement the spec changes from <https://github.com/tc39/proposal-weakrefs/pull/187>.", "is_private": false, "author": "andrebargull@googlemail.com", "id": 14753499}, {"raw_text": "Implements the spec changes from: https://github.com/tc39/proposal-weakrefs/pull/187\n\nThe spec change removes the `FinalizationRegistryCleanupIterator` in favour of\ncalling the clean-up callback for each finalised value. It also allows to call\n`cleanupSome()` within the callback function.\n\n`FinalizationRegistryObject::cleanupQueuedRecords()` has been changed to iterate\nfrom back to front, because this allows us to call `GCVector::popCopy()`, which\nmakes it more efficient to remove entries from the `records` vector.\n\nDepends on D70820", "text": "Created attachment 9140360\nBug 1629796: Replace finalization iterator with multiple callback calls. r=jonco!\n\nImplements the spec changes from: https://github.com/tc39/proposal-weakrefs/pull/187\n\nThe spec change removes the `FinalizationRegistryCleanupIterator` in favour of\ncalling the clean-up callback for each finalised value. It also allows to call\n`cleanupSome()` within the callback function.\n\n`FinalizationRegistryObject::cleanupQueuedRecords()` has been changed to iterate\nfrom back to front, because this allows us to call `GCVector::popCopy()`, which\nmakes it more efficient to remove entries from the `records` vector.\n\nDepends on D70820", "is_private": false, "id": 14753602, "author": "andrebargull@googlemail.com", "bug_id": 1629796, "attachment_id": 9140360, "creator": "andrebargull@googlemail.com", "creation_time": "2020-04-14T09:53:42Z", "count": 1, "tags": [], "time": "2020-04-14T09:53:42Z"}, {"time": "2020-05-06T13:32:37Z", "tags": [], "count": 2, "creation_time": "2020-05-06T13:32:37Z", "creator": "andrebargull@googlemail.com", "attachment_id": null, "bug_id": 1629796, "id": 14800253, "author": "andrebargull@googlemail.com", "is_private": false, "raw_text": "Hi Jon, just a quick NI, because I'm not sure if you've seen my response to <https://phabricator.services.mozilla.com/D70821#inline-416401>.", "text": "Hi Jon, just a quick NI, because I'm not sure if you've seen my response to <https://phabricator.services.mozilla.com/D70821#inline-416401>."}, {"tags": [], "bug_id": 1629796, "count": 3, "attachment_id": null, "time": "2020-05-08T09:56:02Z", "is_private": false, "raw_text": "Replied on phabricator.  Sorry for the delay.", "text": "Replied on phabricator.  Sorry for the delay.", "author": "jcoppeard@mozilla.com", "creation_time": "2020-05-08T09:56:02Z", "id": 14804374, "creator": "jcoppeard@mozilla.com"}, {"bug_id": 1629796, "attachment_id": null, "is_private": false, "text": "Pushed by ncsoregi@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/c0c9d8211967\nReplace finalization iterator with multiple callback calls. r=jonco", "raw_text": "Pushed by ncsoregi@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/c0c9d8211967\nReplace finalization iterator with multiple callback calls. r=jonco", "author": "pulsebot@bots.tld", "id": 14816489, "tags": [], "count": 4, "time": "2020-05-13T12:03:09Z", "creation_time": "2020-05-13T12:03:09Z", "creator": "pulsebot@bots.tld"}, {"count": 5, "tags": [], "time": "2020-05-13T13:28:21Z", "creator": "ncsoregi@mozilla.com", "creation_time": "2020-05-13T13:28:21Z", "bug_id": 1629796, "attachment_id": null, "text": "Backed out for mochitest failures on test_finalizationRegistry.html\n\n*backout:* https://hg.mozilla.org/integration/autoland/rev/1e2ce9981292d4160a966f4aa4c54be5a155e136\n\n*push:* Failures have appeared on a subsequent push: https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&selectedTaskRun=Z4Lehi9MSPu4oognz6Pv2w-0&revision=d6525047e9415413285449e849c06c6630f1e53c&searchStr=mochitest-plain\n\n*failure log:* https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=302106694&repo=autoland&lineNumber=7692\n\n>[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-PASS | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | undefined assertion name \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-PASS | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | undefined assertion name \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - Buffered messages finished\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-UNEXPECTED-FAIL | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | uncaught exception - TypeError: i is not iterable at go/registry2<@http://mochi.test:8888/tests/js/xpconnect/tests/mochitest/test_finalizationRegistry.html:19:68\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO -     simpletestOnerror@SimpleTest/SimpleTest.js:1950:18\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO -     OnErrorEventHandlerNonNull*@SimpleTest/SimpleTest.js:1925:1\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - GECKO(4477) | JavaScript error: http://mochi.test:8888/tests/js/xpconnect/tests/mochi", "raw_text": "Backed out for mochitest failures on test_finalizationRegistry.html\n\n*backout:* https://hg.mozilla.org/integration/autoland/rev/1e2ce9981292d4160a966f4aa4c54be5a155e136\n\n*push:* Failures have appeared on a subsequent push: https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&selectedTaskRun=Z4Lehi9MSPu4oognz6Pv2w-0&revision=d6525047e9415413285449e849c06c6630f1e53c&searchStr=mochitest-plain\n\n*failure log:* https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=302106694&repo=autoland&lineNumber=7692\n\n>[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-PASS | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | undefined assertion name \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-PASS | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | undefined assertion name \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - Buffered messages finished\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - TEST-UNEXPECTED-FAIL | js/xpconnect/tests/mochitest/test_finalizationRegistry.html | uncaught exception - TypeError: i is not iterable at go/registry2<@http://mochi.test:8888/tests/js/xpconnect/tests/mochitest/test_finalizationRegistry.html:19:68\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - \n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO -     simpletestOnerror@SimpleTest/SimpleTest.js:1950:18\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO -     OnErrorEventHandlerNonNull*@SimpleTest/SimpleTest.js:1925:1\n[task 2020-05-13T13:24:04.104Z] 13:24:04     INFO - GECKO(4477) | JavaScript error: http://mochi.test:8888/tests/js/xpconnect/tests/mochi", "is_private": false, "author": "ncsoregi@mozilla.com", "id": 14816672}, {"id": 14816682, "creation_time": "2020-05-13T13:35:42Z", "author": "andrebargull@googlemail.com", "creator": "andrebargull@googlemail.com", "is_private": false, "raw_text": "Sorry about that, I didn't see that there are also mochi-tests which need to be updated to match the new API.", "text": "Sorry about that, I didn't see that there are also mochi-tests which need to be updated to match the new API.", "time": "2020-05-13T13:35:42Z", "attachment_id": null, "tags": [], "bug_id": 1629796, "count": 6}, {"bug_id": 1629796, "attachment_id": null, "raw_text": "Pushed by ncsoregi@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/cd6d298b0d89\nReplace finalization iterator with multiple callback calls. r=jonco", "text": "Pushed by ncsoregi@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/cd6d298b0d89\nReplace finalization iterator with multiple callback calls. r=jonco", "is_private": false, "id": 14817062, "author": "pulsebot@bots.tld", "count": 7, "tags": [], "time": "2020-05-13T16:02:44Z", "creator": "pulsebot@bots.tld", "creation_time": "2020-05-13T16:02:44Z"}, {"creation_time": "2020-05-13T21:49:02Z", "creator": "cbrindusan@mozilla.com", "tags": ["bugherder"], "count": 8, "time": "2020-05-13T21:49:02Z", "is_private": false, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/cd6d298b0d89", "text": "https://hg.mozilla.org/mozilla-central/rev/cd6d298b0d89", "author": "cbrindusan@mozilla.com", "id": 14817919, "bug_id": 1629796, "attachment_id": null}]}}, "comments": {}}