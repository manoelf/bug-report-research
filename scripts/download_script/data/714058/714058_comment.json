{"bugs": {"714058": {"comments": [{"tags": [], "bug_id": 714058, "text": "Now, if there are a couple of windows with animated images, they consume resources even if window is covered by some other window and user can not see images. I suppose, it worth adding visibility check and \"do not draw\" if covered.\nExplanations, how to do this under Windows, are in this two blog posts\nhttp://blogs.msdn.com/b/oldnewthing/archive/2003/08/29/54728.aspx\nhttp://blogs.msdn.com/b/oldnewthing/archive/2003/09/02/54758.aspx\nAlso, I suppose, flash drawing may discarded in same way too. If I choose wrong component, please, move bug to appropriate section.", "raw_text": "Now, if there are a couple of windows with animated images, they consume resources even if window is covered by some other window and user can not see images. I suppose, it worth adding visibility check and \"do not draw\" if covered.\nExplanations, how to do this under Windows, are in this two blog posts\nhttp://blogs.msdn.com/b/oldnewthing/archive/2003/08/29/54728.aspx\nhttp://blogs.msdn.com/b/oldnewthing/archive/2003/09/02/54758.aspx\nAlso, I suppose, flash drawing may discarded in same way too. If I choose wrong component, please, move bug to appropriate section.", "attachment_id": null, "author": "pppx@i.com.ua", "creator": "pppx@i.com.ua", "creation_time": "2011-12-29T15:12:03Z", "time": "2011-12-29T15:12:03Z", "is_private": false, "id": 5944880, "count": 0}, {"tags": [], "bug_id": 714058, "text": "Isn't this covered by bug 666446? (fixed in Fx11)", "attachment_id": null, "raw_text": "Isn't this covered by bug 666446? (fixed in Fx11)", "creator": "moz@jeka.info", "time": "2011-12-29T15:55:02Z", "creation_time": "2011-12-29T15:55:02Z", "author": "moz@jeka.info", "is_private": false, "id": 5944945, "count": 1}, {"attachment_id": null, "raw_text": "(In reply to j.j. from comment #1)\n> Isn't this covered by bug 666446? (fixed in Fx11)\n\nNot really (depending on what you mean by \"this\"). bug 666446 doesn't in any way prevent us from animating images in the foreground tab of covered-up windows. It does coalesce their invalidations, so that multiple animated images in such a window would get repainted simultaneously which saves on resources.  It didn't add any logic for \"is this window visible\", though, which is what Phoenix seems to be requesting.\n\nAlso: I don't think this is really be an animated-image-specific thing. As noted at the end of comment 0 -- if this were useful for animated images, then it'd also be useful for flash (and also for canvas / SVG animation / CSS transitions / anything else requiring frequent repaints).\n\n  --> Genericizing summary a bit, and moving to Core|General", "text": "(In reply to j.j. from comment #1)\n> Isn't this covered by bug 666446? (fixed in Fx11)\n\nNot really (depending on what you mean by \"this\"). bug 666446 doesn't in any way prevent us from animating images in the foreground tab of covered-up windows. It does coalesce their invalidations, so that multiple animated images in such a window would get repainted simultaneously which saves on resources.  It didn't add any logic for \"is this window visible\", though, which is what Phoenix seems to be requesting.\n\nAlso: I don't think this is really be an animated-image-specific thing. As noted at the end of comment 0 -- if this were useful for animated images, then it'd also be useful for flash (and also for canvas / SVG animation / CSS transitions / anything else requiring frequent repaints).\n\n  --> Genericizing summary a bit, and moving to Core|General", "bug_id": 714058, "tags": [], "is_private": false, "id": 5945543, "count": 2, "creator": "dholbert@mozilla.com", "creation_time": "2011-12-29T20:27:21Z", "time": "2011-12-29T20:27:21Z", "author": "dholbert@mozilla.com"}, {"creation_time": "2011-12-29T20:31:32Z", "time": "2011-12-29T20:31:32Z", "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com", "count": 3, "id": 5945558, "is_private": false, "tags": [], "bug_id": 714058, "text": "I suspect this may already be handled by the OS somewhat (or if it isn't, it definitely could be).  IIRC, we never proactively paint right now -- we just post invalidations to the OS, and then we wait for *it* to send us a callback (and only then do we paint).\n\nSo I'd expect the OS to have some intelligence for \"Ok, you invalidated this area -- but I know that another program is covering up that area -- so I won't bother telling you to repaint it yet.\"  I'm not sure it's worth trying to build that intelligence into Gecko.", "attachment_id": null, "raw_text": "I suspect this may already be handled by the OS somewhat (or if it isn't, it definitely could be).  IIRC, we never proactively paint right now -- we just post invalidations to the OS, and then we wait for *it* to send us a callback (and only then do we paint).\n\nSo I'd expect the OS to have some intelligence for \"Ok, you invalidated this area -- but I know that another program is covering up that area -- so I won't bother telling you to repaint it yet.\"  I'm not sure it's worth trying to build that intelligence into Gecko."}, {"text": "(In reply to Daniel Holbert [:dholbert] from comment #3)\n> I'm not sure it's worth trying to build that intelligence into Gecko.\n\nso this is wontifx?  or have things evolved to moderate this position?", "bug_id": 714058, "tags": [], "attachment_id": null, "raw_text": "(In reply to Daniel Holbert [:dholbert] from comment #3)\n> I'm not sure it's worth trying to build that intelligence into Gecko.\n\nso this is wontifx?  or have things evolved to moderate this position?", "creator": "vseerror@lehigh.edu", "time": "2013-12-05T15:46:01Z", "creation_time": "2013-12-05T15:46:01Z", "author": "vseerror@lehigh.edu", "is_private": false, "count": 4, "id": 8159811}, {"id": 8159843, "count": 5, "is_private": false, "time": "2013-12-05T15:53:00Z", "creation_time": "2013-12-05T15:53:00Z", "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com", "attachment_id": null, "raw_text": "Kicking needinfo to someone who's better-able to answer that.\n\nBas, do you know if there's anything useful we can do along these lines? (tl;dr the bug reporter was seeing CPU usage from animations in Firefox, even when the animations were covered up by another window.  Is there anything we can reasonably do to improve there?)\n\n(I'm not sure if there is, as I noted in comment 3.)", "bug_id": 714058, "text": "Kicking needinfo to someone who's better-able to answer that.\n\nBas, do you know if there's anything useful we can do along these lines? (tl;dr the bug reporter was seeing CPU usage from animations in Firefox, even when the animations were covered up by another window.  Is there anything we can reasonably do to improve there?)\n\n(I'm not sure if there is, as I noted in comment 3.)", "tags": []}, {"author": "bas@basschouten.com", "creator": "bas@basschouten.com", "creation_time": "2013-12-10T18:32:04Z", "time": "2013-12-10T18:32:04Z", "is_private": false, "id": 8178623, "count": 6, "tags": [], "text": "The widget folks and RefreshDriver folks would be in a better position to answer this. Even with OMTC we only paint when the composition thread is being told to paint I believe. So from a graphics perspective I don't think there's much work to be done here. Maybe Avi knows?", "bug_id": 714058, "raw_text": "The widget folks and RefreshDriver folks would be in a better position to answer this. Even with OMTC we only paint when the composition thread is being told to paint I believe. So from a graphics perspective I don't think there's much work to be done here. Maybe Avi knows?", "attachment_id": null}, {"raw_text": "I asked mattwoodrow and benwa, they both think the GPU will indeed render regardless of OS invalidation rects, especially with OMTC.", "id": 8180193, "count": 7, "is_private": false, "attachment_id": null, "text": "I asked mattwoodrow and benwa, they both think the GPU will indeed render regardless of OS invalidation rects, especially with OMTC.", "bug_id": 714058, "tags": [], "author": "avihpit@yahoo.com", "creation_time": "2013-12-10T22:45:31Z", "time": "2013-12-10T22:45:31Z", "creator": "avihpit@yahoo.com"}]}}, "comments": {}}