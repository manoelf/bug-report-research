{"comments": {}, "bugs": {"684035": {"comments": [{"raw_text": "tagnaq reported this issue to security@m.o.  The issue is that when saving an attachment sent with X-Mozilla-External-Attachment-URL, we automatically fetch the URL in the default browser. This could be used, for example, to de-anonymize a user if the email client was using Tor but the browser wasn't.  We could put up a dialog before fetching the URL confirming that's what the user wants.\n\nPoC:\n========================\nMIME-Version: 1.0\nDate: ...\nFrom: ...\nTo: ...\nSubject: ...\nContent-Transfer-Encoding: 8bit Content-Type: multipart/mixed; boundary=\"------------1237\"\n\n--------------1237\nContent-Type: text/plain; name=\"foo.txt\"\nX-Mozilla-External-Attachment-URL: http://www.example.com/foo.txt\nContent-Disposition: attachment; filename=\"foo.txt\"\n\n--------------1237--", "attachment_id": null, "tags": [], "bug_id": 684035, "text": "tagnaq reported this issue to security@m.o.  The issue is that when saving an attachment sent with X-Mozilla-External-Attachment-URL, we automatically fetch the URL in the default browser. This could be used, for example, to de-anonymize a user if the email client was using Tor but the browser wasn't.  We could put up a dialog before fetching the URL confirming that's what the user wants.\n\nPoC:\n========================\nMIME-Version: 1.0\nDate: ...\nFrom: ...\nTo: ...\nSubject: ...\nContent-Transfer-Encoding: 8bit Content-Type: multipart/mixed; boundary=\"------------1237\"\n\n--------------1237\nContent-Type: text/plain; name=\"foo.txt\"\nX-Mozilla-External-Attachment-URL: http://www.example.com/foo.txt\nContent-Disposition: attachment; filename=\"foo.txt\"\n\n--------------1237--", "is_private": false, "id": 5694709, "count": 0, "author": "brandon@hackmill.com", "creator": "brandon@hackmill.com", "time": "2011-09-01T21:01:47Z", "creation_time": "2011-09-01T21:01:47Z"}, {"raw_text": "I'm adding the email conversation between security@m.o and me (starting in June 2011) here:\n\n-----------------------------------------------------------------------------\nMessage-ID: <4E0BD901.8030802@gmail.com>\nDate: Thu, 30 Jun 2011 04:01:37 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org>\nIn-Reply-To: <4E0A318A.50901@mozilla.org>\nContent-Type: multipart/mixed;\n boundary=\"------------070808080908070708060807\"\n\nThis is a multi-part message in MIME format.\n--------------070808080908070708060807\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\n\nHi Brandon,\n\nI'm sorry for the delay.\n\n> > I\n> > tested with a variety of file types and was not able to observe the\n> > behavior you are describing, so I will wait to hear back from you with\n> > additional details.\nI'm sending you a PoC to reproduce the behaviour. Actually it is very\nsimple, but not only the email content matters. The server needs to send\nthe correct headers/response too (redirect) - which is not a problem for\nan attacker anyway.\n\nThe PoC is not harmful, it uses the target url:\nhttp://www.example.com/foo.txt\nwhich will open firefox with http://www.iana.org/domains/example/\n(The domain/webserver is not controlled by me..)\n\nThe PoC includes\nContent-Type:\nContent-Disposition:\nheader fields but their values are not important\nimage/png, application/pdf, etc. would also do it.\n\nIf you are having problems to reproduce it, let me know,\nI can also send you an email with the deployed PoC in it - if you\nexplicitly wish.\n\nThis email contains an attachment, which is not related to this bug but\nit contains just my public GPG key - please use it for encrypting your\nreplies.\n(actually that would make a perfect social engineering attack to trick a\nuser into 'Save as...' ;)\n\nPlease let me know in case you are allocating a CVE for this one.\n\nPoC:\n========================\nMIME-Version: 1.0\nDate: ...\nFrom: ...\nTo: ...\nSubject: ...\nContent-Transfer-Encoding: 8bit\nContent-Type: multipart/mixed;\n boundary=\"------------1237\"\n\n--------------1237\nContent-Type: text/plain; name=\"foo.txt\"\nX-Mozilla-External-Attachment-URL: http://www.example.com/foo.txt\nContent-Disposition: attachment; filename=\"foo.txt\"\n\n--------------1237--\n\n\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E0C9A0F.5060407@mozilla.org>\nDate: Thu, 30 Jun 2011 08:45:19 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.18) Gecko/20110616 Thunderbird/3.1.11\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com>\nIn-Reply-To: <4E0BD901.8030802@gmail.com>\nX-Enigmail-Version: 1.1.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nHello,\n\nThank you for your reply.  I received the PoC, and we will investigate\nthis issue right away.  We will be back in touch with you as we\ndetermine the right course of action in terms of fixing this bug.  Let\nme know if you have any questions in the meantime.\n\nRegards,\n\nBrandon Sterne\nMozilla Security Group\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E198987.2030200@gmail.com>\nDate: Sun, 10 Jul 2011 13:14:15 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nMozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\nsemi-mitigation via preferences change:\nnetwork.protocol-handler.warn-external.http = true\nnetwork.protocol-handler.warn-external.https = true\n\nthis will at least ask the user for confirmation before it will open\nfirefox, but even with this changes the user is not informed that the\nfile is remote.\n\nbtw: as you might have noticed already, this is not the only part where\nThunderbird has problems with HTTP Redirects.\n\nregards\n\n\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E1B19AB.90701@gmail.com>\nDate: Mon, 11 Jul 2011 17:41:31 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nMozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\nA question about the general handling of the\nX-Mozilla-External-Attachment-URL header field (an the other\nX-Mozilla... headers)\nIs that a remote feature by design or is that supposed to be set by\nThunderbird locally only?\n\nthanks.\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5EAF6A.5050005@gmail.com>\nDate: Thu, 01 Sep 2011 00:02:18 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 06/30/2011 05:45 PM, Mozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\n> > \n> > Regards,\n> > \n> > Brandon Sterne\n> > Mozilla Security Group\nHi,\n\nafter having a look at Thunderbird 7.0b1 I suppose a fix was commited. I\nhaven't heard from you since June. Did I miss an email?\n\nThe release notes [1] mention \"Several fixes to attachment handling\".\nCan you confirm that 7.0b1 contains a fix?\n\nthanks!\n\n[1] https://www.mozilla.org/en-US/thunderbird/7.0beta/releasenotes/\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5EB901.3010108@mozilla.org>\nDate: Wed, 31 Aug 2011 15:43:13 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (X11; Linux i686; rv:6.0) Gecko/20110812 Thunderbird/6.0\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com>\nIn-Reply-To: <4E5EAF6A.5050005@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\nHello,\n\nHere is what I sent you about 15 minutes after the first response:\n\nOn 06/30/2011 08:58 AM, Mozilla Security wrote:\n> > Hello again,\n> >\n> > As I'm reading through your PoC, I believe the risk of the issue\n> > you are reporting is lower than I originally thought, and I want to\n> > make sure I'm not missing some aspect of the issue.\n> >\n> > If I understand it correctly, the\n> > X-Mozilla-External-Attachment-URL header is used to cause the \"Save\n> > As...\" action to open the URL in the default browser, *not* to open\n> > the file using the operating system's default application for that\n> > type of file.  This is an important distinction, as Firefox and\n> > other browsers are set up to take \"safe\" actions with the remote\n> > content based on what type of file it is.  In your example, Firefox\n> > will display the contents of a text file, as that action is not\n> > considered harmful.  If it were an executable, however, we would\n> > not allow the user to open it directly, but instead would only give\n> > them the option of saving it locally.\n> >\n> > Let me know if I have misunderstood the issue.  I want to make sure\n> > I understand it before I file any bugs in our bug database.\n> >\n> > Regards,\n> >\n> > Brandon Sterne Mozilla Security Group\n\nI hope my question was clear.  I don't believe the \"fixes to\nattachment handling\" that you referred to in the release notes are\nrelated to the issue you reported.  Let me know if you have any questions.\n\nRegards,\n\n-- Brandon Sterne Mozilla Security Group \n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5F41B2.5040304@gmail.com>\nDate: Thu, 01 Sep 2011 10:26:26 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org>\nIn-Reply-To: <4E5EB901.3010108@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nHello,\n\nthank you for your prompt answer.\n\nOn 09/01/2011 12:43 AM, Mozilla Security wrote:\n> > Here is what I sent you about 15 minutes after the first response:\n\nTo which email address was this sent? (unfortunately I never received it)\n\n> > On 06/30/2011 08:58 AM, Mozilla Security wrote:\n>> >> Hello again,\n> > \n>> >> As I'm reading through your PoC, I believe the risk of the issue\n>> >> you are reporting is lower than I originally thought, and I want to\n>> >> make sure I'm not missing some aspect of the issue.\n> > \n>> >> If I understand it correctly, the\n>> >> X-Mozilla-External-Attachment-URL header is used to cause the \"Save\n>> >> As...\" action to open the URL in the default browser, *not* to open\n>> >> the file using the operating system's default application for that\n>> >> type of file.  \n\nYou understood the bug correctly.\n\n>> >> Let me know if I have misunderstood the issue.  I want to make sure\n>> >> I understand it before I file any bugs in our bug database.\n\nPlease let me know if there is an entry in bugzilla for this bug.\n\n\n> > I hope my question was clear.  I don't believe the \"fixes to\n> > attachment handling\" that you referred to in the release notes are\n> > related to the issue you reported.  Let me know if you have any questions.\n\nThat is interesting because the original PoC as it was, is not working\nanymore with TB 7.0b1 :)\n\nkind regards!\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FB91E.6080306@mozilla.org>\nDate: Thu, 01 Sep 2011 09:55:58 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0.1) Gecko/20110830 Thunderbird/6.0.1\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com>\nIn-Reply-To: <4E5F41B2.5040304@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nOn 9/1/11 1:26 AM, tagnaq wrote:\n> Hello,\n> \n> thank you for your prompt answer.\n> \n> On 09/01/2011 12:43 AM, Mozilla Security wrote:\n>> Here is what I sent you about 15 minutes after the first\n>> response:\n> \n> To which email address was this sent? (unfortunately I never\n> received it)\n\nSorry for the mixup.  It does appear that I sent that email to the\nMozilla Security address twice, rather than copying you.\n\n>> On 06/30/2011 08:58 AM, Mozilla Security wrote:\n>>> Hello again,\n>> \n>>> As I'm reading through your PoC, I believe the risk of the\n>>> issue you are reporting is lower than I originally thought, and\n>>> I want to make sure I'm not missing some aspect of the issue.\n>> \n>>> If I understand it correctly, the \n>>> X-Mozilla-External-Attachment-URL header is used to cause the\n>>> \"Save As...\" action to open the URL in the default browser,\n>>> *not* to open the file using the operating system's default\n>>> application for that type of file.\n> \n> You understood the bug correctly.\n\nI'm glad to hear that.\n\n>>> Let me know if I have misunderstood the issue.  I want to make\n>>> sure I understand it before I file any bugs in our bug\n>>> database.\n> \n> Please let me know if there is an entry in bugzilla for this bug.\n\nI never filed a Bugzilla ticket, as I didn't believe there was an\nactual exploit here.  My opinion is that we have the correct behavior\nin prompting the user to save the file, and _only_ presenting that\noption when it is a \"dangerous\" file type.\n\n>> I hope my question was clear.  I don't believe the \"fixes to \n>> attachment handling\" that you referred to in the release notes\n>> are related to the issue you reported.  Let me know if you have\n>> any questions.\n> \n> That is interesting because the original PoC as it was, is not\n> working anymore with TB 7.0b1 :)\n\nHow do you mean it is not working anymore?  Do we no longer even\npresent the download prompt?\n\n> kind regards!\n\nThanks again for contacting us, and let me know if you have any other\nquestions.\n\nRegards,\n\nBrandon Sterne\nMozilla Security Group\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.8 (Darwin)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/\n\niQIcBAEBAgAGBQJOX7kdAAoJEBAMm4nfVaFGZ+YP+gI/ffH3A+G7NXuuEpQK+gRl\nlXf4T6g8ziDCIYDg0NCo+z0i+Z3l1mYFzo1BqdyighAVYCJJrmeXRKz2BJz/Q3G+\ny10toswyYq/RL3feFcKgOREPeyBqNi7TBGKazgfB6QBu6cBKCgfpP82DiY+arQYy\nG6oH4gLqjz2Kw+QzrwMD3lzIow8m+bkGAnkRynOAhwNd278p5P8dvq66yqdYSvbu\nhrUycXODHKHoBe/TTPqf4lujpQHlbn25LeWBHIUSp2bEDf5bmN+v0b9IosEtSu5B\nAkrGBlvr11gVSit+OlfOmHXIP2mlczynm4Y8Xn/6d5+25oHN5USKpP9n4e80rzGb\nhLzySBb9ySfLTa/zWPYuMc1XrNO3QRTrAnSQkYRagXX+kR4E9boSwP6vxdyphtWV\n98WXlLNEAbSkb2HNFw9cKDsIcwTlbhQSDGrQFBLHUhjzhJlHBPhf86Qo4cgspeEH\naVNPKtBMulHevP3G3JNbv7A4NlwljRY8mgibkZgYFGaO5R0NE83Inx+/s31bnKV6\n87oD5xefgvoED/TFgBb6UfVDaUVUsGC+qBJm+D8JV+UOZ1nUzqCr4qeUwVtmxw+W\n7J2ScHMJj6YcHjAdR9p2vXG4kXzfOl92jhtm33oXrqshnbKwBhUnyePhZH/FUEwV\nn9EQ1UMw31igGK8TjIwI\n=vQ4y\n-----END PGP SIGNATURE-----\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FE6DC.3010100@gmail.com>\nDate: Thu, 01 Sep 2011 22:11:08 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org>\nIn-Reply-To: <4E5FB91E.6080306@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 09/01/2011 06:55 PM, Mozilla Security wrote:\n> > Sorry for the mixup.  It does appear that I sent that email to the\n> > Mozilla Security address twice, rather than copying you.\nOk, that explains why I didn't receive that mail.\n\nWas the answer to my mail from the 11th July  (Message-ID:\n<4E1B19AB.90701@gmail.com>) also \"lost\" this way?\n\n>> >> Please let me know if there is an entry in bugzilla for this bug.\n> > \n> > I never filed a Bugzilla ticket, as I didn't believe there was an\n> > actual exploit here.  My opinion is that we have the correct behavior\n> > in prompting the user to save the file\nThe very nature of this bug is the missing prompt. After selecting \"Save\nas...\" I would expect Thunderbird to ask me for the location but\nThunderbird immediately starts the browser instead (no prompt).\nI agree that one might say that this is not a security issue, but it is\nnot expected behaviour and at least a bug in my opinion.\n\nIn my context - I analyzed Thunderbird in context with Tor - this bug\nallows an attacker to deanonymize its target - if the target tries to\nsave an attachment.\n\n..but after all 7.0b1 seems to fix the issue - or at least prevents the\nPoC from working (I haven't looked into the changes).\n\nkind regards!\n\nps: please encrypt all your replies.\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FF2D6.9010206@mozilla.org>\nDate: Thu, 01 Sep 2011 14:02:14 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0.1) Gecko/20110830 Thunderbird/6.0.1\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org> <4E5FE6DC.3010100@gmail.com>\nIn-Reply-To: <4E5FE6DC.3010100@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nOn 9/1/11 1:11 PM, tagnaq wrote:\n> > On 09/01/2011 06:55 PM, Mozilla Security wrote:\n>> >> Sorry for the mixup.  It does appear that I sent that email to\n>> >> the Mozilla Security address twice, rather than copying you.\n> > \n> > Ok, that explains why I didn't receive that mail.\n> > \n> > Was the answer to my mail from the 11th July  (Message-ID: \n> > <4E1B19AB.90701@gmail.com>) also \"lost\" this way?\n\nI do not have a message from you on that date nor any message from you\nwith that Message-ID.\n\n>>> >>> Please let me know if there is an entry in bugzilla for this\n>>> >>> bug.\n>> >> \n>> >> I never filed a Bugzilla ticket, as I didn't believe there was\n>> >> an actual exploit here.  My opinion is that we have the correct\n>> >> behavior in prompting the user to save the file\n> > \n> > The very nature of this bug is the missing prompt. After selecting\n> > \"Save as...\" I would expect Thunderbird to ask me for the location\n> > but Thunderbird immediately starts the browser instead (no\n> > prompt). I agree that one might say that this is not a security\n> > issue, but it is not expected behaviour and at least a bug in my\n> > opinion.\n> > \n> > In my context - I analyzed Thunderbird in context with Tor - this\n> > bug allows an attacker to deanonymize its target - if the target\n> > tries to save an attachment.\nPresumably, the request for the URL would go through the Tor proxy as\nwell, right?  Very well.  I have filed a bug to track this issue:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=684035\n\nI do not believe it needs to be hidden, as this is more of a privacy\nissue than a security exploit, plus having the bug be open will\nincrease the probability that someone ultimately fixes it.\n\n> > ..but after all 7.0b1 seems to fix the issue - or at least prevents\n> > the PoC from working (I haven't looked into the changes).\nI still don't have an answer there. Perhaps one of the developers who\ninvestigates the bug will know what changed.\n\n> > kind regards!\n> > \n> > ps: please encrypt all your replies.\nThank you. I will for this and future replies.\n\n\nBest regards,\n\nBrandon Sterne\nMozilla Security Group\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FF554.6080102@gmail.com>\nDate: Thu, 01 Sep 2011 23:12:52 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org> <4E5FE6DC.3010100@gmail.com> <4E5FF2D6.9010206@mozilla.org>\nIn-Reply-To: <4E5FF2D6.9010206@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 09/01/2011 11:02 PM, Mozilla Security wrote:\n> > I do not have a message from you on that date nor any message from you\n> > with that Message-ID.\nI suppose you didn't get my email from 10th July either.\nLooks like we're having communication issues..\n\n\n> > Presumably, the request for the URL would go through the Tor proxy as\n> > well, right?  Very well.  I have filed a bug to track this issue:\n> > https://bugzilla.mozilla.org/show_bug.cgi?id=684035\n> > \n> > I do not believe it needs to be hidden, as this is more of a privacy\n> > issue than a security exploit, plus having the bug be open will\n> > increase the probability that someone ultimately fixes it.\nThanks for filing the bug.\nIf you agree I'll add our email conversation to the bug.\n\nkind regards!", "attachment_id": null, "tags": [], "bug_id": 684035, "text": "I'm adding the email conversation between security@m.o and me (starting in June 2011) here:\n\n-----------------------------------------------------------------------------\nMessage-ID: <4E0BD901.8030802@gmail.com>\nDate: Thu, 30 Jun 2011 04:01:37 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org>\nIn-Reply-To: <4E0A318A.50901@mozilla.org>\nContent-Type: multipart/mixed;\n boundary=\"------------070808080908070708060807\"\n\nThis is a multi-part message in MIME format.\n--------------070808080908070708060807\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\n\nHi Brandon,\n\nI'm sorry for the delay.\n\n> > I\n> > tested with a variety of file types and was not able to observe the\n> > behavior you are describing, so I will wait to hear back from you with\n> > additional details.\nI'm sending you a PoC to reproduce the behaviour. Actually it is very\nsimple, but not only the email content matters. The server needs to send\nthe correct headers/response too (redirect) - which is not a problem for\nan attacker anyway.\n\nThe PoC is not harmful, it uses the target url:\nhttp://www.example.com/foo.txt\nwhich will open firefox with http://www.iana.org/domains/example/\n(The domain/webserver is not controlled by me..)\n\nThe PoC includes\nContent-Type:\nContent-Disposition:\nheader fields but their values are not important\nimage/png, application/pdf, etc. would also do it.\n\nIf you are having problems to reproduce it, let me know,\nI can also send you an email with the deployed PoC in it - if you\nexplicitly wish.\n\nThis email contains an attachment, which is not related to this bug but\nit contains just my public GPG key - please use it for encrypting your\nreplies.\n(actually that would make a perfect social engineering attack to trick a\nuser into 'Save as...' ;)\n\nPlease let me know in case you are allocating a CVE for this one.\n\nPoC:\n========================\nMIME-Version: 1.0\nDate: ...\nFrom: ...\nTo: ...\nSubject: ...\nContent-Transfer-Encoding: 8bit\nContent-Type: multipart/mixed;\n boundary=\"------------1237\"\n\n--------------1237\nContent-Type: text/plain; name=\"foo.txt\"\nX-Mozilla-External-Attachment-URL: http://www.example.com/foo.txt\nContent-Disposition: attachment; filename=\"foo.txt\"\n\n--------------1237--\n\n\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E0C9A0F.5060407@mozilla.org>\nDate: Thu, 30 Jun 2011 08:45:19 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.18) Gecko/20110616 Thunderbird/3.1.11\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com>\nIn-Reply-To: <4E0BD901.8030802@gmail.com>\nX-Enigmail-Version: 1.1.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nHello,\n\nThank you for your reply.  I received the PoC, and we will investigate\nthis issue right away.  We will be back in touch with you as we\ndetermine the right course of action in terms of fixing this bug.  Let\nme know if you have any questions in the meantime.\n\nRegards,\n\nBrandon Sterne\nMozilla Security Group\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E198987.2030200@gmail.com>\nDate: Sun, 10 Jul 2011 13:14:15 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nMozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\nsemi-mitigation via preferences change:\nnetwork.protocol-handler.warn-external.http = true\nnetwork.protocol-handler.warn-external.https = true\n\nthis will at least ask the user for confirmation before it will open\nfirefox, but even with this changes the user is not informed that the\nfile is remote.\n\nbtw: as you might have noticed already, this is not the only part where\nThunderbird has problems with HTTP Redirects.\n\nregards\n\n\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E1B19AB.90701@gmail.com>\nDate: Mon, 11 Jul 2011 17:41:31 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nMozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\nA question about the general handling of the\nX-Mozilla-External-Attachment-URL header field (an the other\nX-Mozilla... headers)\nIs that a remote feature by design or is that supposed to be set by\nThunderbird locally only?\n\nthanks.\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5EAF6A.5050005@gmail.com>\nDate: Thu, 01 Sep 2011 00:02:18 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org>\nIn-Reply-To: <4E0C9A0F.5060407@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 06/30/2011 05:45 PM, Mozilla Security wrote:\n> > Hello,\n> > \n> > Thank you for your reply.  I received the PoC, and we will investigate\n> > this issue right away.  We will be back in touch with you as we\n> > determine the right course of action in terms of fixing this bug.  Let\n> > me know if you have any questions in the meantime.\n> > \n> > Regards,\n> > \n> > Brandon Sterne\n> > Mozilla Security Group\nHi,\n\nafter having a look at Thunderbird 7.0b1 I suppose a fix was commited. I\nhaven't heard from you since June. Did I miss an email?\n\nThe release notes [1] mention \"Several fixes to attachment handling\".\nCan you confirm that 7.0b1 contains a fix?\n\nthanks!\n\n[1] https://www.mozilla.org/en-US/thunderbird/7.0beta/releasenotes/\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5EB901.3010108@mozilla.org>\nDate: Wed, 31 Aug 2011 15:43:13 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (X11; Linux i686; rv:6.0) Gecko/20110812 Thunderbird/6.0\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com>\nIn-Reply-To: <4E5EAF6A.5050005@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\nHello,\n\nHere is what I sent you about 15 minutes after the first response:\n\nOn 06/30/2011 08:58 AM, Mozilla Security wrote:\n> > Hello again,\n> >\n> > As I'm reading through your PoC, I believe the risk of the issue\n> > you are reporting is lower than I originally thought, and I want to\n> > make sure I'm not missing some aspect of the issue.\n> >\n> > If I understand it correctly, the\n> > X-Mozilla-External-Attachment-URL header is used to cause the \"Save\n> > As...\" action to open the URL in the default browser, *not* to open\n> > the file using the operating system's default application for that\n> > type of file.  This is an important distinction, as Firefox and\n> > other browsers are set up to take \"safe\" actions with the remote\n> > content based on what type of file it is.  In your example, Firefox\n> > will display the contents of a text file, as that action is not\n> > considered harmful.  If it were an executable, however, we would\n> > not allow the user to open it directly, but instead would only give\n> > them the option of saving it locally.\n> >\n> > Let me know if I have misunderstood the issue.  I want to make sure\n> > I understand it before I file any bugs in our bug database.\n> >\n> > Regards,\n> >\n> > Brandon Sterne Mozilla Security Group\n\nI hope my question was clear.  I don't believe the \"fixes to\nattachment handling\" that you referred to in the release notes are\nrelated to the issue you reported.  Let me know if you have any questions.\n\nRegards,\n\n-- Brandon Sterne Mozilla Security Group \n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5F41B2.5040304@gmail.com>\nDate: Thu, 01 Sep 2011 10:26:26 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org>\nIn-Reply-To: <4E5EB901.3010108@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nHello,\n\nthank you for your prompt answer.\n\nOn 09/01/2011 12:43 AM, Mozilla Security wrote:\n> > Here is what I sent you about 15 minutes after the first response:\n\nTo which email address was this sent? (unfortunately I never received it)\n\n> > On 06/30/2011 08:58 AM, Mozilla Security wrote:\n>> >> Hello again,\n> > \n>> >> As I'm reading through your PoC, I believe the risk of the issue\n>> >> you are reporting is lower than I originally thought, and I want to\n>> >> make sure I'm not missing some aspect of the issue.\n> > \n>> >> If I understand it correctly, the\n>> >> X-Mozilla-External-Attachment-URL header is used to cause the \"Save\n>> >> As...\" action to open the URL in the default browser, *not* to open\n>> >> the file using the operating system's default application for that\n>> >> type of file.  \n\nYou understood the bug correctly.\n\n>> >> Let me know if I have misunderstood the issue.  I want to make sure\n>> >> I understand it before I file any bugs in our bug database.\n\nPlease let me know if there is an entry in bugzilla for this bug.\n\n\n> > I hope my question was clear.  I don't believe the \"fixes to\n> > attachment handling\" that you referred to in the release notes are\n> > related to the issue you reported.  Let me know if you have any questions.\n\nThat is interesting because the original PoC as it was, is not working\nanymore with TB 7.0b1 :)\n\nkind regards!\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FB91E.6080306@mozilla.org>\nDate: Thu, 01 Sep 2011 09:55:58 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0.1) Gecko/20110830 Thunderbird/6.0.1\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com>\nIn-Reply-To: <4E5F41B2.5040304@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nOn 9/1/11 1:26 AM, tagnaq wrote:\n> Hello,\n> \n> thank you for your prompt answer.\n> \n> On 09/01/2011 12:43 AM, Mozilla Security wrote:\n>> Here is what I sent you about 15 minutes after the first\n>> response:\n> \n> To which email address was this sent? (unfortunately I never\n> received it)\n\nSorry for the mixup.  It does appear that I sent that email to the\nMozilla Security address twice, rather than copying you.\n\n>> On 06/30/2011 08:58 AM, Mozilla Security wrote:\n>>> Hello again,\n>> \n>>> As I'm reading through your PoC, I believe the risk of the\n>>> issue you are reporting is lower than I originally thought, and\n>>> I want to make sure I'm not missing some aspect of the issue.\n>> \n>>> If I understand it correctly, the \n>>> X-Mozilla-External-Attachment-URL header is used to cause the\n>>> \"Save As...\" action to open the URL in the default browser,\n>>> *not* to open the file using the operating system's default\n>>> application for that type of file.\n> \n> You understood the bug correctly.\n\nI'm glad to hear that.\n\n>>> Let me know if I have misunderstood the issue.  I want to make\n>>> sure I understand it before I file any bugs in our bug\n>>> database.\n> \n> Please let me know if there is an entry in bugzilla for this bug.\n\nI never filed a Bugzilla ticket, as I didn't believe there was an\nactual exploit here.  My opinion is that we have the correct behavior\nin prompting the user to save the file, and _only_ presenting that\noption when it is a \"dangerous\" file type.\n\n>> I hope my question was clear.  I don't believe the \"fixes to \n>> attachment handling\" that you referred to in the release notes\n>> are related to the issue you reported.  Let me know if you have\n>> any questions.\n> \n> That is interesting because the original PoC as it was, is not\n> working anymore with TB 7.0b1 :)\n\nHow do you mean it is not working anymore?  Do we no longer even\npresent the download prompt?\n\n> kind regards!\n\nThanks again for contacting us, and let me know if you have any other\nquestions.\n\nRegards,\n\nBrandon Sterne\nMozilla Security Group\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.8 (Darwin)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/\n\niQIcBAEBAgAGBQJOX7kdAAoJEBAMm4nfVaFGZ+YP+gI/ffH3A+G7NXuuEpQK+gRl\nlXf4T6g8ziDCIYDg0NCo+z0i+Z3l1mYFzo1BqdyighAVYCJJrmeXRKz2BJz/Q3G+\ny10toswyYq/RL3feFcKgOREPeyBqNi7TBGKazgfB6QBu6cBKCgfpP82DiY+arQYy\nG6oH4gLqjz2Kw+QzrwMD3lzIow8m+bkGAnkRynOAhwNd278p5P8dvq66yqdYSvbu\nhrUycXODHKHoBe/TTPqf4lujpQHlbn25LeWBHIUSp2bEDf5bmN+v0b9IosEtSu5B\nAkrGBlvr11gVSit+OlfOmHXIP2mlczynm4Y8Xn/6d5+25oHN5USKpP9n4e80rzGb\nhLzySBb9ySfLTa/zWPYuMc1XrNO3QRTrAnSQkYRagXX+kR4E9boSwP6vxdyphtWV\n98WXlLNEAbSkb2HNFw9cKDsIcwTlbhQSDGrQFBLHUhjzhJlHBPhf86Qo4cgspeEH\naVNPKtBMulHevP3G3JNbv7A4NlwljRY8mgibkZgYFGaO5R0NE83Inx+/s31bnKV6\n87oD5xefgvoED/TFgBb6UfVDaUVUsGC+qBJm+D8JV+UOZ1nUzqCr4qeUwVtmxw+W\n7J2ScHMJj6YcHjAdR9p2vXG4kXzfOl92jhtm33oXrqshnbKwBhUnyePhZH/FUEwV\nn9EQ1UMw31igGK8TjIwI\n=vQ4y\n-----END PGP SIGNATURE-----\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FE6DC.3010100@gmail.com>\nDate: Thu, 01 Sep 2011 22:11:08 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org>\nIn-Reply-To: <4E5FB91E.6080306@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 09/01/2011 06:55 PM, Mozilla Security wrote:\n> > Sorry for the mixup.  It does appear that I sent that email to the\n> > Mozilla Security address twice, rather than copying you.\nOk, that explains why I didn't receive that mail.\n\nWas the answer to my mail from the 11th July  (Message-ID:\n<4E1B19AB.90701@gmail.com>) also \"lost\" this way?\n\n>> >> Please let me know if there is an entry in bugzilla for this bug.\n> > \n> > I never filed a Bugzilla ticket, as I didn't believe there was an\n> > actual exploit here.  My opinion is that we have the correct behavior\n> > in prompting the user to save the file\nThe very nature of this bug is the missing prompt. After selecting \"Save\nas...\" I would expect Thunderbird to ask me for the location but\nThunderbird immediately starts the browser instead (no prompt).\nI agree that one might say that this is not a security issue, but it is\nnot expected behaviour and at least a bug in my opinion.\n\nIn my context - I analyzed Thunderbird in context with Tor - this bug\nallows an attacker to deanonymize its target - if the target tries to\nsave an attachment.\n\n..but after all 7.0b1 seems to fix the issue - or at least prevents the\nPoC from working (I haven't looked into the changes).\n\nkind regards!\n\nps: please encrypt all your replies.\n\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FF2D6.9010206@mozilla.org>\nDate: Thu, 01 Sep 2011 14:02:14 -0700\nFrom: Mozilla Security <security@mozilla.org>\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0.1) Gecko/20110830 Thunderbird/6.0.1\nMIME-Version: 1.0\nTo: tagnaq <tagnaq@gmail.com>\nCC: security@mozilla.org\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org> <4E5FE6DC.3010100@gmail.com>\nIn-Reply-To: <4E5FE6DC.3010100@gmail.com>\nX-Enigmail-Version: 1.3.1\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n\nOn 9/1/11 1:11 PM, tagnaq wrote:\n> > On 09/01/2011 06:55 PM, Mozilla Security wrote:\n>> >> Sorry for the mixup.  It does appear that I sent that email to\n>> >> the Mozilla Security address twice, rather than copying you.\n> > \n> > Ok, that explains why I didn't receive that mail.\n> > \n> > Was the answer to my mail from the 11th July  (Message-ID: \n> > <4E1B19AB.90701@gmail.com>) also \"lost\" this way?\n\nI do not have a message from you on that date nor any message from you\nwith that Message-ID.\n\n>>> >>> Please let me know if there is an entry in bugzilla for this\n>>> >>> bug.\n>> >> \n>> >> I never filed a Bugzilla ticket, as I didn't believe there was\n>> >> an actual exploit here.  My opinion is that we have the correct\n>> >> behavior in prompting the user to save the file\n> > \n> > The very nature of this bug is the missing prompt. After selecting\n> > \"Save as...\" I would expect Thunderbird to ask me for the location\n> > but Thunderbird immediately starts the browser instead (no\n> > prompt). I agree that one might say that this is not a security\n> > issue, but it is not expected behaviour and at least a bug in my\n> > opinion.\n> > \n> > In my context - I analyzed Thunderbird in context with Tor - this\n> > bug allows an attacker to deanonymize its target - if the target\n> > tries to save an attachment.\nPresumably, the request for the URL would go through the Tor proxy as\nwell, right?  Very well.  I have filed a bug to track this issue:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=684035\n\nI do not believe it needs to be hidden, as this is more of a privacy\nissue than a security exploit, plus having the bug be open will\nincrease the probability that someone ultimately fixes it.\n\n> > ..but after all 7.0b1 seems to fix the issue - or at least prevents\n> > the PoC from working (I haven't looked into the changes).\nI still don't have an answer there. Perhaps one of the developers who\ninvestigates the bug will know what changed.\n\n> > kind regards!\n> > \n> > ps: please encrypt all your replies.\nThank you. I will for this and future replies.\n\n\nBest regards,\n\nBrandon Sterne\nMozilla Security Group\n-----------------------------------------------------------------------------\n-----------------------------------------------------------------------------\nMessage-ID: <4E5FF554.6080102@gmail.com>\nDate: Thu, 01 Sep 2011 23:12:52 +0200\nFrom: tagnaq <tagnaq@gmail.com>\nMIME-Version: 1.0\nTo: Mozilla Security <security@mozilla.org>\nSubject: Re: Thunderbird Attachment Handling Bug\nReferences: <4E0A318A.50901@mozilla.org> <4E0BD901.8030802@gmail.com> <4E0C9A0F.5060407@mozilla.org> <4E5EAF6A.5050005@gmail.com> <4E5EB901.3010108@mozilla.org> <4E5F41B2.5040304@gmail.com> <4E5FB91E.6080306@mozilla.org> <4E5FE6DC.3010100@gmail.com> <4E5FF2D6.9010206@mozilla.org>\nIn-Reply-To: <4E5FF2D6.9010206@mozilla.org>\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nOn 09/01/2011 11:02 PM, Mozilla Security wrote:\n> > I do not have a message from you on that date nor any message from you\n> > with that Message-ID.\nI suppose you didn't get my email from 10th July either.\nLooks like we're having communication issues..\n\n\n> > Presumably, the request for the URL would go through the Tor proxy as\n> > well, right?  Very well.  I have filed a bug to track this issue:\n> > https://bugzilla.mozilla.org/show_bug.cgi?id=684035\n> > \n> > I do not believe it needs to be hidden, as this is more of a privacy\n> > issue than a security exploit, plus having the bug be open will\n> > increase the probability that someone ultimately fixes it.\nThanks for filing the bug.\nIf you agree I'll add our email conversation to the bug.\n\nkind regards!", "id": 5694840, "count": 1, "is_private": false, "author": "tagnaq@bitmessage.ch", "creation_time": "2011-09-01T21:51:11Z", "time": "2011-09-01T21:51:11Z", "creator": "tagnaq@bitmessage.ch"}, {"creator": "tagnaq@bitmessage.ch", "creation_time": "2011-09-23T21:45:00Z", "time": "2011-09-23T21:45:00Z", "author": "tagnaq@bitmessage.ch", "is_private": false, "count": 2, "id": 5734567, "tags": [], "bug_id": 684035, "text": "reference:\nhttps://bitly.com/qDZm7C (PDF file - section: 4.1.4)", "attachment_id": null, "raw_text": "reference:\nhttps://bitly.com/qDZm7C (PDF file - section: 4.1.4)"}]}}}