{"bugs": {"698276": {"comments": [{"bug_id": 698276, "count": 0, "id": 5813882, "attachment_id": 570551, "raw_text": "From parent bug:\n\nFor the new Downloads panel, having sessionType available after the session\nstartup phase finished can simplify some of the session restore code.", "author": "misak.bugzilla@gmail.com", "creation_time": "2011-10-30T14:49:49Z", "tags": [], "time": "2011-10-30T14:49:49Z", "text": "Created attachment 570551\npatch\n\nFrom parent bug:\n\nFor the new Downloads panel, having sessionType available after the session\nstartup phase finished can simplify some of the session restore code.", "creator": "misak.bugzilla@gmail.com", "is_private": false}, {"is_private": false, "creator": "neil@httl.net", "count": 1, "creation_time": "2011-10-30T15:12:29Z", "author": "neil@httl.net", "text": "Comment on attachment 570551\npatch\n\n>+      if (this._sessionType != Ci.nsISessionStartup.NO_SESSION)\n>+        Services.obs.removeObserver(this, \"browser:purge-session-history\");\n>       this.init();\nI don't understand this change; _sessionType defaults to Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by this.init(), which is also where the observer gets added in the first place.", "bug_id": 698276, "time": "2011-10-30T15:12:29Z", "tags": [], "attachment_id": 570551, "raw_text": ">+      if (this._sessionType != Ci.nsISessionStartup.NO_SESSION)\n>+        Services.obs.removeObserver(this, \"browser:purge-session-history\");\n>       this.init();\nI don't understand this change; _sessionType defaults to Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by this.init(), which is also where the observer gets added in the first place.", "id": 5813892}, {"count": 2, "creator": "misak.bugzilla@gmail.com", "is_private": false, "time": "2011-10-31T20:02:57Z", "tags": [], "bug_id": 698276, "text": "Created attachment 570810\npatch v2", "author": "misak.bugzilla@gmail.com", "creation_time": "2011-10-31T20:02:57Z", "raw_text": "", "attachment_id": 570810, "id": 5816046}, {"count": 3, "bug_id": 698276, "is_private": false, "creator": "misak.bugzilla@gmail.com", "text": "(In reply to neil@parkwaycc.co.uk from comment #1)\n> Comment on attachment 570551 [diff] [details] [review]\n> patch\n> \n> I don't understand this change; _sessionType defaults to\n> Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> this.init(), which is also where the observer gets added in the first place.\n\nIt adds and removes observer if _sessionType changed from default NO_SESSION ?", "tags": [], "time": "2011-10-31T20:06:41Z", "creation_time": "2011-10-31T20:06:41Z", "author": "misak.bugzilla@gmail.com", "raw_text": "(In reply to neil@parkwaycc.co.uk from comment #1)\n> Comment on attachment 570551 [diff] [details] [review]\n> patch\n> \n> I don't understand this change; _sessionType defaults to\n> Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> this.init(), which is also where the observer gets added in the first place.\n\nIt adds and removes observer if _sessionType changed from default NO_SESSION ?", "attachment_id": null, "id": 5816060}, {"raw_text": "(In reply to Misak Khachatryan from comment #3)\n> (In reply to comment #1)\n> > I don't understand this change; _sessionType defaults to\n> > Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> > this.init(), which is also where the observer gets added in the first place.\n> \n> It adds and removes observer if _sessionType changed from default NO_SESSION ?\n\nBut it does it before anyone changes _sessionType...", "attachment_id": null, "id": 5816508, "is_private": false, "creator": "neil@httl.net", "text": "(In reply to Misak Khachatryan from comment #3)\n> (In reply to comment #1)\n> > I don't understand this change; _sessionType defaults to\n> > Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> > this.init(), which is also where the observer gets added in the first place.\n> \n> It adds and removes observer if _sessionType changed from default NO_SESSION ?\n\nBut it does it before anyone changes _sessionType...", "tags": [], "time": "2011-10-31T22:23:07Z", "creation_time": "2011-10-31T22:23:07Z", "author": "neil@httl.net", "count": 4, "bug_id": 698276}, {"is_private": false, "creator": "misak.bugzilla@gmail.com", "count": 5, "creation_time": "2011-11-01T06:12:08Z", "author": "misak.bugzilla@gmail.com", "text": "That(In reply to neil@parkwaycc.co.uk from comment #4)\n> (In reply to Misak Khachatryan from comment #3)\n> > (In reply to comment #1)\n> > > I don't understand this change; _sessionType defaults to\n> > > Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> > > this.init(), which is also where the observer gets added in the first place.\n> > \n> > It adds and removes observer if _sessionType changed from default NO_SESSION ?\n> \n> But it does it before anyone changes _sessionType...\n\nThat's because I placed it wrong :D . It belongs to  \"quit-application\" case.", "time": "2011-11-01T06:12:08Z", "tags": [], "bug_id": 698276, "attachment_id": null, "raw_text": "That(In reply to neil@parkwaycc.co.uk from comment #4)\n> (In reply to Misak Khachatryan from comment #3)\n> > (In reply to comment #1)\n> > > I don't understand this change; _sessionType defaults to\n> > > Components.interfaces.nsISessionStartup.NO_SESSION and is only changed by\n> > > this.init(), which is also where the observer gets added in the first place.\n> > \n> > It adds and removes observer if _sessionType changed from default NO_SESSION ?\n> \n> But it does it before anyone changes _sessionType...\n\nThat's because I placed it wrong :D . It belongs to  \"quit-application\" case.", "id": 5817278}, {"text": "Created attachment 571014\npatch v3", "tags": [], "time": "2011-11-01T15:33:23Z", "bug_id": 698276, "creation_time": "2011-11-01T15:33:23Z", "author": "misak.bugzilla@gmail.com", "count": 6, "is_private": false, "creator": "misak.bugzilla@gmail.com", "id": 5817998, "raw_text": "", "attachment_id": 571014}, {"tags": [], "time": "2011-11-01T17:39:53Z", "text": "This still doesn't look right. I'd better ask in bug 686065.", "author": "neil@httl.net", "creation_time": "2011-11-01T17:39:53Z", "creator": "neil@httl.net", "is_private": false, "id": 5818352, "raw_text": "This still doesn't look right. I'd better ask in bug 686065.", "attachment_id": null, "bug_id": 698276, "count": 7}, {"attachment_id": 571014, "raw_text": "OK, so zpao thinks his patch might be wrong. Let's see what he comes up with.", "id": 5873924, "is_private": false, "creator": "neil@httl.net", "count": 8, "creation_time": "2011-11-26T23:09:16Z", "author": "neil@httl.net", "text": "Comment on attachment 571014\npatch v3\n\nOK, so zpao thinks his patch might be wrong. Let's see what he comes up with.", "time": "2011-11-26T23:09:16Z", "tags": [], "bug_id": 698276}]}}, "comments": {}}