{"bugs": {"624104": {"comments": [{"creation_time": "2011-01-08T06:51:33Z", "attachment_id": null, "bug_id": 624104, "tags": [], "creator": "ehsan.akhgari@gmail.com", "author": "ehsan.akhgari@gmail.com", "count": 0, "is_private": false, "raw_text": "STR:\n\n1. Make sure that Gmail is set up as your mailto handler, then open the test case in the URL field.\n2. Click \"page\".\n3. Go back.\n4. Click \"email\".\n\nThe current history entry is replaced, and mozilla.com will remain in the forward list.  There is no way to get back to the test page.  Instead, the forward item should be replaced by the gmail page.\n\nThis is really annoying; it happened to me when I mistakenly clicked a mailto link on a bug page.", "text": "STR:\n\n1. Make sure that Gmail is set up as your mailto handler, then open the test case in the URL field.\n2. Click \"page\".\n3. Go back.\n4. Click \"email\".\n\nThe current history entry is replaced, and mozilla.com will remain in the forward list.  There is no way to get back to the test page.  Instead, the forward item should be replaced by the gmail page.\n\nThis is really annoying; it happened to me when I mistakenly clicked a mailto link on a bug page.", "id": 5184605, "time": "2011-01-08T06:51:33Z"}, {"raw_text": "BTW, 3.6 shows the same behavior.", "count": 1, "tags": [], "author": "ehsan.akhgari@gmail.com", "attachment_id": null, "bug_id": 624104, "id": 5184606, "text": "BTW, 3.6 shows the same behavior.", "time": "2011-01-08T06:51:47Z", "is_private": false, "creator": "ehsan.akhgari@gmail.com", "creation_time": "2011-01-08T06:51:47Z"}, {"bug_id": 624104, "attachment_id": null, "author": "bzbarsky@mit.edu", "tags": [], "count": 2, "raw_text": "> 1. Make sure that Gmail is set up as your mailto handler\n\nSet up where?  This part likely matters... With Thunderbird as my mailto handler set in OS prefs, I don't see the problem described here.", "creation_time": "2011-01-08T07:14:55Z", "creator": "bzbarsky@mit.edu", "time": "2011-01-08T07:14:55Z", "id": 5184622, "text": "> 1. Make sure that Gmail is set up as your mailto handler\n\nSet up where?  This part likely matters... With Thunderbird as my mailto handler set in OS prefs, I don't see the problem described here.", "is_private": false}, {"count": 3, "raw_text": "(In reply to comment #2)\n> > 1. Make sure that Gmail is set up as your mailto handler\n> \n> Set up where?\n\nPreferences->Applications->\"mailto\" in filter box->\"Use gmail\"", "attachment_id": null, "bug_id": 624104, "tags": [], "author": "gavin.sharp@gmail.com", "text": "(In reply to comment #2)\n> > 1. Make sure that Gmail is set up as your mailto handler\n> \n> Set up where?\n\nPreferences->Applications->\"mailto\" in filter box->\"Use gmail\"", "id": 5185203, "time": "2011-01-08T21:13:28Z", "is_private": false, "creation_time": "2011-01-08T21:13:28Z", "creator": "gavin.sharp@gmail.com"}, {"count": 4, "raw_text": "OK.  Any idea what code that ends up triggering?  I assume it's Firefox code, not core code...", "attachment_id": null, "bug_id": 624104, "tags": [], "author": "bzbarsky@mit.edu", "is_private": false, "id": 5185307, "text": "OK.  Any idea what code that ends up triggering?  I assume it's Firefox code, not core code...", "time": "2011-01-08T23:35:49Z", "creation_time": "2011-01-08T23:35:49Z", "creator": "bzbarsky@mit.edu"}, {"count": 5, "raw_text": "That UI configures the mimeTypes.rdf entries used by uriloader/exthandler/nsHandlerService.js. Gmail is a nsIWebHandlerApp.", "bug_id": 624104, "attachment_id": null, "author": "gavin.sharp@gmail.com", "tags": [], "is_private": false, "time": "2011-01-08T23:39:12Z", "id": 5185310, "text": "That UI configures the mimeTypes.rdf entries used by uriloader/exthandler/nsHandlerService.js. Gmail is a nsIWebHandlerApp.", "creation_time": "2011-01-08T23:39:12Z", "creator": "gavin.sharp@gmail.com"}, {"is_private": false, "raw_text": "Specifically, I believe the load in 4) is triggered by:\nhttp://mxr.mozilla.org/mozilla-central/source/uriloader/exthandler/nsWebHandlerApp.js#98", "id": 5185319, "text": "Specifically, I believe the load in 4) is triggered by:\nhttp://mxr.mozilla.org/mozilla-central/source/uriloader/exthandler/nsWebHandlerApp.js#98", "time": "2011-01-08T23:56:34Z", "count": 6, "tags": [], "creator": "gavin.sharp@gmail.com", "author": "gavin.sharp@gmail.com", "creation_time": "2011-01-08T23:56:34Z", "attachment_id": null, "bug_id": 624104}, {"tags": [], "author": "bzbarsky@mit.edu", "attachment_id": null, "bug_id": 624104, "raw_text": "Uh... yes.  That does a load via the uriloader directly, without actually letting the docshell know anything about the load until it starts getting data.  So docshell doesn't get a chance to do the normal session history management it would do; as far as it can tell from the calls it gets the situation is no different from the load of the testcase page being a multipart/x-mixed-replace load (the first part is the actual testcase; the second part is gmail).\n\nccing the author of that code and the reviewers; why was this done as it was?", "count": 7, "creator": "bzbarsky@mit.edu", "creation_time": "2011-01-09T01:44:52Z", "text": "Uh... yes.  That does a load via the uriloader directly, without actually letting the docshell know anything about the load until it starts getting data.  So docshell doesn't get a chance to do the normal session history management it would do; as far as it can tell from the calls it gets the situation is no different from the load of the testcase page being a multipart/x-mixed-replace load (the first part is the actual testcase; the second part is gmail).\n\nccing the author of that code and the reviewers; why was this done as it was?", "id": 5185358, "time": "2011-01-09T01:44:52Z", "is_private": false}, {"attachment_id": null, "bug_id": 624104, "creation_time": "2017-10-27T18:25:34Z", "creator": "ph@patrickhubenthal.com", "tags": [], "author": "ph@patrickhubenthal.com", "count": 8, "id": 12796626, "raw_text": "I can reproduce this in FF 56, and I suspect it's the same bug as these:\n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=499527\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1223279\n\nAll three bug reports indicate that after clicking on the mailto link, the page that should be first in the back history list - i.e. the page with the mailto link on it \u2013\u00a0is no longer what you get when you click on the back button. The reporter of 499527 says explicitly that clicking the back button took him back to the page before the mailto link, and the reporter of 1223279 says that his back arrow was deactivated if he clicked a mailto link in a new tab (i.e. a tab with no back history) but not if he clicked a mailto link in an existing tab. Presumably he didn't try clicking the back arrow in the existing tab, or didn't notice that it took him back two pages instead of one.\n\nI'm noting all this here because this reporter's description most accurately matches my experience: This bug only shows up for me if I have an entry in the forward history list for the tab in question.\n\nOne other detail: The page with the mailto link only disappears from the tab's back history; it's still available in the History dropdown list from the application menu.", "text": "I can reproduce this in FF 56, and I suspect it's the same bug as these:\n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=499527\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1223279\n\nAll three bug reports indicate that after clicking on the mailto link, the page that should be first in the back history list - i.e. the page with the mailto link on it \u2013\u00a0is no longer what you get when you click on the back button. The reporter of 499527 says explicitly that clicking the back button took him back to the page before the mailto link, and the reporter of 1223279 says that his back arrow was deactivated if he clicked a mailto link in a new tab (i.e. a tab with no back history) but not if he clicked a mailto link in an existing tab. Presumably he didn't try clicking the back arrow in the existing tab, or didn't notice that it took him back two pages instead of one.\n\nI'm noting all this here because this reporter's description most accurately matches my experience: This bug only shows up for me if I have an entry in the forward history list for the tab in question.\n\nOne other detail: The page with the mailto link only disappears from the tab's back history; it's still available in the History dropdown list from the application menu.", "time": "2017-10-27T18:25:34Z", "is_private": false}]}}, "comments": {}}