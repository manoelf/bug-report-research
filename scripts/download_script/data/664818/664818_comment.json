{"bugs": {"664818": {"comments": [{"bug_id": 664818, "is_private": false, "count": 0, "tags": [], "id": 5537596, "text": "See attached testcase, one which we're somewhat slower than some of our competitors (though not than the ones that handle CSS selectors correctly).\n\nThis is basically reduced from http://jsperf.com/style-batching\n\nProfile with the patches for bug 657724 shows:\n\n  7% in the .style get (slow stub call under JM)\n  5% double-to-string conversion and string concat in JS\n  2% array_pop\n  2% SetName stubcall\n  2% inline style quickstub time.\n\nThen there's 77% under nsDOMCSSDeclaration::ParsePropertyValue, breaking down like so:\n\n  6% AttributeWillChange\n  5% GetCSSParsingEnvironment (a lot of this is GetBaseURI)\n  2% RemoveScriptBlocker\n 12% ParseProperty (ParseNumber, tokenization, etc).\n  5% nsCSSExpandedDataBlock::Compress\n  3% nsCSSExpandedDataBlock::Expand\n  3% nsCSSScanner::Init\n  2% nsCSSScanner::Close\n  2% nsCSSExpandedDataBlock::TransferFromBlock\n  4% StyleRule::DeclarationChanged (mostly malloc here)\n 11% AttributeChanged\n  7% Setting attrs (mostly refcounting style rules, calling free(), etc).\n  4% Attr-setting DOM code of various sorts", "time": "2011-06-16T20:27:42Z", "attachment_id": null, "creation_time": "2011-06-16T20:27:42Z", "raw_text": "See attached testcase, one which we're somewhat slower than some of our competitors (though not than the ones that handle CSS selectors correctly).\n\nThis is basically reduced from http://jsperf.com/style-batching\n\nProfile with the patches for bug 657724 shows:\n\n  7% in the .style get (slow stub call under JM)\n  5% double-to-string conversion and string concat in JS\n  2% array_pop\n  2% SetName stubcall\n  2% inline style quickstub time.\n\nThen there's 77% under nsDOMCSSDeclaration::ParsePropertyValue, breaking down like so:\n\n  6% AttributeWillChange\n  5% GetCSSParsingEnvironment (a lot of this is GetBaseURI)\n  2% RemoveScriptBlocker\n 12% ParseProperty (ParseNumber, tokenization, etc).\n  5% nsCSSExpandedDataBlock::Compress\n  3% nsCSSExpandedDataBlock::Expand\n  3% nsCSSScanner::Init\n  2% nsCSSScanner::Close\n  2% nsCSSExpandedDataBlock::TransferFromBlock\n  4% StyleRule::DeclarationChanged (mostly malloc here)\n 11% AttributeChanged\n  7% Setting attrs (mostly refcounting style rules, calling free(), etc).\n  4% Attr-setting DOM code of various sorts", "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu"}, {"author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu", "bug_id": 664818, "id": 5537613, "tags": [], "is_private": false, "count": 1, "time": "2011-06-16T20:33:34Z", "attachment_id": null, "text": "At least part of the problem is that padding-left is a shorthand; hence all the expand/compress stuff....  But even if I stick to .height a lot of the rest of that stuff is left.", "creation_time": "2011-06-16T20:33:34Z", "raw_text": "At least part of the problem is that padding-left is a shorthand; hence all the expand/compress stuff....  But even if I stick to .height a lot of the rest of that stuff is left."}, {"id": 5537622, "is_private": false, "count": 2, "tags": [], "bug_id": 664818, "raw_text": "", "creation_time": "2011-06-16T20:36:12Z", "time": "2011-06-16T20:36:12Z", "attachment_id": 539882, "text": "Created attachment 539882\nTestcase", "author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu"}]}}, "comments": {}}