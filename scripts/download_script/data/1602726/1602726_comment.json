{"bugs": {"1602726": {"comments": [{"creation_time": "2019-12-10T10:24:45Z", "author": "Peter.Geier@sskm.de", "time": "2019-12-10T10:24:45Z", "text": "User Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\n\nSteps to reproduce:\n\nAfter Update Firefox ESR 68.2.0 to 68.3.0 running on Windows Server 2012R2/Citrix Envorinment as a normal User we can\u00b4t open HTML File-Links.\n\n\n\n\nActual results:\n\nA Click to MS Word 2016 HTML-Link open a Dialog Window to start with Standard Program but Winword ist not starting.\nSame for Excel, Powerpoint, Adobe Reader and so on. \n\n\nExpected results:\n\nStart the correct Program via MimeType.\n\nAs an Admin via RDP-Session there is no Problem. It Works fine.", "tags": [], "attachment_id": null, "id": 14538015, "is_private": false, "count": 0, "bug_id": 1602726, "raw_text": "User Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\n\nSteps to reproduce:\n\nAfter Update Firefox ESR 68.2.0 to 68.3.0 running on Windows Server 2012R2/Citrix Envorinment as a normal User we can\u00b4t open HTML File-Links.\n\n\n\n\nActual results:\n\nA Click to MS Word 2016 HTML-Link open a Dialog Window to start with Standard Program but Winword ist not starting.\nSame for Excel, Powerpoint, Adobe Reader and so on. \n\n\nExpected results:\n\nStart the correct Program via MimeType.\n\nAs an Admin via RDP-Session there is no Problem. It Works fine.", "creator": "Peter.Geier@sskm.de"}, {"attachment_id": null, "id": 14540452, "tags": [], "creation_time": "2019-12-11T09:45:33Z", "text": "Same Problem with Windows Server 2008 R2 and Published Citrix Apps", "raw_text": "Same Problem with Windows Server 2008 R2 and Published Citrix Apps", "creator": "roger.thomas@sv-bw.de", "is_private": false, "bug_id": 1602726, "count": 1, "time": "2019-12-11T09:45:33Z", "author": "roger.thomas@sv-bw.de"}, {"is_private": false, "count": 2, "bug_id": 1602726, "raw_text": "Toshi, is it likely this is the same issue as bug 1601905? It looks similar and I can't think of any other changes we landed on ESR to do with file opening...", "creator": "gijskruitbosch+bugs@gmail.com", "tags": [], "attachment_id": null, "id": 14543090, "time": "2019-12-12T13:51:55Z", "author": "gijskruitbosch+bugs@gmail.com", "text": "Toshi, is it likely this is the same issue as bug 1601905? It looks similar and I can't think of any other changes we landed on ESR to do with file opening...", "creation_time": "2019-12-12T13:51:55Z"}, {"text": "[Tracking Requested - why for this release]:\nRegression in 68, we may need a point release for this. Toshi is diagnosing.", "time": "2019-12-12T22:23:46Z", "author": "jmathies@mozilla.com", "creation_time": "2019-12-12T22:23:46Z", "creator": "jmathies@mozilla.com", "raw_text": "[Tracking Requested - why for this release]:\nRegression in 68, we may need a point release for this. Toshi is diagnosing.", "bug_id": 1602726, "count": 3, "is_private": false, "id": 14544306, "attachment_id": null, "tags": []}, {"creator": "lizhenry@gmail.com", "raw_text": "Possible regressor: bug 1588975", "text": "Possible regressor: bug 1588975", "bug_id": 1602726, "count": 4, "author": "lizhenry@gmail.com", "time": "2019-12-12T22:37:02Z", "is_private": false, "id": 14544341, "attachment_id": null, "creation_time": "2019-12-12T22:37:02Z", "tags": []}, {"text": "Would this also affect users on 71 release?", "time": "2019-12-12T22:38:21Z", "author": "lizhenry@gmail.com", "creation_time": "2019-12-12T22:38:21Z", "raw_text": "Would this also affect users on 71 release?", "creator": "lizhenry@gmail.com", "is_private": false, "count": 5, "bug_id": 1602726, "attachment_id": null, "id": 14544347, "tags": []}, {"author": "tkikuchi@mozilla.com", "time": "2019-12-12T22:54:52Z", "text": "(In reply to :Gijs (he/him) from comment #2)\n> Toshi, is it likely this is the same issue as bug 1601905? It looks similar and I can't think of any other changes we landed on ESR to do with file opening...\n\nI agree this is a regression from Bug 1588975.  If so, yes, this affects 71 release.  I'm not sure this is the same as Bug 1601905.  Probably a different issue.\n\nSince we don't have Citrix Environment, I'm now preparing ESR68 build without my patch.  Peter and Roger, once it's ready, is it possible to install it and see the issue is solved or not?", "creation_time": "2019-12-12T22:54:52Z", "is_private": false, "count": 6, "bug_id": 1602726, "raw_text": "(In reply to :Gijs (he/him) from comment #2)\n> Toshi, is it likely this is the same issue as bug 1601905? It looks similar and I can't think of any other changes we landed on ESR to do with file opening...\n\nI agree this is a regression from Bug 1588975.  If so, yes, this affects 71 release.  I'm not sure this is the same as Bug 1601905.  Probably a different issue.\n\nSince we don't have Citrix Environment, I'm now preparing ESR68 build without my patch.  Peter and Roger, once it's ready, is it possible to install it and see the issue is solved or not?", "creator": "tkikuchi@mozilla.com", "tags": [], "attachment_id": null, "id": 14544386}, {"creation_time": "2019-12-13T01:04:25Z", "tags": [], "id": 14544544, "attachment_id": null, "time": "2019-12-13T01:04:25Z", "count": 7, "author": "tkikuchi@mozilla.com", "bug_id": 1602726, "is_private": false, "creator": "tkikuchi@mozilla.com", "raw_text": "Here's the latest mozilla-esr68 without Bug 1588975.  Could you try this and see the issue still happens or not?\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=ece685b93dee95e7d8a5f785df950c2b9de5fb04&selectedJob=280956418\n\nFull x64 binaries:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/bvey-1BBSTKpsKYe7GWCwA/runs/0/artifacts/public/build/target.zip\n\nInstaller of x64:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/bvey-1BBSTKpsKYe7GWCwA/runs/0/artifacts/public/build/install/sea/target.installer.exe\n\nMy hypothesis right now is firefox.exe virtualized by Citrix fails to communicate with explorer.exe.  A fix would be to fall back to the original `ShellExecute` if that communication fails.", "text": "Here's the latest mozilla-esr68 without Bug 1588975.  Could you try this and see the issue still happens or not?\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=ece685b93dee95e7d8a5f785df950c2b9de5fb04&selectedJob=280956418\n\nFull x64 binaries:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/bvey-1BBSTKpsKYe7GWCwA/runs/0/artifacts/public/build/target.zip\n\nInstaller of x64:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/bvey-1BBSTKpsKYe7GWCwA/runs/0/artifacts/public/build/install/sea/target.installer.exe\n\nMy hypothesis right now is firefox.exe virtualized by Citrix fails to communicate with explorer.exe.  A fix would be to fall back to the original `ShellExecute` if that communication fails."}, {"bug_id": 1602726, "count": 8, "is_private": false, "creator": "Peter.Geier@sskm.de", "raw_text": "I have used your installer x64 Version.\nProblem is now fixed :-))\nWorks fine.\nThank you for yor fast response.\nToday is my last day in office in 2019.\nI will be back on third January.\nIf you have further questions, please ask to Thomas Roger.\n\nPeter Geier / Munich", "tags": [], "id": 14544784, "attachment_id": null, "author": "Peter.Geier@sskm.de", "time": "2019-12-13T07:08:51Z", "text": "I have used your installer x64 Version.\nProblem is now fixed :-))\nWorks fine.\nThank you for yor fast response.\nToday is my last day in office in 2019.\nI will be back on third January.\nIf you have further questions, please ask to Thomas Roger.\n\nPeter Geier / Munich", "creation_time": "2019-12-13T07:08:51Z"}, {"creation_time": "2019-12-13T07:40:17Z", "tags": [], "id": 14544821, "attachment_id": null, "count": 9, "author": "roger.thomas@sv-bw.de", "time": "2019-12-13T07:40:17Z", "bug_id": 1602726, "is_private": false, "creator": "roger.thomas@sv-bw.de", "text": "My tests with the x64 installer were also successful.", "raw_text": "My tests with the x64 installer were also successful."}, {"tags": [], "creation_time": "2019-12-13T08:17:36Z", "attachment_id": null, "id": 14544875, "is_private": false, "count": 10, "author": "RiemerMalte@citeq.de", "time": "2019-12-13T08:17:36Z", "bug_id": 1602726, "text": "Just to inform you:\n\nMaybe my problem is also related to this bug?\n\nWe use these preferences to start Word-templates from Firefox-Browser.\n \ncapability.policy.policynames = LocalFileLinks\ncapability.policy.LocalFileLinks.sites = [several internal websites]\ncapability.policy.LocalFileLinks.checkloaduri.enabled = allAccess\n \nWe use a workaround with pointing first on a LNK-file, which itself pointing on the actual Word-template.\nExample:\nWord-template is here:\n-> Z:\\public\\msoffice\\letter_template.dotm\nLNK-file we link to from our internal websites:\n-> Z:\\public\\msoffice\\weblinks\\letter_template.lnk\n \nThe lnk-file just link directly to the .dotm-file.\n \nSome of these Word-templates have startup macros (e.g. an user form for getting input from the user). This worked for years. Since the last FF-update to 68.3.0esr these startup-macros does not work anymore. The template opens and you can start the macros manually, but not automatically - which is very important for the user.", "raw_text": "Just to inform you:\n\nMaybe my problem is also related to this bug?\n\nWe use these preferences to start Word-templates from Firefox-Browser.\n \ncapability.policy.policynames = LocalFileLinks\ncapability.policy.LocalFileLinks.sites = [several internal websites]\ncapability.policy.LocalFileLinks.checkloaduri.enabled = allAccess\n \nWe use a workaround with pointing first on a LNK-file, which itself pointing on the actual Word-template.\nExample:\nWord-template is here:\n-> Z:\\public\\msoffice\\letter_template.dotm\nLNK-file we link to from our internal websites:\n-> Z:\\public\\msoffice\\weblinks\\letter_template.lnk\n \nThe lnk-file just link directly to the .dotm-file.\n \nSome of these Word-templates have startup macros (e.g. an user form for getting input from the user). This worked for years. Since the last FF-update to 68.3.0esr these startup-macros does not work anymore. The template opens and you can start the macros manually, but not automatically - which is very important for the user.", "creator": "RiemerMalte@citeq.de"}, {"tags": [], "creation_time": "2019-12-13T10:43:23Z", "attachment_id": null, "id": 14545079, "is_private": false, "count": 11, "author": "VYV03354@nifty.ne.jp", "time": "2019-12-13T10:43:23Z", "bug_id": 1602726, "text": "1. When you right click the .dotm-file and select `New` from the context menu, does the startup macro run?\n2. When you right click the .dotm-file and select `Open` from the context menu, does the startup macro run?", "raw_text": "1. When you right click the .dotm-file and select `New` from the context menu, does the startup macro run?\n2. When you right click the .dotm-file and select `Open` from the context menu, does the startup macro run?", "creator": "VYV03354@nifty.ne.jp"}, {"creator": "RiemerMalte@citeq.de", "raw_text": "\n(In reply to Masatoshi Kimura [:emk] from comment #11)\n> 1. When you right click the .dotm-file and select `New` from the context menu, does the startup macro run?\nYes, we create such templates that macros run via event \"Document_new\"\n\n> 2. When you right click the .dotm-file and select `Open` from the context menu, does the startup macro run?\nNo, we can not use \"Document_open\" for our templates. But it seems to be that with this event there is no problem.\n\nMalte", "bug_id": 1602726, "count": 12, "is_private": false, "id": 14545358, "attachment_id": null, "tags": [], "text": "\n(In reply to Masatoshi Kimura [:emk] from comment #11)\n> 1. When you right click the .dotm-file and select `New` from the context menu, does the startup macro run?\nYes, we create such templates that macros run via event \"Document_new\"\n\n> 2. When you right click the .dotm-file and select `Open` from the context menu, does the startup macro run?\nNo, we can not use \"Document_open\" for our templates. But it seems to be that with this event there is no problem.\n\nMalte", "time": "2019-12-13T14:40:59Z", "author": "RiemerMalte@citeq.de", "creation_time": "2019-12-13T14:40:59Z"}, {"creation_time": "2019-12-13T17:10:31Z", "text": "Hi Malte, Thank you reporting an issue.  Your issue sounds like Bug 1597963.\n\nESR68.3.0esr has another regression that a downloaded file is opened with \"open\" verb instead of the default verb.  This means Firefox *opens* a .dotm file instead of creating a new document based on the .dotm.  When this happens, you will see the title bar says \"letter_template.dotm - Word\" instead of \"Document1 - Word\".  That's why macros are not executed.\n\nBug 1597963 has been fixed in Nightly and uplifted to ESR.  If you can verify the fix on Nightly, that would be great.  Sorry for inconvenience.  If you issue is not fixed in the latest Nightly, could you please file a new bug?", "author": "tkikuchi@mozilla.com", "time": "2019-12-13T17:10:31Z", "id": 14545740, "attachment_id": null, "tags": [], "creator": "tkikuchi@mozilla.com", "raw_text": "Hi Malte, Thank you reporting an issue.  Your issue sounds like Bug 1597963.\n\nESR68.3.0esr has another regression that a downloaded file is opened with \"open\" verb instead of the default verb.  This means Firefox *opens* a .dotm file instead of creating a new document based on the .dotm.  When this happens, you will see the title bar says \"letter_template.dotm - Word\" instead of \"Document1 - Word\".  That's why macros are not executed.\n\nBug 1597963 has been fixed in Nightly and uplifted to ESR.  If you can verify the fix on Nightly, that would be great.  Sorry for inconvenience.  If you issue is not fixed in the latest Nightly, could you please file a new bug?", "bug_id": 1602726, "count": 13, "is_private": false}, {"count": 14, "bug_id": 1602726, "is_private": false, "creator": "tkikuchi@mozilla.com", "raw_text": "(In reply to roger.thomas from comment #9)\n> My tests with the x64 installer were also successful.\n\nThanks for verifying the bits quickly, Peter and Roger!  At least we're 100% sure what is a regressing fix.\n\nRoger, I want to ask you to do one more test on the original ESR.  As :Gijs mentioned earlier, there is another regression, Bug 1601905.  I want to make sure this issue is not a dup of Bug 1601905.\n\nTo verify that, can you save a file first, and then open it from Firefox's download library?  If the issue still happens, this is not Bug 1601905.  Then I'll start prototyping a fix and probably ask you to verify it.", "tags": [], "id": 14546177, "attachment_id": null, "time": "2019-12-13T21:19:21Z", "author": "tkikuchi@mozilla.com", "text": "(In reply to roger.thomas from comment #9)\n> My tests with the x64 installer were also successful.\n\nThanks for verifying the bits quickly, Peter and Roger!  At least we're 100% sure what is a regressing fix.\n\nRoger, I want to ask you to do one more test on the original ESR.  As :Gijs mentioned earlier, there is another regression, Bug 1601905.  I want to make sure this issue is not a dup of Bug 1601905.\n\nTo verify that, can you save a file first, and then open it from Firefox's download library?  If the issue still happens, this is not Bug 1601905.  Then I'll start prototyping a fix and probably ask you to verify it.", "creation_time": "2019-12-13T21:19:21Z"}, {"raw_text": "(In reply to Toshihito Kikuchi [:toshi] from comment #13)\n> Hi Malte, Thank you reporting an issue.  Your issue sounds like Bug 1597963.\n> \n> ESR68.3.0esr has another regression that a downloaded file is opened with \"open\" verb instead of the default verb.  This means Firefox *opens* a .dotm file instead of creating a new document based on the .dotm.  When this happens, you will see the title bar says \"letter_template.dotm - Word\" instead of \"Document1 - Word\".  That's why macros are not executed.\n> \n> Bug 1597963 has been fixed in Nightly and uplifted to ESR.  If you can verify the fix on Nightly, that would be great.  Sorry for inconvenience.  If you issue is not fixed in the latest Nightly, could you please file a new bug?\n\n\nHi Toshihito,\nthat's it! Thanks for your tip. I installed the nightly version 73.0a1 and everything works! So Bug-1597963 could have been the reason.\nThanks to the community - now I can sleep well again ;-)\nMalte", "creator": "RiemerMalte@citeq.de", "is_private": false, "count": 15, "bug_id": 1602726, "attachment_id": null, "id": 14549059, "tags": [], "text": "(In reply to Toshihito Kikuchi [:toshi] from comment #13)\n> Hi Malte, Thank you reporting an issue.  Your issue sounds like Bug 1597963.\n> \n> ESR68.3.0esr has another regression that a downloaded file is opened with \"open\" verb instead of the default verb.  This means Firefox *opens* a .dotm file instead of creating a new document based on the .dotm.  When this happens, you will see the title bar says \"letter_template.dotm - Word\" instead of \"Document1 - Word\".  That's why macros are not executed.\n> \n> Bug 1597963 has been fixed in Nightly and uplifted to ESR.  If you can verify the fix on Nightly, that would be great.  Sorry for inconvenience.  If you issue is not fixed in the latest Nightly, could you please file a new bug?\n\n\nHi Toshihito,\nthat's it! Thanks for your tip. I installed the nightly version 73.0a1 and everything works! So Bug-1597963 could have been the reason.\nThanks to the community - now I can sleep well again ;-)\nMalte", "author": "RiemerMalte@citeq.de", "time": "2019-12-16T08:37:28Z", "creation_time": "2019-12-16T08:37:28Z"}, {"tags": [], "creation_time": "2019-12-16T08:58:37Z", "attachment_id": null, "id": 14549082, "is_private": false, "bug_id": 1602726, "count": 16, "author": "roger.thomas@sv-bw.de", "time": "2019-12-16T08:58:37Z", "text": "(In reply to Toshihito Kikuchi [:toshi] from comment #14)\n> (In reply to roger.thomas from comment #9)\n> > My tests with the x64 installer were also successful.\n> \n> Thanks for verifying the bits quickly, Peter and Roger!  At least we're 100% sure what is a regressing fix.\n> \n> Roger, I want to ask you to do one more test on the original ESR.  As :Gijs mentioned earlier, there is another regression, Bug 1601905.  I want to make sure this issue is not a dup of Bug 1601905.\n> \n> To verify that, can you save a file first, and then open it from Firefox's download library?  If the issue still happens, this is not Bug 1601905.  Then I'll start prototyping a fix and probably ask you to verify it.\n\nWith Firefox 68.2 ESR, pdf files with and without spaces can be opened with the default pdf viewer. With Version 68.3 no Files opened, they only saved to %username%\\appdata\\local\\temp\\", "raw_text": "(In reply to Toshihito Kikuchi [:toshi] from comment #14)\n> (In reply to roger.thomas from comment #9)\n> > My tests with the x64 installer were also successful.\n> \n> Thanks for verifying the bits quickly, Peter and Roger!  At least we're 100% sure what is a regressing fix.\n> \n> Roger, I want to ask you to do one more test on the original ESR.  As :Gijs mentioned earlier, there is another regression, Bug 1601905.  I want to make sure this issue is not a dup of Bug 1601905.\n> \n> To verify that, can you save a file first, and then open it from Firefox's download library?  If the issue still happens, this is not Bug 1601905.  Then I'll start prototyping a fix and probably ask you to verify it.\n\nWith Firefox 68.2 ESR, pdf files with and without spaces can be opened with the default pdf viewer. With Version 68.3 no Files opened, they only saved to %username%\\appdata\\local\\temp\\", "creator": "roger.thomas@sv-bw.de"}, {"id": 14550915, "attachment_id": null, "creation_time": "2019-12-16T23:28:54Z", "tags": [], "creator": "tkikuchi@mozilla.com", "raw_text": "(In reply to roger.thomas from comment #16)\n> With Firefox 68.2 ESR, pdf files with and without spaces can be opened with the default pdf viewer. With Version 68.3 no Files opened, they only saved to %username%\\appdata\\local\\temp\\\n\nThank you for checking that.  I'm assuming %username% on your end does not include any whitespaces.\n\nOnce a prototype for this issue is ready, I'll update this bug.", "text": "(In reply to roger.thomas from comment #16)\n> With Firefox 68.2 ESR, pdf files with and without spaces can be opened with the default pdf viewer. With Version 68.3 no Files opened, they only saved to %username%\\appdata\\local\\temp\\\n\nThank you for checking that.  I'm assuming %username% on your end does not include any whitespaces.\n\nOnce a prototype for this issue is ready, I'll update this bug.", "bug_id": 1602726, "author": "tkikuchi@mozilla.com", "count": 17, "time": "2019-12-16T23:28:54Z", "is_private": false}, {"text": "If we land a fix in the next week, there still may be time to uplift for 72 and 68.4esr.", "time": "2019-12-17T17:01:17Z", "author": "lizhenry@gmail.com", "creation_time": "2019-12-17T17:01:17Z", "raw_text": "If we land a fix in the next week, there still may be time to uplift for 72 and 68.4esr.", "creator": "lizhenry@gmail.com", "is_private": false, "count": 18, "bug_id": 1602726, "attachment_id": null, "id": 14552302, "tags": []}, {"creator": "madperson@gmx.at", "raw_text": "", "count": 19, "bug_id": 1602726, "is_private": false, "id": 14553150, "attachment_id": null, "tags": [], "text": "*** Bug 1604626 has been marked as a duplicate of this bug. ***", "time": "2019-12-17T21:37:18Z", "author": "madperson@gmx.at", "creation_time": "2019-12-17T21:37:18Z"}, {"is_private": false, "bug_id": 1602726, "count": 20, "raw_text": "A prototype is ready to test.  I added a simple fallbak logic and logging code to Browser Console.\n\nInstaller of x64 ([Submitted job](https://treeherder.mozilla.org/#/jobs?repo=try&revision=dcc92b04d7a037f89bab35cc91bccad15a96d141)):\n\n[https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/MywFRdAuTwCviJCsUmZAZA/runs/0/artifacts/public/build/install/sea/target.installer.exe](https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/MywFRdAuTwCviJCsUmZAZA/runs/0/artifacts/public/build/install/sea/target.installer.exe)\n\nRoger, could you try the following steps with this prototype?\n\n1. Install a prototype and run it from client\n2. Press Ctrl+Shift+J to open [Browser Console](https://developer.mozilla.org/en-US/docs/Tools/Browser_Console)\n3. Reproduce the issue (I hope the fallback logic solves the issue this time...)\n5. Regardless of the result, copy output on Browser Console\n\nIf the logging code works correctly, you'll see messages on Browser Console like below.  Please copy-and-paste it here so that we can see what happens with Citrix.\n\n```\nGetSystemMetrics(SM_REMOTESESSION) - 1\nWTSQuerySessionInformationA - 2\nCoCreateInstance(CLSID_ShellWindows) - 00000000\nIShellWindows::FindWindowSW - 00000000\nIDispatch::QueryInterface(IID_IServiceProvider) - 00000000\nIServiceProvider::QueryService(SID_STopLevelBrowser) - 00000000\nIShellBrowser::QueryActiveShellView(SID_STopLevelBrowser) - 00000000\nIShellView::GetItemObject() - 00000000\nIDispatch::QueryInterface(IID_IShellFolderViewDual) - 00000000\nIShellFolderViewDual::get_Application() - 00000000\nIDispatch::QueryInterface(IID_IShellDispatch2) - 00000000\nIShellDispatch2::ShellExecute() - 00000000\n```", "creator": "tkikuchi@mozilla.com", "tags": [], "attachment_id": null, "id": 14554743, "time": "2019-12-18T17:32:10Z", "author": "tkikuchi@mozilla.com", "text": "A prototype is ready to test.  I added a simple fallbak logic and logging code to Browser Console.\n\nInstaller of x64 ([Submitted job](https://treeherder.mozilla.org/#/jobs?repo=try&revision=dcc92b04d7a037f89bab35cc91bccad15a96d141)):\n\n[https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/MywFRdAuTwCviJCsUmZAZA/runs/0/artifacts/public/build/install/sea/target.installer.exe](https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/MywFRdAuTwCviJCsUmZAZA/runs/0/artifacts/public/build/install/sea/target.installer.exe)\n\nRoger, could you try the following steps with this prototype?\n\n1. Install a prototype and run it from client\n2. Press Ctrl+Shift+J to open [Browser Console](https://developer.mozilla.org/en-US/docs/Tools/Browser_Console)\n3. Reproduce the issue (I hope the fallback logic solves the issue this time...)\n5. Regardless of the result, copy output on Browser Console\n\nIf the logging code works correctly, you'll see messages on Browser Console like below.  Please copy-and-paste it here so that we can see what happens with Citrix.\n\n```\nGetSystemMetrics(SM_REMOTESESSION) - 1\nWTSQuerySessionInformationA - 2\nCoCreateInstance(CLSID_ShellWindows) - 00000000\nIShellWindows::FindWindowSW - 00000000\nIDispatch::QueryInterface(IID_IServiceProvider) - 00000000\nIServiceProvider::QueryService(SID_STopLevelBrowser) - 00000000\nIShellBrowser::QueryActiveShellView(SID_STopLevelBrowser) - 00000000\nIShellView::GetItemObject() - 00000000\nIDispatch::QueryInterface(IID_IShellFolderViewDual) - 00000000\nIShellFolderViewDual::get_Application() - 00000000\nIDispatch::QueryInterface(IID_IShellDispatch2) - 00000000\nIShellDispatch2::ShellExecute() - 00000000\n```", "creation_time": "2019-12-18T17:32:10Z"}, {"creation_time": "2019-12-19T14:17:22Z", "author": "roger.thomas@sv-bw.de", "time": "2019-12-19T14:17:22Z", "text": "Hi Toshi, the pdf File opened in PDF Viewer\n\n\nXHRGEThttps://blocklists.settings.services.mozilla.com/v1/blocklist/3/%7Bec8030f7-c20a-464f-9b0e-13a3a9e97384%7D/68.4.0/Firefox/20191217200913/WINNT_x86_64-msvc/en-US/default/Windows_NT%206.1/default/default/1/1/new/\n[HTTP/1.1 200 Connection established 1530ms]\n\nJsonSchemaValidator.jsm: Ignoring parameter \"https://www.s-ncc.de/kunden/fi/nccreg.nsf\" - origin was expected but received full URL. JsonSchemaValidator.jsm:236\nJsonSchemaValidator.jsm: Ignoring parameter \"https://www.s-ncc.de/leser/index.htm\" - origin was expected but received full URL. JsonSchemaValidator.jsm:236\nuncaught exception: 2147746065 SessionStore.jsm:1325:22\nUnknown category for SetEventRecordingEnabled: fxmonitor\nKey event not available on some keyboard layouts: key=\u201ci\u201d modifiers=\u201caccel,alt,shift\u201d id=\u201ckey_browserToolbox\u201d browser.xul\nuncaught exception: 2147746132 2\nGetSystemMetrics(SM_REMOTESESSION) - 1\nWTSQuerySessionInformationA - 1\nCoCreateInstance(CLSID_ShellWindows) - 80040154\n\nI tested it with this link: https://checkmk.com/download/Marco_Reale_Check_MK_Beginner_guide.pdf", "tags": [], "id": 14556511, "attachment_id": null, "count": 21, "bug_id": 1602726, "is_private": false, "creator": "roger.thomas@sv-bw.de", "raw_text": "Hi Toshi, the pdf File opened in PDF Viewer\n\n\nXHRGEThttps://blocklists.settings.services.mozilla.com/v1/blocklist/3/%7Bec8030f7-c20a-464f-9b0e-13a3a9e97384%7D/68.4.0/Firefox/20191217200913/WINNT_x86_64-msvc/en-US/default/Windows_NT%206.1/default/default/1/1/new/\n[HTTP/1.1 200 Connection established 1530ms]\n\nJsonSchemaValidator.jsm: Ignoring parameter \"https://www.s-ncc.de/kunden/fi/nccreg.nsf\" - origin was expected but received full URL. JsonSchemaValidator.jsm:236\nJsonSchemaValidator.jsm: Ignoring parameter \"https://www.s-ncc.de/leser/index.htm\" - origin was expected but received full URL. JsonSchemaValidator.jsm:236\nuncaught exception: 2147746065 SessionStore.jsm:1325:22\nUnknown category for SetEventRecordingEnabled: fxmonitor\nKey event not available on some keyboard layouts: key=\u201ci\u201d modifiers=\u201caccel,alt,shift\u201d id=\u201ckey_browserToolbox\u201d browser.xul\nuncaught exception: 2147746132 2\nGetSystemMetrics(SM_REMOTESESSION) - 1\nWTSQuerySessionInformationA - 1\nCoCreateInstance(CLSID_ShellWindows) - 80040154\n\nI tested it with this link: https://checkmk.com/download/Marco_Reale_Check_MK_Beginner_guide.pdf"}, {"is_private": false, "bug_id": 1602726, "count": 22, "time": "2019-12-19T17:06:52Z", "author": "VYV03354@nifty.ne.jp", "text": "https://searchfox.org/mozilla-central/rev/6305f6935f496b3a302c7afcc579399a4217729c/widget/windows/ShellHeaderOnlyUtils.h#56\nShould `dwClsContext` be `CLSCTX_ALL` (that is, should it contain `CLSCTX_REMOTE_SERVER`)?", "raw_text": "https://searchfox.org/mozilla-central/rev/6305f6935f496b3a302c7afcc579399a4217729c/widget/windows/ShellHeaderOnlyUtils.h#56\nShould `dwClsContext` be `CLSCTX_ALL` (that is, should it contain `CLSCTX_REMOTE_SERVER`)?", "creator": "VYV03354@nifty.ne.jp", "tags": [], "creation_time": "2019-12-19T17:06:52Z", "attachment_id": null, "id": 14556834}, {"text": "Thank you for sharing the result!  Knowing `CoCreateInstance` failed with `REGDB_E_CLASSNOTREG` (= 80040154) is big progress.\n\n(In reply to Masatoshi Kimura [:emk] from comment #22)\n> https://searchfox.org/mozilla-central/rev/6305f6935f496b3a302c7afcc579399a4217729c/widget/windows/ShellHeaderOnlyUtils.h#56\n> Should `dwClsContext` be `CLSCTX_ALL` (that is, should it contain `CLSCTX_REMOTE_SERVER`)?\n\nMaybe, but I'm not sure.  In my understanding, firefox.exe is running on the server.  Getting `REGDB_E_CLASSNOTREG` seems to mean the Citrix server does not register shell.  At the same time, a downloaded file should be stored in the server.  Communication between firefox and shell will not be cross-machine.  All is my hypothesis, though.\n\nLuckily I had a chance to test this scenario on Microsoft RemoteApp.  I could reproduce the issue, but interestingly, the failure was `IShellWindows::FindWindowSW` returned `S_FALSE`.  Good news is in both cases we get an error code.\n\nNeither `WTSQuerySessionInformationA` nor `GetSystemMetrics(SM_REMOTESESSION)` is useful because it returns the same in a normal RDP session.\n\nHowever we detect the situation, we don't know a perfect solution if a user opens Skype for Business (or anything which does not support the `PreferSystem32Images` policy) in Citrix or RemoteApp.  We should ask Microsoft whether there is a nice way to deal with it.  In the meantime I'm thinking to add a fallback simply when `ShellExecuteByExplorer` returns an error.", "time": "2019-12-20T01:14:02Z", "author": "tkikuchi@mozilla.com", "creation_time": "2019-12-20T01:14:02Z", "raw_text": "Thank you for sharing the result!  Knowing `CoCreateInstance` failed with `REGDB_E_CLASSNOTREG` (= 80040154) is big progress.\n\n(In reply to Masatoshi Kimura [:emk] from comment #22)\n> https://searchfox.org/mozilla-central/rev/6305f6935f496b3a302c7afcc579399a4217729c/widget/windows/ShellHeaderOnlyUtils.h#56\n> Should `dwClsContext` be `CLSCTX_ALL` (that is, should it contain `CLSCTX_REMOTE_SERVER`)?\n\nMaybe, but I'm not sure.  In my understanding, firefox.exe is running on the server.  Getting `REGDB_E_CLASSNOTREG` seems to mean the Citrix server does not register shell.  At the same time, a downloaded file should be stored in the server.  Communication between firefox and shell will not be cross-machine.  All is my hypothesis, though.\n\nLuckily I had a chance to test this scenario on Microsoft RemoteApp.  I could reproduce the issue, but interestingly, the failure was `IShellWindows::FindWindowSW` returned `S_FALSE`.  Good news is in both cases we get an error code.\n\nNeither `WTSQuerySessionInformationA` nor `GetSystemMetrics(SM_REMOTESESSION)` is useful because it returns the same in a normal RDP session.\n\nHowever we detect the situation, we don't know a perfect solution if a user opens Skype for Business (or anything which does not support the `PreferSystem32Images` policy) in Citrix or RemoteApp.  We should ask Microsoft whether there is a nice way to deal with it.  In the meantime I'm thinking to add a fallback simply when `ShellExecuteByExplorer` returns an error.", "creator": "tkikuchi@mozilla.com", "is_private": false, "count": 23, "bug_id": 1602726, "attachment_id": null, "id": 14557833, "tags": []}, {"text": "*** Bug 1605472 has been marked as a duplicate of this bug. ***", "time": "2019-12-20T21:20:46Z", "author": "madperson@gmx.at", "creation_time": "2019-12-20T21:20:46Z", "raw_text": "", "creator": "madperson@gmx.at", "is_private": false, "bug_id": 1602726, "count": 24, "attachment_id": null, "id": 14559470, "tags": []}, {"tags": [], "attachment_id": null, "id": 14559615, "is_private": false, "bug_id": 1602726, "count": 25, "raw_text": "checked on Firefox 68.2.0 ESR - works properly. Opens files. \nchecked on Firefox 68.3.0 ESR and 71 (wrrrrr... I had to edit my compatibility.ini profile file to return to 68.2.0esr from 68.3.0/71) - doesn't work. No action after clicking opening file with associated app. \n\n**HOW TO EDIT THIS BEHAVIOUR WITH about:config?** Security bugs fixed in 68.3.0esr but I cannot work with this version with standard conf.", "creator": "bugzil.la@wp.pl", "creation_time": "2019-12-20T22:14:24Z", "author": "bugzil.la@wp.pl", "time": "2019-12-20T22:14:24Z", "text": "checked on Firefox 68.2.0 ESR - works properly. Opens files. \nchecked on Firefox 68.3.0 ESR and 71 (wrrrrr... I had to edit my compatibility.ini profile file to return to 68.2.0esr from 68.3.0/71) - doesn't work. No action after clicking opening file with associated app. \n\n**HOW TO EDIT THIS BEHAVIOUR WITH about:config?** Security bugs fixed in 68.3.0esr but I cannot work with this version with standard conf."}, {"creation_time": "2019-12-20T22:15:47Z", "tags": [], "id": 14559621, "attachment_id": null, "bug_id": 1602726, "time": "2019-12-20T22:15:47Z", "count": 26, "author": "bugzil.la@wp.pl", "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "BTW. I use Windows 8.1, not Server 2012. My bug is marked as duplication of this bug.", "text": "BTW. I use Windows 8.1, not Server 2012. My bug is marked as duplication of this bug."}, {"text": "Created attachment 9117380\nBug 1602726 - Fall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz\n\nIt turned out that `ShellExecuteByExplorer` does not work on VDI such as Citrix\nor Microsoft RemoteApp.  This patch adds a fallback to the original launching\ncode if `ShellExecuteByExplorer` fails.  This will be a temporary solution until\nwe find out a way to solve both interop issues `PreferSystem32Images` and VDI.", "time": "2019-12-20T22:33:39Z", "author": "tkikuchi@mozilla.com", "creation_time": "2019-12-20T22:33:39Z", "creator": "tkikuchi@mozilla.com", "raw_text": "It turned out that `ShellExecuteByExplorer` does not work on VDI such as Citrix\nor Microsoft RemoteApp.  This patch adds a fallback to the original launching\ncode if `ShellExecuteByExplorer` fails.  This will be a temporary solution until\nwe find out a way to solve both interop issues `PreferSystem32Images` and VDI.", "count": 27, "bug_id": 1602726, "is_private": false, "id": 14559661, "attachment_id": 9117380, "tags": []}, {"text": "I think that fallback to ShellExecuteEx should be forever. Please read about ReactOS. Firefox should work also on ReactOS. It is really need use of ShellExecuteByExplorer or PreferSystem32Images if ShellExecuteEx function **is good enough**?\n\nAdditionally Firefox uses GetVersion/GetVersionEx instead of testing features. Please see source code. Checking version of Windows is very bad practice. Firefox shall be open also for emulators (Wine) and alternative systems (ReactOS).", "time": "2019-12-20T23:40:04Z", "author": "bugzil.la@wp.pl", "creation_time": "2019-12-20T23:40:04Z", "creator": "bugzil.la@wp.pl", "raw_text": "I think that fallback to ShellExecuteEx should be forever. Please read about ReactOS. Firefox should work also on ReactOS. It is really need use of ShellExecuteByExplorer or PreferSystem32Images if ShellExecuteEx function **is good enough**?\n\nAdditionally Firefox uses GetVersion/GetVersionEx instead of testing features. Please see source code. Checking version of Windows is very bad practice. Firefox shall be open also for emulators (Wine) and alternative systems (ReactOS).", "count": 28, "bug_id": 1602726, "is_private": false, "id": 14559748, "attachment_id": null, "tags": []}, {"time": "2020-01-01T20:58:48Z", "author": "bugzil.la@wp.pl", "text": "Why? Do we have to change browser?", "creation_time": "2020-01-01T20:58:48Z", "count": 29, "bug_id": 1602726, "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Why? Do we have to change browser?", "tags": [], "id": 14569735, "attachment_id": null}, {"id": 14569877, "attachment_id": null, "creation_time": "2020-01-02T08:11:20Z", "tags": [], "creator": "bugzil.la@wp.pl", "text": "After research: **this bug does not apply only to citrix and remote app.**\n\nApplies to all Windows with a changed default \"shell\" (progman) and Windows with removed or not-launched shell (most KIOSK mode configurations without EXPLORER shell). \n\nChanged or removed default shell (main explorer.exe process) means:\n- the explorer.exe is still present in system and can be used to manual browsing catalogs but not start as shell.\n- `IShellWindows::FindWindowSW` etc. methods may not work due to undocumented behaviour of this feature (undocumented communication between OS and explorer.exe),\n- `WinExec`, `CreateProcess`, `ShellExecuteEx` still works. \n\nFor testing, it is probably sufficient to kill explorer.exe in taskmgr.exe and then download a PDF / DOCX and trying to open it (with shutdowned explorer.exe). \n\nAfter googling, the `ShellExecuteByExplorer` has long history of bugs... in the past. Due to use \"new API functions\" added in Vista, Windows 7 and Windows 8 (not fully documented). \n\nRunning unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \nhttps://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\nRunning with lower privileges doesn't force user to click the UAC. \n\nBTW. Can I please link to download compiled version (unofficial) of win32 Firefox 68.3.0/68.4.0 ESR with corrected this bug (with D58054 solution)?", "raw_text": "After research: **this bug does not apply only to citrix and remote app.**\n\nApplies to all Windows with a changed default \"shell\" (progman) and Windows with removed or not-launched shell (most KIOSK mode configurations without EXPLORER shell). \n\nChanged or removed default shell (main explorer.exe process) means:\n- the explorer.exe is still present in system and can be used to manual browsing catalogs but not start as shell.\n- `IShellWindows::FindWindowSW` etc. methods may not work due to undocumented behaviour of this feature (undocumented communication between OS and explorer.exe),\n- `WinExec`, `CreateProcess`, `ShellExecuteEx` still works. \n\nFor testing, it is probably sufficient to kill explorer.exe in taskmgr.exe and then download a PDF / DOCX and trying to open it (with shutdowned explorer.exe). \n\nAfter googling, the `ShellExecuteByExplorer` has long history of bugs... in the past. Due to use \"new API functions\" added in Vista, Windows 7 and Windows 8 (not fully documented). \n\nRunning unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \nhttps://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\nRunning with lower privileges doesn't force user to click the UAC. \n\nBTW. Can I please link to download compiled version (unofficial) of win32 Firefox 68.3.0/68.4.0 ESR with corrected this bug (with D58054 solution)?", "count": 30, "author": "bugzil.la@wp.pl", "time": "2020-01-02T08:11:20Z", "bug_id": 1602726, "is_private": false}, {"tags": [], "creation_time": "2020-01-02T12:51:28Z", "attachment_id": null, "id": 14570162, "is_private": false, "bug_id": 1602726, "count": 31, "author": "VYV03354@nifty.ne.jp", "time": "2020-01-02T12:51:28Z", "raw_text": "(In reply to Mozira from comment #30)\n> Running unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \n> https://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\n\nIt does not work with non-admin users, so it's useless for our purpose.", "text": "(In reply to Mozira from comment #30)\n> Running unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \n> https://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\n\nIt does not work with non-admin users, so it's useless for our purpose.", "creator": "VYV03354@nifty.ne.jp"}, {"is_private": false, "bug_id": 1602726, "time": "2020-01-02T14:53:16Z", "author": "bugzil.la@wp.pl", "count": 32, "text": "(In reply to Masatoshi Kimura [:emk] from comment #31)\n> (In reply to Mozira from comment #30)\n> > Running unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \n> > https://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\n> \n> It does not work with non-admin users, so it's useless for our purpose.\n\nIf non admin user then the firefox process is not run woth privileged node and here can be used... `ShellExecuteEx`?", "raw_text": "(In reply to Masatoshi Kimura [:emk] from comment #31)\n> (In reply to Mozira from comment #30)\n> > Running unelevated process doesn't need to use new not fully documented shell functions. It can be done like here: \n> > https://www.codeproject.com/Articles/16796/Riding-the-Vista-UAC-elevator-up-and-down\n> \n> It does not work with non-admin users, so it's useless for our purpose.\n\nIf non admin user then the firefox process is not run woth privileged node and here can be used... `ShellExecuteEx`?", "creator": "bugzil.la@wp.pl", "tags": [], "creation_time": "2020-01-02T14:53:16Z", "attachment_id": null, "id": 14570331}, {"attachment_id": null, "id": 14570797, "tags": [], "raw_text": "(In reply to Mozira from comment #30)\n\n> BTW. Can I please link to download compiled version (unofficial) of win32 Firefox 68.3.0/68.4.0 ESR with corrected this bug (with D58054 solution)?\n\nHere it is.\n\nSubmitted job:\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=a3062338c656260afc7559519bcfb0f279845648&selectedJob=283221177\nx64 installer:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/SPTygn80QKGLQfehJ3CDWw/runs/0/artifacts/public/build/install/sea/target.installer.exe\nFull x64 binaries:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/SPTygn80QKGLQfehJ3CDWw/runs/0/artifacts/public/build/target.zip", "creator": "tkikuchi@mozilla.com", "is_private": false, "count": 33, "bug_id": 1602726, "creation_time": "2020-01-02T19:11:17Z", "text": "(In reply to Mozira from comment #30)\n\n> BTW. Can I please link to download compiled version (unofficial) of win32 Firefox 68.3.0/68.4.0 ESR with corrected this bug (with D58054 solution)?\n\nHere it is.\n\nSubmitted job:\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=a3062338c656260afc7559519bcfb0f279845648&selectedJob=283221177\nx64 installer:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/SPTygn80QKGLQfehJ3CDWw/runs/0/artifacts/public/build/install/sea/target.installer.exe\nFull x64 binaries:\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/SPTygn80QKGLQfehJ3CDWw/runs/0/artifacts/public/build/target.zip", "time": "2020-01-02T19:11:17Z", "author": "tkikuchi@mozilla.com"}, {"raw_text": "@Toshi, which version should I download for Windows 8.1 32-bit? Where I find msi or exe files?", "creator": "bugzil.la@wp.pl", "is_private": false, "bug_id": 1602726, "count": 34, "attachment_id": null, "id": 14570915, "tags": [], "text": "@Toshi, which version should I download for Windows 8.1 32-bit? Where I find msi or exe files?", "time": "2020-01-02T20:41:01Z", "author": "bugzil.la@wp.pl", "creation_time": "2020-01-02T20:41:01Z"}, {"creation_time": "2020-01-02T22:17:34Z", "text": "x86 installer is ready.\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/b9p6tTK7QlSanzGWA2HOfw/runs/0/artifacts/public/build/install/sea/target.installer.exe", "time": "2020-01-02T22:17:34Z", "author": "tkikuchi@mozilla.com", "attachment_id": null, "id": 14571045, "tags": [], "raw_text": "x86 installer is ready.\nhttps://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/b9p6tTK7QlSanzGWA2HOfw/runs/0/artifacts/public/build/install/sea/target.installer.exe", "creator": "tkikuchi@mozilla.com", "is_private": false, "count": 35, "bug_id": 1602726}, {"is_private": false, "count": 36, "time": "2020-01-03T05:18:11Z", "author": "bugzil.la@wp.pl", "bug_id": 1602726, "text": "Thank you @Tochi.\n\nThe win32 Firefox looks to work correctly (including opening of PDF / ODT files) :-)", "raw_text": "Thank you @Tochi.\n\nThe win32 Firefox looks to work correctly (including opening of PDF / ODT files) :-)", "creator": "bugzil.la@wp.pl", "tags": [], "creation_time": "2020-01-03T05:18:11Z", "attachment_id": null, "id": 14571247}, {"creation_time": "2020-01-07T03:18:32Z", "text": "*** Bug 1605469 has been marked as a duplicate of this bug. ***", "time": "2020-01-07T03:18:32Z", "author": "unicorn.consulting@gmail.com", "attachment_id": null, "id": 14576671, "tags": [], "raw_text": "", "creator": "unicorn.consulting@gmail.com", "is_private": false, "count": 37, "bug_id": 1602726}, {"tags": [], "creation_time": "2020-01-08T17:05:24Z", "attachment_id": null, "id": 14580513, "is_private": false, "author": "pulsebot@bots.tld", "count": 38, "time": "2020-01-08T17:05:24Z", "bug_id": 1602726, "text": "Pushed by ccoroiu@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/32803329a548\nFall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz", "raw_text": "Pushed by ccoroiu@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/32803329a548\nFall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz", "creator": "pulsebot@bots.tld"}, {"count": 39, "bug_id": 1602726, "is_private": false, "creator": "apavel@mozilla.com", "raw_text": "https://hg.mozilla.org/mozilla-central/rev/32803329a548", "tags": ["bugherder"], "id": 14581150, "attachment_id": null, "author": "apavel@mozilla.com", "time": "2020-01-08T22:06:41Z", "text": "https://hg.mozilla.org/mozilla-central/rev/32803329a548", "creation_time": "2020-01-08T22:06:41Z"}, {"attachment_id": null, "id": 14581747, "tags": [], "raw_text": "In which firefox-esr68 version the bug will be fixed?", "creator": "Peter.Geier@sskm.de", "is_private": false, "count": 40, "bug_id": 1602726, "creation_time": "2020-01-09T07:05:41Z", "text": "In which firefox-esr68 version the bug will be fixed?", "author": "Peter.Geier@sskm.de", "time": "2020-01-09T07:05:41Z"}, {"bug_id": 1602726, "author": "ryanvm@gmail.com", "time": "2020-01-09T19:06:20Z", "count": 41, "is_private": false, "creator": "ryanvm@gmail.com", "text": "Please nominate this for Beta and ESR68 approval when you get a chance.", "raw_text": "Please nominate this for Beta and ESR68 approval when you get a chance.", "creation_time": "2020-01-09T19:06:20Z", "tags": [], "id": 14583212, "attachment_id": null}, {"text": "Comment on attachment 9117380\nBug 1602726 - Fall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz\n\n### Beta/Release Uplift Approval Request\n* **User impact if declined**: If explorer.exe is not available in a user's environment, Firefox fails to open a downloaded file.  This is a regression from Bug 1588975.  The affected environment includes VDI such as Microsoft RemoteApp and Citrix.\n* **Is this code covered by automated tests?**: No\n* **Has the fix been verified in Nightly?**: Yes\n* **Needs manual test from QE?**: No\n* **If yes, steps to reproduce**: \n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: The risk is low because the fix is to add a fallback to the original logic (use `ShellExecuteEx`) if a new logic fails.\n* **String changes made/needed**: None", "time": "2020-01-09T22:28:20Z", "author": "tkikuchi@mozilla.com", "creation_time": "2020-01-09T22:28:20Z", "creator": "tkikuchi@mozilla.com", "raw_text": "### Beta/Release Uplift Approval Request\n* **User impact if declined**: If explorer.exe is not available in a user's environment, Firefox fails to open a downloaded file.  This is a regression from Bug 1588975.  The affected environment includes VDI such as Microsoft RemoteApp and Citrix.\n* **Is this code covered by automated tests?**: No\n* **Has the fix been verified in Nightly?**: Yes\n* **Needs manual test from QE?**: No\n* **If yes, steps to reproduce**: \n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: The risk is low because the fix is to add a fallback to the original logic (use `ShellExecuteEx`) if a new logic fails.\n* **String changes made/needed**: None", "count": 42, "bug_id": 1602726, "is_private": false, "id": 14583718, "attachment_id": 9117380, "tags": []}, {"tags": [], "creation_time": "2020-01-09T22:29:58Z", "attachment_id": 9117380, "id": 14583720, "is_private": false, "bug_id": 1602726, "time": "2020-01-09T22:29:58Z", "count": 43, "author": "ryanvm@gmail.com", "raw_text": "Falls back to the old logic to avoid a regression from bug 1588975 causing issues in Citrix environments. Approved for 73.0b3.", "text": "Comment on attachment 9117380\nBug 1602726 - Fall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz\n\nFalls back to the old logic to avoid a regression from bug 1588975 causing issues in Citrix environments. Approved for 73.0b3.", "creator": "ryanvm@gmail.com"}, {"tags": ["bugherder", "uplift"], "attachment_id": null, "id": 14583890, "is_private": false, "count": 44, "bug_id": 1602726, "raw_text": "https://hg.mozilla.org/releases/mozilla-beta/rev/dcd448e696e1", "creator": "nbeleuzu@mozilla.com", "creation_time": "2020-01-10T00:33:45Z", "time": "2020-01-10T00:33:45Z", "author": "nbeleuzu@mozilla.com", "text": "https://hg.mozilla.org/releases/mozilla-beta/rev/dcd448e696e1"}, {"creator": "tkikuchi@mozilla.com", "raw_text": "### ESR Uplift Approval Request\n* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a regression from Bug 1588975, which was uplifted to ESR.  The affected environment includes VDI such as Microsoft RemoteApp and Citrix.  Those environments are used by enterprise customers.\n* **User impact if declined**: If explorer.exe is not available in a user's environment, Firefox fails to open a downloaded file.\n* **Fix Landed on Version**: 74.0a1\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: The risk is low because the fix is to add a fallback to the original logic (use `ShellExecuteEx`) if a new logic fails.\n* **String or UUID changes made by this patch**: None", "bug_id": 1602726, "count": 45, "is_private": false, "id": 14583901, "attachment_id": 9117380, "tags": [], "text": "Comment on attachment 9117380\nBug 1602726 - Fall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz\n\n### ESR Uplift Approval Request\n* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a regression from Bug 1588975, which was uplifted to ESR.  The affected environment includes VDI such as Microsoft RemoteApp and Citrix.  Those environments are used by enterprise customers.\n* **User impact if declined**: If explorer.exe is not available in a user's environment, Firefox fails to open a downloaded file.\n* **Fix Landed on Version**: 74.0a1\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: The risk is low because the fix is to add a fallback to the original logic (use `ShellExecuteEx`) if a new logic fails.\n* **String or UUID changes made by this patch**: None", "time": "2020-01-10T00:47:07Z", "author": "tkikuchi@mozilla.com", "creation_time": "2020-01-10T00:47:07Z"}, {"text": "Hi guys, unfortunately we can not successfully reproduce and verify this issue because we are lacking the exact environment on which it was reproducible. \n\nPeter or Mozira, could you look over if you have some time and verify that it has been fixed and working correctly? Thank you!", "author": "catalin.sasca@softvision.com", "time": "2020-01-10T12:46:23Z", "creation_time": "2020-01-10T12:46:23Z", "creator": "catalin.sasca@softvision.com", "raw_text": "Hi guys, unfortunately we can not successfully reproduce and verify this issue because we are lacking the exact environment on which it was reproducible. \n\nPeter or Mozira, could you look over if you have some time and verify that it has been fixed and working correctly? Thank you!", "count": 46, "bug_id": 1602726, "is_private": false, "id": 14584625, "attachment_id": null, "tags": []}, {"id": 14584667, "attachment_id": null, "tags": [], "creator": "Peter.Geier@sskm.de", "raw_text": "Hi Catalin,\nI need download links for fixed 68esr and fixed 7x Version.", "bug_id": 1602726, "count": 47, "is_private": false, "creation_time": "2020-01-10T13:15:03Z", "text": "Hi Catalin,\nI need download links for fixed 68esr and fixed 7x Version.", "author": "Peter.Geier@sskm.de", "time": "2020-01-10T13:15:03Z"}, {"creation_time": "2020-01-10T13:21:47Z", "time": "2020-01-10T13:21:47Z", "author": "catalin.sasca@softvision.com", "text": "68esr seems to be not yet fixed, but you can verify on 73.0b3 (https://archive.mozilla.org/pub/firefox/candidates/73.0b3-candidates/build1/) and 74.0a1 (https://archive.mozilla.org/pub/firefox/nightly/2020/01/2020-01-10-09-50-23-mozilla-central/).\n\nThank you! Please let me know if you need anything else.", "tags": [], "id": 14584677, "attachment_id": null, "bug_id": 1602726, "count": 48, "is_private": false, "creator": "catalin.sasca@softvision.com", "raw_text": "68esr seems to be not yet fixed, but you can verify on 73.0b3 (https://archive.mozilla.org/pub/firefox/candidates/73.0b3-candidates/build1/) and 74.0a1 (https://archive.mozilla.org/pub/firefox/nightly/2020/01/2020-01-10-09-50-23-mozilla-central/).\n\nThank you! Please let me know if you need anything else."}, {"text": "Hi Catalin,\n\nboth Versions works fine, seems to be fixed :-)\n\nPlease inform me about fixing 68esr Version.\nWe only use this version on Citrix.\nIt will be important, because esr 68.4.1 includes a critical fix an we use aktual 68.2.0.\nThanks a lot.", "time": "2020-01-10T13:51:49Z", "author": "Peter.Geier@sskm.de", "creation_time": "2020-01-10T13:51:49Z", "creator": "Peter.Geier@sskm.de", "raw_text": "Hi Catalin,\n\nboth Versions works fine, seems to be fixed :-)\n\nPlease inform me about fixing 68esr Version.\nWe only use this version on Citrix.\nIt will be important, because esr 68.4.1 includes a critical fix an we use aktual 68.2.0.\nThanks a lot.", "bug_id": 1602726, "count": 49, "is_private": false, "id": 14584733, "attachment_id": null, "tags": []}, {"creator": "catalin.sasca@softvision.com", "raw_text": "Sure thing Peter! Thanks to you too for verifying them.", "bug_id": 1602726, "count": 50, "is_private": false, "id": 14584862, "attachment_id": null, "tags": [], "text": "Sure thing Peter! Thanks to you too for verifying them.", "author": "catalin.sasca@softvision.com", "time": "2020-01-10T14:50:54Z", "creation_time": "2020-01-10T14:50:54Z"}, {"tags": [], "creation_time": "2020-01-10T21:21:50Z", "attachment_id": 9117380, "id": 14585671, "is_private": false, "bug_id": 1602726, "author": "ryanvm@gmail.com", "count": 51, "time": "2020-01-10T21:21:50Z", "raw_text": "Thanks for the Nightly and Beta verification. Approved for 68.5esr.", "text": "Comment on attachment 9117380\nBug 1602726 - Fall back to ShellExecuteEx if ShellExecuteByExplorer fails.  r=aklotz\n\nThanks for the Nightly and Beta verification. Approved for 68.5esr.", "creator": "ryanvm@gmail.com"}, {"tags": ["bugherder", "uplift"], "creation_time": "2020-01-10T21:28:10Z", "attachment_id": null, "id": 14585684, "is_private": false, "author": "ryanvm@gmail.com", "time": "2020-01-10T21:28:10Z", "count": 52, "bug_id": 1602726, "raw_text": "https://hg.mozilla.org/releases/mozilla-esr68/rev/a871b8691545", "text": "https://hg.mozilla.org/releases/mozilla-esr68/rev/a871b8691545", "creator": "ryanvm@gmail.com"}, {"attachment_id": null, "id": 14590909, "tags": [], "creation_time": "2020-01-14T09:09:24Z", "text": "I returned to Firefox 68.4.0. \n\nFirefox 68.4.1 and 68.4.0 - I attach screenshots of behaviour. New behaviour in 68.4.1 is unacceptable. Please see screens.", "raw_text": "I returned to Firefox 68.4.0. \n\nFirefox 68.4.1 and 68.4.0 - I attach screenshots of behaviour. New behaviour in 68.4.1 is unacceptable. Please see screens.", "creator": "bugzil.la@wp.pl", "is_private": false, "bug_id": 1602726, "count": 53, "time": "2020-01-14T09:09:24Z", "author": "bugzil.la@wp.pl"}, {"creation_time": "2020-01-14T09:11:12Z", "tags": [], "id": 14590912, "attachment_id": 9120697, "author": "bugzil.la@wp.pl", "count": 54, "time": "2020-01-14T09:11:12Z", "bug_id": 1602726, "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Screens. Good behaviour in 68.4.0. Wrong behaviour in FF 68.4.1!!!", "text": "Created attachment 9120697\nbugzilla.png\n\nScreens. Good behaviour in 68.4.0. Wrong behaviour in FF 68.4.1!!!"}, {"creation_time": "2020-01-14T09:12:54Z", "tags": [], "id": 14590915, "attachment_id": null, "bug_id": 1602726, "author": "bugzil.la@wp.pl", "count": 55, "time": "2020-01-14T09:12:54Z", "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Links in Thunderbird 68.4.1 also not working.", "text": "Links in Thunderbird 68.4.1 also not working."}, {"tags": [], "attachment_id": null, "id": 14590948, "is_private": false, "bug_id": 1602726, "count": 56, "raw_text": "Please leave status flags alone.", "creator": "jcristau@mozilla.com", "creation_time": "2020-01-14T09:39:23Z", "time": "2020-01-14T09:39:23Z", "author": "jcristau@mozilla.com", "text": "Please leave status flags alone."}, {"tags": [], "attachment_id": null, "id": 14590951, "is_private": false, "count": 57, "bug_id": 1602726, "raw_text": "For what it's worth there's no relevant change between firefox 68.4.0 and 68.4.1.", "creator": "jcristau@mozilla.com", "creation_time": "2020-01-14T09:40:29Z", "time": "2020-01-14T09:40:29Z", "author": "jcristau@mozilla.com", "text": "For what it's worth there's no relevant change between firefox 68.4.0 and 68.4.1."}, {"bug_id": 1602726, "author": "bugzil.la@wp.pl", "time": "2020-01-14T09:51:47Z", "count": 58, "is_private": false, "creator": "bugzil.la@wp.pl", "text": "Thus why FF Nightly 68.4.0 (compilation above) works and FF 68.4.1 Official not?", "raw_text": "Thus why FF Nightly 68.4.0 (compilation above) works and FF 68.4.1 Official not?", "creation_time": "2020-01-14T09:51:47Z", "tags": [], "id": 14590991, "attachment_id": null}, {"creator": "bugzil.la@wp.pl", "text": "Please try kill Explorer.exe and then try both versions.", "raw_text": "Please try kill Explorer.exe and then try both versions.", "bug_id": 1602726, "author": "bugzil.la@wp.pl", "count": 59, "time": "2020-01-14T09:52:25Z", "is_private": false, "id": 14590992, "attachment_id": null, "creation_time": "2020-01-14T09:52:25Z", "tags": []}, {"creation_time": "2020-01-14T10:24:18Z", "author": "gijskruitbosch+bugs@gmail.com", "time": "2020-01-14T10:24:18Z", "text": "(In reply to Mozira from comment #58)\n> Thus why FF Nightly 68.4.0 (compilation above)\n\nYou tried what's called a \"trypush\" build (comment #35); not the official/real 68.4.0 build. This build was set up by a developer so you could test if things worked. It included 2 patches - the one on this bug, and the one on bug 1601905.\n\n> works and FF 68.4.1 Official not?\n\nThe official fx 68.4.1 build doesn't have the patch from this bug, it only has the patch from bug 1601905. This bug was marked as fixed on ESR because the 68.5 release will include the fix from this bug. This is normal procedure - bugs are labeled fixed on branches that have the code, even if no official release has happened with that code yet.", "tags": [], "id": 14591042, "attachment_id": null, "bug_id": 1602726, "count": 60, "is_private": false, "creator": "gijskruitbosch+bugs@gmail.com", "raw_text": "(In reply to Mozira from comment #58)\n> Thus why FF Nightly 68.4.0 (compilation above)\n\nYou tried what's called a \"trypush\" build (comment #35); not the official/real 68.4.0 build. This build was set up by a developer so you could test if things worked. It included 2 patches - the one on this bug, and the one on bug 1601905.\n\n> works and FF 68.4.1 Official not?\n\nThe official fx 68.4.1 build doesn't have the patch from this bug, it only has the patch from bug 1601905. This bug was marked as fixed on ESR because the 68.5 release will include the fix from this bug. This is normal procedure - bugs are labeled fixed on branches that have the code, even if no official release has happened with that code yet."}, {"time": "2020-01-14T10:46:18Z", "author": "bugzil.la@wp.pl", "text": "Mr. @Gijs, thank you for clarifying the situation.\n\nI thought version FF 68.4.1esr includes all 68.4.0 Nightly fixes. So I'll wait for version 68.5.0esr and test official 68.5.0. :-)\nForgive me for not knowing your procedures.\nI will inform how 68.5.0 works due to thisbug. When the release of 68.5.0esr is planned? (I'm on Nightly update channel now...)\n\n@Toshi's version works correctly (68.4.0 Nightly).", "creation_time": "2020-01-14T10:46:18Z", "count": 61, "bug_id": 1602726, "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Mr. @Gijs, thank you for clarifying the situation.\n\nI thought version FF 68.4.1esr includes all 68.4.0 Nightly fixes. So I'll wait for version 68.5.0esr and test official 68.5.0. :-)\nForgive me for not knowing your procedures.\nI will inform how 68.5.0 works due to thisbug. When the release of 68.5.0esr is planned? (I'm on Nightly update channel now...)\n\n@Toshi's version works correctly (68.4.0 Nightly).", "tags": [], "id": 14591116, "attachment_id": null}, {"attachment_id": null, "id": 14592552, "tags": [], "raw_text": "> Links in Thunderbird 68.4.1 also not working.\n\nTB 68.4.1 doesn't have this patch.", "creator": "jorgk-bmo@jorgk.com", "is_private": false, "count": 62, "bug_id": 1602726, "creation_time": "2020-01-14T20:51:37Z", "text": "> Links in Thunderbird 68.4.1 also not working.\n\nTB 68.4.1 doesn't have this patch.", "author": "jorgk-bmo@jorgk.com", "time": "2020-01-14T20:51:37Z"}, {"creation_time": "2020-01-15T14:49:59Z", "author": "V.Bartels@gmx.de", "time": "2020-01-15T14:49:59Z", "text": "Another way to reproduce:\n\nstart Firefox under a different user account like:\n\nC:\\WINDOWS\\system32\\cmd.exe /c C:\\WINDOWS\\system32\\runas.exe /savecred /profile /user:TestAccount \"C:\\Program Files\\Firefox Nightly\\firefox.exe -nosplash -no-remote\"\n\nAnd yes: Firefox Nightly 74.0a1 works fine\nAnd yes: Thunderbird 68.4.1 is broken (start as above)", "tags": [], "id": 14594074, "attachment_id": null, "bug_id": 1602726, "count": 63, "is_private": false, "creator": "V.Bartels@gmx.de", "raw_text": "Another way to reproduce:\n\nstart Firefox under a different user account like:\n\nC:\\WINDOWS\\system32\\cmd.exe /c C:\\WINDOWS\\system32\\runas.exe /savecred /profile /user:TestAccount \"C:\\Program Files\\Firefox Nightly\\firefox.exe -nosplash -no-remote\"\n\nAnd yes: Firefox Nightly 74.0a1 works fine\nAnd yes: Thunderbird 68.4.1 is broken (start as above)"}, {"bug_id": 1602726, "count": 64, "time": "2020-01-17T11:22:05Z", "author": "bugzil.la@wp.pl", "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Thus the patch should **not be temporary**. Should exist forever in the code.", "text": "Thus the patch should **not be temporary**. Should exist forever in the code.", "creation_time": "2020-01-17T11:22:05Z", "tags": ["advocacy"], "id": 14597378, "attachment_id": null}, {"raw_text": "Landed on FIREFOX_ESR_68_4_X_RELBRANCH for 68.4.2.\nhttps://hg.mozilla.org/releases/mozilla-esr68/rev/20ab1567df2b04f11625bac2ce8fe2984c4c08eb", "creator": "ryanvm@gmail.com", "is_private": false, "count": 65, "bug_id": 1602726, "attachment_id": null, "id": 14597757, "tags": ["uplift"], "text": "Landed on FIREFOX_ESR_68_4_X_RELBRANCH for 68.4.2.\nhttps://hg.mozilla.org/releases/mozilla-esr68/rev/20ab1567df2b04f11625bac2ce8fe2984c4c08eb", "author": "ryanvm@gmail.com", "time": "2020-01-17T15:29:10Z", "creation_time": "2020-01-17T15:29:10Z"}, {"author": "bugzil.la@wp.pl", "time": "2020-01-22T00:23:52Z", "text": "Official Firefox 68.4.2esr properly opens PDFs/ODTs for me.", "creation_time": "2020-01-22T00:23:52Z", "bug_id": 1602726, "count": 66, "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "Official Firefox 68.4.2esr properly opens PDFs/ODTs for me.", "tags": [], "id": 14604341, "attachment_id": null}, {"creator": "mkmelin+mozilla@iki.fi", "text": "Hmm, will this be a problem for Thunderbird? https://searchfox.org/mozilla-central/rev/cfd1cc461f1efe0d66c2fdc17c024a203d5a2fd8/xpcom/io/nsLocalFileWin.cpp#90\n> rv = winMediator->GetMostRecentWindow(u\"navigator:browser\",", "raw_text": "Hmm, will this be a problem for Thunderbird? https://searchfox.org/mozilla-central/rev/cfd1cc461f1efe0d66c2fdc17c024a203d5a2fd8/xpcom/io/nsLocalFileWin.cpp#90\n> rv = winMediator->GetMostRecentWindow(u\"navigator:browser\",", "bug_id": 1602726, "count": 67, "author": "mkmelin+mozilla@iki.fi", "time": "2020-01-22T10:26:33Z", "is_private": false, "id": 14604836, "attachment_id": null, "creation_time": "2020-01-22T10:26:33Z", "tags": []}, {"text": "(In reply to Magnus Melin [:mkmelin] from comment #67)\n> Hmm, will this be a problem for Thunderbird? https://searchfox.org/mozilla-central/rev/cfd1cc461f1efe0d66c2fdc17c024a203d5a2fd8/xpcom/io/nsLocalFileWin.cpp#90\n> > rv = winMediator->GetMostRecentWindow(u\"navigator:browser\",\n\n`GetMostRecentNavigatorHWND` is not a new function.  I removed it as https://hg.mozilla.org/mozilla-central/rev/d20b7b5518c6, and now I reverted it back.", "time": "2020-01-22T16:24:15Z", "author": "tkikuchi@mozilla.com", "creation_time": "2020-01-22T16:24:15Z", "raw_text": "(In reply to Magnus Melin [:mkmelin] from comment #67)\n> Hmm, will this be a problem for Thunderbird? https://searchfox.org/mozilla-central/rev/cfd1cc461f1efe0d66c2fdc17c024a203d5a2fd8/xpcom/io/nsLocalFileWin.cpp#90\n> > rv = winMediator->GetMostRecentWindow(u\"navigator:browser\",\n\n`GetMostRecentNavigatorHWND` is not a new function.  I removed it as https://hg.mozilla.org/mozilla-central/rev/d20b7b5518c6, and now I reverted it back.", "creator": "tkikuchi@mozilla.com", "is_private": false, "count": 68, "bug_id": 1602726, "attachment_id": null, "id": 14605462, "tags": []}, {"creation_time": "2020-02-13T16:03:16Z", "time": "2020-02-13T16:03:16Z", "author": "kenneth@net-spot.dk", "text": "Hi guys,\n\nI am working for a company that replaces the windows shell, and dont have explorer.exe running in the background when firefox are running.\n\nFrom the comments it sounds like this issue should have been fixed but i cannot get it to work on any versions of firefox. I have tried all versions mentioned in this thread and still we are having issues getting firefox to launch applications without the explorer shell running. \n\nThe links that we are trying to run is the following:\n\nsteam://connect/ipaddress\nesportal://arg/arg\n\nthe behavior is working as exected when running firefox normally but as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n\nthis is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n\nam i missing something, should this not work in the current nightly build 75.0a1? \n\nif not can anyone give a link to a version where this is working. \n\nThe issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running.", "tags": [], "id": 14639463, "attachment_id": null, "count": 69, "bug_id": 1602726, "is_private": false, "creator": "kenneth@net-spot.dk", "raw_text": "Hi guys,\n\nI am working for a company that replaces the windows shell, and dont have explorer.exe running in the background when firefox are running.\n\nFrom the comments it sounds like this issue should have been fixed but i cannot get it to work on any versions of firefox. I have tried all versions mentioned in this thread and still we are having issues getting firefox to launch applications without the explorer shell running. \n\nThe links that we are trying to run is the following:\n\nsteam://connect/ipaddress\nesportal://arg/arg\n\nthe behavior is working as exected when running firefox normally but as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n\nthis is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n\nam i missing something, should this not work in the current nightly build 75.0a1? \n\nif not can anyone give a link to a version where this is working. \n\nThe issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running."}, {"time": "2020-02-13T16:16:06Z", "author": "gijskruitbosch+bugs@gmail.com", "text": "(In reply to Koenig from comment #69)\n> The links that we are trying to run is the following:\n> \n> steam://connect/ipaddress\n> esportal://arg/arg\n> ...\n> as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n> \n> this is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n>\n> The issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running.\n\nPlease can you file a new bug and CC me and :toshi and leave a comment here?\n\nFor reference, I suspect https://searchfox.org/mozilla-central/rev/a4be2fbe9bd4f405c91cc16e4e3a80400f5a9301/uriloader/exthandler/win/nsMIMEInfoWin.cpp#270-275 is failing (which is asking the shell to validate URLs). This code is specific to launching URIs, and this bug is about files, not URIs.", "creation_time": "2020-02-13T16:16:06Z", "is_private": false, "count": 70, "bug_id": 1602726, "raw_text": "(In reply to Koenig from comment #69)\n> The links that we are trying to run is the following:\n> \n> steam://connect/ipaddress\n> esportal://arg/arg\n> ...\n> as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n> \n> this is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n>\n> The issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running.\n\nPlease can you file a new bug and CC me and :toshi and leave a comment here?\n\nFor reference, I suspect https://searchfox.org/mozilla-central/rev/a4be2fbe9bd4f405c91cc16e4e3a80400f5a9301/uriloader/exthandler/win/nsMIMEInfoWin.cpp#270-275 is failing (which is asking the shell to validate URLs). This code is specific to launching URIs, and this bug is about files, not URIs.", "creator": "gijskruitbosch+bugs@gmail.com", "tags": [], "attachment_id": null, "id": 14639496}, {"count": 71, "bug_id": 1602726, "is_private": false, "creator": "kenneth@net-spot.dk", "raw_text": "(In reply to :Gijs (he/him) from comment #70)\n> (In reply to Koenig from comment #69)\n> > The links that we are trying to run is the following:\n> > \n> > steam://connect/ipaddress\n> > esportal://arg/arg\n> > ...\n> > as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n> > \n> > this is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n> >\n> > The issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running.\n> \n> Please can you file a new bug and CC me and :toshi and leave a comment here?\n> \n> For reference, I suspect https://searchfox.org/mozilla-central/rev/a4be2fbe9bd4f405c91cc16e4e3a80400f5a9301/uriloader/exthandler/win/nsMIMEInfoWin.cpp#270-275 is failing (which is asking the shell to validate URLs). This code is specific to launching URIs, and this bug is about files, not URIs.\n\nHi, thank you for the reply.\n\nIm new to this forum, so dont really know how to CC :) \n\nI have created a new bug submission that can be found here :\n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1615370", "tags": [], "id": 14639706, "attachment_id": null, "author": "kenneth@net-spot.dk", "time": "2020-02-13T17:36:15Z", "text": "(In reply to :Gijs (he/him) from comment #70)\n> (In reply to Koenig from comment #69)\n> > The links that we are trying to run is the following:\n> > \n> > steam://connect/ipaddress\n> > esportal://arg/arg\n> > ...\n> > as soon as windows explorer is killed via task manager nothing happens when clicking the launch button in firefox.\n> > \n> > this is the console error output when attempting without explorer.exe running : https://gyazo.com/7006fdce2ffb5a73236aac6d10001fca\n> >\n> > The issue is easy to replicate just kill windows explorer and the above links will fail after working fine when it is running.\n> \n> Please can you file a new bug and CC me and :toshi and leave a comment here?\n> \n> For reference, I suspect https://searchfox.org/mozilla-central/rev/a4be2fbe9bd4f405c91cc16e4e3a80400f5a9301/uriloader/exthandler/win/nsMIMEInfoWin.cpp#270-275 is failing (which is asking the shell to validate URLs). This code is specific to launching URIs, and this bug is about files, not URIs.\n\nHi, thank you for the reply.\n\nIm new to this forum, so dont really know how to CC :) \n\nI have created a new bug submission that can be found here :\n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1615370", "creation_time": "2020-02-13T17:36:15Z"}, {"tags": [], "id": 14640312, "attachment_id": null, "count": 72, "bug_id": 1602726, "is_private": false, "creator": "bugzil.la@wp.pl", "raw_text": "With shell replacement **Firefox** 68.5.0 also works for me, but **thunderbird** 68.5.0 doesn't open links starting from version 68.3.1. Version 68.5.0esr of Thunderbird is probably affected by other problem because Thunderbird 68.3.0 doesn't open attachments (like here) but opened links! In 68.3.1 links stopped to work. It means, there was other modification of code.", "creation_time": "2020-02-13T21:32:48Z", "time": "2020-02-13T21:32:48Z", "author": "bugzil.la@wp.pl", "text": "With shell replacement **Firefox** 68.5.0 also works for me, but **thunderbird** 68.5.0 doesn't open links starting from version 68.3.1. Version 68.5.0esr of Thunderbird is probably affected by other problem because Thunderbird 68.3.0 doesn't open attachments (like here) but opened links! In 68.3.1 links stopped to work. It means, there was other modification of code."}, {"creation_time": "2020-02-20T20:59:31Z", "text": "*** Bug 1605308 has been marked as a duplicate of this bug. ***", "time": "2020-02-20T20:59:31Z", "author": "rtublitz@mozilla.com", "id": 14652755, "attachment_id": null, "tags": [], "creator": "rtublitz@mozilla.com", "raw_text": "", "bug_id": 1602726, "count": 73, "is_private": false}]}}, "comments": {}}