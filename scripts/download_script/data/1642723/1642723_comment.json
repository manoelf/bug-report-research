{"comments": {}, "bugs": {"1642723": {"comments": [{"tags": [], "bug_id": 1642723, "count": 0, "is_private": false, "author": "nhnt11@gmail.com", "time": "2020-06-02T18:28:39Z", "raw_text": "We need to be able to roll this out gradually so that we don't overload any providers. Even the dry-run involves up to 10 requests per client which can be very significant when the entire release population updates.", "text": "We need to be able to roll this out gradually so that we don't overload any providers. Even the dry-run involves up to 10 requests per client which can be very significant when the entire release population updates.", "id": 14858796, "attachment_id": null, "creator": "nhnt11@gmail.com", "creation_time": "2020-06-02T18:28:39Z"}, {"author": "nhnt11@gmail.com", "bug_id": 1642723, "tags": [], "is_private": false, "count": 1, "raw_text": "", "time": "2020-06-02T18:40:57Z", "id": 14858813, "text": "Created attachment 9153521\nBug 1642723 - Pref-off automatic TRR-selection by default. r=johannh!,mythmon!,valentin!", "creation_time": "2020-06-02T18:40:57Z", "creator": "nhnt11@gmail.com", "attachment_id": 9153521}, {"text": "The attached patch is built on mozilla-release. Patch for central/beta coming later.", "id": 14858854, "creation_time": "2020-06-02T19:01:48Z", "attachment_id": null, "creator": "nhnt11@gmail.com", "author": "nhnt11@gmail.com", "bug_id": 1642723, "tags": [], "is_private": false, "count": 2, "raw_text": "The attached patch is built on mozilla-release. Patch for central/beta coming later.", "time": "2020-06-02T19:01:48Z"}, {"author": "nhnt11@gmail.com", "count": 3, "is_private": false, "tags": [], "bug_id": 1642723, "raw_text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=6cd54615056efa57ca8d3ec0deddfb6c60133c94", "time": "2020-06-02T19:38:19Z", "id": 14858923, "text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=6cd54615056efa57ca8d3ec0deddfb6c60133c94", "creation_time": "2020-06-02T19:38:19Z", "attachment_id": null, "creator": "nhnt11@gmail.com"}, {"attachment_id": 9153521, "creator": "nhnt11@gmail.com", "creation_time": "2020-06-02T22:08:31Z", "text": "Comment on attachment 9153521\nBug 1642723 - Pref-off automatic TRR-selection by default. r=johannh!,mythmon!,valentin!\n\n### Beta/Release Uplift Approval Request\n* **User impact if declined**: This prefs-off a feature that seems to be effectively DDoS'ing NextDNS, one of our DNS over HTTPs providers. This patch is blocking the rollout of Fx77.\n* **Is this code covered by automated tests?**: Yes\n* **Has the fix been verified in Nightly?**: No\n* **Needs manual test from QE?**: Yes\n* **If yes, steps to reproduce**:\n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Medium\n* **Why is the change risky/not risky? (and alternatives if risky)**: This patch is not a simple visual change, which to me rules out the \"Low\" risk category. However, all it does is cause a code path to return early if a pref is false, which it is by default, and the code path in question is not responsible for anything that could cause breakage.\n* **String changes made/needed**: None", "id": 14859281, "time": "2020-06-02T22:08:31Z", "raw_text": "### Beta/Release Uplift Approval Request\n* **User impact if declined**: This prefs-off a feature that seems to be effectively DDoS'ing NextDNS, one of our DNS over HTTPs providers. This patch is blocking the rollout of Fx77.\n* **Is this code covered by automated tests?**: Yes\n* **Has the fix been verified in Nightly?**: No\n* **Needs manual test from QE?**: Yes\n* **If yes, steps to reproduce**:\n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Medium\n* **Why is the change risky/not risky? (and alternatives if risky)**: This patch is not a simple visual change, which to me rules out the \"Low\" risk category. However, all it does is cause a code path to return early if a pref is false, which it is by default, and the code path in question is not responsible for anything that could cause breakage.\n* **String changes made/needed**: None", "count": 4, "is_private": false, "bug_id": 1642723, "tags": [], "author": "nhnt11@gmail.com"}, {"count": 5, "is_private": false, "bug_id": 1642723, "tags": [], "author": "nhnt11@gmail.com", "time": "2020-06-02T22:09:18Z", "raw_text": "Note that the patch on Phabricator is based on mozilla-release and we still need separate patches for beta and central.", "text": "Note that the patch on Phabricator is based on mozilla-release and we still need separate patches for beta and central.", "id": 14859283, "creator": "nhnt11@gmail.com", "attachment_id": null, "creation_time": "2020-06-02T22:09:18Z"}, {"raw_text": "Approved for 77.0.1", "time": "2020-06-02T22:26:07Z", "author": "ryanvm@gmail.com", "bug_id": 1642723, "tags": [], "count": 6, "is_private": false, "creation_time": "2020-06-02T22:26:07Z", "creator": "ryanvm@gmail.com", "attachment_id": 9153521, "text": "Comment on attachment 9153521\nBug 1642723 - Pref-off automatic TRR-selection by default. r=johannh!,mythmon!,valentin!\n\nApproved for 77.0.1", "id": 14859332}, {"creation_time": "2020-06-02T22:27:39Z", "attachment_id": null, "creator": "ryanvm@gmail.com", "text": "https://hg.mozilla.org/releases/mozilla-release/rev/b8d272601020250ac2897e113b3fc3b53b72cf4b", "id": 14859340, "raw_text": "https://hg.mozilla.org/releases/mozilla-release/rev/b8d272601020250ac2897e113b3fc3b53b72cf4b", "time": "2020-06-02T22:27:39Z", "author": "ryanvm@gmail.com", "is_private": false, "count": 7, "tags": ["uplift"], "bug_id": 1642723}, {"time": "2020-06-03T01:15:16Z", "raw_text": "Added to the 77.0.1 relnotes:\n> Disabled automatic selection of DNS over HTTPS providers during a test to enable wider deployment in a more controlled way", "count": 8, "is_private": false, "tags": [], "bug_id": 1642723, "author": "ryanvm@gmail.com", "creator": "ryanvm@gmail.com", "attachment_id": null, "creation_time": "2020-06-03T01:15:16Z", "id": 14859568, "text": "Added to the 77.0.1 relnotes:\n> Disabled automatic selection of DNS over HTTPS providers during a test to enable wider deployment in a more controlled way"}, {"text": "Pref-off automatic TRR-selection by default\nFirefox Release 76.0.1, Firefox Release 77.0.1\n\nWe have finished verifying Bug 1642723.\n\nQuality status: GREEN\n\nWhy is this Sign Off green?\n- During testing we have not encountered any issues. \n\nTesting Summary:\n- Test Suite: TestRail\n- We did not manage to test the natural browser update flow from 76.0.1 or 77.0 to the 77.0.1 dot release. However, we tried enrolling in the Normandy Stage recipe in Firefox 76 and updating to 77.0.1 by manually overwriting the installation. Using this scenario after opening the profile using Firefox 77.0.1 the rollout was marked as graduated and the profile was unenrolled.\n- As a workaround we enrolled a profile in the rollout using Firefox Release 76.0.1 and then opened the same profile with Firefox Release 77.0.1 without overwriting the installation and managed to test the scenario.\n- We did not manage to capture relevant data by using Wireshark.\n\nTested Platforms and browser versions:\n- Firefox Release 77.0.1 en-US using Windows 10 x64\n- Firefox Release 77.0.1 en-US using macOS 10.15\n- Firefox Release 77.0.1 es-MX using Ubuntu Linux 18.04\n- Firefox Release 77.0.1 en-US using Windows 8 x64\n- Firefox Release 77.0.1 es-MX using Windows 7 x64\n- Firefox Release 76.0.1 en-US using Windows 10 x64\n- Firefox Release 76.0.1 en-US using macOS 10.15\n- Firefox Release 76.0.1 es-MX using Ubuntu Linux 18.04\n- Firefox Release 76.0.1 en-US using Windows 8 x64\n- Firefox Release 76.0.1 es-MX using Windows 7 x64", "id": 14860705, "attachment_id": null, "creator": "ppop@mozilla.com", "creation_time": "2020-06-03T15:15:43Z", "is_private": false, "count": 9, "tags": [], "bug_id": 1642723, "author": "ppop@mozilla.com", "time": "2020-06-03T15:15:43Z", "raw_text": "Pref-off automatic TRR-selection by default\nFirefox Release 76.0.1, Firefox Release 77.0.1\n\nWe have finished verifying Bug 1642723.\n\nQuality status: GREEN\n\nWhy is this Sign Off green?\n- During testing we have not encountered any issues. \n\nTesting Summary:\n- Test Suite: TestRail\n- We did not manage to test the natural browser update flow from 76.0.1 or 77.0 to the 77.0.1 dot release. However, we tried enrolling in the Normandy Stage recipe in Firefox 76 and updating to 77.0.1 by manually overwriting the installation. Using this scenario after opening the profile using Firefox 77.0.1 the rollout was marked as graduated and the profile was unenrolled.\n- As a workaround we enrolled a profile in the rollout using Firefox Release 76.0.1 and then opened the same profile with Firefox Release 77.0.1 without overwriting the installation and managed to test the scenario.\n- We did not manage to capture relevant data by using Wireshark.\n\nTested Platforms and browser versions:\n- Firefox Release 77.0.1 en-US using Windows 10 x64\n- Firefox Release 77.0.1 en-US using macOS 10.15\n- Firefox Release 77.0.1 es-MX using Ubuntu Linux 18.04\n- Firefox Release 77.0.1 en-US using Windows 8 x64\n- Firefox Release 77.0.1 es-MX using Windows 7 x64\n- Firefox Release 76.0.1 en-US using Windows 10 x64\n- Firefox Release 76.0.1 en-US using macOS 10.15\n- Firefox Release 76.0.1 es-MX using Ubuntu Linux 18.04\n- Firefox Release 76.0.1 en-US using Windows 8 x64\n- Firefox Release 76.0.1 es-MX using Windows 7 x64"}, {"bug_id": 1642723, "tags": [], "count": 10, "is_private": false, "author": "nhnt11@gmail.com", "time": "2020-06-03T18:39:05Z", "raw_text": "", "text": "Created attachment 9153936\nBug 1642723 - Pref-off automatic TRR-selection by default (back-port from mozilla-release). r=valentin!,johannh", "id": 14861195, "creator": "nhnt11@gmail.com", "attachment_id": 9153936, "creation_time": "2020-06-03T18:39:05Z"}, {"creator": "nhnt11@gmail.com", "attachment_id": 9153937, "time": "2020-06-03T18:39:18Z", "creation_time": "2020-06-03T18:39:18Z", "raw_text": "\n\nDepends on D78126", "is_private": false, "count": 11, "bug_id": 1642723, "tags": [], "text": "Created attachment 9153937\nBug 1642723 - Also check doh-rollout.uri in browser_trrSelection_disable.js test. r=valentin!\n\n\n\nDepends on D78126", "id": 14861197, "author": "nhnt11@gmail.com"}, {"time": "2020-06-03T18:40:52Z", "raw_text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=59d1ba044cea650651a4067717dffe89922acf9f", "count": 12, "is_private": false, "bug_id": 1642723, "tags": [], "author": "nhnt11@gmail.com", "attachment_id": null, "creator": "nhnt11@gmail.com", "creation_time": "2020-06-03T18:40:52Z", "id": 14861203, "text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=59d1ba044cea650651a4067717dffe89922acf9f"}, {"raw_text": "Valentin can you get to this review today?", "time": "2020-06-04T15:32:45Z", "author": "jcristau@mozilla.com", "bug_id": 1642723, "tags": [], "is_private": false, "count": 13, "creation_time": "2020-06-04T15:32:45Z", "creator": "jcristau@mozilla.com", "attachment_id": null, "text": "Valentin can you get to this review today?", "id": 14863048}, {"author": "valentin.gosu@gmail.com", "count": 14, "is_private": false, "tags": [], "bug_id": 1642723, "raw_text": "(In reply to Julien Cristau [:jcristau] from comment #13)\n> Valentin can you get to this review today?\n\nThe patch for release was already r+\nI just did the other patches too.", "time": "2020-06-04T15:47:36Z", "id": 14863126, "text": "(In reply to Julien Cristau [:jcristau] from comment #13)\n> Valentin can you get to this review today?\n\nThe patch for release was already r+\nI just did the other patches too.", "creation_time": "2020-06-04T15:47:36Z", "attachment_id": null, "creator": "valentin.gosu@gmail.com"}, {"creation_time": "2020-06-04T16:02:53Z", "creator": "nhnt11@gmail.com", "attachment_id": 9153936, "text": "Comment on attachment 9153936\nBug 1642723 - Pref-off automatic TRR-selection by default (back-port from mozilla-release). r=valentin!,johannh\n\n### Beta/Release Uplift Approval Request\n* **User impact if declined**: Automatic TRR selection code can trigger a bug that can cause the client to DoS proxies, DoH providers, etc. in some scenarios. (Also, this patch is necessary to maintain compatibility across releases - it already landed in m-r)\n* **Is this code covered by automated tests?**: Yes\n* **Has the fix been verified in Nightly?**: No\n* **Needs manual test from QE?**: No\n* **If yes, steps to reproduce**: I would say no because this has already been QA'd and dot-released in 77.0.1 and this patch simply back-ports to Nightly and Beta.\n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: Already QA'd and dot-released in 77.0.1\n* **String changes made/needed**: none", "id": 14863183, "raw_text": "### Beta/Release Uplift Approval Request\n* **User impact if declined**: Automatic TRR selection code can trigger a bug that can cause the client to DoS proxies, DoH providers, etc. in some scenarios. (Also, this patch is necessary to maintain compatibility across releases - it already landed in m-r)\n* **Is this code covered by automated tests?**: Yes\n* **Has the fix been verified in Nightly?**: No\n* **Needs manual test from QE?**: No\n* **If yes, steps to reproduce**: I would say no because this has already been QA'd and dot-released in 77.0.1 and this patch simply back-ports to Nightly and Beta.\n* **List of other uplifts needed**: None\n* **Risk to taking this patch**: Low\n* **Why is the change risky/not risky? (and alternatives if risky)**: Already QA'd and dot-released in 77.0.1\n* **String changes made/needed**: none", "time": "2020-06-04T16:02:53Z", "author": "nhnt11@gmail.com", "bug_id": 1642723, "tags": [], "is_private": false, "count": 15}, {"author": "pulsebot@bots.tld", "count": 16, "is_private": false, "bug_id": 1642723, "tags": [], "raw_text": "Pushed by nhnt11@gmail.com:\nhttps://hg.mozilla.org/integration/autoland/rev/0fd2e1828e89\nPref-off automatic TRR-selection by default (back-port from mozilla-release). r=valentin\nhttps://hg.mozilla.org/integration/autoland/rev/2a72043f1fca\nAlso check doh-rollout.uri in browser_trrSelection_disable.js test. r=valentin", "time": "2020-06-04T16:03:41Z", "id": 14863185, "text": "Pushed by nhnt11@gmail.com:\nhttps://hg.mozilla.org/integration/autoland/rev/0fd2e1828e89\nPref-off automatic TRR-selection by default (back-port from mozilla-release). r=valentin\nhttps://hg.mozilla.org/integration/autoland/rev/2a72043f1fca\nAlso check doh-rollout.uri in browser_trrSelection_disable.js test. r=valentin", "creation_time": "2020-06-04T16:03:41Z", "creator": "pulsebot@bots.tld", "attachment_id": null}, {"creator": "jcristau@mozilla.com", "attachment_id": 9153936, "creation_time": "2020-06-04T16:25:11Z", "text": "Comment on attachment 9153936\nBug 1642723 - Pref-off automatic TRR-selection by default (back-port from mozilla-release). r=valentin!,johannh\n\nthis is already in 77.0.1, approved for 78.0b3", "id": 14863277, "time": "2020-06-04T16:25:11Z", "raw_text": "this is already in 77.0.1, approved for 78.0b3", "tags": [], "bug_id": 1642723, "is_private": false, "count": 17, "author": "jcristau@mozilla.com"}, {"raw_text": "https://hg.mozilla.org/releases/mozilla-beta/rev/a6f31328e670\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/a496c7db9cee", "creation_time": "2020-06-04T18:49:37Z", "time": "2020-06-04T18:49:37Z", "attachment_id": null, "creator": "ryanvm@gmail.com", "author": "ryanvm@gmail.com", "id": 14863640, "text": "https://hg.mozilla.org/releases/mozilla-beta/rev/a6f31328e670\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/a496c7db9cee", "bug_id": 1642723, "tags": ["bugherder", "uplift"], "count": 18, "is_private": false}, {"author": "ncsoregi@mozilla.com", "bug_id": 1642723, "tags": ["bugherder"], "is_private": false, "count": 19, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/0fd2e1828e89\nhttps://hg.mozilla.org/mozilla-central/rev/2a72043f1fca", "time": "2020-06-04T22:02:37Z", "text": "https://hg.mozilla.org/mozilla-central/rev/0fd2e1828e89\nhttps://hg.mozilla.org/mozilla-central/rev/2a72043f1fca", "id": 14864110, "creation_time": "2020-06-04T22:02:37Z", "creator": "ncsoregi@mozilla.com", "attachment_id": null}]}}}