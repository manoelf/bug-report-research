{"bugs": {"1643149": {"comments": [{"is_private": false, "text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0\n\nSteps to reproduce:\n\nOpen a new window.\n\n\nActual results:\n\nFirefox stopped to respond to commands and sometimes there are rendering glitches.\n\nI run mozregression first with a new profile and then with webrender enabled but nothing was wrong. I tried it with my usual profile and the problematic commit is this one: https://hg.mozilla.org/integration/autoland/rev/9b17e776c11765d83ef5f1b0a6288a0c688cd1e1.\n\nRight I know I can't try other flags but I still want to help. What is the best way to share my config?", "raw_text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0\n\nSteps to reproduce:\n\nOpen a new window.\n\n\nActual results:\n\nFirefox stopped to respond to commands and sometimes there are rendering glitches.\n\nI run mozregression first with a new profile and then with webrender enabled but nothing was wrong. I tried it with my usual profile and the problematic commit is this one: https://hg.mozilla.org/integration/autoland/rev/9b17e776c11765d83ef5f1b0a6288a0c688cd1e1.\n\nRight I know I can't try other flags but I still want to help. What is the best way to share my config?", "creation_time": "2020-06-03T20:38:26Z", "id": 14861501, "author": "dm@mssdvd.com", "creator": "dm@mssdvd.com", "tags": [], "bug_id": 1643149, "count": 0, "time": "2020-06-03T20:38:26Z", "attachment_id": null}, {"creator": "dm@mssdvd.com", "creation_time": "2020-06-03T20:40:10Z", "time": "2020-06-03T20:40:10Z", "count": 1, "tags": [], "author": "dm@mssdvd.com", "id": 14861503, "raw_text": "I use sway on Arch Linux.", "text": "I use sway on Arch Linux.", "is_private": false, "attachment_id": null, "bug_id": 1643149}, {"creation_time": "2020-06-03T20:46:36Z", "creator": "dm@mssdvd.com", "tags": [], "count": 2, "time": "2020-06-03T20:46:36Z", "is_private": false, "text": "Created attachment 9153967\nabout:support dump (from a previous working build)", "raw_text": "", "id": 14861509, "author": "dm@mssdvd.com", "bug_id": 1643149, "attachment_id": 9153967}, {"time": "2020-06-03T20:57:20Z", "tags": [], "count": 3, "creation_time": "2020-06-03T20:57:20Z", "creator": "dm@mssdvd.com", "attachment_id": null, "bug_id": 1643149, "id": 14861537, "author": "dm@mssdvd.com", "is_private": false, "raw_text": "I noticed that Webrender is now disabled by default, I enabled it with gfx.webrender.all=true and the issue now is gone. I also tried to disable/enable widget.wayland-dmabuf-vaapi.enabled and widget.wayland-dmabuf-webgl.enabled but they don't have any effect on the issue.", "text": "I noticed that Webrender is now disabled by default, I enabled it with gfx.webrender.all=true and the issue now is gone. I also tried to disable/enable widget.wayland-dmabuf-vaapi.enabled and widget.wayland-dmabuf-webgl.enabled but they don't have any effect on the issue."}, {"time": "2020-06-03T21:17:49Z", "count": 4, "tags": [], "creator": "release-mgmt-account-bot@mozilla.tld", "creation_time": "2020-06-03T21:17:49Z", "attachment_id": null, "bug_id": 1643149, "author": "release-mgmt-account-bot@mozilla.tld", "id": 14861593, "text": "[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.", "raw_text": "[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.", "is_private": false}, {"tags": [], "bug_id": 1643149, "count": 5, "time": "2020-06-04T01:52:02Z", "attachment_id": null, "is_private": false, "raw_text": "(In reply to d.masserut from comment #3)\n> I noticed that Webrender is now disabled by default, I enabled it with gfx.webrender.all=true and the issue now is gone. \n\n0x5917 is [whitelisted](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxDriverInfo.cpp#612) and WebRender is [enabled by default](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxInfoX11.cpp#516) on Nightly with Mesa 18+ if your screen size is at maximum [4953600 pixels](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxInfoBase.cpp#813).\n\nWhat is your screen size?", "text": "(In reply to d.masserut from comment #3)\n> I noticed that Webrender is now disabled by default, I enabled it with gfx.webrender.all=true and the issue now is gone. \n\n0x5917 is [whitelisted](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxDriverInfo.cpp#612) and WebRender is [enabled by default](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxInfoX11.cpp#516) on Nightly with Mesa 18+ if your screen size is at maximum [4953600 pixels](https://searchfox.org/mozilla-central/rev/7cadba1d8b8feaec4615f5bb98aac4b8a719793c/widget/GfxInfoBase.cpp#813).\n\nWhat is your screen size?", "creation_time": "2020-06-04T01:52:02Z", "id": 14861963, "author": "jan@ikenmeyer.eu", "creator": "jan@ikenmeyer.eu"}, {"is_private": false, "raw_text": "Thanks, I'll look at it asap.", "text": "Thanks, I'll look at it asap.", "author": "stransky@redhat.com", "id": 14862172, "bug_id": 1643149, "attachment_id": null, "creation_time": "2020-06-04T06:14:05Z", "creator": "stransky@redhat.com", "tags": [], "count": 6, "time": "2020-06-04T06:14:05Z"}, {"author": "bugzilla@kl.wtf", "id": 14862474, "is_private": false, "text": "Appears to just be an accidental inverted check in `InhibitWaylandIdle`.\n\n```\nbool WakeLockTopic::InhibitWaylandIdle() {\n  // ...\n  MozContainer* container = focusedWindow->GetMozContainer();\n  wl_surface* waylandSurface = moz_container_wayland_surface_lock(container);\n  /* The check below is wrong */\n  if (!waylandSurface) {\n    mWaylandInhibitor = zwp_idle_inhibit_manager_v1_create_inhibitor(\n        waylandDisplay->GetIdleInhibitManager(), waylandSurface);\n    moz_container_wayland_surface_unlock(container);\n  }\n  return true;\n}\n```", "raw_text": "Appears to just be an accidental inverted check in `InhibitWaylandIdle`.\n\n```\nbool WakeLockTopic::InhibitWaylandIdle() {\n  // ...\n  MozContainer* container = focusedWindow->GetMozContainer();\n  wl_surface* waylandSurface = moz_container_wayland_surface_lock(container);\n  /* The check below is wrong */\n  if (!waylandSurface) {\n    mWaylandInhibitor = zwp_idle_inhibit_manager_v1_create_inhibitor(\n        waylandDisplay->GetIdleInhibitManager(), waylandSurface);\n    moz_container_wayland_surface_unlock(container);\n  }\n  return true;\n}\n```", "attachment_id": null, "bug_id": 1643149, "creation_time": "2020-06-04T10:48:36Z", "creator": "bugzilla@kl.wtf", "time": "2020-06-04T10:48:36Z", "tags": [], "count": 7}, {"bug_id": 1643149, "attachment_id": null, "raw_text": "I see thanks. There's another bug in mozcontainer where the lock it's release.", "text": "I see thanks. There's another bug in mozcontainer where the lock it's release.", "is_private": false, "id": 14862481, "author": "stransky@redhat.com", "count": 8, "tags": [], "time": "2020-06-04T10:54:48Z", "creator": "stransky@redhat.com", "creation_time": "2020-06-04T10:54:48Z"}, {"creation_time": "2020-06-04T13:34:45Z", "creator": "stransky@redhat.com", "time": "2020-06-04T13:34:45Z", "tags": [], "count": 9, "id": 14862799, "author": "stransky@redhat.com", "is_private": false, "text": "Created attachment 9154180\nBug 1643149 [Wayland] Fix MozContainer deadlock, r?jhorak", "raw_text": "", "attachment_id": 9154180, "bug_id": 1643149}, {"time": "2020-06-04T13:58:43Z", "count": 10, "tags": [], "creator": "pulsebot@bots.tld", "creation_time": "2020-06-04T13:58:43Z", "attachment_id": null, "bug_id": 1643149, "author": "pulsebot@bots.tld", "id": 14862842, "raw_text": "Pushed by abutkovits@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/827d6e47acfc\n[Wayland] Fix MozContainer deadlock, r=jhorak", "text": "Pushed by abutkovits@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/827d6e47acfc\n[Wayland] Fix MozContainer deadlock, r=jhorak", "is_private": false}, {"bug_id": 1643149, "attachment_id": null, "raw_text": "", "text": "*** Bug 1643364 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 14863690, "author": "jan@ikenmeyer.eu", "count": 11, "tags": [], "time": "2020-06-04T19:10:33Z", "creator": "jan@ikenmeyer.eu", "creation_time": "2020-06-04T19:10:33Z"}, {"time": "2020-06-04T19:12:51Z", "count": 12, "tags": [], "creator": "jan@ikenmeyer.eu", "creation_time": "2020-06-04T19:12:51Z", "attachment_id": null, "bug_id": 1643149, "id": 14863694, "author": "jan@ikenmeyer.eu", "raw_text": "", "text": "*** Bug 1643407 has been marked as a duplicate of this bug. ***", "is_private": false}, {"author": "ncsoregi@mozilla.com", "creation_time": "2020-06-04T22:02:53Z", "id": 14864116, "creator": "ncsoregi@mozilla.com", "is_private": false, "text": "https://hg.mozilla.org/mozilla-central/rev/827d6e47acfc", "raw_text": "https://hg.mozilla.org/mozilla-central/rev/827d6e47acfc", "attachment_id": null, "time": "2020-06-04T22:02:53Z", "tags": ["bugherder"], "bug_id": 1643149, "count": 13}]}}, "comments": {}}