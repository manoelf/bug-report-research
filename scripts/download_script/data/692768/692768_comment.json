{"comments": {}, "bugs": {"692768": {"comments": [{"creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org", "tags": [], "is_private": false, "count": 0, "id": 5766313, "bug_id": 692768, "raw_text": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:7.0.1) Gecko/20110928 Firefox/7.0.1 SeaMonkey/2.4.1\nBuild ID: 20110928161145\n\nSteps to reproduce:\n\nIMAP account connected to UW IMAPd version 2007f (most recent version)\nComposing a new message and taking longer than the auto-save interval.\nSending message after it has been auto-saved at least once.\n\n\nActual results:\n\nA copy of the message remains in the Drafts folder after sending it.\n\n\nExpected results:\n\nThe copy in Drafts should be deleted.\n\nIt works OK with UW IMAPd version 2004c and 2006c  (tested).\nThere appears to be a change after 2006c that causes this behaviour.\nThere is nothing particular with the saved Draft, it is unread and it can be manually deleted without problem.", "creation_time": "2011-10-07T13:34:32Z", "text": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:7.0.1) Gecko/20110928 Firefox/7.0.1 SeaMonkey/2.4.1\nBuild ID: 20110928161145\n\nSteps to reproduce:\n\nIMAP account connected to UW IMAPd version 2007f (most recent version)\nComposing a new message and taking longer than the auto-save interval.\nSending message after it has been auto-saved at least once.\n\n\nActual results:\n\nA copy of the message remains in the Drafts folder after sending it.\n\n\nExpected results:\n\nThe copy in Drafts should be deleted.\n\nIt works OK with UW IMAPd version 2004c and 2006c  (tested).\nThere appears to be a change after 2006c that causes this behaviour.\nThere is nothing particular with the saved Draft, it is unread and it can be manually deleted without problem.", "time": "2011-10-07T13:34:32Z", "attachment_id": null}, {"tags": [], "count": 1, "is_private": false, "id": 5768779, "bug_id": 692768, "raw_text": "Do you see multiple versions of draft mails by next?\n 1. Disable auto-save\n 2. Compose a very small mail with no attachment\n 3. Execute \"Save\", click other than Drafts, click Drafts again\n 4. Do step 3 multiple times\n\nIf only single draft is always kept by step 3/step 4, problem is possibly next;\n  Contention between auto-save and mail send.\n  There are known two issues.\n  - Auto-save is scheduled while mail sending is in progress\n  - Mail send is scheduled while auto-save is in progress\n  In this case, one of next can happen;\n  - last version by auto-save is not removed, because mail sending\n    doesn't know last version generated by auto-save. \n  - delete of previous or final version by auto-save and/or mail send may fail\n    due to contention. If auto-save generates last version, two copy may remain.\n\nIf UW-IMAP 2007 only issue, possibly CONDSTORE relevant Tb's problem, if CONDSTORE is supported from, or enabled by default from, UW-IMAP 2007.\nIt may be relevant to UIDPLUS. Some servers don't return UIDPLUS in capability response but return response by UIDPLUS to append command. In this case, some of them don't support \"search for specific message-id header\" which Tb uses to find previous draft when UIDPLUS is not supported.  \n\nDoes Tb request \"uid xxx store flags \\Deleted\" to previous version of draft when new version of draft is saved?", "creation_time": "2011-10-08T03:10:03Z", "text": "Do you see multiple versions of draft mails by next?\n 1. Disable auto-save\n 2. Compose a very small mail with no attachment\n 3. Execute \"Save\", click other than Drafts, click Drafts again\n 4. Do step 3 multiple times\n\nIf only single draft is always kept by step 3/step 4, problem is possibly next;\n  Contention between auto-save and mail send.\n  There are known two issues.\n  - Auto-save is scheduled while mail sending is in progress\n  - Mail send is scheduled while auto-save is in progress\n  In this case, one of next can happen;\n  - last version by auto-save is not removed, because mail sending\n    doesn't know last version generated by auto-save. \n  - delete of previous or final version by auto-save and/or mail send may fail\n    due to contention. If auto-save generates last version, two copy may remain.\n\nIf UW-IMAP 2007 only issue, possibly CONDSTORE relevant Tb's problem, if CONDSTORE is supported from, or enabled by default from, UW-IMAP 2007.\nIt may be relevant to UIDPLUS. Some servers don't return UIDPLUS in capability response but return response by UIDPLUS to append command. In this case, some of them don't support \"search for specific message-id header\" which Tb uses to find previous draft when UIDPLUS is not supported.  \n\nDoes Tb request \"uid xxx store flags \\Deleted\" to previous version of draft when new version of draft is saved?", "attachment_id": null, "time": "2011-10-08T03:10:03Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"raw_text": "There is no timing aspect in the problem.\n(i.e. it happens every time, after the auto-save has been done at least once)\nI have set a 15 minute auto-save interval so it is very apparent that no auto-save is\nin progress.  I start compose mode with a 1-line message, wait until it auto-saves\n(1 unread message present in Drafts folder) then hit send at least 10 seconds later and the\ncopy in Drafts remains there.\nWhen the compose is left open for more than the drafts interval, only a single copy\nof the mail is kept (auto-save mails do not accumulate).", "creation_time": "2011-10-08T08:32:43Z", "text": "There is no timing aspect in the problem.\n(i.e. it happens every time, after the auto-save has been done at least once)\nI have set a 15 minute auto-save interval so it is very apparent that no auto-save is\nin progress.  I start compose mode with a 1-line message, wait until it auto-saves\n(1 unread message present in Drafts folder) then hit send at least 10 seconds later and the\ncopy in Drafts remains there.\nWhen the compose is left open for more than the drafts interval, only a single copy\nof the mail is kept (auto-save mails do not accumulate).", "attachment_id": null, "time": "2011-10-08T08:32:43Z", "tags": [], "count": 2, "is_private": false, "id": 5768998, "bug_id": 692768, "creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org"}, {"text": "(In reply to Rob Janssen from comment #2)\n> When the compose is left open for more than the drafts interval,\n> only a single copy of the mail is kept (auto-save mails do not accumulate).\n\nIf mail is not altered since last auto-save(first auto-save in your case), next auto-save is not scheduled. Is this case? Or you modified composing mail after first auto-save?\n\nBecause your auto-save interval is 15 minutes, you can do manual \"Save\" multiple times during first 15 minute after start of composition without auto-save. Itentional/explicit \"Save\" doesn't require modification of mail, but change suffix of subject, like test-001 to test-002, to see latest content of saved draft mail.\n\nDo you see multiple mails in Drafts by multiple manual \"Save\" within 15 minute?\nIf yes, can you get IMAP log for it? (timestamp,imap:5)\nIf no, can you get IMAP & SMTP log for next? (timestamp,imap:5,smtp:5)\n  Compose a mail, wait for first auto-save,\n  send mail after 10 seconds or more after the first auto-save.", "time": "2011-10-08T10:08:30Z", "attachment_id": null, "raw_text": "(In reply to Rob Janssen from comment #2)\n> When the compose is left open for more than the drafts interval,\n> only a single copy of the mail is kept (auto-save mails do not accumulate).\n\nIf mail is not altered since last auto-save(first auto-save in your case), next auto-save is not scheduled. Is this case? Or you modified composing mail after first auto-save?\n\nBecause your auto-save interval is 15 minutes, you can do manual \"Save\" multiple times during first 15 minute after start of composition without auto-save. Itentional/explicit \"Save\" doesn't require modification of mail, but change suffix of subject, like test-001 to test-002, to see latest content of saved draft mail.\n\nDo you see multiple mails in Drafts by multiple manual \"Save\" within 15 minute?\nIf yes, can you get IMAP log for it? (timestamp,imap:5)\nIf no, can you get IMAP & SMTP log for next? (timestamp,imap:5,smtp:5)\n  Compose a mail, wait for first auto-save,\n  send mail after 10 seconds or more after the first auto-save.", "creation_time": "2011-10-08T10:08:30Z", "bug_id": 692768, "count": 3, "is_private": false, "tags": [], "id": 5769040, "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"text": "Created attachment 565791\nLog of manual save with UW IMAPd 2007f", "attachment_id": 565791, "time": "2011-10-09T11:18:52Z", "raw_text": "", "creation_time": "2011-10-09T11:18:52Z", "bug_id": 692768, "tags": [], "is_private": false, "count": 4, "id": 5769874, "creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org"}, {"creation_time": "2011-10-09T11:20:34Z", "raw_text": "", "text": "Created attachment 565792\nLog of manual save with UW IMAPd 2004c", "time": "2011-10-09T11:20:34Z", "attachment_id": 565792, "is_private": false, "count": 5, "tags": [], "id": 5769875, "bug_id": 692768, "creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org"}, {"creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org", "creation_time": "2011-10-09T11:24:34Z", "raw_text": "(In reply to WADA from comment #3)\n\n> Do you see multiple mails in Drafts by multiple manual \"Save\" within 15\n> minute?\n> If yes, can you get IMAP log for it? (timestamp,imap:5)\n\nYes.  When I do multiple saves of the message, no matter if I change the subject or\nnot, I see two copies of the saved message in Drafts.\nInterestingly, there always are two copies also when I have saved the third one.  It\ndeletes the oldest one and puts a new one.\n\nBut when using imapd 2004c, I see only a single copy of the message, also when changing\nthe subject.\n\nI have uploaded 2 logfiles of those tests, hopefully you can see what is going wrong.", "text": "(In reply to WADA from comment #3)\n\n> Do you see multiple mails in Drafts by multiple manual \"Save\" within 15\n> minute?\n> If yes, can you get IMAP log for it? (timestamp,imap:5)\n\nYes.  When I do multiple saves of the message, no matter if I change the subject or\nnot, I see two copies of the saved message in Drafts.\nInterestingly, there always are two copies also when I have saved the third one.  It\ndeletes the oldest one and puts a new one.\n\nBut when using imapd 2004c, I see only a single copy of the message, also when changing\nthe subject.\n\nI have uploaded 2 logfiles of those tests, hopefully you can see what is going wrong.", "time": "2011-10-09T11:24:34Z", "attachment_id": null, "is_private": false, "count": 6, "tags": [], "id": 5769877, "bug_id": 692768}, {"author": "m-wada@usa.com", "creator": "m-wada@usa.com", "bug_id": 692768, "id": 5773481, "tags": [], "count": 7, "is_private": false, "time": "2011-10-11T02:28:06Z", "attachment_id": null, "text": "(In reply to Rob Janssen from comment #4)\n> Log of manual save with UW IMAPd 2007f\n\n(A) UIDPLUS, APPENDUID is enabled \n> 2 OK [CAPABILITY IMAP4REV1 I18NLEVEL=1 LITERAL+ IDLE UIDPLUS NAMESPACE CHILDREN MAILBOX-REFERRALS BINARY UNSELECT ESEARCH WITHIN SCAN SORT THREAD=REFERENCES THREAD=ORDEREDSUBJECT MULTIAPPEND] User h.mulder authenticated\n(B) UID=9, UID=10 in Mail/Drafts\n> 3 select \"Mail/Drafts\"\n> * OK [UIDNEXT 11] Predicted next UID\n> 3 OK [READ-WRITE] SELECT completed\n> 4 UID fetch 1:* (FLAGS)\n> * 1 FETCH (UID 9 FLAGS (\\Draft))\n> * 2 FETCH (UID 10 FLAGS (\\Draft))\n> 4 OK UID FETCH completed\n(C) First draft save(UID=11). UID is not returned from server.\n> 5 append \"Mail/Drafts\" (\\Draft) {2253+}\n> 5 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(D) Second draft save(UID=12). UID is not returned from server.\n> 11 append \"Mail/Drafts\" (\\Draft) {2255+}\n> 11 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(E) Tb requests delete of UID=10, instead of expected UID=11.\n> 13 uid store 10 +Flags (\\Seen \\Deleted)\n> 13 OK UID STORE completed\n\nIs your UW IMAPd 2007f configured properly?\n\nTb looks confused by bad \"OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\".\nTb is better not to request delete when UID is not returned correctly.", "raw_text": "(In reply to Rob Janssen from comment #4)\n> Log of manual save with UW IMAPd 2007f\n\n(A) UIDPLUS, APPENDUID is enabled \n> 2 OK [CAPABILITY IMAP4REV1 I18NLEVEL=1 LITERAL+ IDLE UIDPLUS NAMESPACE CHILDREN MAILBOX-REFERRALS BINARY UNSELECT ESEARCH WITHIN SCAN SORT THREAD=REFERENCES THREAD=ORDEREDSUBJECT MULTIAPPEND] User h.mulder authenticated\n(B) UID=9, UID=10 in Mail/Drafts\n> 3 select \"Mail/Drafts\"\n> * OK [UIDNEXT 11] Predicted next UID\n> 3 OK [READ-WRITE] SELECT completed\n> 4 UID fetch 1:* (FLAGS)\n> * 1 FETCH (UID 9 FLAGS (\\Draft))\n> * 2 FETCH (UID 10 FLAGS (\\Draft))\n> 4 OK UID FETCH completed\n(C) First draft save(UID=11). UID is not returned from server.\n> 5 append \"Mail/Drafts\" (\\Draft) {2253+}\n> 5 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(D) Second draft save(UID=12). UID is not returned from server.\n> 11 append \"Mail/Drafts\" (\\Draft) {2255+}\n> 11 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(E) Tb requests delete of UID=10, instead of expected UID=11.\n> 13 uid store 10 +Flags (\\Seen \\Deleted)\n> 13 OK UID STORE completed\n\nIs your UW IMAPd 2007f configured properly?\n\nTb looks confused by bad \"OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\".\nTb is better not to request delete when UID is not returned correctly.", "creation_time": "2011-10-11T02:28:06Z"}, {"id": 5773792, "is_private": false, "count": 8, "tags": [], "bug_id": 692768, "raw_text": "(In reply to WADA from comment #7)\n\n> Is your UW IMAPd 2007f configured properly?\n\nThe creator of UW IMAPd does not believe in configuration.\nThe documentation insists all the time that there is no configuration file to be used\noutside UW and that the /etc/c-client.cf file that is read should not be used and serves\nno useful purpose.\n\nSo I don't use it.  The IMAPd is just running as compiled by default (with make lnp, i.e.\nlinux OS with PAM authentication)", "creation_time": "2011-10-11T07:54:00Z", "time": "2011-10-11T07:54:00Z", "attachment_id": null, "text": "(In reply to WADA from comment #7)\n\n> Is your UW IMAPd 2007f configured properly?\n\nThe creator of UW IMAPd does not believe in configuration.\nThe documentation insists all the time that there is no configuration file to be used\noutside UW and that the /etc/c-client.cf file that is read should not be used and serves\nno useful purpose.\n\nSo I don't use it.  The IMAPd is just running as compiled by default (with make lnp, i.e.\nlinux OS with PAM authentication)", "author": "pe1chl@amsat.org", "creator": "pe1chl@amsat.org"}, {"text": "FYI.\n\n(C) First draft save(UID=11). UID is not returned from server.\n> 5 append \"Mail/Drafts\" (\\Draft) {2253+}\n> 5 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(D) Second draft save(UID=12). UID is not returned from server.\n> 11 append \"Mail/Drafts\" (\\Draft) {2255+}\n> 11 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n\nEven if server correctly returns \"NO\" to append, Tb probably goes ahead to \"uid xxx store flas \\Deleted\" step when \"append new draft + delete old draft\" case, as done in \"append detach'ed mail + delete original mail\" case(Bug 693353).\nIf you can see such problem, post comment to that bug or open separate bug for \"NO to append of new draft\" case, please.", "creator": "m-wada@usa.com", "time": "2012-01-17T00:59:48Z", "attachment_id": null, "author": "m-wada@usa.com", "raw_text": "FYI.\n\n(C) First draft save(UID=11). UID is not returned from server.\n> 5 append \"Mail/Drafts\" (\\Draft) {2253+}\n> 5 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n(D) Second draft save(UID=12). UID is not returned from server.\n> 11 append \"Mail/Drafts\" (\\Draft) {2255+}\n> 11 OK Unable to re-open mailbox for APPENDUID: Mail/Drafts\n\nEven if server correctly returns \"NO\" to append, Tb probably goes ahead to \"uid xxx store flas \\Deleted\" step when \"append new draft + delete old draft\" case, as done in \"append detach'ed mail + delete original mail\" case(Bug 693353).\nIf you can see such problem, post comment to that bug or open separate bug for \"NO to append of new draft\" case, please.", "creation_time": "2012-01-17T00:59:48Z", "bug_id": 692768, "is_private": false, "count": 9, "tags": [], "id": 5984065}, {"creator": "pe1chl@amsat.org", "author": "pe1chl@amsat.org", "creation_time": "2014-03-19T09:56:46Z", "raw_text": "I updated my home system to openSUSE 13.1 with UW IMAPD 2007e and SeaMonkey 2.24 (Linux) as\ndistributed, and now I have the same problem on that system.", "text": "I updated my home system to openSUSE 13.1 with UW IMAPD 2007e and SeaMonkey 2.24 (Linux) as\ndistributed, and now I have the same problem on that system.", "attachment_id": null, "time": "2014-03-19T09:56:46Z", "tags": [], "is_private": false, "count": 10, "id": 8551610, "bug_id": 692768}, {"creation_time": "2016-01-30T16:39:06Z", "raw_text": "If I understand correctly, you are now on Thundrebird.\nDo you see the same problem when using a current version of Thunderbird?", "attachment_id": null, "time": "2016-01-30T16:39:06Z", "text": "If I understand correctly, you are now on Thundrebird.\nDo you see the same problem when using a current version of Thunderbird?", "id": 11122644, "tags": [], "is_private": false, "count": 11, "bug_id": 692768, "author": "vseerror@lehigh.edu", "creator": "vseerror@lehigh.edu"}, {"author": "pe1chl@amsat.org", "creator": "pe1chl@amsat.org", "time": "2016-01-30T16:43:20Z", "attachment_id": null, "text": "No, at home I still use Seamonkey and this problem still occurs on 2.39", "creation_time": "2016-01-30T16:43:20Z", "raw_text": "No, at home I still use Seamonkey and this problem still occurs on 2.39", "bug_id": 692768, "id": 11122648, "is_private": false, "count": 12, "tags": []}]}}}