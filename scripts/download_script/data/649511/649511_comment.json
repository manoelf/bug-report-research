{"bugs": {"649511": {"comments": [{"creation_time": "2011-04-12T22:27:27Z", "text": "The current message-passing API for message manager is:\n\naddMessageListener(name, func)\n\nfunc(cx) {\n  cx {\n    name: \"\",\n    sync: bool,\n    json: data\n  }\n}\n\nThis serializes/deserializes using JSON.\n\nThe message-passing API for jetpack processes is a little bit cleaner, and also supports handles, but the impl is a mess of custom JS code:\n\nregisterReceiver(name, func)\n\nfunc(name, data...)\n\nWe want to switch to the jetpack-style API. We can do this while maintaining the old addMessageListener API (at least for a while). We also want to implement handles almost exactly as they are implemented in jetpack.\n\ngal says that we should be using the JS structured-clone API to implement this, because it's right and just. I'm going to take a stab at this, with assistance as necessary.\n\nIt may also be necessary to clean up error handling code along the way, because there are still places where we don't check JSAPI return codes and errors therefore never get reported to the console.", "id": 5405028, "raw_text": "The current message-passing API for message manager is:\n\naddMessageListener(name, func)\n\nfunc(cx) {\n  cx {\n    name: \"\",\n    sync: bool,\n    json: data\n  }\n}\n\nThis serializes/deserializes using JSON.\n\nThe message-passing API for jetpack processes is a little bit cleaner, and also supports handles, but the impl is a mess of custom JS code:\n\nregisterReceiver(name, func)\n\nfunc(name, data...)\n\nWe want to switch to the jetpack-style API. We can do this while maintaining the old addMessageListener API (at least for a while). We also want to implement handles almost exactly as they are implemented in jetpack.\n\ngal says that we should be using the JS structured-clone API to implement this, because it's right and just. I'm going to take a stab at this, with assistance as necessary.\n\nIt may also be necessary to clean up error handling code along the way, because there are still places where we don't check JSAPI return codes and errors therefore never get reported to the console.", "tags": [], "creator": "benjamin@smedbergs.us", "count": 0, "bug_id": 649511, "author": "benjamin@smedbergs.us", "is_private": false, "time": "2011-04-12T22:27:27Z", "attachment_id": null}, {"attachment_id": null, "author": "josh@joshmatthews.net", "count": 1, "creator": "josh@joshmatthews.net", "tags": [], "time": "2011-04-12T23:40:14Z", "bug_id": 649511, "creation_time": "2011-04-12T23:40:14Z", "is_private": false, "text": "*** Bug 572685 has been marked as a duplicate of this bug. ***", "id": 5405189, "raw_text": ""}]}}, "comments": {}}