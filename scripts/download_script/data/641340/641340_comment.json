{"bugs": {"641340": {"comments": [{"is_private": false, "time": "2011-03-13T17:31:07Z", "attachment_id": null, "creation_time": "2011-03-13T17:31:07Z", "text": "On my mac, 50% of the total time is reflow (the rest is painting).\n\nAlmost half of reflow is in nsFloatManager::GetFlowArea, called from nsBlockFrame::AddFloat, called from nsLineLayout::ReflowFrame.\n\nPresumably this is actually the GetFloatAvailableSpace calls AddFloat makes being inlined (including both overloads of GetFloatAvailableSpace and the GetFloatAvailableSpaceWithState call).\n\nI'm guessing we're ending up with an O(N^2) algorithm here, right?", "id": 5341932, "raw_text": "On my mac, 50% of the total time is reflow (the rest is painting).\n\nAlmost half of reflow is in nsFloatManager::GetFlowArea, called from nsBlockFrame::AddFloat, called from nsLineLayout::ReflowFrame.\n\nPresumably this is actually the GetFloatAvailableSpace calls AddFloat makes being inlined (including both overloads of GetFloatAvailableSpace and the GetFloatAvailableSpaceWithState call).\n\nI'm guessing we're ending up with an O(N^2) algorithm here, right?", "count": 0, "tags": [], "creator": "bzbarsky@mit.edu", "bug_id": 641340, "author": "bzbarsky@mit.edu"}, {"author": "bzbarsky@mit.edu", "attachment_id": null, "bug_id": 641340, "tags": [], "time": "2011-03-13T19:18:53Z", "count": 1, "creator": "bzbarsky@mit.edu", "raw_text": "One other note.  The reason we do float reflow at all is that each cell of the maze is a float.  Each cell also has an empty div kid.  When marking a cell for the first time, the script changes the style of the cell's div kid.\n\nThat said, it's only changing the visibility and background styles; why the heck is this triggering reflow?", "id": 5342047, "text": "One other note.  The reason we do float reflow at all is that each cell of the maze is a float.  Each cell also has an empty div kid.  When marking a cell for the first time, the script changes the style of the cell's div kid.\n\nThat said, it's only changing the visibility and background styles; why the heck is this triggering reflow?", "is_private": false, "creation_time": "2011-03-13T19:18:53Z"}, {"attachment_id": null, "author": "bzbarsky@mit.edu", "is_private": false, "creation_time": "2011-03-13T19:47:58Z", "text": "Oh, this is semi-ridiculous.\n\n1)  There is nothing in-flow inside that maze: just floated borders and abs pos\n    markers.\n2)  They handle positioning the (absolutely positioned, natch) markers by setting\n    their transform from no transform to a translate transform.  For us that\n    means reframing, of course.  And they do this one marker at a time, when they\n    change the marker's color.\n\nSo we end up reframing the marker, and hence reflowing the whole maze.\n\nAlso, changing transform-origin would force reflow of the marker no matter what.\n\nOf course since the marker is abs pos reframing it, or reflowing it, absolutely can't change the position of _anything_ else on the page.  So it seems like the right optimization here would be for that case...  Can we manage that?", "id": 5342070, "raw_text": "Oh, this is semi-ridiculous.\n\n1)  There is nothing in-flow inside that maze: just floated borders and abs pos\n    markers.\n2)  They handle positioning the (absolutely positioned, natch) markers by setting\n    their transform from no transform to a translate transform.  For us that\n    means reframing, of course.  And they do this one marker at a time, when they\n    change the marker's color.\n\nSo we end up reframing the marker, and hence reflowing the whole maze.\n\nAlso, changing transform-origin would force reflow of the marker no matter what.\n\nOf course since the marker is abs pos reframing it, or reflowing it, absolutely can't change the position of _anything_ else on the page.  So it seems like the right optimization here would be for that case...  Can we manage that?", "count": 2, "time": "2011-03-13T19:47:58Z", "tags": [], "creator": "bzbarsky@mit.edu", "bug_id": 641340}, {"bug_id": 641340, "tags": [], "creator": "dbaron@dbaron.org", "count": 3, "raw_text": "(In reply to comment #2)\n> Of course since the marker is abs pos reframing it, or reflowing it, absolutely\n> can't change the position of _anything_ else on the page.  So it seems like the\n> right optimization here would be for that case...  Can we manage that?\n\nExcept abs pos elements can change scrollable overflow area, and we currently only change overflow areas during reflow.  We need a mechanism for recomputing overflow areas outside of reflow; it blocks a whole bunch of things we need to do.  (I thought we had a bug on it, but can't find one.)", "id": 5342084, "text": "(In reply to comment #2)\n> Of course since the marker is abs pos reframing it, or reflowing it, absolutely\n> can't change the position of _anything_ else on the page.  So it seems like the\n> right optimization here would be for that case...  Can we manage that?\n\nExcept abs pos elements can change scrollable overflow area, and we currently only change overflow areas during reflow.  We need a mechanism for recomputing overflow areas outside of reflow; it blocks a whole bunch of things we need to do.  (I thought we had a bug on it, but can't find one.)", "creation_time": "2011-03-13T20:02:03Z", "author": "dbaron@dbaron.org", "time": "2011-03-13T20:02:03Z", "is_private": false, "attachment_id": null}, {"is_private": false, "time": "2011-03-13T20:19:09Z", "attachment_id": null, "creation_time": "2011-03-13T20:19:09Z", "text": "Fwiw, I think that we should still fix this bug as filed: we shouldn't need an O(N^2) algorithm on the floats here.  I just don't think that'll get us close to \"fast\" on the maze, given all the other reflow/reframe overhead here.", "id": 5342109, "raw_text": "Fwiw, I think that we should still fix this bug as filed: we shouldn't need an O(N^2) algorithm on the floats here.  I just don't think that'll get us close to \"fast\" on the maze, given all the other reflow/reframe overhead here.", "tags": [], "creator": "bzbarsky@mit.edu", "count": 4, "bug_id": 641340, "author": "bzbarsky@mit.edu"}, {"attachment_id": null, "is_private": false, "time": "2011-03-30T20:14:19Z", "author": "bugzilla.x.0x@xoxy.net", "text": "O(N^2)?\nA candidate for blocking Bug 86952.", "creation_time": "2011-03-30T20:14:19Z", "raw_text": "O(N^2)?\nA candidate for blocking Bug 86952.", "id": 5381238, "bug_id": 641340, "tags": [], "count": 5, "creator": "bugzilla.x.0x@xoxy.net"}, {"author": "mr.7ramy@gmail.com", "creation_time": "2011-06-01T15:01:29Z", "text": "opera pass this test amazingly", "id": 5506111, "raw_text": "opera pass this test amazingly", "creator": "mr.7ramy@gmail.com", "count": 6, "tags": [], "bug_id": 641340, "attachment_id": null, "is_private": false, "time": "2011-06-01T15:01:29Z"}, {"raw_text": "Please add Windows platform also. I can confirm that Maze solver runs very slow on Windows comared to other browsers", "id": 5557189, "text": "Please add Windows platform also. I can confirm that Maze solver runs very slow on Windows comared to other browsers", "creation_time": "2011-06-26T16:32:36Z", "bug_id": 641340, "tags": [], "creator": "scrapmachines@gmail.com", "count": 7, "author": "scrapmachines@gmail.com", "is_private": false, "time": "2011-06-26T16:32:36Z", "attachment_id": null}, {"bug_id": 641340, "creator": "mevans@mozilla.com", "tags": [], "count": 8, "raw_text": "Looks to be better in nightly FF8. But Firefox just gets killed in this test. Anything we can do better on this? \n\nOn 64bit Win7 \nProcessor:Intel\ufd3eR\ufd3f Core\ufd3eTM\ufd3f i7 CPU       Q 820  @ 1.73GHz   1.73 GHz\nInstalled memory \ufd3eRAM\ufd3f:\t8.00 GB\nSystem type:\t64\u2010bit Operating System\n\nBuild identifier: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:5.0) Gecko/20100101 Firefox/5.0\nTime: 233 seconds\n\nBuild identifier: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:8.0a1) Gecko/20110707 Firefox/8.0a1\nTime: 115 seconds\n\nGoogle Chrome\t12.0.742.112 (Official Build 90304)\nTime: 1.5 seconds\n\nIE 9 9.0.8080\nTime: 6.0 seconds", "id": 5580399, "text": "Looks to be better in nightly FF8. But Firefox just gets killed in this test. Anything we can do better on this? \n\nOn 64bit Win7 \nProcessor:Intel\ufd3eR\ufd3f Core\ufd3eTM\ufd3f i7 CPU       Q 820  @ 1.73GHz   1.73 GHz\nInstalled memory \ufd3eRAM\ufd3f:\t8.00 GB\nSystem type:\t64\u2010bit Operating System\n\nBuild identifier: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:5.0) Gecko/20100101 Firefox/5.0\nTime: 233 seconds\n\nBuild identifier: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:8.0a1) Gecko/20110707 Firefox/8.0a1\nTime: 115 seconds\n\nGoogle Chrome\t12.0.742.112 (Official Build 90304)\nTime: 1.5 seconds\n\nIE 9 9.0.8080\nTime: 6.0 seconds", "creation_time": "2011-07-08T07:19:30Z", "author": "mevans@mozilla.com", "time": "2011-07-08T07:19:30Z", "is_private": false, "attachment_id": null}, {"author": "bzbarsky@mit.edu", "tags": [], "count": 9, "creator": "bzbarsky@mit.edu", "bug_id": 641340, "creation_time": "2011-07-08T19:57:10Z", "text": "> Anything we can do better on this? \n\nThis bug and bug 641341 are the obvious things we can do better.  That's why they're filed.\n\nWell, that and making the painting faster somehow; see comment 0.", "id": 5581620, "raw_text": "> Anything we can do better on this? \n\nThis bug and bug 641341 are the obvious things we can do better.  That's why they're filed.\n\nWell, that and making the painting faster somehow; see comment 0.", "attachment_id": null, "time": "2011-07-08T19:57:10Z", "is_private": false}, {"attachment_id": null, "time": "2011-08-29T13:55:47Z", "is_private": false, "author": "jmuizelaar@mozilla.com", "count": 10, "tags": [], "creator": "jmuizelaar@mozilla.com", "bug_id": 641340, "id": 5684748, "raw_text": "In this comparison (http://www.tomshardware.com/reviews/web-browser-performance-standard-html5,3013-16.html) this test was one of the few areas where Firefox was rated as weak.", "creation_time": "2011-08-29T13:55:47Z", "text": "In this comparison (http://www.tomshardware.com/reviews/web-browser-performance-standard-html5,3013-16.html) this test was one of the few areas where Firefox was rated as weak."}, {"bug_id": 641340, "creator": "cjones.bugs@gmail.com", "tags": [], "count": 11, "time": "2011-08-31T06:32:31Z", "raw_text": "If reflowing the entire maze is causing us to invalidate the entire maze, then the repaint time should go down as amount of maze reflowed is reduced.  But of course the paint time might be worth looking at in case anything sticks out.", "id": 5689911, "text": "If reflowing the entire maze is causing us to invalidate the entire maze, then the repaint time should go down as amount of maze reflowed is reduced.  But of course the paint time might be worth looking at in case anything sticks out.", "is_private": false, "creation_time": "2011-08-31T06:32:31Z", "author": "cjones.bugs@gmail.com", "attachment_id": null}, {"bug_id": 641340, "count": 12, "tags": [], "creator": "rjesup@jesup.org", "time": "2011-09-28T12:51:33Z", "text": "Created attachment 563041\njprof at 2ms\n\nThis takes 85 seconds on my ultra-fast Xeon desktop, and 4.5 seconds on Chrome on the same machine.  Really.\n\nThis bug's contribution is around 17%.", "creation_time": "2011-09-28T12:51:33Z", "is_private": false, "raw_text": "This takes 85 seconds on my ultra-fast Xeon desktop, and 4.5 seconds on Chrome on the same machine.  Really.\n\nThis bug's contribution is around 17%.", "id": 5742877, "author": "rjesup@jesup.org", "attachment_id": 563041}, {"time": "2011-09-30T07:35:10Z", "is_private": false, "attachment_id": null, "creator": "bzbarsky@mit.edu", "count": 13, "tags": [], "bug_id": 641340, "creation_time": "2011-09-30T07:35:10Z", "text": "Bug 670311 will hopefully make this all better.", "id": 5748843, "raw_text": "Bug 670311 will hopefully make this all better.", "author": "bzbarsky@mit.edu"}, {"attachment_id": null, "is_private": false, "time": "2011-10-03T15:27:35Z", "author": "rjesup@jesup.org", "text": "FYI, TomsHardware indicates FF7 got 10 seconds *worse* than FF6 on this test - so we went in the wrong direction.", "creation_time": "2011-10-03T15:27:35Z", "raw_text": "FYI, TomsHardware indicates FF7 got 10 seconds *worse* than FF6 on this test - so we went in the wrong direction.", "id": 5754151, "bug_id": 641340, "count": 14, "tags": [], "creator": "rjesup@jesup.org"}, {"time": "2011-10-03T15:30:26Z", "count": 15, "creator": "bzbarsky@mit.edu", "tags": [], "bug_id": 641340, "id": 5754157, "raw_text": "Regression range welcome.  Possibly in an actual metabug tracking the test that all the specific bugs block?", "creation_time": "2011-10-03T15:30:26Z", "is_private": false, "text": "Regression range welcome.  Possibly in an actual metabug tracking the test that all the specific bugs block?", "attachment_id": null, "author": "bzbarsky@mit.edu"}, {"author": "rjesup@jesup.org", "bug_id": 641340, "tags": [], "creator": "rjesup@jesup.org", "count": 16, "text": "I'd love to - but there's no way I have time. :-(  Perhaps QA could verify the regression and bisect.", "creation_time": "2011-10-03T16:28:07Z", "raw_text": "I'd love to - but there's no way I have time. :-(  Perhaps QA could verify the regression and bisect.", "id": 5754296, "attachment_id": null, "time": "2011-10-03T16:28:07Z", "is_private": false}, {"author": "mevans@mozilla.com", "creator": "mevans@mozilla.com", "count": 17, "tags": [], "bug_id": 641340, "id": 5754356, "raw_text": "Juan or Anthony can we get someone assigned to verify the regression?", "creation_time": "2011-10-03T16:43:54Z", "text": "Juan or Anthony can we get someone assigned to verify the regression?", "attachment_id": null, "time": "2011-10-03T16:43:54Z", "is_private": false}, {"attachment_id": null, "time": "2011-10-03T17:10:49Z", "is_private": false, "author": "bzbarsky@mit.edu", "bug_id": 641340, "tags": [], "creator": "bzbarsky@mit.edu", "count": 18, "raw_text": "Please file a separate bug for the regression.  Do NOT hijack this bug.", "id": 5754442, "text": "Please file a separate bug for the regression.  Do NOT hijack this bug.", "creation_time": "2011-10-03T17:10:49Z"}, {"author": "rjesup@jesup.org", "attachment_id": null, "raw_text": "Filed bug 691414 on the regression", "id": 5754599, "text": "Filed bug 691414 on the regression", "is_private": false, "creation_time": "2011-10-03T17:55:28Z", "bug_id": 641340, "creator": "rjesup@jesup.org", "time": "2011-10-03T17:55:28Z", "count": 19, "tags": []}, {"attachment_id": null, "is_private": false, "time": "2011-10-04T02:49:13Z", "author": "bzbarsky@mit.edu", "creation_time": "2011-10-04T02:49:13Z", "text": "I don't see an obvious way to make this faster, actually... And even with bug 670311 fixed we'd still need to reflow the placeholders to get the right y position for them.  David, any ideas?\n\nOne other note: a lot of the reflow seems to happen off paint events, so moving painting to the refresh driver might help here.", "id": 5756278, "raw_text": "I don't see an obvious way to make this faster, actually... And even with bug 670311 fixed we'd still need to reflow the placeholders to get the right y position for them.  David, any ideas?\n\nOne other note: a lot of the reflow seems to happen off paint events, so moving painting to the refresh driver might help here.", "tags": [], "count": 20, "creator": "bzbarsky@mit.edu", "bug_id": 641340}, {"attachment_id": null, "is_private": false, "time": "2011-10-04T03:13:34Z", "author": "dbaron@dbaron.org", "raw_text": "Would being able to reframe all children of a frame (rather than the frame itself) help here at all?  (We could do that on transform to no transform changes, since the reason to reframe is for fixed-pos descendants.)  Or we could even replace that with code that searches the descendants for a fixed-pos frame and just reframes those -- may well be worth doing.  Would that get rid of the need to reflow at all?", "id": 5756318, "text": "Would being able to reframe all children of a frame (rather than the frame itself) help here at all?  (We could do that on transform to no transform changes, since the reason to reframe is for fixed-pos descendants.)  Or we could even replace that with code that searches the descendants for a fixed-pos frame and just reframes those -- may well be worth doing.  Would that get rid of the need to reflow at all?", "creation_time": "2011-10-04T03:13:34Z", "bug_id": 641340, "tags": [], "creator": "dbaron@dbaron.org", "count": 21}, {"author": "bzbarsky@mit.edu", "attachment_id": null, "text": "If we didn't need to reframe the transformed element itself on transform changes then we would not need to reflow at all on this testcase, yes.  All the remaining cost would be painting.", "creation_time": "2011-10-04T03:15:57Z", "is_private": false, "raw_text": "If we didn't need to reframe the transformed element itself on transform changes then we would not need to reflow at all on this testcase, yes.  All the remaining cost would be painting.", "id": 5756320, "bug_id": 641340, "tags": [], "creator": "bzbarsky@mit.edu", "count": 22, "time": "2011-10-04T03:15:57Z"}, {"bug_id": 641340, "time": "2011-10-04T03:16:31Z", "creator": "dbaron@dbaron.org", "tags": [], "count": 23, "text": "... with bug 524925, of course.", "is_private": false, "creation_time": "2011-10-04T03:16:31Z", "raw_text": "... with bug 524925, of course.", "id": 5756322, "author": "dbaron@dbaron.org", "attachment_id": null}, {"author": "bzbarsky@mit.edu", "id": 5756328, "raw_text": "Note that we would also need to deal with transformed ib splits a bit too; right now they get the positioned wrapper blocks.  But we could just reframe an ib split on transform changes; that situation is cheap to detect and I bet rare.", "creation_time": "2011-10-04T03:19:44Z", "text": "Note that we would also need to deal with transformed ib splits a bit too; right now they get the positioned wrapper blocks.  But we could just reframe an ib split on transform changes; that situation is cheap to detect and I bet rare.", "tags": [], "count": 24, "creator": "bzbarsky@mit.edu", "bug_id": 641340, "attachment_id": null, "is_private": false, "time": "2011-10-04T03:19:44Z"}, {"author": "dbaron@dbaron.org", "creator": "dbaron@dbaron.org", "tags": [], "count": 25, "bug_id": 641340, "creation_time": "2011-10-04T03:22:12Z", "text": "I filed bug 691651 for doing that.", "id": 5756332, "raw_text": "I filed bug 691651 for doing that.", "attachment_id": null, "time": "2011-10-04T03:22:12Z", "is_private": false}, {"is_private": false, "time": "2011-10-04T03:22:22Z", "attachment_id": null, "text": "Oh, hmm.  I wonder why I was seeing no time spent in reflow when I hacked the transform stuff here, given bug 524925...", "creation_time": "2011-10-04T03:22:22Z", "raw_text": "Oh, hmm.  I wonder why I was seeing no time spent in reflow when I hacked the transform stuff here, given bug 524925...", "id": 5756333, "bug_id": 641340, "count": 26, "tags": [], "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu"}, {"is_private": false, "time": "2013-09-23T14:04:19Z", "attachment_id": null, "text": "Removing qawanted since the regression has already been filed (fyi: it doesn't reproduce on current versions).", "creation_time": "2013-09-23T14:04:19Z", "raw_text": "Removing qawanted since the regression has already been filed (fyi: it doesn't reproduce on current versions).", "id": 7889979, "bug_id": 641340, "creator": "ioana_damy@yahoo.com", "tags": [], "count": 27, "author": "ioana_damy@yahoo.com"}, {"attachment_id": null, "is_private": false, "time": "2015-09-30T20:29:39Z", "author": "MatsPalmgren_bugz@use.startmail.com", "text": "I can't seem to find IE Maze Solver anywhere on the web anymore.\nDid anyone save a copy to disk by any chance?", "creation_time": "2015-09-30T20:29:39Z", "raw_text": "I can't seem to find IE Maze Solver anywhere on the web anymore.\nDid anyone save a copy to disk by any chance?", "id": 10796368, "bug_id": 641340, "tags": [], "count": 28, "creator": "MatsPalmgren_bugz@use.startmail.com"}, {"raw_text": "http://web.archive.org/web/20140325062456/http://ie.microsoft.com/testdrive/Performance/MazeSolver/Default.html\n\nworks for me.", "id": 10796392, "text": "http://web.archive.org/web/20140325062456/http://ie.microsoft.com/testdrive/Performance/MazeSolver/Default.html\n\nworks for me.", "is_private": false, "creation_time": "2015-09-30T20:33:52Z", "bug_id": 641340, "time": "2015-09-30T20:33:52Z", "creator": "jmuizelaar@mozilla.com", "tags": [], "count": 29, "author": "jmuizelaar@mozilla.com", "attachment_id": null}, {"is_private": false, "time": "2015-09-30T20:43:53Z", "attachment_id": null, "id": 10796445, "raw_text": "Thanks!  It looks like they've put it on github actually:\nhttps://github.com/MicrosoftEdge/Demos/tree/master/mazesolver", "creation_time": "2015-09-30T20:43:53Z", "text": "Thanks!  It looks like they've put it on github actually:\nhttps://github.com/MicrosoftEdge/Demos/tree/master/mazesolver", "tags": [], "creator": "MatsPalmgren_bugz@use.startmail.com", "count": 30, "bug_id": 641340, "author": "MatsPalmgren_bugz@use.startmail.com"}]}}, "comments": {}}