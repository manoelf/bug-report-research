{"comments": {}, "bugs": {"659522": {"comments": [{"is_private": false, "author": "dholbert@mozilla.com", "id": 5491120, "tags": [], "creation_time": "2011-05-25T00:22:44Z", "attachment_id": null, "bug_id": 659522, "time": "2011-05-25T00:22:44Z", "count": 0, "raw_text": "The 4 tests inside of window_activation.xul (which is part of test_activation.xul) don't actually test anything right now.  e.g.:\n\n> ok(getComputedStyle(document.getElementById(\"box\"), \"\").backgroundColor, \"rgb(0, 0, 255)\");\n\nThese \"ok\" calls really want to be \"is\" calls.  Currently, the ok() test just checks if the first argument is \"truthy\", which doesn't tell us anything.\n\nSadly, when I replace the \"ok()\" checks with \"is()\" checks, 2 of the checks fail. :(  I'm guessing that this has been the case since the test was added in the first place.  I don't know if that's indicative of a code bug or a test bug, but either way, we should fix it.", "creator": "dholbert@mozilla.com", "text": "The 4 tests inside of window_activation.xul (which is part of test_activation.xul) don't actually test anything right now.  e.g.:\n\n> ok(getComputedStyle(document.getElementById(\"box\"), \"\").backgroundColor, \"rgb(0, 0, 255)\");\n\nThese \"ok\" calls really want to be \"is\" calls.  Currently, the ok() test just checks if the first argument is \"truthy\", which doesn't tell us anything.\n\nSadly, when I replace the \"ok()\" checks with \"is()\" checks, 2 of the checks fail. :(  I'm guessing that this has been the case since the test was added in the first place.  I don't know if that's indicative of a code bug or a test bug, but either way, we should fix it."}, {"creator": "dholbert@mozilla.com", "raw_text": "", "text": "Created attachment 534948\nfirst patch: replace \"ok\" with is & todo_is", "count": 1, "time": "2011-05-25T00:29:23Z", "attachment_id": 534948, "tags": [], "creation_time": "2011-05-25T00:29:23Z", "bug_id": 659522, "is_private": false, "author": "dholbert@mozilla.com", "id": 5491133}, {"bug_id": 659522, "text": "I'm posting this first patch until we have an actual fix here, so that we'll be checking _something_ rather than not checking anything. :)", "tags": [], "creation_time": "2011-05-25T00:31:30Z", "attachment_id": null, "raw_text": "I'm posting this first patch until we have an actual fix here, so that we'll be checking _something_ rather than not checking anything. :)", "creator": "dholbert@mozilla.com", "id": 5491139, "is_private": false, "time": "2011-05-25T00:31:30Z", "author": "dholbert@mozilla.com", "count": 2}, {"author": "dholbert@mozilla.com", "is_private": false, "id": 5491191, "tags": [], "creation_time": "2011-05-25T00:59:37Z", "attachment_id": 534953, "bug_id": 659522, "time": "2011-05-25T00:59:37Z", "count": 3, "raw_text": "Thanks!\n\nHere's the patch again, with a typo fix in one of the test-failure-messages.  (s/blue/cyan/) & with r+ noted.\n\nI'm currently running the previous (functionally-equivalent) version of patch through TryServer just to be sure the is() & todo_is() conditions behave the same on our tinderboxen as on my local machine.\n\nI'm also making a targeted build from the changeset that added this test, to see if our behavior was the same back then.", "creator": "dholbert@mozilla.com", "text": "Created attachment 534953\nfirst patch v2: replace \"ok\" with is & todo_is (has issues on TryServer)\n\nThanks!\n\nHere's the patch again, with a typo fix in one of the test-failure-messages.  (s/blue/cyan/) & with r+ noted.\n\nI'm currently running the previous (functionally-equivalent) version of patch through TryServer just to be sure the is() & todo_is() conditions behave the same on our tinderboxen as on my local machine.\n\nI'm also making a targeted build from the changeset that added this test, to see if our behavior was the same back then."}, {"id": 5491201, "is_private": false, "author": "dholbert@mozilla.com", "bug_id": 659522, "tags": [], "creation_time": "2011-05-25T01:05:23Z", "attachment_id": null, "time": "2011-05-25T01:05:23Z", "count": 4, "text": "(In reply to comment #3)\n> I'm also making a targeted build from the changeset that added this test, to\n> see if our behavior was the same back then.\n\nTargeted build[1] done - I've confirmed that our behavior was the same back then.  With my patch here, the testcase's first two checks are satisfied, and the second two are not (and hence need todo_is to prevent permaorange).\n\n[1] at http://hg.mozilla.org/mozilla-central/rev/e17c076aceea", "raw_text": "(In reply to comment #3)\n> I'm also making a targeted build from the changeset that added this test, to\n> see if our behavior was the same back then.\n\nTargeted build[1] done - I've confirmed that our behavior was the same back then.  With my patch here, the testcase's first two checks are satisfied, and the second two are not (and hence need todo_is to prevent permaorange).\n\n[1] at http://hg.mozilla.org/mozilla-central/rev/e17c076aceea", "creator": "dholbert@mozilla.com"}, {"attachment_id": null, "creation_time": "2011-05-25T10:27:42Z", "tags": [], "bug_id": 659522, "is_private": false, "author": "mstange.moz@gmail.com", "id": 5491835, "creator": "mstange.moz@gmail.com", "raw_text": "(In reply to comment #0)\n> These \"ok\" calls really want to be \"is\" calls.\n\nOops. How did you catch this!?\n\nI've sent a patch that should fix the whole test to the tryserver:\nhttp://tbpl.mozilla.org/?tree=Try&rev=60918e5a12e2", "text": "(In reply to comment #0)\n> These \"ok\" calls really want to be \"is\" calls.\n\nOops. How did you catch this!?\n\nI've sent a patch that should fix the whole test to the tryserver:\nhttp://tbpl.mozilla.org/?tree=Try&rev=60918e5a12e2", "count": 5, "time": "2011-05-25T10:27:42Z"}, {"text": "(In reply to comment #5)\n> Oops. How did you catch this!?\n\nOver in bug 659466. :)\n\nYou'll want to base your work here off of that bug's patch, in order for your tests' stylesheets to be correctly parsed.", "creator": "dholbert@mozilla.com", "raw_text": "(In reply to comment #5)\n> Oops. How did you catch this!?\n\nOver in bug 659466. :)\n\nYou'll want to base your work here off of that bug's patch, in order for your tests' stylesheets to be correctly parsed.", "count": 6, "time": "2011-05-25T18:30:19Z", "bug_id": 659522, "attachment_id": null, "creation_time": "2011-05-25T18:30:19Z", "tags": [], "id": 5492892, "is_private": false, "author": "dholbert@mozilla.com"}, {"is_private": false, "count": 7, "author": "dholbert@mozilla.com", "time": "2011-05-25T18:39:53Z", "id": 5492921, "attachment_id": null, "creation_time": "2011-05-25T18:39:53Z", "tags": [], "creator": "dholbert@mozilla.com", "raw_text": "BTW, tinderbox doesn't like my patch here -- it looks like the test boxes behave differently from my local box for some reason (and mac/windows test boxes behave differently from linux).\n\nMy try push (including the data URI fixup from bug 659466):\n  http://tbpl.mozilla.org/?tree=Try&rev=09799053faba\n\nThat has these unexpecteds on linux:\nERROR TEST-UNEXPECTED-FAIL | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is initially cyan in openerDoc - got \"rgb(0, 0, 255)\", expected \"rgb(0, 255, 255)\"\nERROR TEST-UNEXPECTED-PASS | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is blue in openerDoc after it's focused - \"rgb(0, 0, 255)\" should equal \"rgb(0, 0, 255)\"\n\n...with this additional unexpected on Windows/Mac:\nERROR TEST-UNEXPECTED-PASS | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is cyan in document after it's unfocused - \"rgb(0, 255, 255)\" should equal \"rgb(0, 255, 255)\"\n\nSo my patch here shouldn't land in its current state. Markus, I fully support you improving upon it & landing something better. :)", "bug_id": 659522, "text": "BTW, tinderbox doesn't like my patch here -- it looks like the test boxes behave differently from my local box for some reason (and mac/windows test boxes behave differently from linux).\n\nMy try push (including the data URI fixup from bug 659466):\n  http://tbpl.mozilla.org/?tree=Try&rev=09799053faba\n\nThat has these unexpecteds on linux:\nERROR TEST-UNEXPECTED-FAIL | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is initially cyan in openerDoc - got \"rgb(0, 0, 255)\", expected \"rgb(0, 255, 255)\"\nERROR TEST-UNEXPECTED-PASS | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is blue in openerDoc after it's focused - \"rgb(0, 0, 255)\" should equal \"rgb(0, 0, 255)\"\n\n...with this additional unexpected on Windows/Mac:\nERROR TEST-UNEXPECTED-PASS | chrome://mochitests/content/chrome/dom/tests/mochitest/chrome/test_activation.xul | checking that background is cyan in document after it's unfocused - \"rgb(0, 255, 255)\" should equal \"rgb(0, 255, 255)\"\n\nSo my patch here shouldn't land in its current state. Markus, I fully support you improving upon it & landing something better. :)"}]}}}