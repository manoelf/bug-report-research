{"bugs": {"658896": {"comments": [{"creation_time": "2011-05-22T19:59:36Z", "author": "ruby_murray1@hotmail.com", "attachment_id": null, "id": 5485461, "text": "User-Agent:       Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\nBuild Identifier: 5.0   (but same problem with older version)\n\nThis canvas animation grinds to a halt (essentially crashes) using the latest and older versions of firefox.  Works fine on Chrome.  I have made many canvas animations before, but this is the first time firefox has not been able to run my animation.  This is also the first time I have made a \"pixel based\" animation (createImageData), so I wonder if that may be the problem.  I would really like to know if this is a bug, or just something I can fix by improving my coding !  Thank you.\n\nReproducible: Always\n\nSteps to Reproduce:\n1.Go to the web page:  http://www.mpklein.co.uk/filter/diffraction2.html\n2.The canvas animations runs VERY slowly and then crashes the browser\n3.(works fine on Chrome)\n\nActual Results:  \nBrowser runs VERY slowly and then crashes (need to kill process after)\n\nExpected Results:  \nShould run fast (as it does in Chrome)\n\nPlease let me know @  ruby_murray1@hotmail.com\n\nThank you", "creator": "ruby_murray1@hotmail.com", "count": 0, "raw_text": "User-Agent:       Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\nBuild Identifier: 5.0   (but same problem with older version)\n\nThis canvas animation grinds to a halt (essentially crashes) using the latest and older versions of firefox.  Works fine on Chrome.  I have made many canvas animations before, but this is the first time firefox has not been able to run my animation.  This is also the first time I have made a \"pixel based\" animation (createImageData), so I wonder if that may be the problem.  I would really like to know if this is a bug, or just something I can fix by improving my coding !  Thank you.\n\nReproducible: Always\n\nSteps to Reproduce:\n1.Go to the web page:  http://www.mpklein.co.uk/filter/diffraction2.html\n2.The canvas animations runs VERY slowly and then crashes the browser\n3.(works fine on Chrome)\n\nActual Results:  \nBrowser runs VERY slowly and then crashes (need to kill process after)\n\nExpected Results:  \nShould run fast (as it does in Chrome)\n\nPlease let me know @  ruby_murray1@hotmail.com\n\nThank you", "bug_id": 658896, "is_private": false, "tags": [], "time": "2011-05-22T19:59:36Z"}, {"count": 1, "bug_id": 658896, "time": "2011-05-23T11:58:00Z", "author": "andrei.domuta@softvision.ro", "creator": "andrei.domuta@softvision.ro", "raw_text": "Reproducible also on:\nWindows XP: Mozilla/5.0 (Windows NT 5.1; rv:6.0a1) Gecko/20110522 Firefox/6.0a1\nand\nMAC OS 10.6\nMozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0a1) Gecko/20110522 Firefox/6.0a1\n\n*Note: Status could be set on NEW", "tags": [], "is_private": false, "creation_time": "2011-05-23T11:58:00Z", "text": "Reproducible also on:\nWindows XP: Mozilla/5.0 (Windows NT 5.1; rv:6.0a1) Gecko/20110522 Firefox/6.0a1\nand\nMAC OS 10.6\nMozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:6.0a1) Gecko/20110522 Firefox/6.0a1\n\n*Note: Status could be set on NEW", "attachment_id": null, "id": 5486166}, {"time": "2011-05-23T15:12:17Z", "count": 2, "bug_id": 658896, "author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu", "is_private": false, "tags": [], "raw_text": "The reason the page is slow is that it has this structure:\n\n  function draw() {\n    // do some stuff\n    setInterval(draw, 50);\n  }\n\nThis causes exponential growth in number of calls to draw() that are happening; every 50ms the number doubles.  We have existing bugs on it being able to use setInterval in this way to cause such an explosion in the number of timers.  If I use setTimeout there instead of setInterval, which is what I assume was intended, things work fine.\n\nI wonder how Chrome is handling this... do they ignore the setInterval call or clamp total number of intervals or something?", "id": 5486499, "attachment_id": null, "text": "The reason the page is slow is that it has this structure:\n\n  function draw() {\n    // do some stuff\n    setInterval(draw, 50);\n  }\n\nThis causes exponential growth in number of calls to draw() that are happening; every 50ms the number doubles.  We have existing bugs on it being able to use setInterval in this way to cause such an explosion in the number of timers.  If I use setTimeout there instead of setInterval, which is what I assume was intended, things work fine.\n\nI wonder how Chrome is handling this... do they ignore the setInterval call or clamp total number of intervals or something?", "creation_time": "2011-05-23T15:12:17Z"}, {"attachment_id": null, "id": 5486538, "creator": "bzbarsky@mit.edu", "text": "Ah, looks like there's no magic here in Chrome.  It just has separate event queues for painting and \"everything going on in the page\", so while the latter is swamped and timers aren't actually firing and the CPU is pegged updating the imagedata hundreds of thousands of frames per 50ms the painting is still happening.\n\nNot sure what the best way to handle this is...", "author": "bzbarsky@mit.edu", "creation_time": "2011-05-23T15:27:02Z", "time": "2011-05-23T15:27:02Z", "is_private": false, "tags": [], "raw_text": "Ah, looks like there's no magic here in Chrome.  It just has separate event queues for painting and \"everything going on in the page\", so while the latter is swamped and timers aren't actually firing and the CPU is pegged updating the imagedata hundreds of thousands of frames per 50ms the painting is still happening.\n\nNot sure what the best way to handle this is...", "bug_id": 658896, "count": 3}, {"time": "2011-05-24T01:27:42Z", "bug_id": 658896, "count": 4, "creator": "roc@ocallahan.org", "author": "roc@ocallahan.org", "is_private": false, "tags": [], "raw_text": "We could probably solve this by moving all painting to the refresh driver so we don't need to use OS paint events to drive painting (which we want to do already), and then find a way to schedule paints with higher priority than timers or some other events.\n\nThis page is pretty broken though.", "id": 5488231, "attachment_id": null, "text": "We could probably solve this by moving all painting to the refresh driver so we don't need to use OS paint events to drive painting (which we want to do already), and then find a way to schedule paints with higher priority than timers or some other events.\n\nThis page is pretty broken though.", "creation_time": "2011-05-24T01:27:42Z"}, {"creation_time": "2011-05-24T01:29:40Z", "text": "No doubts about that last!", "id": 5488233, "attachment_id": null, "raw_text": "No doubts about that last!", "tags": [], "is_private": false, "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu", "bug_id": 658896, "count": 5, "time": "2011-05-24T01:29:40Z"}, {"is_private": false, "tags": [], "time": "2011-05-24T18:08:19Z", "count": 6, "raw_text": "Seems to me this isn't a bug at all then !  Thank you for pointing out the mistake in my code.  I have now moved the setInterval declaration outside of the draw function, so that setInterval is only set once (I didn't want anything exponential !).  (haven't updated the online version yet).  The modified code works fine.  \n\nIn my defence, I sometimes develop/test in Chrome.  I think I probably made this mistake when developing in Chrome, and since it worked I carried on reusing code ... and have now discovered the mistake using firefox.  Thank you firefox !\n\nShall I set the status to RESOLVED or do people want to continue looking into this?", "bug_id": 658896, "author": "ruby_murray1@hotmail.com", "id": 5489937, "attachment_id": null, "creator": "ruby_murray1@hotmail.com", "text": "Seems to me this isn't a bug at all then !  Thank you for pointing out the mistake in my code.  I have now moved the setInterval declaration outside of the draw function, so that setInterval is only set once (I didn't want anything exponential !).  (haven't updated the online version yet).  The modified code works fine.  \n\nIn my defence, I sometimes develop/test in Chrome.  I think I probably made this mistake when developing in Chrome, and since it worked I carried on reusing code ... and have now discovered the mistake using firefox.  Thank you firefox !\n\nShall I set the status to RESOLVED or do people want to continue looking into this?", "creation_time": "2011-05-24T18:08:19Z"}, {"author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu", "count": 7, "bug_id": 658896, "time": "2011-05-24T19:07:33Z", "creation_time": "2011-05-24T19:07:33Z", "text": "I think it's worth leaving open with the new summary in case we come up with a clever way to make that happen.  It seems like it would be desirable for video and such too.", "attachment_id": null, "id": 5490146, "raw_text": "I think it's worth leaving open with the new summary in case we come up with a clever way to make that happen.  It seems like it would be desirable for video and such too.", "tags": [], "is_private": false}]}}, "comments": {}}