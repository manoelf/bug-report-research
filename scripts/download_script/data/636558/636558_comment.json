{"comments": {}, "bugs": {"636558": {"comments": [{"author": "paul.biggar@gmail.com", "text": "After bug 634155, there will be 42 OffTheBooks allocations. The GC does not know about these allocations, and so is unable to factor them into its decisions. We should remove these wherever possible.", "count": 0, "attachment_id": null, "creator": "paul.biggar@gmail.com", "time": "2011-02-24T20:51:19Z", "id": 5302419, "is_private": false, "bug_id": 636558, "creation_time": "2011-02-24T20:51:19Z", "raw_text": "After bug 634155, there will be 42 OffTheBooks allocations. The GC does not know about these allocations, and so is unable to factor them into its decisions. We should remove these wherever possible.", "tags": []}, {"is_private": false, "bug_id": 636558, "creation_time": "2011-02-24T21:15:45Z", "raw_text": "There is actually a ton more of these places, literally thousands--outside the JS engine. I think the right thing to do here is to start monitoring overall process memory use.", "tags": [], "time": "2011-02-24T21:15:45Z", "id": 5302486, "attachment_id": null, "creator": "gal@uci.edu", "author": "gal@uci.edu", "count": 1, "text": "There is actually a ton more of these places, literally thousands--outside the JS engine. I think the right thing to do here is to start monitoring overall process memory use."}, {"attachment_id": null, "creator": "paul.biggar@gmail.com", "author": "paul.biggar@gmail.com", "count": 2, "text": "(In reply to comment #1)\n> There is actually a ton more of these places, literally thousands\n\nI don't understand. I thought allocating JS objects etc went through the JSAPI, like using JS_NewObject.", "is_private": false, "bug_id": 636558, "creation_time": "2011-02-24T21:24:52Z", "raw_text": "(In reply to comment #1)\n> There is actually a ton more of these places, literally thousands\n\nI don't understand. I thought allocating JS objects etc went through the JSAPI, like using JS_NewObject.", "tags": [], "time": "2011-02-24T21:24:52Z", "id": 5302525}, {"text": "Yes, JS object headers are allocate inside the engine. The embedding can attach megabytes of malloc-ed memory to a JS object though. The JS heap is usually a small part of our total memory profile.", "count": 3, "id": 5302551, "author": "gal@uci.edu", "time": "2011-02-24T21:32:54Z", "creator": "gal@uci.edu", "tags": [], "raw_text": "Yes, JS object headers are allocate inside the engine. The embedding can attach megabytes of malloc-ed memory to a JS object though. The JS heap is usually a small part of our total memory profile.", "bug_id": 636558, "creation_time": "2011-02-24T21:32:54Z", "is_private": false, "attachment_id": null}, {"id": 5302595, "time": "2011-02-24T21:42:22Z", "tags": [], "creation_time": "2011-02-24T21:42:22Z", "bug_id": 636558, "raw_text": "Also, unless the GC incremental rewrite that is ongoing has changed things, the when-to-GC heuristics are touchy and adding more on-the-books accounting can cause SS and other benchmark regressions due to too much GC.\n\n/be", "is_private": false, "count": 4, "text": "Also, unless the GC incremental rewrite that is ongoing has changed things, the when-to-GC heuristics are touchy and adding more on-the-books accounting can cause SS and other benchmark regressions due to too much GC.\n\n/be", "author": "brendan@mozilla.org", "creator": "brendan@mozilla.org", "attachment_id": null}, {"id": 5302605, "time": "2011-02-24T21:43:18Z", "is_private": false, "tags": [], "raw_text": "So, retuning will be a wild ride. Definitely do not want for Fx4.\n\nComment 1 is right and there's even some electrolysis work to build on, IIRC. Cc'ing cjones.\n\n/be", "bug_id": 636558, "creation_time": "2011-02-24T21:43:18Z", "author": "brendan@mozilla.org", "text": "So, retuning will be a wild ride. Definitely do not want for Fx4.\n\nComment 1 is right and there's even some electrolysis work to build on, IIRC. Cc'ing cjones.\n\n/be", "count": 5, "attachment_id": null, "creator": "brendan@mozilla.org"}, {"id": 5307746, "time": "2011-02-28T00:25:25Z", "is_private": false, "tags": [], "bug_id": 636558, "creation_time": "2011-02-28T00:25:25Z", "raw_text": "(In reply to comment #1)\n> There is actually a ton more of these places, literally thousands--outside the\n> JS engine. I think the right thing to do here is to start monitoring overall\n> process memory use.\n\nDoes this mean adding OffTheBooks was a waste of time?", "author": "n.nethercote@gmail.com", "count": 6, "text": "(In reply to comment #1)\n> There is actually a ton more of these places, literally thousands--outside the\n> JS engine. I think the right thing to do here is to start monitoring overall\n> process memory use.\n\nDoes this mean adding OffTheBooks was a waste of time?", "attachment_id": null, "creator": "n.nethercote@gmail.com"}, {"tags": [], "creation_time": "2011-02-28T00:34:22Z", "bug_id": 636558, "raw_text": "No, it means it needs more work.", "is_private": false, "id": 5307756, "time": "2011-02-28T00:34:22Z", "creator": "gal@uci.edu", "attachment_id": null, "text": "No, it means it needs more work.", "count": 7, "author": "gal@uci.edu"}]}}}