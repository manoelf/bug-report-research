{"bugs": {"669954": {"comments": [{"bug_id": 669954, "id": 5579150, "is_private": false, "creation_time": "2011-07-07T18:22:12Z", "creator": "josh@joshmatthews.net", "count": 0, "text": "In the same vein as bug 666636.", "author": "josh@joshmatthews.net", "tags": [], "time": "2011-07-07T18:22:12Z", "raw_text": "In the same vein as bug 666636.", "attachment_id": null}, {"id": 5579216, "bug_id": 669954, "text": "I'm against doing this -- I'd like to keep reftests limited to what Web content can do, which will encourage writing tests that we can share with other browsers.  Things that require SpecialPowers can use reftest-in-mochitest.", "count": 1, "author": "dbaron@dbaron.org", "time": "2011-07-07T18:45:25Z", "raw_text": "I'm against doing this -- I'd like to keep reftests limited to what Web content can do, which will encourage writing tests that we can share with other browsers.  Things that require SpecialPowers can use reftest-in-mochitest.", "is_private": false, "creation_time": "2011-07-07T18:45:25Z", "creator": "dbaron@dbaron.org", "tags": [], "attachment_id": null}, {"count": 2, "text": "Basically all of the js browser tests need the ability to do something like SpecialPowers (in order to change prefs with multiple processes). Is it simple to convert all of those to reftest-in-mochitest? Or should we duplicate the relevant SpecialPowers code in the js reftest harness code?", "author": "azakai@mozilla.com", "id": 5579261, "bug_id": 669954, "raw_text": "Basically all of the js browser tests need the ability to do something like SpecialPowers (in order to change prefs with multiple processes). Is it simple to convert all of those to reftest-in-mochitest? Or should we duplicate the relevant SpecialPowers code in the js reftest harness code?", "time": "2011-07-07T19:03:54Z", "creator": "azakai@mozilla.com", "creation_time": "2011-07-07T19:03:54Z", "is_private": false, "attachment_id": null, "tags": []}, {"bug_id": 669954, "id": 5579380, "is_private": false, "creation_time": "2011-07-07T19:54:22Z", "creator": "dbaron@dbaron.org", "text": "What are the \"js browser tests\"?", "count": 3, "author": "dbaron@dbaron.org", "tags": [], "time": "2011-07-07T19:54:22Z", "raw_text": "What are the \"js browser tests\"?", "attachment_id": null}, {"tags": [], "attachment_id": null, "creation_time": "2011-07-07T20:13:26Z", "is_private": false, "creator": "azakai@mozilla.com", "time": "2011-07-07T20:13:26Z", "raw_text": "The tests that run when you do |make jstestbrowser|. They use the reftest harness and also js/src/tests/browser.js.", "id": 5579407, "bug_id": 669954, "text": "The tests that run when you do |make jstestbrowser|. They use the reftest harness and also js/src/tests/browser.js.", "count": 4, "author": "azakai@mozilla.com"}, {"time": "2011-07-11T13:27:34Z", "raw_text": "(In reply to comment #4)\n> The tests that run when you do |make jstestbrowser|. They use the reftest\n> harness and also js/src/tests/browser.js.\n\nThey're more commonly known as jsreftests.  I agree with David, that reftests themselves shouldn't need specialPowers since they should be entirely in-content tests. \n\nFor the JSReftest case, we could load the Special Powers extension during the harness setup (in runreftest.py).  Once the extension is installed, there shouldn't be any further harness work needed for the jsreftest tests to access the in-content side of specialpowers.  \n\nObviously the default use of runreftest.py would not install the special powers extension.", "author": "cmtalbert@gmail.com", "count": 5, "text": "(In reply to comment #4)\n> The tests that run when you do |make jstestbrowser|. They use the reftest\n> harness and also js/src/tests/browser.js.\n\nThey're more commonly known as jsreftests.  I agree with David, that reftests themselves shouldn't need specialPowers since they should be entirely in-content tests. \n\nFor the JSReftest case, we could load the Special Powers extension during the harness setup (in runreftest.py).  Once the extension is installed, there shouldn't be any further harness work needed for the jsreftest tests to access the in-content side of specialpowers.  \n\nObviously the default use of runreftest.py would not install the special powers extension.", "id": 5584325, "bug_id": 669954, "attachment_id": null, "tags": [], "creator": "cmtalbert@gmail.com", "creation_time": "2011-07-11T13:27:34Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "jmaher@mozilla.com", "creation_time": "2011-07-11T19:55:43Z", "is_private": false, "time": "2011-07-11T19:55:43Z", "raw_text": "I vote for adding specialpowers to reftest.  Mostly because we are sharing a lot of code between the harnesses and in one specific example (http://mxr.mozilla.org/mozilla-central/source/layout/tools/reftest/jar.mn#7) we cannot fix logging in mochitest without breaking reftest.", "text": "I vote for adding specialpowers to reftest.  Mostly because we are sharing a lot of code between the harnesses and in one specific example (http://mxr.mozilla.org/mozilla-central/source/layout/tools/reftest/jar.mn#7) we cannot fix logging in mochitest without breaking reftest.", "count": 6, "author": "jmaher@mozilla.com", "id": 5585164, "bug_id": 669954}, {"creation_time": "2011-07-14T00:53:06Z", "is_private": false, "creator": "cjones.bugs@gmail.com", "tags": [], "attachment_id": null, "id": 5590416, "bug_id": 669954, "author": "cjones.bugs@gmail.com", "count": 7, "text": "jsreftests are kind of a separate beast from rendering reftests.  I'm not sure why jsreftest was added to the reftest harness, but they're distinct enough code that SpecialPowers could be turned on for jsreftest but not rendering reftests.\n\nBug 669949 doesn't need SpecialPowers for pref access anymore, for jsreftest.  It does need Components.utils access.  So I'm not sure how to update the dep here.", "time": "2011-07-14T00:53:06Z", "raw_text": "jsreftests are kind of a separate beast from rendering reftests.  I'm not sure why jsreftest was added to the reftest harness, but they're distinct enough code that SpecialPowers could be turned on for jsreftest but not rendering reftests.\n\nBug 669949 doesn't need SpecialPowers for pref access anymore, for jsreftest.  It does need Components.utils access.  So I'm not sure how to update the dep here."}, {"is_private": false, "creation_time": "2011-07-18T16:46:18Z", "creator": "ted@mielczarek.org", "tags": [], "attachment_id": null, "id": 5596729, "bug_id": 669954, "count": 8, "text": "Dupe this one way or the other with bug 655622", "author": "ted@mielczarek.org", "time": "2011-07-18T16:46:18Z", "raw_text": "Dupe this one way or the other with bug 655622"}]}}, "comments": {}}