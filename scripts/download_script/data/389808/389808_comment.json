{"comments": {}, "bugs": {"389808": {"comments": [{"author": "fredbezies@gmail.com", "tags": [], "creation_time": "2007-07-27T07:52:35Z", "attachment_id": null, "creator": "fredbezies@gmail.com", "raw_text": "User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9a7pre) Gecko/2007072707 Firefox/3.0a7pre\nBuild Identifier: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9a7pre) Gecko/2007072707 Minefield/3.0a7pre\n\nThis is very recent regression.\n\nWhen I start a newly build firefox (homemade one), I cannot see anymore all the content of the personal toolbar. It is just blank.\n\nIt work yesterday on my homemade trunk build (made at 26th july, midnight mozilla.org time).\n\nCould it be related to bug 385937 or to bug 319455 ?\n\nReproducible: Always\n\nSteps to Reproduce:\n1.Grab source\n2.Build firefox\n3.Launch firefox\nActual Results:  \nBlank personal toolbar\n\nExpected Results:  \nMy bookmarks displayed.\n\nHere is the .mozconfig I used :\n\n\"#\n# See http://www.mozilla.org/build/ for build instructions.\n#\n\n. $topsrcdir/browser/config/mozconfig\n\n# Options for 'configure' (same as command-line options).\nac_add_options --enable-optimize=\"-Os -freorder-blocks -fno-reorder-functions\"\nac_add_options --disable-debug\nac_add_options --disable-tests\n\nac_add_options --enable-canvas\nac_add_options --enable-svg\nac_add_options --enable-pango\nac_add_options --enable-default-toolkit=cairo-gtk2\nac_add_options --enable-libxul\nac_add_options --enable-places-bookmarks\n\nac_add_options --enable-strip\"\n\nAnd my build was made at 26th july 10:00pm mozilla.org time.\n\nMy OS is an ubuntu linux 7.04 AMD64 up-to-date.", "time": "2007-07-27T07:52:35Z", "id": 3261831, "is_private": false, "bug_id": 389808, "text": "User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9a7pre) Gecko/2007072707 Firefox/3.0a7pre\nBuild Identifier: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9a7pre) Gecko/2007072707 Minefield/3.0a7pre\n\nThis is very recent regression.\n\nWhen I start a newly build firefox (homemade one), I cannot see anymore all the content of the personal toolbar. It is just blank.\n\nIt work yesterday on my homemade trunk build (made at 26th july, midnight mozilla.org time).\n\nCould it be related to bug 385937 or to bug 319455 ?\n\nReproducible: Always\n\nSteps to Reproduce:\n1.Grab source\n2.Build firefox\n3.Launch firefox\nActual Results:  \nBlank personal toolbar\n\nExpected Results:  \nMy bookmarks displayed.\n\nHere is the .mozconfig I used :\n\n\"#\n# See http://www.mozilla.org/build/ for build instructions.\n#\n\n. $topsrcdir/browser/config/mozconfig\n\n# Options for 'configure' (same as command-line options).\nac_add_options --enable-optimize=\"-Os -freorder-blocks -fno-reorder-functions\"\nac_add_options --disable-debug\nac_add_options --disable-tests\n\nac_add_options --enable-canvas\nac_add_options --enable-svg\nac_add_options --enable-pango\nac_add_options --enable-default-toolkit=cairo-gtk2\nac_add_options --enable-libxul\nac_add_options --enable-places-bookmarks\n\nac_add_options --enable-strip\"\n\nAnd my build was made at 26th july 10:00pm mozilla.org time.\n\nMy OS is an ubuntu linux 7.04 AMD64 up-to-date.", "count": 0}, {"is_private": false, "author": "twalker@mozilla.com", "tags": [], "creation_time": "2007-07-27T14:23:11Z", "raw_text": "Do you have extensions in your profile?\nDoes opening a second window show contents in the toolbar?", "time": "2007-07-27T14:23:11Z", "id": 3262027, "bug_id": 389808, "text": "Do you have extensions in your profile?\nDoes opening a second window show contents in the toolbar?", "count": 1, "creator": "twalker@mozilla.com", "attachment_id": null}, {"author": "fredbezies@gmail.com", "tags": [], "creation_time": "2007-07-27T16:17:19Z", "creator": "fredbezies@gmail.com", "attachment_id": null, "time": "2007-07-27T16:17:19Z", "raw_text": "No extensions.\n\nOpening another windows doesn't help.\n\nMaybe opening, then closing too rapidly the window corrupt places.sqlite ?", "id": 3262121, "is_private": false, "bug_id": 389808, "text": "No extensions.\n\nOpening another windows doesn't help.\n\nMaybe opening, then closing too rapidly the window corrupt places.sqlite ?", "count": 2}, {"text": "I'm seeing this now after doing a large delete of my bugzilla history. Everything's still in the menu though.\n\nI was able to set it as the bookmark toolbar folder and it works again, but maybe the anno expired, somehow?", "count": 3, "bug_id": 389808, "is_private": false, "id": 3262169, "raw_text": "I'm seeing this now after doing a large delete of my bugzilla history. Everything's still in the menu though.\n\nI was able to set it as the bookmark toolbar folder and it works again, but maybe the anno expired, somehow?", "time": "2007-07-27T16:58:39Z", "attachment_id": null, "creator": "mconnor@mozilla.com", "tags": [], "creation_time": "2007-07-27T16:58:39Z", "author": "mconnor@mozilla.com"}, {"is_private": false, "tags": [], "creation_time": "2007-07-27T17:09:00Z", "author": "moco@sspitzer.org", "bug_id": 389808, "count": 4, "text": "Frederic, do you see anything in your history menu, bookmarks menu, or if you open up the history sidebar, bookmarks sidebar or bookmark organizer dialog?\n\nthis might be fall out from #319455.\n\nWe've had similar sounding problems where some SQL fails, and then we fail to initialize a places service.\n\nFrederic:  would you mind sharing your places.sqlite file with me privately, over email?\n", "raw_text": "Frederic, do you see anything in your history menu, bookmarks menu, or if you open up the history sidebar, bookmarks sidebar or bookmark organizer dialog?\n\nthis might be fall out from #319455.\n\nWe've had similar sounding problems where some SQL fails, and then we fail to initialize a places service.\n\nFrederic:  would you mind sharing your places.sqlite file with me privately, over email?\n", "time": "2007-07-27T17:09:00Z", "id": 3262191, "attachment_id": null, "creator": "moco@sspitzer.org"}, {"text": "> I was able to set it as the bookmark toolbar folder and it works again, but\n> maybe the anno expired, somehow?\n\nyou are on to something.  I have some older places.sqlite from various people where the annotation for the personal toolbar folder appears to be expirable.\n\ninvestigating...", "count": 5, "bug_id": 389808, "id": 3262196, "time": "2007-07-27T17:17:18Z", "raw_text": "> I was able to set it as the bookmark toolbar folder and it works again, but\n> maybe the anno expired, somehow?\n\nyou are on to something.  I have some older places.sqlite from various people where the annotation for the personal toolbar folder appears to be expirable.\n\ninvestigating...", "attachment_id": null, "creator": "moco@sspitzer.org", "is_private": false, "creation_time": "2007-07-27T17:17:18Z", "tags": [], "author": "moco@sspitzer.org"}, {"is_private": false, "author": "moco@sspitzer.org", "creation_time": "2007-07-27T17:19:42Z", "tags": [], "id": 3262198, "time": "2007-07-27T17:19:42Z", "raw_text": "if we do happen to be expiring the personal toolbar folder annotation, I don't think we want to ship M7 with this.", "text": "if we do happen to be expiring the personal toolbar folder annotation, I don't think we want to ship M7 with this.", "count": 6, "bug_id": 389808, "creator": "moco@sspitzer.org", "attachment_id": null}, {"attachment_id": null, "creator": "fredbezies@gmail.com", "id": 3262208, "time": "2007-07-27T17:28:10Z", "raw_text": "(In reply to comment #4)\n> Frederic, do you see anything in your history menu, bookmarks menu, or if you\n> open up the history sidebar, bookmarks sidebar or bookmark organizer dialog?\n\nThey are all displayed ok...\n\n> \n> this might be fall out from #319455.\n> \n> We've had similar sounding problems where some SQL fails, and then we fail to\n> initialize a places service.\n> \n> Frederic:  would you mind sharing your places.sqlite file with me privately,\n> over email?\n> \n\nNo. Of course. Send it right now.\n\nBy the way, replacing a backup version of my places.sqlite cure the bug...\n", "count": 7, "text": "(In reply to comment #4)\n> Frederic, do you see anything in your history menu, bookmarks menu, or if you\n> open up the history sidebar, bookmarks sidebar or bookmark organizer dialog?\n\nThey are all displayed ok...\n\n> \n> this might be fall out from #319455.\n> \n> We've had similar sounding problems where some SQL fails, and then we fail to\n> initialize a places service.\n> \n> Frederic:  would you mind sharing your places.sqlite file with me privately,\n> over email?\n> \n\nNo. Of course. Send it right now.\n\nBy the way, replacing a backup version of my places.sqlite cure the bug...\n", "bug_id": 389808, "author": "fredbezies@gmail.com", "tags": [], "creation_time": "2007-07-27T17:28:10Z", "is_private": false}, {"attachment_id": null, "creator": "moco@sspitzer.org", "id": 3262212, "raw_text": "With one places.sqlite I have from an end user, every expiration (including the personal toolbar folder) is EXPIRE_WEEKS (4) and none are EXPIRE_NEVER (1).\n\nthis could explain what Frederic and Mconnor are seeing.", "time": "2007-07-27T17:30:33Z", "text": "With one places.sqlite I have from an end user, every expiration (including the personal toolbar folder) is EXPIRE_WEEKS (4) and none are EXPIRE_NEVER (1).\n\nthis could explain what Frederic and Mconnor are seeing.", "count": 8, "bug_id": 389808, "author": "moco@sspitzer.org", "tags": [], "creation_time": "2007-07-27T17:30:33Z", "is_private": false}, {"attachment_id": null, "creator": "ria.klaassen@gmail.com", "raw_text": "I saw this also. Had to delete places.sqlite but this was not enough. I also had to use another copy of my bookmarks. But it finally works now.", "time": "2007-07-27T17:37:54Z", "id": 3262221, "bug_id": 389808, "text": "I saw this also. Had to delete places.sqlite but this was not enough. I also had to use another copy of my bookmarks. But it finally works now.", "count": 9, "author": "ria.klaassen@gmail.com", "tags": [], "creation_time": "2007-07-27T17:37:54Z", "is_private": false}, {"raw_text": "(In reply to comment #8)\n> With one places.sqlite I have from an end user, every expiration (including the\n> personal toolbar folder) is EXPIRE_WEEKS (4) and none are EXPIRE_NEVER (1).\n> \n> this could explain what Frederic and Mconnor are seeing.\n> \n\nI'm seeing the same in my places.sqlite that was used exclusively with alpha 6. We'll have to make sure that setters are using the right expiration value, and then we'll probably also have to add code to the schema migration to change these to EXPIRE_NEVER.", "time": "2007-07-27T17:39:43Z", "id": 3262223, "bug_id": 389808, "text": "(In reply to comment #8)\n> With one places.sqlite I have from an end user, every expiration (including the\n> personal toolbar folder) is EXPIRE_WEEKS (4) and none are EXPIRE_NEVER (1).\n> \n> this could explain what Frederic and Mconnor are seeing.\n> \n\nI'm seeing the same in my places.sqlite that was used exclusively with alpha 6. We'll have to make sure that setters are using the right expiration value, and then we'll probably also have to add code to the schema migration to change these to EXPIRE_NEVER.", "count": 10, "attachment_id": null, "creator": "hzbz@pm.me", "is_private": false, "author": "hzbz@pm.me", "tags": [], "creation_time": "2007-07-27T17:39:43Z"}, {"creator": "hzbz@pm.me", "attachment_id": null, "bug_id": 389808, "count": 11, "text": "We'll need to do two things:\n\n1. re-add the toolbar annotation to the toolbar folder\n2. update existing EXPIRE_WEEKS annotations to EXPIRE_NEVER\n\nAlso, updating the schema migration doesn't help those who've already updated to the nightly. Instead we could add some migration code in one of the services, that runs only if zero items have the toolbar annotation, and then remove the code in the betas.", "raw_text": "We'll need to do two things:\n\n1. re-add the toolbar annotation to the toolbar folder\n2. update existing EXPIRE_WEEKS annotations to EXPIRE_NEVER\n\nAlso, updating the schema migration doesn't help those who've already updated to the nightly. Instead we could add some migration code in one of the services, that runs only if zero items have the toolbar annotation, and then remove the code in the betas.", "time": "2007-07-27T17:50:16Z", "id": 3262232, "tags": [], "creation_time": "2007-07-27T17:50:16Z", "author": "hzbz@pm.me", "is_private": false}, {"bug_id": 389808, "count": 12, "text": "I saw this this morning on my Windows 2000 system. I have since made a new profile and everything is OK with bookmarks. The old profile started as a Firefox 2 profile that was migrated to Minefield.\n\nMozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.9a7pre) Gecko/2007072705 Minefield/3.0a7pre ID:2007072705", "time": "2007-07-27T18:14:12Z", "raw_text": "I saw this this morning on my Windows 2000 system. I have since made a new profile and everything is OK with bookmarks. The old profile started as a Firefox 2 profile that was migrated to Minefield.\n\nMozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.9a7pre) Gecko/2007072705 Minefield/3.0a7pre ID:2007072705", "is_private": false, "id": 3262259, "attachment_id": null, "creator": "murph.0912@protonmail.com", "creation_time": "2007-07-27T18:14:12Z", "tags": [], "author": "murph.0912@protonmail.com"}, {"text": "(In reply to comment #12)\nYeah, I see this too. When I start the places.sqlite and bookmarks.html file in a new profile there is no toolbar problem. I used those files for my default profile and now I have my normal three months-history and also a bookmarks toolbar.", "count": 13, "bug_id": 389808, "id": 3262319, "time": "2007-07-27T19:05:28Z", "raw_text": "(In reply to comment #12)\nYeah, I see this too. When I start the places.sqlite and bookmarks.html file in a new profile there is no toolbar problem. I used those files for my default profile and now I have my normal three months-history and also a bookmarks toolbar.", "attachment_id": null, "creator": "ria.klaassen@gmail.com", "is_private": false, "tags": [], "creation_time": "2007-07-27T19:05:28Z", "author": "ria.klaassen@gmail.com"}, {"id": 3262340, "raw_text": "- changes annotation constants, reverting EXPIRE_NEVER back to the pre-bug319455 value\n\n- re-adds the bookmark toolbar folder annotation to the folder that has the default toolbar folder title\n\n- does *not* fix the problem for nightly testers who've renamed their toolbar folder, or changed it to a different folder.", "time": "2007-07-27T19:24:27Z", "count": 14, "text": "Created attachment 274197\nfix v1\n\n- changes annotation constants, reverting EXPIRE_NEVER back to the pre-bug319455 value\n\n- re-adds the bookmark toolbar folder annotation to the folder that has the default toolbar folder title\n\n- does *not* fix the problem for nightly testers who've renamed their toolbar folder, or changed it to a different folder.", "bug_id": 389808, "attachment_id": 274197, "creator": "hzbz@pm.me", "is_private": false, "author": "hzbz@pm.me", "tags": [], "creation_time": "2007-07-27T19:24:27Z"}, {"bug_id": 389808, "text": "verification steps:\n\n1. create a profile w/ an Alpha 6 build (or pre-checkin of bug 319455)\n\n2. close the app, open up the sqlite file with SQLite Database Browser, and delete the record from moz_items_annos where anno_attribute_id = 1\n\n3. open the profile with the 2007072705 nightly, and note that the bookmarks toolbar is empty\n\n4. using a build with this patch, open the profile, and note that the bookmarks toolbar contents are back\n\nnote:\n\nthis bug affects other annotation consumers as well, such as microsummaries, and livemarks. the restoration of EXPIRE_NEVER = 4 fixes these consumers also.", "count": 15, "time": "2007-07-27T19:36:54Z", "raw_text": "verification steps:\n\n1. create a profile w/ an Alpha 6 build (or pre-checkin of bug 319455)\n\n2. close the app, open up the sqlite file with SQLite Database Browser, and delete the record from moz_items_annos where anno_attribute_id = 1\n\n3. open the profile with the 2007072705 nightly, and note that the bookmarks toolbar is empty\n\n4. using a build with this patch, open the profile, and note that the bookmarks toolbar contents are back\n\nnote:\n\nthis bug affects other annotation consumers as well, such as microsummaries, and livemarks. the restoration of EXPIRE_NEVER = 4 fixes these consumers also.", "id": 3262352, "creator": "hzbz@pm.me", "attachment_id": null, "is_private": false, "tags": [], "creation_time": "2007-07-27T19:36:54Z", "author": "hzbz@pm.me"}, {"is_private": false, "creation_time": "2007-07-27T19:52:42Z", "tags": [], "author": "hzbz@pm.me", "count": 16, "text": "Created attachment 274201\nfix v2\n\n- revert the expiration constants back to their pre-319455 values where possible, to reduce confusion\n\n- add more comments", "bug_id": 389808, "id": 3262368, "raw_text": "- revert the expiration constants back to their pre-319455 values where possible, to reduce confusion\n\n- add more comments", "time": "2007-07-27T19:52:42Z", "creator": "hzbz@pm.me", "attachment_id": 274201}, {"creation_time": "2007-07-27T19:59:17Z", "tags": [], "creator": "moco@sspitzer.org", "attachment_id": 274201, "author": "moco@sspitzer.org", "text": "Comment on attachment 274201\nfix v2\n\nr=sspitzer", "count": 17, "bug_id": 389808, "id": 3262375, "is_private": false, "time": "2007-07-27T19:59:17Z", "raw_text": "r=sspitzer"}, {"is_private": false, "author": "hzbz@pm.me", "creation_time": "2007-07-27T20:48:39Z", "tags": [], "id": 3262433, "time": "2007-07-27T20:48:39Z", "raw_text": "Checking in toolkit/components/places/public/nsIAnnotationService.idl;\n/cvsroot/mozilla/toolkit/components/places/public/nsIAnnotationService.idl,v  <--  nsIAnnotationService.idl\nnew revision: 1.17; previous revision: 1.16\ndone\nChecking in toolkit/components/places/src/nsNavBookmarks.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavBookmarks.cpp,v  <--  nsNavBookmarks.cpp\nnew revision: 1.115; previous revision: 1.114\ndone\nChecking in toolkit/components/places/src/nsNavHistoryExpire.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavHistoryExpire.cpp,v  <--  nsNavHistoryExpire.cpp\nnew revision: 1.9; previous revision: 1.8\ndone", "text": "Checking in toolkit/components/places/public/nsIAnnotationService.idl;\n/cvsroot/mozilla/toolkit/components/places/public/nsIAnnotationService.idl,v  <--  nsIAnnotationService.idl\nnew revision: 1.17; previous revision: 1.16\ndone\nChecking in toolkit/components/places/src/nsNavBookmarks.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavBookmarks.cpp,v  <--  nsNavBookmarks.cpp\nnew revision: 1.115; previous revision: 1.114\ndone\nChecking in toolkit/components/places/src/nsNavHistoryExpire.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavHistoryExpire.cpp,v  <--  nsNavHistoryExpire.cpp\nnew revision: 1.9; previous revision: 1.8\ndone", "count": 18, "bug_id": 389808, "attachment_id": null, "creator": "hzbz@pm.me"}, {"attachment_id": null, "creator": "peter.vanderwoude@gmail.com", "id": 3262536, "raw_text": "Live bookmarks on the bookmarks toolbar didn't get the reload context menu after this landed.\n\nMy 20070721 places.sqlite backup works fine\n", "time": "2007-07-27T22:42:44Z", "text": "Live bookmarks on the bookmarks toolbar didn't get the reload context menu after this landed.\n\nMy 20070721 places.sqlite backup works fine\n", "count": 19, "bug_id": 389808, "author": "peter.vanderwoude@gmail.com", "creation_time": "2007-07-27T22:42:44Z", "tags": [], "is_private": false}, {"tags": [], "creation_time": "2007-07-27T23:52:39Z", "author": "moco@sspitzer.org", "is_private": false, "attachment_id": null, "creator": "moco@sspitzer.org", "count": 20, "text": "> Live bookmarks on the bookmarks toolbar didn't get the reload context \n> menu after this landed.\n\nyikes.  \n\nThis bug will have wiped out the annotations for livemarks and converted them to regular book folders.", "bug_id": 389808, "id": 3262617, "raw_text": "> Live bookmarks on the bookmarks toolbar didn't get the reload context \n> menu after this landed.\n\nyikes.  \n\nThis bug will have wiped out the annotations for livemarks and converted them to regular book folders.", "time": "2007-07-27T23:52:39Z"}, {"author": "robert.strong.bugs@gmail.com", "tags": [], "creation_time": "2007-07-29T04:57:23Z", "is_private": false, "creator": "robert.strong.bugs@gmail.com", "attachment_id": null, "id": 3263278, "time": "2007-07-29T04:57:23Z", "raw_text": "", "text": "*** Bug 390004 has been marked as a duplicate of this bug. ***", "count": 21, "bug_id": 389808}, {"creator": "moco@sspitzer.org", "attachment_id": null, "raw_text": "unfortunately, jay patel also hit this bug.\n\nfor future reference, it is the 2007072704 that kills your annotations.", "time": "2007-08-07T20:47:35Z", "id": 3273041, "bug_id": 389808, "count": 22, "text": "unfortunately, jay patel also hit this bug.\n\nfor future reference, it is the 2007072704 that kills your annotations.", "author": "moco@sspitzer.org", "tags": [], "creation_time": "2007-08-07T20:47:35Z", "is_private": false}]}}}