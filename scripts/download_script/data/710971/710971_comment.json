{"bugs": {"710971": {"comments": [{"creator": "jdinbox@gmail.com", "author": "jdinbox@gmail.com", "is_private": false, "count": 0, "tags": [], "id": 5918060, "bug_id": 710971, "raw_text": "From http://www.viva64.com/en/a/0078/\n\nExample 5. Incomplete checking of input values\n\nPRBool\nnsStyleAnimation::AddWeighted(...)\n{\n  ...\n  if (unit[0] == eCSSUnit_Null || unit[1] == eCSSUnit_Null ||\n      unit[0] == eCSSUnit_Null || unit[0] == eCSSUnit_URL) {\n    return PR_FALSE;\n  }\n  ...\n}\n\nPVS-Studio diagnostic message: V501 There are identical sub-expressions 'unit [0] == eCSSUnit_Null' to the left and to the right of the '||' operator. nsstyleanimation.cpp 1767\n\nIt seems to me that this code fragment contains 2 misprints simultaneously. I cannot tell for sure how exactly the code should look, but the developers most likely intended it to be written as follows:\n\nif (unit[0] == eCSSUnit_Null || unit[1] == eCSSUnit_Null ||\n    unit[0] == eCSSUnit_URL  || unit[1] == eCSSUnit_URL) {\n\nThe misprints may cause the function to process incorrect input values.", "creation_time": "2011-12-15T06:47:38Z", "text": "From http://www.viva64.com/en/a/0078/\n\nExample 5. Incomplete checking of input values\n\nPRBool\nnsStyleAnimation::AddWeighted(...)\n{\n  ...\n  if (unit[0] == eCSSUnit_Null || unit[1] == eCSSUnit_Null ||\n      unit[0] == eCSSUnit_Null || unit[0] == eCSSUnit_URL) {\n    return PR_FALSE;\n  }\n  ...\n}\n\nPVS-Studio diagnostic message: V501 There are identical sub-expressions 'unit [0] == eCSSUnit_Null' to the left and to the right of the '||' operator. nsstyleanimation.cpp 1767\n\nIt seems to me that this code fragment contains 2 misprints simultaneously. I cannot tell for sure how exactly the code should look, but the developers most likely intended it to be written as follows:\n\nif (unit[0] == eCSSUnit_Null || unit[1] == eCSSUnit_Null ||\n    unit[0] == eCSSUnit_URL  || unit[1] == eCSSUnit_URL) {\n\nThe misprints may cause the function to process incorrect input values.", "time": "2011-12-15T06:47:38Z", "attachment_id": null}, {"creation_time": "2011-12-15T07:17:17Z", "raw_text": "We need to look at both ComputeDistance and AddWeighted.\n\nThere was originally only an nsCSSValuePair case, and it checked both units against null.\n\nhttps://hg.mozilla.org/mozilla-central/rev/dd88bfc07421 added a URL check for the first unit.  Sort of a special case, but reasonable.\n\nI think the mistakes come in the CSSValueTriplet case, from https://hg.mozilla.org/mozilla-central/rev/ea882f18d8ac :\n * ComputeDistance and AddWeighted have different logic there\n * neither checks unit[2] against eCSSUnit_Null, though ComputeDistance almost did (triggering this warning)\n * I think, additionally, neither ValueTriplet case should check against eCSSUnit_URL\n\nNothing actually looks dangerous here, though.", "text": "We need to look at both ComputeDistance and AddWeighted.\n\nThere was originally only an nsCSSValuePair case, and it checked both units against null.\n\nhttps://hg.mozilla.org/mozilla-central/rev/dd88bfc07421 added a URL check for the first unit.  Sort of a special case, but reasonable.\n\nI think the mistakes come in the CSSValueTriplet case, from https://hg.mozilla.org/mozilla-central/rev/ea882f18d8ac :\n * ComputeDistance and AddWeighted have different logic there\n * neither checks unit[2] against eCSSUnit_Null, though ComputeDistance almost did (triggering this warning)\n * I think, additionally, neither ValueTriplet case should check against eCSSUnit_URL\n\nNothing actually looks dangerous here, though.", "time": "2011-12-15T07:17:17Z", "attachment_id": null, "count": 1, "is_private": false, "tags": [], "id": 5918117, "bug_id": 710971, "creator": "dbaron@dbaron.org", "author": "dbaron@dbaron.org"}]}}, "comments": {}}