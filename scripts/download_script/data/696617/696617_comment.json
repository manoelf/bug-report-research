{"comments": {}, "bugs": {"696617": {"comments": [{"creation_time": "2011-10-23T01:14:38Z", "author": "moxie@thoughtcrime.org", "text": "User Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 20110928134238\n\nSteps to reproduce:\n\n1) I call PR_OpenTCPSocket to create several sockets.\n2) I call PR_SetSocketOption on all of them, with arguments to make the sockets non-blocking.\n3) I call PR_Connect on all of them, which correctly returns PR_WOULD_BLOCK_ERROR.\n4) I call PR_Poll on them until one connects.\n5) I call PR_SetSocketOption to return the first connected socket back to blocking mode.\n\nThe above works perfectly on Linux.  On Windows, the final PR_SetSocketOption in step 5 returns PR_SUCCESS, but if I call PR_Read on that fd when there is no data pending, it returns -1 and PR_WOULD_BLOCK_ERROR.  It seems that the second PR_SetSocketOption call in Step 5 is actually failing to return the socket to blocking mode.\n\nI'm not sure if this is a Windows thing or an NSPR bug?\n\n\nActual results:\n\n.\n\n\nExpected results:\n\n.", "time": "2011-10-23T01:14:38Z", "bug_id": 696617, "tags": [], "is_private": false, "creator": "moxie@thoughtcrime.org", "count": 0, "id": 5799012, "attachment_id": null, "raw_text": "User Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 20110928134238\n\nSteps to reproduce:\n\n1) I call PR_OpenTCPSocket to create several sockets.\n2) I call PR_SetSocketOption on all of them, with arguments to make the sockets non-blocking.\n3) I call PR_Connect on all of them, which correctly returns PR_WOULD_BLOCK_ERROR.\n4) I call PR_Poll on them until one connects.\n5) I call PR_SetSocketOption to return the first connected socket back to blocking mode.\n\nThe above works perfectly on Linux.  On Windows, the final PR_SetSocketOption in step 5 returns PR_SUCCESS, but if I call PR_Read on that fd when there is no data pending, it returns -1 and PR_WOULD_BLOCK_ERROR.  It seems that the second PR_SetSocketOption call in Step 5 is actually failing to return the socket to blocking mode.\n\nI'm not sure if this is a Windows thing or an NSPR bug?\n\n\nActual results:\n\n.\n\n\nExpected results:\n\n."}]}}}