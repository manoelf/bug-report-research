{"bugs": {"624770": {"comments": [{"creation_time": "2011-01-11T18:21:33Z", "tags": [], "time": "2011-01-11T18:21:33Z", "attachment_id": null, "author": "shopik@inblock.ru", "creator": "shopik@inblock.ru", "bug_id": 624770, "is_private": false, "text": "After fix in Bug 470746 all drafts stays as unread even after you send email. It does mark it as deleted but should mark as read in that case, otherwise counter on folder is misleading and distracting until you purge folder.", "id": 5190607, "raw_text": "After fix in Bug 470746 all drafts stays as unread even after you send email. It does mark it as deleted but should mark as read in that case, otherwise counter on folder is misleading and distracting until you purge folder.", "count": 0}, {"is_private": false, "text": "Is IMAP delete model of \"Just mark it as deleted\" only issue?\nDoes spec of \"unread count\" include \"unread mail with \\Deleted flag\"?", "bug_id": 624770, "count": 1, "id": 5192616, "raw_text": "Is IMAP delete model of \"Just mark it as deleted\" only issue?\nDoes spec of \"unread count\" include \"unread mail with \\Deleted flag\"?", "tags": [], "creation_time": "2011-01-12T03:44:09Z", "time": "2011-01-12T03:44:09Z", "creator": "m-wada@usa.com", "attachment_id": null, "author": "m-wada@usa.com"}, {"is_private": false, "text": "Yes this is only issue with \"Mark as deleted\" model, when using \"Move to this folder\" mode TB just remove message after sending. I'm not really understood your second sentence", "count": 2, "id": 5194031, "creation_time": "2011-01-12T18:32:39Z", "tags": [], "bug_id": 624770, "raw_text": "Yes this is only issue with \"Mark as deleted\" model, when using \"Move to this folder\" mode TB just remove message after sending. I'm not really understood your second sentence", "time": "2011-01-12T18:32:39Z", "creator": "shopik@inblock.ru", "author": "shopik@inblock.ru", "attachment_id": null}, {"text": "Second question was;\n  If \"unread count\" is \"count of unread mails of no \\Deleted flag\",\n  this bug's problem of \"misleading unread count\" doesn't occur,\n  even if deleted mail's status is not changed to read status.\n  Which is proper solution of this bug?\n  (a) store also \\Seen flag when store \\Deleted flag \n  (b) ignore mail of \\Deleted when unread count display\nI think \"unread count\" should include mail of \\Deleted flag when \"Just mark it as deleted\" model. So, as you say, I also think (a) for \"deleted draft mail only\" is needed.", "is_private": false, "id": 5195200, "count": 3, "tags": [], "creation_time": "2011-01-12T23:55:02Z", "bug_id": 624770, "raw_text": "Second question was;\n  If \"unread count\" is \"count of unread mails of no \\Deleted flag\",\n  this bug's problem of \"misleading unread count\" doesn't occur,\n  even if deleted mail's status is not changed to read status.\n  Which is proper solution of this bug?\n  (a) store also \\Seen flag when store \\Deleted flag \n  (b) ignore mail of \\Deleted when unread count display\nI think \"unread count\" should include mail of \\Deleted flag when \"Just mark it as deleted\" model. So, as you say, I also think (a) for \"deleted draft mail only\" is needed.", "time": "2011-01-12T23:55:02Z", "attachment_id": null, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"count": 4, "id": 5196188, "text": "(a) This is way currently TB work when you _manually_ delete unread email in \"Mark-as-Deleted\" model, it will set \\Deleted and \\Seen flag. So user will expect this work for drafts too.\nAnd thus main purpose of Drafts folder unread count is get attention of user that he\\she have unfinished draft.", "is_private": false, "creation_time": "2011-01-13T09:04:02Z", "tags": [], "raw_text": "(a) This is way currently TB work when you _manually_ delete unread email in \"Mark-as-Deleted\" model, it will set \\Deleted and \\Seen flag. So user will expect this work for drafts too.\nAnd thus main purpose of Drafts folder unread count is get attention of user that he\\she have unfinished draft.", "bug_id": 624770, "creator": "shopik@inblock.ru", "author": "shopik@inblock.ru", "attachment_id": null, "time": "2011-01-13T09:04:02Z"}, {"time": "2011-01-16T14:25:57Z", "attachment_id": null, "author": "shopik@inblock.ru", "creator": "shopik@inblock.ru", "bug_id": 624770, "raw_text": "Well it's fixed with recent build\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0b10pre) Gecko/20110113 Thunderbird/3.3a2pre", "creation_time": "2011-01-16T14:25:57Z", "tags": [], "text": "Well it's fixed with recent build\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0b10pre) Gecko/20110113 Thunderbird/3.3a2pre", "is_private": false, "count": 5, "id": 5203518}, {"tags": [], "creation_time": "2011-01-22T13:06:43Z", "creator": "shopik@inblock.ru", "author": "shopik@inblock.ru", "attachment_id": null, "time": "2011-01-22T13:06:43Z", "raw_text": "It's working in most cases, but in some rare condition it won't mark it as read. To reproduce that you need save draft by pressing ctrl+s and then sending email immediately. Draft will be marked as deleted but not marked as read.\n\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0b10pre) Gecko/20110121 Thunderbird/3.3a3pre", "id": 5219311, "count": 6, "is_private": false, "text": "It's working in most cases, but in some rare condition it won't mark it as read. To reproduce that you need save draft by pressing ctrl+s and then sending email immediately. Draft will be marked as deleted but not marked as read.\n\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0b10pre) Gecko/20110121 Thunderbird/3.3a3pre", "bug_id": 624770}, {"author": "shopik@inblock.ru", "attachment_id": 506099, "creator": "shopik@inblock.ru", "time": "2011-01-22T13:21:40Z", "raw_text": "", "bug_id": 624770, "creation_time": "2011-01-22T13:21:40Z", "tags": [], "count": 7, "id": 5219318, "text": "Created attachment 506099\ndoesn't set seen flag only deleted", "is_private": false}, {"time": "2011-01-22T13:24:39Z", "attachment_id": 506100, "author": "shopik@inblock.ru", "creator": "shopik@inblock.ru", "bug_id": 624770, "raw_text": "To reproduce, good behavior just wait like few seconds before sending email. Also if you open Draft folder you will see during save two messages save, but I believe second message is ui-ghost because if you reopen draft folder there only one draft.", "creation_time": "2011-01-22T13:24:39Z", "tags": [], "is_private": false, "text": "Created attachment 506100\nset both flags, seen and deleted\n\nTo reproduce, good behavior just wait like few seconds before sending email. Also if you open Draft folder you will see during save two messages save, but I believe second message is ui-ghost because if you reopen draft folder there only one draft.", "count": 8, "id": 5219319}, {"raw_text": "Do you enable auto-save?\n\nThere are two issues relevant to auto-save.\n  bug 380275 : for mail send while auto-save is in progress\n  bug 413165 : for auto-save even after send is requested\nAnd, as bug 257735 was fixed in trunk nightly, I could see next phenomenon repeatedly; old version is not deleted by auto-save and multiple copies of draft is generated.\n 1. auto-save=enabled, per one minute\n    draft folder = Draft of Yohoo! Mail IMAP account\n    mail.identity.id1.showSaveMsgDlg=true\n    (dialog after draft save is shown)\n    \"Just mark it as deleted\" model\n 2. Edit a draft mail(say Subject: V01, UID=1) which has large ataachment(s).\n 3. Change subject to \"Subject: V02\", wait for auto-save\n    => Dialog after draft save is shown\n    => V01(UID=1) : Deleted(\\Deleted), Read status(\\Seen)\n    => V02(UID=2) : Active(-\\Deleted), Unread status(-\\Seen)\n 3. Change subject to \"Subject: V03\", wait for auto-save\n 4. Press Ctrl+S, just after progress meter is shown(by auto-save)\n    => Dialog of \"draft save faild, retry or cancel\" by fix of bug 257735\n       (dialog after draft save is not shown)\n    => V02(UID=2) : Remains\n    => V03(UID=3) : Active(-\\Deleted), Unread status(-\\Seen) is created\n 5. Reply \"Retry\" to \"draft save faild, retry or cancel\"\n    => Dialog after save is shown\n    => V02(UID=2) : Deleted(\\Deleted), Read status(\\Seen)\n    => V03(UID=4) : Active(-\\Deleted), Unread status(-\\Seen) is created\n\nBecause next \"draft save/delete\" can happen at same time, \"store \\Seen\", \"store replied status for replied mail\", \"store \\Deleted\" etc. may fail or may not be executed due to resource contention.\n(i-a) auto-save before send request\n(i-b) Ctrl+S before send request\n(ii)  auto-save after send request, while send is in progress\n(iii) mail sending followed by delete of draft, while auto-save is in progress", "bug_id": 624770, "author": "m-wada@usa.com", "creator": "m-wada@usa.com", "attachment_id": null, "time": "2011-01-23T04:41:30Z", "id": 5220058, "count": 9, "text": "Do you enable auto-save?\n\nThere are two issues relevant to auto-save.\n  bug 380275 : for mail send while auto-save is in progress\n  bug 413165 : for auto-save even after send is requested\nAnd, as bug 257735 was fixed in trunk nightly, I could see next phenomenon repeatedly; old version is not deleted by auto-save and multiple copies of draft is generated.\n 1. auto-save=enabled, per one minute\n    draft folder = Draft of Yohoo! Mail IMAP account\n    mail.identity.id1.showSaveMsgDlg=true\n    (dialog after draft save is shown)\n    \"Just mark it as deleted\" model\n 2. Edit a draft mail(say Subject: V01, UID=1) which has large ataachment(s).\n 3. Change subject to \"Subject: V02\", wait for auto-save\n    => Dialog after draft save is shown\n    => V01(UID=1) : Deleted(\\Deleted), Read status(\\Seen)\n    => V02(UID=2) : Active(-\\Deleted), Unread status(-\\Seen)\n 3. Change subject to \"Subject: V03\", wait for auto-save\n 4. Press Ctrl+S, just after progress meter is shown(by auto-save)\n    => Dialog of \"draft save faild, retry or cancel\" by fix of bug 257735\n       (dialog after draft save is not shown)\n    => V02(UID=2) : Remains\n    => V03(UID=3) : Active(-\\Deleted), Unread status(-\\Seen) is created\n 5. Reply \"Retry\" to \"draft save faild, retry or cancel\"\n    => Dialog after save is shown\n    => V02(UID=2) : Deleted(\\Deleted), Read status(\\Seen)\n    => V03(UID=4) : Active(-\\Deleted), Unread status(-\\Seen) is created\n\nBecause next \"draft save/delete\" can happen at same time, \"store \\Seen\", \"store replied status for replied mail\", \"store \\Deleted\" etc. may fail or may not be executed due to resource contention.\n(i-a) auto-save before send request\n(i-b) Ctrl+S before send request\n(ii)  auto-save after send request, while send is in progress\n(iii) mail sending followed by delete of draft, while auto-save is in progress", "is_private": false, "tags": [], "creation_time": "2011-01-23T04:41:30Z"}, {"is_private": false, "text": "(In reply to comment #8)\n> set both flags, seen and deleted\n\nAfter append of new draft version(UID=960), \"uid feth 920:* (flags)\" is executed, then \\Deleted & \\Seen is stored for UD=960.  \n(1) auto-save after send request?\n> 21 append \"Drafts\" (\\Draft) {489+}\n> 21 OK [APPENDUID 1193430880 960] Append completed.\n(2) fetch of the newly saved draft\n> 24 UID fetch 920:* (FLAGS)\n> * 3 FETCH (UID 960 FLAGS (\\Draft \\Recent))\n> 24 OK Fetch completed.\n(3) delete of draft after send completion\n> 27 uid store 960 +Flags (\\Seen \\Deleted)\n> * 3 FETCH (UID 960 FLAGS (\\Deleted \\Seen \\Draft \\Recent))\n> 27 OK Store completed.\n\n(In reply to comment #7)\n> doesn't set seen flag only deleted\n\nAfter append of new draft version(UID=956), \"uid fetch XXX:* (flags)\" is not seen in log. \"Send operation\" looks to have ended earlier than \"both flags are stored\" case. \nTb doesn't know \"\\Seen or no \\Seen\" yet. It looks that \\Seen is not stored because status is not \"no \\Seen flag==Unread\".\n(1) auto-save after send request?\n> 5 append \"Drafts\" (\\Draft) {488+}\n> 5 OK [APPENDUID 1193430880 956] Append completed.\n(2) delete of draft after send completion\n> 8 uid store 956 +Flags (\\Deleted)\n>   * 4 FETCH (UID 956 FLAGS (\\Deleted \\Draft \\Recent))\n> 8 OK Store completed.\n\nI think \"Unconditional store of \\Delete & \\Seen\" is sufficient for this bug's problem.", "count": 10, "id": 5221205, "creation_time": "2011-01-24T05:17:03Z", "tags": [], "bug_id": 624770, "raw_text": "(In reply to comment #8)\n> set both flags, seen and deleted\n\nAfter append of new draft version(UID=960), \"uid feth 920:* (flags)\" is executed, then \\Deleted & \\Seen is stored for UD=960.  \n(1) auto-save after send request?\n> 21 append \"Drafts\" (\\Draft) {489+}\n> 21 OK [APPENDUID 1193430880 960] Append completed.\n(2) fetch of the newly saved draft\n> 24 UID fetch 920:* (FLAGS)\n> * 3 FETCH (UID 960 FLAGS (\\Draft \\Recent))\n> 24 OK Fetch completed.\n(3) delete of draft after send completion\n> 27 uid store 960 +Flags (\\Seen \\Deleted)\n> * 3 FETCH (UID 960 FLAGS (\\Deleted \\Seen \\Draft \\Recent))\n> 27 OK Store completed.\n\n(In reply to comment #7)\n> doesn't set seen flag only deleted\n\nAfter append of new draft version(UID=956), \"uid fetch XXX:* (flags)\" is not seen in log. \"Send operation\" looks to have ended earlier than \"both flags are stored\" case. \nTb doesn't know \"\\Seen or no \\Seen\" yet. It looks that \\Seen is not stored because status is not \"no \\Seen flag==Unread\".\n(1) auto-save after send request?\n> 5 append \"Drafts\" (\\Draft) {488+}\n> 5 OK [APPENDUID 1193430880 956] Append completed.\n(2) delete of draft after send completion\n> 8 uid store 956 +Flags (\\Deleted)\n>   * 4 FETCH (UID 956 FLAGS (\\Deleted \\Draft \\Recent))\n> 8 OK Store completed.\n\nI think \"Unconditional store of \\Delete & \\Seen\" is sufficient for this bug's problem.", "time": "2011-01-24T05:17:03Z", "attachment_id": null, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"text": "I have auto-save enabled in 5 minutes.", "is_private": false, "id": 5221557, "count": 11, "creation_time": "2011-01-24T11:20:54Z", "tags": [], "bug_id": 624770, "raw_text": "I have auto-save enabled in 5 minutes.", "time": "2011-01-24T11:20:54Z", "attachment_id": null, "creator": "shopik@inblock.ru", "author": "shopik@inblock.ru"}, {"bug_id": 624770, "raw_text": "I see this same problem under Ubuntu 11.10 using Thunderbird 10.0.2.  It's very annoying, because when I use the gmail app in my android phone, deleted drafts continue to show up as unread in my email threads in my Inbox view even.  This is because of the way the gmail inbox can still show non-inbox labeled messages if they are in the same thread as an actual inbox messaged.  For example, a deleted draft reply.  Very annoying indeed.", "time": "2012-03-01T22:41:32Z", "author": "eric@ejahn.net", "creator": "eric@ejahn.net", "attachment_id": null, "is_private": false, "text": "I see this same problem under Ubuntu 11.10 using Thunderbird 10.0.2.  It's very annoying, because when I use the gmail app in my android phone, deleted drafts continue to show up as unread in my email threads in my Inbox view even.  This is because of the way the gmail inbox can still show non-inbox labeled messages if they are in the same thread as an actual inbox messaged.  For example, a deleted draft reply.  Very annoying indeed.", "count": 12, "id": 6107545, "tags": [], "creation_time": "2012-03-01T22:41:32Z"}]}}, "comments": {}}