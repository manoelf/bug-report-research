{"comments": {}, "bugs": {"696594": {"comments": [{"raw_text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 2011092900\n\nSteps to reproduce:\n\nLoad up a PNG file with an sRGB chunk in firefox.\n\n\nActual results:\n\nImage is rendered with increased tint so to speak, I suspect it re-applies the system color profile, i.e. that I loaded into Xorg to have color correction on a global scale.\n\n\nExpected results:\n\nNot tint the image.\n\nThis has been reported in the distro bz:\nhttps://bugzilla.novell.com/show_bug.cgi?id=725961\nwith sample images in\nhttps://bugzilla.novell.com/show_bug.cgi?id=725960", "time": "2011-10-22T18:38:48Z", "author": "jengelh@medozas.de", "text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 2011092900\n\nSteps to reproduce:\n\nLoad up a PNG file with an sRGB chunk in firefox.\n\n\nActual results:\n\nImage is rendered with increased tint so to speak, I suspect it re-applies the system color profile, i.e. that I loaded into Xorg to have color correction on a global scale.\n\n\nExpected results:\n\nNot tint the image.\n\nThis has been reported in the distro bz:\nhttps://bugzilla.novell.com/show_bug.cgi?id=725961\nwith sample images in\nhttps://bugzilla.novell.com/show_bug.cgi?id=725960", "count": 0, "id": 5798822, "bug_id": 696594, "attachment_id": null, "tags": [], "creator": "jengelh@medozas.de", "is_private": false, "creation_time": "2011-10-22T18:38:48Z"}, {"creator": "b56girard@gmail.com", "is_private": false, "creation_time": "2011-10-23T15:03:33Z", "attachment_id": null, "tags": [], "author": "b56girard@gmail.com", "text": "I'm not familiar with color management on Linux so here's a few question:\n1) Is this something default in openSUSE/Xorg? If not which settings have you set in which program?\n2) What color space does it expect the programs to render in?\n3) Does setting gfx.color_management.mode=0 in about:config resolve the problem?\n\nFrom the looks of it our logic for getting the output profile is incomplete.", "count": 1, "id": 5799383, "bug_id": 696594, "raw_text": "I'm not familiar with color management on Linux so here's a few question:\n1) Is this something default in openSUSE/Xorg? If not which settings have you set in which program?\n2) What color space does it expect the programs to render in?\n3) Does setting gfx.color_management.mode=0 in about:config resolve the problem?\n\nFrom the looks of it our logic for getting the output profile is incomplete.", "time": "2011-10-23T15:03:33Z"}, {"raw_text": "1. In essence, it runs `dispwin -v -d1 -c -L` and loads \"/home/jengelh/.local/share/color/icc/devices/display/HSD100IFW1 2011-09-14 max nativ min nativ 2.2 MQ-HQ 3xCurve+MTX.icc\" according to strace. dispwin is provided by argyllcms.\n\n2. iccdump says\n\nicc:\nHeader:\n  size         = 18260 bytes\n  CMM          = 'argl'\n  Version      = 2.2.0\n  Device Class = Display\n  Color Space  = RGB\n  Conn. Space  = XYZ\n  Date, Time   = 14 Sep 2011, 12:18:07\n  Platform     = *nix\n  Flags        = Not Embedded Profile, Use anywhere\n  Dev. Mnfctr. = '????'\n  Dev. Model   = '????'\n  Dev. Attrbts = Reflective, Glossy\n  Rndrng Intnt = Relative Colorimetric\n  Illuminant   = 0.964203, 1.000000, 0.824905    [Lab 100.000000, 0.000498, -0.000436]\n  Creator      = 'argl'\n[...]", "time": "2011-10-23T16:13:01Z", "id": 5799426, "bug_id": 696594, "text": "1. In essence, it runs `dispwin -v -d1 -c -L` and loads \"/home/jengelh/.local/share/color/icc/devices/display/HSD100IFW1 2011-09-14 max nativ min nativ 2.2 MQ-HQ 3xCurve+MTX.icc\" according to strace. dispwin is provided by argyllcms.\n\n2. iccdump says\n\nicc:\nHeader:\n  size         = 18260 bytes\n  CMM          = 'argl'\n  Version      = 2.2.0\n  Device Class = Display\n  Color Space  = RGB\n  Conn. Space  = XYZ\n  Date, Time   = 14 Sep 2011, 12:18:07\n  Platform     = *nix\n  Flags        = Not Embedded Profile, Use anywhere\n  Dev. Mnfctr. = '????'\n  Dev. Model   = '????'\n  Dev. Attrbts = Reflective, Glossy\n  Rndrng Intnt = Relative Colorimetric\n  Illuminant   = 0.964203, 1.000000, 0.824905    [Lab 100.000000, 0.000498, -0.000436]\n  Creator      = 'argl'\n[...]", "count": 2, "author": "jengelh@medozas.de", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-10-23T16:13:01Z", "creator": "jengelh@medozas.de"}, {"author": "jengelh@medozas.de", "count": 3, "text": "gfx.color_management.mode=0 turns off color correction within firefox entirely, which is not desired.\n\nThe following new observations point out that the system color profile is not involved any longer.\n\nRetrieve http://www.color.org/Lower_Left.jpg as sample image. This image is false-colored on purpose (\"BGR\"), and has an ICC profile to correct the values stored in the image before display.\n\nSteps to reproduce:\n1. Load Lower_Left.jpg for display in both firefox and e.g. gimp (mine uses libgegl somehow, FYI).\n2. Do a screenshot (import -window root, or similar).\n\nActual results:\n- the upper left pixel of the JPEG is rendered as (108,178,254) [#6cb2fe] in gimp, and (100,158,251) [#649efb] in firefox.\n\nExpected results:\n- because of the simple BGR swap, the ideal rendered color would have been (108,176,254) [#6cb0fe]. The error of the color conversion is therefore (0,2,0) for gimp and (8,20,3) for firefox.\n\nTest 2 follows.\n\nSteps to reproduce:\n1. Create a PNG file with gimp that has all pixels set to (255,0,0) [#ff0000], and sRGB-Perceptual assigned (Image\u00a0> Mode\u00a0> Assign Color Profile\u00a0> sRGB).\n2. Load the resulting PNG in firefox.\n3. Make a screenshot.\n\nActual results:\n- firefox displays it as (255,0,23) [#ff0017], gimp as (255,0,0) [#ff0000]. The error for firefox is therefore (0,0,23), about as larger as with the JPEG file.\n\nExpected results:\n- as observed, gimp has a slight roundoff error in the first test. Since this is not present in the red image, it is possible that gimp may skip the color conversion (since the file is already sRGB).\n- in anticipation of that it does skip the conversion, I would expect for a rounding error of at most (0,0,3) for any program that does a color conversion in some way.", "creator": "jengelh@medozas.de", "is_private": false, "creation_time": "2011-10-23T17:56:18Z", "id": 5799486, "bug_id": 696594, "attachment_id": null, "raw_text": "gfx.color_management.mode=0 turns off color correction within firefox entirely, which is not desired.\n\nThe following new observations point out that the system color profile is not involved any longer.\n\nRetrieve http://www.color.org/Lower_Left.jpg as sample image. This image is false-colored on purpose (\"BGR\"), and has an ICC profile to correct the values stored in the image before display.\n\nSteps to reproduce:\n1. Load Lower_Left.jpg for display in both firefox and e.g. gimp (mine uses libgegl somehow, FYI).\n2. Do a screenshot (import -window root, or similar).\n\nActual results:\n- the upper left pixel of the JPEG is rendered as (108,178,254) [#6cb2fe] in gimp, and (100,158,251) [#649efb] in firefox.\n\nExpected results:\n- because of the simple BGR swap, the ideal rendered color would have been (108,176,254) [#6cb0fe]. The error of the color conversion is therefore (0,2,0) for gimp and (8,20,3) for firefox.\n\nTest 2 follows.\n\nSteps to reproduce:\n1. Create a PNG file with gimp that has all pixels set to (255,0,0) [#ff0000], and sRGB-Perceptual assigned (Image\u00a0> Mode\u00a0> Assign Color Profile\u00a0> sRGB).\n2. Load the resulting PNG in firefox.\n3. Make a screenshot.\n\nActual results:\n- firefox displays it as (255,0,23) [#ff0017], gimp as (255,0,0) [#ff0000]. The error for firefox is therefore (0,0,23), about as larger as with the JPEG file.\n\nExpected results:\n- as observed, gimp has a slight roundoff error in the first test. Since this is not present in the red image, it is possible that gimp may skip the color conversion (since the file is already sRGB).\n- in anticipation of that it does skip the conversion, I would expect for a rounding error of at most (0,0,3) for any program that does a color conversion in some way.", "time": "2011-10-23T17:56:18Z", "tags": []}, {"author": "b56girard@gmail.com", "count": 4, "text": "I know that disabling the color management isn't the solution. I'm trying to diagnose and understand the problem in order to know what the best fix is. Does disabling.\n\nYour original problem is that color management is applied by both Firefox and 'globally'. Does disabling it prevent it from being applied twice.\n\nWhat you're describing in Comment #3 appears to be an entirely different bug. I would like to resolve these issues separately if they are separate.", "id": 5799513, "bug_id": 696594, "time": "2011-10-23T18:40:47Z", "raw_text": "I know that disabling the color management isn't the solution. I'm trying to diagnose and understand the problem in order to know what the best fix is. Does disabling.\n\nYour original problem is that color management is applied by both Firefox and 'globally'. Does disabling it prevent it from being applied twice.\n\nWhat you're describing in Comment #3 appears to be an entirely different bug. I would like to resolve these issues separately if they are separate.", "creator": "b56girard@gmail.com", "creation_time": "2011-10-23T18:40:47Z", "is_private": false, "attachment_id": null, "tags": []}, {"id": 5799537, "bug_id": 696594, "count": 5, "text": "My original problem was just that I noticed hues increasing. The assumption that the color profile was applied twice has been redacted since firefox's behavior is reproducible even when the global color correction is cleared.", "author": "jengelh@medozas.de", "time": "2011-10-23T19:15:09Z", "raw_text": "My original problem was just that I noticed hues increasing. The assumption that the color profile was applied twice has been redacted since firefox's behavior is reproducible even when the global color correction is cleared.", "creation_time": "2011-10-23T19:15:09Z", "is_private": false, "creator": "jengelh@medozas.de", "tags": [], "attachment_id": null}]}}}