{"comments": {}, "bugs": {"639724": {"comments": [{"text": "The summary might not be very clear...\n\nAs far as I understand it, nsAttrValue::mBits can store a pointer to a MiscContainer. When it does that, it stores 2 bits for the type and 62 bits for the pointer. On 64 bits system, the pointer might need 64 bits, thus, the pointer returned by nsAttrValue::GetPtr() might be incorrect.\n\nFor this reason (and others like bug 586761 or simply readability), I think we should use a PRPackedBool to store the type and a union to store the data, instead of the current PRUptrdiff. That would increase the size of the object of 1 octet (9 octets instead of 8) but might also decrease the use of MiscContainer (which requires 20 octets in addition of the first 8).\n\nThis said, I'm sure I'm missing something... Please, tell me what :)", "raw_text": "The summary might not be very clear...\n\nAs far as I understand it, nsAttrValue::mBits can store a pointer to a MiscContainer. When it does that, it stores 2 bits for the type and 62 bits for the pointer. On 64 bits system, the pointer might need 64 bits, thus, the pointer returned by nsAttrValue::GetPtr() might be incorrect.\n\nFor this reason (and others like bug 586761 or simply readability), I think we should use a PRPackedBool to store the type and a union to store the data, instead of the current PRUptrdiff. That would increase the size of the object of 1 octet (9 octets instead of 8) but might also decrease the use of MiscContainer (which requires 20 octets in addition of the first 8).\n\nThis said, I'm sure I'm missing something... Please, tell me what :)", "creator": "mounir@lamouri.fr", "time": "2011-03-08T02:53:22Z", "count": 0, "bug_id": 639724, "tags": [], "creation_time": "2011-03-08T02:53:22Z", "attachment_id": null, "id": 5329213, "author": "mounir@lamouri.fr", "is_private": false}, {"count": 1, "time": "2011-03-08T03:09:00Z", "creator": "bzbarsky@mit.edu", "raw_text": "> On 64 bits system, the pointer might need 64 bits\n\nIn theory.  Depending on what it's pointing to.\n\nCan we ever have a situation here where the thing being pointed to is not aligned on a 4-byte boundary?  I'd think no... \n\n> That would increase the size of the object of 1 octet (9 octets instead of 8)\n\nWhich due to alignment means doubling the sie of the object, right?\n\n> but might also decrease the use of MiscContainer\n\nI think the idea is that MiscContainer is the rare case (though it's worth checking that assumption!).", "text": "> On 64 bits system, the pointer might need 64 bits\n\nIn theory.  Depending on what it's pointing to.\n\nCan we ever have a situation here where the thing being pointed to is not aligned on a 4-byte boundary?  I'd think no... \n\n> That would increase the size of the object of 1 octet (9 octets instead of 8)\n\nWhich due to alignment means doubling the sie of the object, right?\n\n> but might also decrease the use of MiscContainer\n\nI think the idea is that MiscContainer is the rare case (though it's worth checking that assumption!).", "is_private": false, "author": "bzbarsky@mit.edu", "id": 5329235, "attachment_id": null, "creation_time": "2011-03-08T03:09:00Z", "tags": [], "bug_id": 639724}, {"text": "Why is 64bit different from 32bit? I.e. why would using 30 bits to store a pointer be a problem on 32bit systems?\n\nIn all sorts of places we only use tagged pointers where we use the two lowest bits to store additional information. So far that seems to have worked just fine, both on 32bit and 64bit.", "creator": "jonas@sicking.cc", "raw_text": "Why is 64bit different from 32bit? I.e. why would using 30 bits to store a pointer be a problem on 32bit systems?\n\nIn all sorts of places we only use tagged pointers where we use the two lowest bits to store additional information. So far that seems to have worked just fine, both on 32bit and 64bit.", "count": 2, "time": "2011-03-08T03:29:18Z", "bug_id": 639724, "attachment_id": null, "tags": [], "creation_time": "2011-03-08T03:29:18Z", "id": 5329263, "is_private": false, "author": "jonas@sicking.cc"}, {"text": "Err.. that should say:\n\nI.e. why wouldn't using 30 bits to store a pointer be a problem on 32bit systems?", "raw_text": "Err.. that should say:\n\nI.e. why wouldn't using 30 bits to store a pointer be a problem on 32bit systems?", "creator": "jonas@sicking.cc", "time": "2011-03-08T03:30:03Z", "count": 3, "bug_id": 639724, "tags": [], "creation_time": "2011-03-08T03:30:03Z", "attachment_id": null, "id": 5329267, "author": "jonas@sicking.cc", "is_private": false}, {"attachment_id": null, "creation_time": "2018-06-29T04:49:31Z", "tags": [], "creator": "bug-husbandry-bot@mozilla.bugs", "raw_text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly.", "bug_id": 639724, "text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly.", "is_private": false, "count": 4, "author": "bug-husbandry-bot@mozilla.bugs", "time": "2018-06-29T04:49:31Z", "id": 13436241}]}}}