{"bugs": {"682609": {"comments": [{"time": "2011-08-27T21:03:31Z", "raw_text": "Our codebase is plagued by the NS_ASSERTION macro whose name wrongly suggests that it's an assertion, which it currently isn't by default (only is with XPCOM_DEBUG_BREAK set to a suitable value). As a result, we have lots of bugs that are harder than necessary to track down, because people have been relying on NS_ASSERTION for stuff that should have been fatal.\n\nLately there's been discussion on dev-platform about that, and I don't know what the conclusions were; the present bug will serve as a tracking bug for all the places where NS_ASSERTION is used where a real assert is needed.", "attachment_id": null, "tags": [], "creator": "jacob.benoit.1@gmail.com", "count": 0, "text": "Our codebase is plagued by the NS_ASSERTION macro whose name wrongly suggests that it's an assertion, which it currently isn't by default (only is with XPCOM_DEBUG_BREAK set to a suitable value). As a result, we have lots of bugs that are harder than necessary to track down, because people have been relying on NS_ASSERTION for stuff that should have been fatal.\n\nLately there's been discussion on dev-platform about that, and I don't know what the conclusions were; the present bug will serve as a tracking bug for all the places where NS_ASSERTION is used where a real assert is needed.", "author": "jacob.benoit.1@gmail.com", "id": 5682868, "bug_id": 682609, "creation_time": "2011-08-27T21:03:31Z", "is_private": false}, {"is_private": false, "creation_time": "2011-08-27T21:19:22Z", "creator": "jacob.benoit.1@gmail.com", "tags": [], "attachment_id": null, "bug_id": 682609, "id": 5682892, "count": 1, "text": "David: bug 678327 comment 5 says that you are working on resolving this general issue. Is there a bug filed for that? The present bug is only a tracking bug for places where NS_ASSERTION is used and its current default behavior is unsuitable.", "author": "jacob.benoit.1@gmail.com", "time": "2011-08-27T21:19:22Z", "raw_text": "David: bug 678327 comment 5 says that you are working on resolving this general issue. Is there a bug filed for that? The present bug is only a tracking bug for places where NS_ASSERTION is used and its current default behavior is unsuitable."}, {"is_private": false, "creation_time": "2011-08-27T21:23:31Z", "creator": "jacob.benoit.1@gmail.com", "tags": [], "attachment_id": null, "id": 5682895, "bug_id": 682609, "author": "jacob.benoit.1@gmail.com", "count": 2, "text": "NS_PRECONDITION has the same problem as NS_ASSERTION.", "time": "2011-08-27T21:23:31Z", "raw_text": "NS_PRECONDITION has the same problem as NS_ASSERTION."}, {"creation_time": "2018-04-30T04:24:13Z", "is_private": false, "id": 13242008, "bug_id": 682609, "text": "Bug 1457813 will replace 1436 non-asserting NS_PRECONDITIONs with MOZ_ASSERT and two asserting NS_PRECONDITIONs with NS_ASSERTIONS: bug 478135 and bug 749326.", "count": 3, "author": "cpeterson@mozilla.com", "creator": "cpeterson@mozilla.com", "tags": [], "raw_text": "Bug 1457813 will replace 1436 non-asserting NS_PRECONDITIONs with MOZ_ASSERT and two asserting NS_PRECONDITIONs with NS_ASSERTIONS: bug 478135 and bug 749326.", "attachment_id": null, "time": "2018-04-30T04:24:13Z"}, {"author": "krosylight@mozilla.com", "text": "This was raised again in https://phabricator.services.mozilla.com/D69858#inline-414015. Am I understanding right that an `NS_ASSERTION` should be replaced by `MOZ_ASSERT` unless doing so causes a crash?", "count": 4, "creator": "krosylight@mozilla.com", "creation_time": "2020-04-09T10:53:49Z", "is_private": false, "id": 14744969, "bug_id": 682609, "attachment_id": null, "raw_text": "This was raised again in https://phabricator.services.mozilla.com/D69858#inline-414015. Am I understanding right that an `NS_ASSERTION` should be replaced by `MOZ_ASSERT` unless doing so causes a crash?", "time": "2020-04-09T10:53:49Z", "tags": []}, {"tags": [], "time": "2020-04-14T19:07:15Z", "raw_text": "(In reply to Kagami :saschanaz from comment #4)\n> This was raised again in https://phabricator.services.mozilla.com/D69858#inline-414015. Am I understanding right that an `NS_ASSERTION` should be replaced by `MOZ_ASSERT` unless doing so causes a crash?\n\nNew code should prefer `MOZ_ASSERT` over `NS_ASSERTION`.\n\n`MOZ_ASSERT` will abort in debug builds so we can find and fix assertion failures hit during automated tests. `NS_ASSERTION` will just print a warning which is easy to miss. Some of our test runners will detect `NS_ASSERTION` warnings and treat them as test failures, but I don't know if all the test runners do.", "attachment_id": null, "bug_id": 682609, "id": 14755083, "creation_time": "2020-04-14T19:07:15Z", "is_private": false, "creator": "cpeterson@mozilla.com", "count": 5, "text": "(In reply to Kagami :saschanaz from comment #4)\n> This was raised again in https://phabricator.services.mozilla.com/D69858#inline-414015. Am I understanding right that an `NS_ASSERTION` should be replaced by `MOZ_ASSERT` unless doing so causes a crash?\n\nNew code should prefer `MOZ_ASSERT` over `NS_ASSERTION`.\n\n`MOZ_ASSERT` will abort in debug builds so we can find and fix assertion failures hit during automated tests. `NS_ASSERTION` will just print a warning which is easy to miss. Some of our test runners will detect `NS_ASSERTION` warnings and treat them as test failures, but I don't know if all the test runners do.", "author": "cpeterson@mozilla.com"}]}}, "comments": {}}