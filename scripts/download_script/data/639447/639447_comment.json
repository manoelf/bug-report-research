{"bugs": {"639447": {"comments": [{"bug_id": 639447, "creation_time": "2011-03-07T11:06:33Z", "raw_text": "Currently, when selecting a calendar item and then moving focus it is not always clear if the item is in the current selection. For example, STR:\n\n\n1. Go to mail mode\n2. Select an item from the today pane\n3. Select a folder item from the folder pane\n\n\nThis causes the calendar item to be shown in bright blue, even though the folder pane is currently in focus.\n\nIn this bug I will be creating a manager interface so we can handle selection and focus better.", "tags": [], "is_private": false, "time": "2011-03-07T11:06:33Z", "id": 5326814, "creator": "philipp@bugzilla.kewis.ch", "attachment_id": null, "text": "Currently, when selecting a calendar item and then moving focus it is not always clear if the item is in the current selection. For example, STR:\n\n\n1. Go to mail mode\n2. Select an item from the today pane\n3. Select a folder item from the folder pane\n\n\nThis causes the calendar item to be shown in bright blue, even though the folder pane is currently in focus.\n\nIn this bug I will be creating a manager interface so we can handle selection and focus better.", "count": 0, "author": "philipp@bugzilla.kewis.ch"}, {"id": 5336736, "time": "2011-03-10T18:45:15Z", "is_private": false, "tags": [], "creation_time": "2011-03-10T18:45:15Z", "bug_id": 639447, "raw_text": "This patch adds a selection manager that takes care of the currently focused selection. The different parts of the calendar UI now notify this manager when they receive or loose focus.\n\nThis has made the specific commands for modify/deleting the focused items obsolete and also its no longer needed to differ between tasks and events, its merely items w.r.t selection.\n\nI was also able to make the circular dependancy between the views and unifinder a bit more intuitive since the selection manager allows listening for selection changes.\n\nI've also changed the CSS a bit so that its more visible to the user which pane is currently active. Similar to the already existing behavior in the tree views, when the today pane is not in focus then instead of the selected blue color, a gray inactive color is shown. \n\nThis also lead to finding a bug with showing the currently happening event: If an event is currenly occurring, then it is shown in light blue. If you previously selected this event, then selected something else, the light blue went away. I've fixed this by changing the attribute name from \"current\" to \"currentEvent\".\n\nThe Sunbird changes are untested and don't have to be reviewed thourougly (NPOTB).\n\nSince this patch is large, if you need support for reviewing please let me know and I'll set additional review to someone else.", "author": "philipp@bugzilla.kewis.ch", "count": 1, "text": "Created attachment 518438\nFix - v1\n\nThis patch adds a selection manager that takes care of the currently focused selection. The different parts of the calendar UI now notify this manager when they receive or loose focus.\n\nThis has made the specific commands for modify/deleting the focused items obsolete and also its no longer needed to differ between tasks and events, its merely items w.r.t selection.\n\nI was also able to make the circular dependancy between the views and unifinder a bit more intuitive since the selection manager allows listening for selection changes.\n\nI've also changed the CSS a bit so that its more visible to the user which pane is currently active. Similar to the already existing behavior in the tree views, when the today pane is not in focus then instead of the selected blue color, a gray inactive color is shown. \n\nThis also lead to finding a bug with showing the currently happening event: If an event is currenly occurring, then it is shown in light blue. If you previously selected this event, then selected something else, the light blue went away. I've fixed this by changing the attribute name from \"current\" to \"currentEvent\".\n\nThe Sunbird changes are untested and don't have to be reviewed thourougly (NPOTB).\n\nSince this patch is large, if you need support for reviewing please let me know and I'll set additional review to someone else.", "attachment_id": 518438, "creator": "philipp@bugzilla.kewis.ch"}, {"raw_text": "In addition to the previous comments, this patch removes a few unneeded functions and simplifies getting items of a specific type:\n\n* getSelectedTasks() gets replaced with gCalendarSelection.getSelectedItemsType()\n  which gets items that implement a specific interface\n\n* getTaskTree() is removed since there was only one caller left, replaced with\n  document.tooltipNode which works fine.", "creation_time": "2011-03-10T20:40:48Z", "bug_id": 639447, "tags": [], "is_private": false, "time": "2011-03-10T20:40:48Z", "id": 5337136, "creator": "philipp@bugzilla.kewis.ch", "attachment_id": 518491, "text": "Created attachment 518491\nFix - v2\n\nIn addition to the previous comments, this patch removes a few unneeded functions and simplifies getting items of a specific type:\n\n* getSelectedTasks() gets replaced with gCalendarSelection.getSelectedItemsType()\n  which gets items that implement a specific interface\n\n* getTaskTree() is removed since there was only one caller left, replaced with\n  document.tooltipNode which works fine.", "count": 2, "author": "philipp@bugzilla.kewis.ch"}, {"id": 5377352, "time": "2011-03-29T14:15:57Z", "tags": [], "raw_text": "Just tested the fix-v2 on Thunderbird 3.3a4 (Miramar) after the building troubles. :-)\n\n(In reply to comment #1)\n> I've also changed the CSS a bit so that its more visible to the user which pane\n> is currently active. Similar to the already existing behavior in the tree\n> views, when the today pane is not in focus then instead of the selected blue\n> color, a gray inactive color is shown. \n\nThis doesn't seem working.\nWhen I click on an event on the today pane, I can't get the normal look of a selected event i.e. the bright(selected) blue color. I can get the bright blue only if I press the tab key (as many time as needed to move the focus on the agenda). A normal selection by clicking on the event, gives to the events the gray inactive color, but then, clicking another element (a task in the task section, a mail or a folder in the mail pane), the event doesn't change look, it stays gray so it's impossible to understand if the event is selected or focused/blurred.\n\n\n> This also lead to finding a bug with showing the currently happening event: If\n> an event is currenly occurring, then it is shown in light blue. If you\n> previously selected this event, then selected something else, the light blue\n> went away. I've fixed this by changing the attribute name from \"current\" to\n> \"currentEvent\".\n\nThis now seems working fine.\n\n\nI've also found these wrong behaviors:\n\n1)\nThe events on the todaypane can't be neither opened nor deleted by double click or by contextual menu items. The only possible action is converting to mail or task (the only item active in the contextual menu). Once converted into a task (save and close the dialog but *without* click any element in the view) then the items \"Open\" and \"Delete event\" in the contextual menu becomes active, though, opening or deleting any event actually acts on the just converted task and not on the selected event.\nOnce done the conversion into a task by saving and closing the dialog, if you click in the view (select an event or change the selected day), in the contextual menu, the items \"Open\" and \"Delete event\" become inactive as before.\n\n2) \nI don't know how this could depend on the patch but I verify this behavior in the task view:\n- create a new task;\n- go in task mode and select the task;\n- double click the task in order to open the edit dialog (the dialog gets\n  the focus)\n  -> the buttons on the task message-header disappear;\n- close the edit dialog\n  -> the buttons on the task message-header reappear;\n\n\nAnother thing related to the Windows 7 (aero?) theme (that actually is matter for another bug):\nall the items in the system, selected or blurred, have a look that is that one you can find e.g. on the Thunderbird's folder pane as you can see in the screenshot (I don't know whether this is customizable somehow via Windows' settings) i.e. a transparent blue color with a thin border (darker when selected, clearer when blurred/hovered). The same look is present in the todaypane's tasks section and in the unifinder. Instead, the look on the agenda is different (apart from the issue) and maybe would be better a more similar look.\n\nNow I'm going to take a look to the code.", "bug_id": 639447, "creation_time": "2011-03-29T14:15:57Z", "is_private": false, "text": "Created attachment 522670\nSelected items on Windows 7\n\nJust tested the fix-v2 on Thunderbird 3.3a4 (Miramar) after the building troubles. :-)\n\n(In reply to comment #1)\n> I've also changed the CSS a bit so that its more visible to the user which pane\n> is currently active. Similar to the already existing behavior in the tree\n> views, when the today pane is not in focus then instead of the selected blue\n> color, a gray inactive color is shown. \n\nThis doesn't seem working.\nWhen I click on an event on the today pane, I can't get the normal look of a selected event i.e. the bright(selected) blue color. I can get the bright blue only if I press the tab key (as many time as needed to move the focus on the agenda). A normal selection by clicking on the event, gives to the events the gray inactive color, but then, clicking another element (a task in the task section, a mail or a folder in the mail pane), the event doesn't change look, it stays gray so it's impossible to understand if the event is selected or focused/blurred.\n\n\n> This also lead to finding a bug with showing the currently happening event: If\n> an event is currenly occurring, then it is shown in light blue. If you\n> previously selected this event, then selected something else, the light blue\n> went away. I've fixed this by changing the attribute name from \"current\" to\n> \"currentEvent\".\n\nThis now seems working fine.\n\n\nI've also found these wrong behaviors:\n\n1)\nThe events on the todaypane can't be neither opened nor deleted by double click or by contextual menu items. The only possible action is converting to mail or task (the only item active in the contextual menu). Once converted into a task (save and close the dialog but *without* click any element in the view) then the items \"Open\" and \"Delete event\" in the contextual menu becomes active, though, opening or deleting any event actually acts on the just converted task and not on the selected event.\nOnce done the conversion into a task by saving and closing the dialog, if you click in the view (select an event or change the selected day), in the contextual menu, the items \"Open\" and \"Delete event\" become inactive as before.\n\n2) \nI don't know how this could depend on the patch but I verify this behavior in the task view:\n- create a new task;\n- go in task mode and select the task;\n- double click the task in order to open the edit dialog (the dialog gets\n  the focus)\n  -> the buttons on the task message-header disappear;\n- close the edit dialog\n  -> the buttons on the task message-header reappear;\n\n\nAnother thing related to the Windows 7 (aero?) theme (that actually is matter for another bug):\nall the items in the system, selected or blurred, have a look that is that one you can find e.g. on the Thunderbird's folder pane as you can see in the screenshot (I don't know whether this is customizable somehow via Windows' settings) i.e. a transparent blue color with a thin border (darker when selected, clearer when blurred/hovered). The same look is present in the todaypane's tasks section and in the unifinder. Instead, the look on the agenda is different (apart from the issue) and maybe would be better a more similar look.\n\nNow I'm going to take a look to the code.", "count": 3, "author": "bv1578@gmail.com", "creator": "bv1578@gmail.com", "attachment_id": 522670}, {"attachment_id": null, "creator": "bv1578@gmail.com", "author": "bv1578@gmail.com", "text": "Forgot to say that the contextual menu in the task section of today pane is broken too. Only the item \"New task...\" is active, but here, deleting the tasks with the \"del\" key or opening them with double click is working.", "count": 4, "is_private": false, "tags": [], "bug_id": 639447, "creation_time": "2011-03-30T08:09:03Z", "raw_text": "Forgot to say that the contextual menu in the task section of today pane is broken too. Only the item \"New task...\" is active, but here, deleting the tasks with the \"del\" key or opening them with double click is working.", "id": 5379781, "time": "2011-03-30T08:09:03Z"}, {"is_private": false, "attachment_id": 518491, "raw_text": "Found another issue related to bug 632174\n\nStart Thunderbird with unifinder already closed in the previous session, switch to calendar mode, drag and drop (or open) any event in the view. The console shows the error:\n\nError: TypeError: this.tree.view is undefined STACK: 1: [resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js:1236] notifyFunc\n2: [resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js:1239] calListenerBag_notify\n3: [resource://calendar/modules/calSelectionManager.jsm:214] notifySelectionChanged\n4: [chrome://calendar/content/calendar-month-view.xml:665] setSelectedItems\n5: [chrome://calendar/content/calendar-view-core.xml:298] select\n6: [chrome://calendar/content/calendar-view-core.xml:382] onxbldraggesture\n\nSource File: resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js\nLine: 1236\n\nThe error occurs only the first time an event is moved.\n\nThe error is different from that one reported in bug 632174 but the cause is probably the same, though, that error occurs, instead of the one mentioned above, if you start TB with unifinder open and then you close it before move the event. Starting TB with unifinder closed, and moving an event, generates the error reported here that is specific of the code present in the patch.\n\nAll considered, I think would be better to take a look to another patch with fewer issues.\nr-", "creation_time": "2011-04-05T09:17:51Z", "bug_id": 639447, "creator": "bv1578@gmail.com", "tags": [], "author": "bv1578@gmail.com", "time": "2011-04-05T09:17:51Z", "id": 5390931, "text": "Comment on attachment 518491\nFix - v2\n\nFound another issue related to bug 632174\n\nStart Thunderbird with unifinder already closed in the previous session, switch to calendar mode, drag and drop (or open) any event in the view. The console shows the error:\n\nError: TypeError: this.tree.view is undefined STACK: 1: [resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js:1236] notifyFunc\n2: [resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js:1239] calListenerBag_notify\n3: [resource://calendar/modules/calSelectionManager.jsm:214] notifySelectionChanged\n4: [chrome://calendar/content/calendar-month-view.xml:665] setSelectedItems\n5: [chrome://calendar/content/calendar-view-core.xml:298] select\n6: [chrome://calendar/content/calendar-view-core.xml:382] onxbldraggesture\n\nSource File: resource://calendar/modules/calUtils.jsm -> file:///C:/.../calendar-js/calUtils.js\nLine: 1236\n\nThe error occurs only the first time an event is moved.\n\nThe error is different from that one reported in bug 632174 but the cause is probably the same, though, that error occurs, instead of the one mentioned above, if you start TB with unifinder open and then you close it before move the event. Starting TB with unifinder closed, and moving an event, generates the error reported here that is specific of the code present in the patch.\n\nAll considered, I think would be better to take a look to another patch with fewer issues.\nr-", "count": 5}, {"id": 5524745, "time": "2011-06-10T13:15:06Z", "tags": [], "raw_text": "Decathlon, thank you very much for your elaborate review. I had hoped my patch would \"just work\", but good thing you found the errors before checkin.\n\nGiven Thunderbird 5 is due around the 21st, I'm going to postpone this until after the release.", "creation_time": "2011-06-10T13:15:06Z", "bug_id": 639447, "is_private": false, "text": "Decathlon, thank you very much for your elaborate review. I had hoped my patch would \"just work\", but good thing you found the errors before checkin.\n\nGiven Thunderbird 5 is due around the 21st, I'm going to postpone this until after the release.", "count": 6, "author": "philipp@bugzilla.kewis.ch", "creator": "philipp@bugzilla.kewis.ch", "attachment_id": null}, {"is_private": false, "creation_time": "2012-01-16T20:24:05Z", "bug_id": 639447, "raw_text": "Whats the status on this one?\n\nSince selections seems to be quite buggy, this one should get some attention.", "tags": [], "time": "2012-01-16T20:24:05Z", "id": 5983411, "attachment_id": null, "creator": "Mozilla@Adrario.de", "author": "Mozilla@Adrario.de", "text": "Whats the status on this one?\n\nSince selections seems to be quite buggy, this one should get some attention.", "count": 7}, {"text": "I haven't done anything since the patch was uploaded. As mentioned in the other bug, feel free to take over :-)", "count": 8, "author": "philipp@bugzilla.kewis.ch", "creator": "philipp@bugzilla.kewis.ch", "attachment_id": null, "time": "2012-01-16T20:30:42Z", "id": 5983437, "raw_text": "I haven't done anything since the patch was uploaded. As mentioned in the other bug, feel free to take over :-)", "creation_time": "2012-01-16T20:30:42Z", "bug_id": 639447, "tags": [], "is_private": false}, {"raw_text": "", "bug_id": 639447, "creation_time": "2014-09-28T21:33:43Z", "creator": "philipp@bugzilla.kewis.ch", "tags": [], "attachment_id": null, "is_private": false, "count": 9, "text": "*** Bug 485447 has been marked as a duplicate of this bug. ***", "author": "philipp@bugzilla.kewis.ch", "time": "2014-09-28T21:33:43Z", "id": 9371654}]}}, "comments": {}}