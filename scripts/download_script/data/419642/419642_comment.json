{"comments": {}, "bugs": {"419642": {"comments": [{"attachment_id": null, "id": 3499772, "tags": [], "creation_time": "2008-02-26T16:30:28Z", "text": "STEPS TO REPRODUCE\n1. start Firefox trunk debug build on MacOSX and leave it open for a while\n\nACTUAL RESULTS\nAfter a couple of minutes a bunch of these warnings appear on the console:\n\nWARNING: Unsafe use of LIKE detected!  Please ensure that you are using mozIStorageConnection::escapeStringForLIKE and that you are binding that result to the statement to prevent SQL injection attacks.: file /Users/mats/ff-trunk/mozilla/storage/src/mozStorageStatement.cpp, line 176\n\n(I have a couple of minor patches in this tree but I doubt they caused it)", "raw_text": "STEPS TO REPRODUCE\n1. start Firefox trunk debug build on MacOSX and leave it open for a while\n\nACTUAL RESULTS\nAfter a couple of minutes a bunch of these warnings appear on the console:\n\nWARNING: Unsafe use of LIKE detected!  Please ensure that you are using mozIStorageConnection::escapeStringForLIKE and that you are binding that result to the statement to prevent SQL injection attacks.: file /Users/mats/ff-trunk/mozilla/storage/src/mozStorageStatement.cpp, line 176\n\n(I have a couple of minor patches in this tree but I doubt they caused it)", "creator": "mats@mozilla.com", "is_private": false, "author": "mats@mozilla.com", "count": 0, "time": "2008-02-26T16:30:28Z", "bug_id": 419642}, {"attachment_id": null, "id": 3500427, "tags": [], "raw_text": "confirmed on a new Linux Debug Build on Fedora 8, with the same steps from mats\n\nWARNING: Unsafe use of LIKE detected!  Please ensure that you are\nusing mozIStorageConnection::escapeStringForLIKE and that you are\nbinding that result to the statement to prevent SQL injection\nattacks.: file /opt/debug/mozilla/storage/src/mozStorageStatement.cpp,\nline 176", "creator": "cbook@mozilla.com", "is_private": false, "count": 1, "bug_id": 419642, "creation_time": "2008-02-26T22:12:21Z", "text": "confirmed on a new Linux Debug Build on Fedora 8, with the same steps from mats\n\nWARNING: Unsafe use of LIKE detected!  Please ensure that you are\nusing mozIStorageConnection::escapeStringForLIKE and that you are\nbinding that result to the statement to prevent SQL injection\nattacks.: file /opt/debug/mozilla/storage/src/mozStorageStatement.cpp,\nline 176", "author": "cbook@mozilla.com", "time": "2008-02-26T22:12:21Z"}, {"text": "I've hit this over 1000 times loading 7800 pages from the top sites on linux. \n\nThis warning is pretty damn scary. We shouldn't depend on a warning and convention to prevent SQL injections.\n\nSee also bug 395974", "author": "bob@bclary.com", "time": "2008-02-28T15:18:40Z", "creation_time": "2008-02-28T15:18:40Z", "creator": "bob@bclary.com", "raw_text": "I've hit this over 1000 times loading 7800 pages from the top sites on linux. \n\nThis warning is pretty damn scary. We shouldn't depend on a warning and convention to prevent SQL injections.\n\nSee also bug 395974", "count": 2, "bug_id": 419642, "is_private": false, "id": 3503854, "attachment_id": null, "tags": []}, {"is_private": false, "count": 3, "bug_id": 419642, "raw_text": "bug 395974 isn't so important - but it looks like some consumer of storage is not escaping their like statements like they should be :(", "creator": "sdwilsh@forerunnerdesigns.com", "tags": [], "attachment_id": null, "id": 3506139, "author": "sdwilsh@forerunnerdesigns.com", "time": "2008-02-29T20:17:41Z", "text": "bug 395974 isn't so important - but it looks like some consumer of storage is not escaping their like statements like they should be :(", "creation_time": "2008-02-29T20:17:41Z"}, {"creator": "dbaron@dbaron.org", "raw_text": "I just noticed that this warning is showing up during the trace-malloc leak test on fxdebug-win32-tbox (which just starts firefox and goes through a few pages in an iframe).", "count": 4, "bug_id": 419642, "is_private": false, "id": 3506146, "attachment_id": null, "tags": [], "text": "I just noticed that this warning is showing up during the trace-malloc leak test on fxdebug-win32-tbox (which just starts firefox and goes through a few pages in an iframe).", "author": "dbaron@dbaron.org", "time": "2008-02-29T20:19:37Z", "creation_time": "2008-02-29T20:19:37Z"}, {"creation_time": "2008-02-29T23:27:46Z", "text": "Assigning to sdwilsh so he can figure out which components aren't escaping their statements.\n\nShawn, if this isn't actually opening us up to SQL injections, please renom and we'll de-block.", "time": "2008-02-29T23:27:46Z", "author": "mbeltzner@gmail.com", "attachment_id": null, "id": 3506489, "tags": [], "raw_text": "Assigning to sdwilsh so he can figure out which components aren't escaping their statements.\n\nShawn, if this isn't actually opening us up to SQL injections, please renom and we'll de-block.", "creator": "mbeltzner@gmail.com", "is_private": false, "count": 5, "bug_id": 419642}, {"creation_time": "2008-02-29T23:30:39Z", "text": "Anyone know offhand if there is a way to print X frames of stack with warnings too?  That'd make this real easy to find...", "time": "2008-02-29T23:30:39Z", "author": "sdwilsh@forerunnerdesigns.com", "attachment_id": null, "id": 3506494, "tags": [], "raw_text": "Anyone know offhand if there is a way to print X frames of stack with warnings too?  That'd make this real easy to find...", "creator": "sdwilsh@forerunnerdesigns.com", "is_private": false, "count": 6, "bug_id": 419642}, {"attachment_id": null, "id": 3506497, "tags": [], "creation_time": "2008-02-29T23:30:58Z", "text": "A reproducible way to hit this would be nice too!", "raw_text": "A reproducible way to hit this would be nice too!", "creator": "sdwilsh@forerunnerdesigns.com", "is_private": false, "bug_id": 419642, "count": 7, "time": "2008-02-29T23:30:58Z", "author": "sdwilsh@forerunnerdesigns.com"}, {"text": "Maybe places?\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3062\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3090\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#4404\n\na bunch of times in calendar code here:\nhttp://mxr.mozilla.org/seamonkey/source/calendar/providers/storage/calStorageCalendar.js\n\nSeeing as that's all I'm seeing, I'm not terribly worried.\n\nNext comment will be looking at each of the places uses...", "time": "2008-03-01T02:08:39Z", "author": "sdwilsh@forerunnerdesigns.com", "creation_time": "2008-03-01T02:08:39Z", "raw_text": "Maybe places?\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3062\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3090\nhttp://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#4404\n\na bunch of times in calendar code here:\nhttp://mxr.mozilla.org/seamonkey/source/calendar/providers/storage/calStorageCalendar.js\n\nSeeing as that's all I'm seeing, I'm not terribly worried.\n\nNext comment will be looking at each of the places uses...", "creator": "sdwilsh@forerunnerdesigns.com", "is_private": false, "bug_id": 419642, "count": 8, "attachment_id": null, "id": 3506732, "tags": []}, {"id": 3506740, "attachment_id": null, "creation_time": "2008-03-01T02:15:45Z", "tags": [], "creator": "sdwilsh@forerunnerdesigns.com", "raw_text": "(In reply to comment #8)\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3062\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3090\nI don't even want to get into the fact that we are building the query up with a sprintf...\nThe LIKE here is safe\n\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#4404\nThis one is safe as well\n\nthe warning is just that - a warning.  There are safe usages of LIKE without binding parameters, and these fall into that case.  Renoming with new information.", "text": "(In reply to comment #8)\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3062\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#3090\nI don't even want to get into the fact that we are building the query up with a sprintf...\nThe LIKE here is safe\n\n> http://bonsai.mozilla.org/cvsblame.cgi?file=/mozilla/toolkit/components/places/src/nsNavHistory.cpp&rev=1.266#4404\nThis one is safe as well\n\nthe warning is just that - a warning.  There are safe usages of LIKE without binding parameters, and these fall into that case.  Renoming with new information.", "author": "sdwilsh@forerunnerdesigns.com", "count": 9, "time": "2008-03-01T02:15:45Z", "bug_id": 419642, "is_private": false}, {"attachment_id": null, "id": 3506742, "tags": [], "creation_time": "2008-03-01T02:18:35Z", "raw_text": "Still, if the warning is going to fire that often (such as what comment #2 says), something needs to be fixed. This doesn't just need to be ignored as \"another warning.\"", "text": "Still, if the warning is going to fire that often (such as what comment #2 says), something needs to be fixed. This doesn't just need to be ignored as \"another warning.\"", "creator": "reed@reedloden.com", "is_private": false, "bug_id": 419642, "author": "reed@reedloden.com", "count": 10, "time": "2008-03-01T02:18:35Z"}, {"creation_time": "2008-03-04T19:06:50Z", "time": "2008-03-04T19:06:50Z", "author": "dsicore@mozilla.bugs", "text": "So do we have any idea of which lines of code are causing the warnings?", "tags": [], "id": 3511438, "attachment_id": null, "bug_id": 419642, "count": 11, "is_private": false, "creator": "dsicore@mozilla.bugs", "raw_text": "So do we have any idea of which lines of code are causing the warnings?"}, {"creation_time": "2008-03-04T20:20:13Z", "time": "2008-03-04T20:20:13Z", "author": "sdwilsh@forerunnerdesigns.com", "text": "(In reply to comment #11)\n> So do we have any idea of which lines of code are causing the warnings?\nSee comment 9.  Someone more familiar with places would be better off explaining when those code paths are run.", "tags": [], "id": 3511574, "attachment_id": null, "bug_id": 419642, "count": 12, "is_private": false, "creator": "sdwilsh@forerunnerdesigns.com", "raw_text": "(In reply to comment #11)\n> So do we have any idea of which lines of code are causing the warnings?\nSee comment 9.  Someone more familiar with places would be better off explaining when those code paths are run."}, {"bug_id": 419642, "count": 13, "is_private": false, "creator": "dsicore@mozilla.bugs", "raw_text": "OK, blocking1.9+ P2 so we can make sure this is investigated.  Dietrich, can you take a look (just looking for anyone on the places team to help out here)?\n\nMoving this to Firefox/Places as well.\n", "tags": [], "id": 3511636, "attachment_id": null, "author": "dsicore@mozilla.bugs", "time": "2008-03-04T21:01:54Z", "text": "OK, blocking1.9+ P2 so we can make sure this is investigated.  Dietrich, can you take a look (just looking for anyone on the places team to help out here)?\n\nMoving this to Firefox/Places as well.\n", "creation_time": "2008-03-04T21:01:54Z"}, {"creator": "hzbz@pm.me", "raw_text": "Ondrej, possibly from your sidebar patch?", "bug_id": 419642, "count": 14, "is_private": false, "id": 3511665, "attachment_id": null, "tags": [], "text": "Ondrej, possibly from your sidebar patch?", "time": "2008-03-04T21:20:03Z", "author": "hzbz@pm.me", "creation_time": "2008-03-04T21:20:03Z"}, {"raw_text": "(In reply to comment #14)\n> Ondrej, possibly from your sidebar patch?\n> \n\nI know that my patch generates some of those false alarms. But I was not able to avoid them unless I would refactor a lot of code I did not need to touch. In my code it is \"url LIKE 'file://%'\" that is triggering them.\n\nThe warning should most likely be removed. It is basically any non-sanitized textual input that could be used for sql injection, LIKE may be just statistical exception. Anyway, I will analyze this in bug 405920. \n", "creator": "ondrej@allpeers.com", "is_private": false, "bug_id": 419642, "count": 15, "attachment_id": null, "id": 3511724, "tags": [], "text": "(In reply to comment #14)\n> Ondrej, possibly from your sidebar patch?\n> \n\nI know that my patch generates some of those false alarms. But I was not able to avoid them unless I would refactor a lot of code I did not need to touch. In my code it is \"url LIKE 'file://%'\" that is triggering them.\n\nThe warning should most likely be removed. It is basically any non-sanitized textual input that could be used for sql injection, LIKE may be just statistical exception. Anyway, I will analyze this in bug 405920. \n", "time": "2008-03-04T21:46:20Z", "author": "ondrej@allpeers.com", "creation_time": "2008-03-04T21:46:20Z"}, {"attachment_id": null, "id": 3512815, "tags": [], "creation_time": "2008-03-05T14:05:43Z", "text": "This warning was implemented with bug 395974 and there is opened bug 395974 about unit tests generating the same warning in very similar case.\n\nThe easiest solution would be to replace this \"url LIKE 'file://%'\" with \"url BETWEEN 'file://' AND 'file:/~'\"\n\nThe readability is little worse, injection risks are none as well as they were before and performance is the same (the indexes are already exhausted by other conditions, otherwise BETWEEN could be faster than LIKE).\n\nI suggest to keep the warning there, it increases awareness of the problem and use BETWEEN.", "raw_text": "This warning was implemented with bug 395974 and there is opened bug 395974 about unit tests generating the same warning in very similar case.\n\nThe easiest solution would be to replace this \"url LIKE 'file://%'\" with \"url BETWEEN 'file://' AND 'file:/~'\"\n\nThe readability is little worse, injection risks are none as well as they were before and performance is the same (the indexes are already exhausted by other conditions, otherwise BETWEEN could be faster than LIKE).\n\nI suggest to keep the warning there, it increases awareness of the problem and use BETWEEN.", "creator": "ondrej@allpeers.com", "is_private": false, "bug_id": 419642, "author": "ondrej@allpeers.com", "time": "2008-03-05T14:05:43Z", "count": 16}, {"raw_text": "", "creator": "ondrej@allpeers.com", "is_private": false, "bug_id": 419642, "count": 17, "attachment_id": 307455, "id": 3512831, "tags": [], "text": "Created attachment 307455\nUse BETWEEN instead of LIKE to avoid false alarm", "time": "2008-03-05T14:26:31Z", "author": "ondrej@allpeers.com", "creation_time": "2008-03-05T14:26:31Z"}, {"creation_time": "2008-03-05T22:25:08Z", "author": "hzbz@pm.me", "time": "2008-03-05T22:25:08Z", "text": "Comment on attachment 307455\nUse BETWEEN instead of LIKE to avoid false alarm\n\nr=me, thanks for following this up.", "tags": [], "attachment_id": 307455, "id": 3513708, "is_private": false, "bug_id": 419642, "count": 18, "raw_text": "r=me, thanks for following this up.", "creator": "hzbz@pm.me"}, {"is_private": false, "count": 19, "author": "hzbz@pm.me", "time": "2008-03-07T18:53:23Z", "bug_id": 419642, "text": "Checking in toolkit/components/places/src/nsNavHistory.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavHistory.cpp,v  <--  nsNavHistory.cpp\nnew revision: 1.270; previous revision: 1.269\ndone", "raw_text": "Checking in toolkit/components/places/src/nsNavHistory.cpp;\n/cvsroot/mozilla/toolkit/components/places/src/nsNavHistory.cpp,v  <--  nsNavHistory.cpp\nnew revision: 1.270; previous revision: 1.269\ndone", "creator": "hzbz@pm.me", "tags": [], "creation_time": "2008-03-07T18:53:23Z", "attachment_id": null, "id": 3516833}, {"text": "Cool.  Thanks for taking this to the finish line.  :)", "author": "dsicore@mozilla.bugs", "time": "2008-03-07T19:00:42Z", "creation_time": "2008-03-07T19:00:42Z", "creator": "dsicore@mozilla.bugs", "raw_text": "Cool.  Thanks for taking this to the finish line.  :)", "count": 20, "bug_id": 419642, "is_private": false, "id": 3516850, "attachment_id": null, "tags": []}, {"id": 3529681, "attachment_id": null, "creation_time": "2008-03-15T17:01:00Z", "tags": [], "creator": "mats@mozilla.com", "text": "Another one: bug 423159", "raw_text": "Another one: bug 423159", "count": 21, "time": "2008-03-15T17:01:00Z", "author": "mats@mozilla.com", "bug_id": 419642, "is_private": false}, {"id": 3540394, "attachment_id": null, "tags": [], "creator": "bob@bclary.com", "raw_text": "several js tests reproduce this warning. See bug 423159 comment 15.", "count": 22, "bug_id": 419642, "is_private": false, "creation_time": "2008-03-21T22:23:00Z", "text": "several js tests reproduce this warning. See bug 423159 comment 15.", "time": "2008-03-21T22:23:00Z", "author": "bob@bclary.com"}, {"text": "Bug 451915 - move Firefox/Places bugs to Firefox/Bookmarks and History. Remove all bugspam from this move by filtering for the string \"places-to-b-and-h\".\n\nIn Thunderbird 3.0b, you do that as follows:\nTools | Message Filters\nMake sure the correct account is selected. Click \"New\"\nConditions: Body   contains   places-to-b-and-h\nChange the action to \"Delete Message\".\nSelect \"Manually Run\" from the dropdown at the top.\nClick OK.\n\nSelect the filter in the list, make sure \"Inbox\" is selected at the bottom, and click \"Run Now\". This should delete all the bugspam. You can then delete the filter.\n\nGerv", "time": "2009-11-26T14:48:52Z", "author": "gerv@mozilla.org", "creation_time": "2009-11-26T14:48:52Z", "creator": "gerv@mozilla.org", "raw_text": "Bug 451915 - move Firefox/Places bugs to Firefox/Bookmarks and History. Remove all bugspam from this move by filtering for the string \"places-to-b-and-h\".\n\nIn Thunderbird 3.0b, you do that as follows:\nTools | Message Filters\nMake sure the correct account is selected. Click \"New\"\nConditions: Body   contains   places-to-b-and-h\nChange the action to \"Delete Message\".\nSelect \"Manually Run\" from the dropdown at the top.\nClick OK.\n\nSelect the filter in the list, make sure \"Inbox\" is selected at the bottom, and click \"Run Now\". This should delete all the bugspam. You can then delete the filter.\n\nGerv", "bug_id": 419642, "count": 23, "is_private": false, "id": 4422768, "attachment_id": null, "tags": []}]}}}