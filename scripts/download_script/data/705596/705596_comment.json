{"bugs": {"705596": {"comments": [{"attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "creation_time": "2011-11-28T04:30:38Z", "is_private": false, "raw_text": "User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.10 (KHTML, like Gecko) Chrome/17.0.947.0 Safari/535.10\n\nSteps to reproduce:\n\n1- Create a recurring event\n2- Modify a single instance (change the starting date and/or the time)\nexemple: modify the first instance (date and time)\n3- Modify the whole serie (change the starting date or the time)\nexemple: modify the whole serie by double clicking the second instance. Change the date to the next one and the time by one hour.\n\n\nActual results:\n\nThe instance modified individually is affected by modifications made to the starting date or time of the whole serie.\n\n\nExpected results:\n\nThe starting date and time should be affected by a modification made to the whole serie. It should be treated as an exemption and should keep its date and time. All other fields are not affected when editing the serie, only the starting date and time have influence.", "time": "2011-11-28T04:30:38Z", "author": "alexandre.f.demers@gmail.com", "count": 0, "text": "User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.10 (KHTML, like Gecko) Chrome/17.0.947.0 Safari/535.10\n\nSteps to reproduce:\n\n1- Create a recurring event\n2- Modify a single instance (change the starting date and/or the time)\nexemple: modify the first instance (date and time)\n3- Modify the whole serie (change the starting date or the time)\nexemple: modify the whole serie by double clicking the second instance. Change the date to the next one and the time by one hour.\n\n\nActual results:\n\nThe instance modified individually is affected by modifications made to the starting date or time of the whole serie.\n\n\nExpected results:\n\nThe starting date and time should be affected by a modification made to the whole serie. It should be treated as an exemption and should keep its date and time. All other fields are not affected when editing the serie, only the starting date and time have influence.", "id": 5874839, "bug_id": 705596}, {"author": "alexandre.f.demers@gmail.com", "count": 1, "text": "I think it is a major bug since it can really mess up your schedule if you don't realize it. If for some reason, there is an exception, this exception must be protected and should not be disrupted by modifications to the serie.", "id": 5887486, "bug_id": 705596, "time": "2011-12-02T05:52:35Z", "raw_text": "I think it is a major bug since it can really mess up your schedule if you don't realize it. If for some reason, there is an exception, this exception must be protected and should not be disrupted by modifications to the serie.", "creator": "alexandre.f.demers@gmail.com", "creation_time": "2011-12-02T05:52:35Z", "is_private": false, "attachment_id": null, "tags": []}, {"time": "2011-12-03T03:28:04Z", "raw_text": "How is an single instance of an occurence trated? I suppose it is relative to the parent event, isn't it? If so, it means changing the parent (all occurences) should also modify any instance to keep it as they are: if the beginning date is moved backward in time, occurences data should be move the other way around; same applies (the other way around) for moving parent foward in time. Am I right?", "id": 5890201, "bug_id": 705596, "author": "alexandre.f.demers@gmail.com", "text": "How is an single instance of an occurence trated? I suppose it is relative to the parent event, isn't it? If so, it means changing the parent (all occurences) should also modify any instance to keep it as they are: if the beginning date is moved backward in time, occurences data should be move the other way around; same applies (the other way around) for moving parent foward in time. Am I right?", "count": 2, "tags": [], "attachment_id": null, "creation_time": "2011-12-03T03:28:04Z", "is_private": false, "creator": "alexandre.f.demers@gmail.com"}, {"tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-12-03T13:43:02Z", "creator": "mozilla@sprosh.com", "time": "2011-12-03T13:43:02Z", "raw_text": "(In reply to Alexandre Demers from comment #0)\n> The instance modified individually is affected by modifications made to the\n> starting date or time of the whole serie.\nI can reproduce this and also think it's a bug.  TB 8 / Lightning 1.0.", "id": 5890566, "bug_id": 705596, "text": "(In reply to Alexandre Demers from comment #0)\n> The instance modified individually is affected by modifications made to the\n> starting date or time of the whole serie.\nI can reproduce this and also think it's a bug.  TB 8 / Lightning 1.0.", "count": 3, "author": "mozilla@sprosh.com"}, {"count": 4, "text": "Confirmed per comment#3.", "author": "mschroeder@mozilla.x-home.org", "creator": "mschroeder@mozilla.x-home.org", "creation_time": "2011-12-04T10:04:07Z", "is_private": false, "id": 5891217, "bug_id": 705596, "raw_text": "Confirmed per comment#3.", "attachment_id": null, "time": "2011-12-04T10:04:07Z", "tags": []}, {"time": "2011-12-05T04:17:55Z", "raw_text": "I had a look and I found out where and why it is behaving like that. In file calRecurrenceInfo.js at function onStartDateChange, here is what I found:\n\"// changing the startdate of an item needs to take exceptions into account.\n// in case we're about to modify a parentItem (aka 'folded' item), we need\n// to modify the recurrenceId's of all possibly existing exceptions as well.\nonStartDateChange: function cRI_onStartDateChange(aNewStartTime, aOldStartTime) {\n\"\nSo, at the time it was coded, it was intended to do exactly what it is doing right now.\n\nAs stated previously, I think it is wrong to do that since an exception must have been purposedly modified. We can assume the user wanted that specific occurence to be at a different date/time and thus it should not be modified. Modification is trivial to do. I'll be joining a patch soon.", "text": "I had a look and I found out where and why it is behaving like that. In file calRecurrenceInfo.js at function onStartDateChange, here is what I found:\n\"// changing the startdate of an item needs to take exceptions into account.\n// in case we're about to modify a parentItem (aka 'folded' item), we need\n// to modify the recurrenceId's of all possibly existing exceptions as well.\nonStartDateChange: function cRI_onStartDateChange(aNewStartTime, aOldStartTime) {\n\"\nSo, at the time it was coded, it was intended to do exactly what it is doing right now.\n\nAs stated previously, I think it is wrong to do that since an exception must have been purposedly modified. We can assume the user wanted that specific occurence to be at a different date/time and thus it should not be modified. Modification is trivial to do. I'll be joining a patch soon.", "count": 5, "author": "alexandre.f.demers@gmail.com", "id": 5892035, "bug_id": 705596, "attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "creation_time": "2011-12-05T04:17:55Z", "is_private": false}, {"tags": [], "attachment_id": null, "raw_text": "(In reply to Alexandre Demers from comment #5)\n> I had a look and I found out where and why it is behaving like that. In file\n> calRecurrenceInfo.js at function onStartDateChange, here is what I found:\n> \"// changing the startdate of an item needs to take exceptions into account.\n> // in case we're about to modify a parentItem (aka 'folded' item), we need\n> // to modify the recurrenceId's of all possibly existing exceptions as well.\n> onStartDateChange: function cRI_onStartDateChange(aNewStartTime,\n> aOldStartTime) {\n> \"\n> So, at the time it was coded, it was intended to do exactly what it is doing\n> right now.\n> \n> As stated previously, I think it is wrong to do that since an exception must\n> have been purposedly modified. We can assume the user wanted that specific\n> occurence to be at a different date/time and thus it should not be modified.\n> Modification is trivial to do. I'll be joining a patch soon.\n\nThe comment is correct in that the recurrenceId does need to be modified for exceptions, as it needs to match the new RRULE for the parent item. However, I agree that the start and end dates do not need to be shifted.", "time": "2011-12-05T05:52:46Z", "is_private": false, "creation_time": "2011-12-05T05:52:46Z", "id": 5892094, "bug_id": 705596, "author": "matthew.mecca@gmail.com", "count": 6, "text": "(In reply to Alexandre Demers from comment #5)\n> I had a look and I found out where and why it is behaving like that. In file\n> calRecurrenceInfo.js at function onStartDateChange, here is what I found:\n> \"// changing the startdate of an item needs to take exceptions into account.\n> // in case we're about to modify a parentItem (aka 'folded' item), we need\n> // to modify the recurrenceId's of all possibly existing exceptions as well.\n> onStartDateChange: function cRI_onStartDateChange(aNewStartTime,\n> aOldStartTime) {\n> \"\n> So, at the time it was coded, it was intended to do exactly what it is doing\n> right now.\n> \n> As stated previously, I think it is wrong to do that since an exception must\n> have been purposedly modified. We can assume the user wanted that specific\n> occurence to be at a different date/time and thus it should not be modified.\n> Modification is trivial to do. I'll be joining a patch soon.\n\nThe comment is correct in that the recurrenceId does need to be modified for exceptions, as it needs to match the new RRULE for the parent item. However, I agree that the start and end dates do not need to be shifted.", "creator": "matthew.mecca@gmail.com"}, {"tags": [], "attachment_id": 579049, "raw_text": "", "time": "2011-12-05T13:47:40Z", "creation_time": "2011-12-05T13:47:40Z", "is_private": false, "id": 5892553, "bug_id": 705596, "author": "alexandre.f.demers@gmail.com", "text": "Created attachment 579049\nDon't shift exceptions", "count": 7, "creator": "alexandre.f.demers@gmail.com"}, {"raw_text": "Could you maybe find out why we were shifting this in the past (using mxr.mozilla.org/comm-central, there is an annotate/blame function in the file that will let you find out where it was added)?\n\nI remember this function was written on purpose, if this is the only place it is used then we should find out why.", "attachment_id": 579049, "time": "2011-12-08T10:45:21Z", "tags": [], "text": "Comment on attachment 579049\nDon't shift exceptions\n\nCould you maybe find out why we were shifting this in the past (using mxr.mozilla.org/comm-central, there is an annotate/blame function in the file that will let you find out where it was added)?\n\nI remember this function was written on purpose, if this is the only place it is used then we should find out why.", "count": 8, "author": "philipp@bugzilla.kewis.ch", "creator": "philipp@bugzilla.kewis.ch", "is_private": false, "creation_time": "2011-12-08T10:45:21Z", "id": 5900147, "bug_id": 705596}, {"raw_text": "(In reply to Philipp Kewisch [:Fallen] from comment #8)\n> Comment on attachment 579049\n> Don't shift exceptions\n> \n> Could you maybe find out why we were shifting this in the past (using\n> mxr.mozilla.org/comm-central, there is an annotate/blame function in the\n> file that will let you find out where it was added)?\n> \n> I remember this function was written on purpose, if this is the only place\n> it is used then we should find out why.\n\nIt was introduce with other thing to fix bug 345607 (see changelog http://hg.mozilla.org/comm-central/rev/06cf82446ca8). From what I can see, it only clones the item, adds the offset where needed and saves it back.\n\nI'll test if the problem reappears when applying the patch.", "time": "2011-12-09T02:45:46Z", "author": "alexandre.f.demers@gmail.com", "text": "(In reply to Philipp Kewisch [:Fallen] from comment #8)\n> Comment on attachment 579049\n> Don't shift exceptions\n> \n> Could you maybe find out why we were shifting this in the past (using\n> mxr.mozilla.org/comm-central, there is an annotate/blame function in the\n> file that will let you find out where it was added)?\n> \n> I remember this function was written on purpose, if this is the only place\n> it is used then we should find out why.\n\nIt was introduce with other thing to fix bug 345607 (see changelog http://hg.mozilla.org/comm-central/rev/06cf82446ca8). From what I can see, it only clones the item, adds the offset where needed and saves it back.\n\nI'll test if the problem reappears when applying the patch.", "count": 9, "bug_id": 705596, "id": 5903174, "attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "is_private": false, "creation_time": "2011-12-09T02:45:46Z"}, {"is_private": false, "creation_time": "2011-12-09T06:15:39Z", "bug_id": 705596, "id": 5903456, "author": "alexandre.f.demers@gmail.com", "count": 10, "text": "Well, there is a problem, but not the same as described in the aforementioned bug. When removing the shiftItem, the event is copied, but the offset is never applied, creating the event at the same beginning date-time as the original.\n\nI'll have to work a bit more to fix this bug.", "creator": "alexandre.f.demers@gmail.com", "tags": [], "attachment_id": null, "raw_text": "Well, there is a problem, but not the same as described in the aforementioned bug. When removing the shiftItem, the event is copied, but the offset is never applied, creating the event at the same beginning date-time as the original.\n\nI'll have to work a bit more to fix this bug.", "time": "2011-12-09T06:15:39Z"}, {"id": 5984805, "bug_id": 705596, "is_private": false, "creation_time": "2012-01-17T11:21:44Z", "creator": "philipp@bugzilla.kewis.ch", "author": "philipp@bugzilla.kewis.ch", "text": "Comment on attachment 579049\nDon't shift exceptions\n\nHey Alexandre,\n\ngiven you mention you need to work more on this, I'm going to take this off of my review queue. Or do you say this patch is ok as it is but you need to do an additional patch to fix all remaining issues? If so, please re-request.", "count": 11, "tags": [], "time": "2012-01-17T11:21:44Z", "attachment_id": 579049, "raw_text": "Hey Alexandre,\n\ngiven you mention you need to work more on this, I'm going to take this off of my review queue. Or do you say this patch is ok as it is but you need to do an additional patch to fix all remaining issues? If so, please re-request."}, {"attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "creation_time": "2012-01-17T23:24:50Z", "is_private": false, "time": "2012-01-17T23:24:50Z", "raw_text": "No problem, sorry for the delay. I'm working on it in my spare time. So take it off your review queue and I'll flag it back later on.", "author": "alexandre.f.demers@gmail.com", "text": "No problem, sorry for the delay. I'm working on it in my spare time. So take it off your review queue and I'll flag it back later on.", "count": 12, "id": 5987120, "bug_id": 705596}, {"tags": [], "attachment_id": null, "creation_time": "2012-11-29T17:15:45Z", "is_private": false, "creator": "chrissc.humbert@gmail.com", "time": "2012-11-29T17:15:45Z", "raw_text": "Hello Alexandre,\n\nDid you have time to work on this?\nDo you need some help\n\nThanks\nChristophe", "bug_id": 705596, "id": 6864682, "author": "chrissc.humbert@gmail.com", "text": "Hello Alexandre,\n\nDid you have time to work on this?\nDo you need some help\n\nThanks\nChristophe", "count": 13}, {"is_private": false, "creation_time": "2012-11-29T17:21:46Z", "creator": "alexandre.f.demers@gmail.com", "tags": [], "attachment_id": null, "id": 6864715, "bug_id": 705596, "author": "alexandre.f.demers@gmail.com", "text": "(In reply to Christophe Humbert from comment #13)\n> Hello Alexandre,\n> \n> Did you have time to work on this?\n> Do you need some help\n> \n> Thanks\n> Christophe\n\nHi Christophe. I had no time since my previous patch which was flawed. Until next week, I won't have time to continue my work (I'm leaving one of my two jobs), but after that I intend to work on it again. The little time I had was mostly spent testing/debugging r600g driver for Linux. If you have some time to kill, you can use the information in the previous comments to have an idea of what has to be done and where code changes have to go.", "count": 14, "raw_text": "(In reply to Christophe Humbert from comment #13)\n> Hello Alexandre,\n> \n> Did you have time to work on this?\n> Do you need some help\n> \n> Thanks\n> Christophe\n\nHi Christophe. I had no time since my previous patch which was flawed. Until next week, I won't have time to continue my work (I'm leaving one of my two jobs), but after that I intend to work on it again. The little time I had was mostly spent testing/debugging r600g driver for Linux. If you have some time to kill, you can use the information in the previous comments to have an idea of what has to be done and where code changes have to go.", "time": "2012-11-29T17:21:46Z"}, {"author": "alexandre.f.demers@gmail.com", "count": 15, "text": "OK, I've been playing with this yesterday. I'm now sure my original patch was correct. However, it has a drawback : indeed, copied events are not shifted when clicking on a different day. Now, I just have to figure out why it does that and we should be fine. Pretty sure the problem arises from a common path used by both actions. It could be because copied events are treated as exceptions of the original recurrent event. If this happens to be true, it should be easy to fix.", "id": 6871693, "bug_id": 705596, "time": "2012-12-01T20:55:24Z", "raw_text": "OK, I've been playing with this yesterday. I'm now sure my original patch was correct. However, it has a drawback : indeed, copied events are not shifted when clicking on a different day. Now, I just have to figure out why it does that and we should be fine. Pretty sure the problem arises from a common path used by both actions. It could be because copied events are treated as exceptions of the original recurrent event. If this happens to be true, it should be easy to fix.", "creator": "alexandre.f.demers@gmail.com", "creation_time": "2012-12-01T20:55:24Z", "is_private": false, "attachment_id": null, "tags": []}, {"tags": [], "attachment_id": null, "is_private": false, "creation_time": "2012-12-01T21:25:13Z", "creator": "alexandre.f.demers@gmail.com", "time": "2012-12-01T21:25:13Z", "raw_text": "Here is what happens when copying a recurrent event : when copying an event from a recurrent rule (RRULE), a new parent and child events are created : a new UID is used (which is correct) with a recurrent date (RDATE) (which can be correct or not since it is not needed if we consider the child as a single event). The parent doesn't preserve the SUMMARY from the original copied event (which is wrong but of no importance), while the child does (which is correct). Now, because a RDATE is used in the parent event, the child event is treated as an exception thus not being shifted if I apply my patch (which removes the shiftItem() function for exceptions). Either we should consider the copied event as a none recurring event (removing the parent event and its RDATE) OR we have to specify if we are modifying an existing event and its recurrent set or if we are copying an existing event from a recurrent set.\n\nWould one solution be better than the other?", "bug_id": 705596, "id": 6871725, "author": "alexandre.f.demers@gmail.com", "text": "Here is what happens when copying a recurrent event : when copying an event from a recurrent rule (RRULE), a new parent and child events are created : a new UID is used (which is correct) with a recurrent date (RDATE) (which can be correct or not since it is not needed if we consider the child as a single event). The parent doesn't preserve the SUMMARY from the original copied event (which is wrong but of no importance), while the child does (which is correct). Now, because a RDATE is used in the parent event, the child event is treated as an exception thus not being shifted if I apply my patch (which removes the shiftItem() function for exceptions). Either we should consider the copied event as a none recurring event (removing the parent event and its RDATE) OR we have to specify if we are modifying an existing event and its recurrent set or if we are copying an existing event from a recurrent set.\n\nWould one solution be better than the other?", "count": 16}, {"attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "creation_time": "2012-12-01T22:40:11Z", "is_private": false, "raw_text": "(In reply to Alexandre Demers from comment #16)\n> Here is what happens when copying a recurrent event : when copying an event\n> from a recurrent rule (RRULE), a new parent and child events are created : a\n> new UID is used (which is correct) with a recurrent date (RDATE) (which can\n> be correct or not since it is not needed if we consider the child as a\n> single event). The parent doesn't preserve the SUMMARY from the original\n> copied event (which is wrong but of no importance), while the child does\n> (which is correct). Now, because a RDATE is used in the parent event, the\n> child event is treated as an exception thus not being shifted if I apply my\n> patch (which removes the shiftItem() function for exceptions). Either we\n> should consider the copied event as a none recurring event (removing the\n> parent event and its RDATE) OR we have to specify if we are modifying an\n> existing event and its recurrent set or if we are copying an existing event\n> from a recurrent set.\n> \n> Would one solution be better than the other?\n\nA new test which was copying 2 events from a recurrent shows the following : the new copied events are both children of one parent event specifying two recurrent dates. Thus, this makes me think we should go with the second options (specify if we are modifying or copying).", "time": "2012-12-01T22:40:11Z", "author": "alexandre.f.demers@gmail.com", "text": "(In reply to Alexandre Demers from comment #16)\n> Here is what happens when copying a recurrent event : when copying an event\n> from a recurrent rule (RRULE), a new parent and child events are created : a\n> new UID is used (which is correct) with a recurrent date (RDATE) (which can\n> be correct or not since it is not needed if we consider the child as a\n> single event). The parent doesn't preserve the SUMMARY from the original\n> copied event (which is wrong but of no importance), while the child does\n> (which is correct). Now, because a RDATE is used in the parent event, the\n> child event is treated as an exception thus not being shifted if I apply my\n> patch (which removes the shiftItem() function for exceptions). Either we\n> should consider the copied event as a none recurring event (removing the\n> parent event and its RDATE) OR we have to specify if we are modifying an\n> existing event and its recurrent set or if we are copying an existing event\n> from a recurrent set.\n> \n> Would one solution be better than the other?\n\nA new test which was copying 2 events from a recurrent shows the following : the new copied events are both children of one parent event specifying two recurrent dates. Thus, this makes me think we should go with the second options (specify if we are modifying or copying).", "count": 17, "id": 6871772, "bug_id": 705596}, {"count": 18, "text": "Another consideration: onStartDateChange (where we are shifting all exception events_ is being called whenever startDate is set. So, we can't just add a new parameter to fix the thing. I would be tempted to remove the shift from onStartDateChange and fix the case where we are copying recurrent events. I think copying recurrent events have nothing to do with the original events being recurrent. They should probably be transformed into none recurrent events (removing for the need of RDATEs) or be shifted as none recurrent events. Any opinion?", "author": "alexandre.f.demers@gmail.com", "bug_id": 705596, "id": 6871960, "time": "2012-12-02T03:16:55Z", "raw_text": "Another consideration: onStartDateChange (where we are shifting all exception events_ is being called whenever startDate is set. So, we can't just add a new parameter to fix the thing. I would be tempted to remove the shift from onStartDateChange and fix the case where we are copying recurrent events. I think copying recurrent events have nothing to do with the original events being recurrent. They should probably be transformed into none recurrent events (removing for the need of RDATEs) or be shifted as none recurrent events. Any opinion?", "creator": "alexandre.f.demers@gmail.com", "creation_time": "2012-12-02T03:16:55Z", "is_private": false, "attachment_id": null, "tags": []}, {"text": "(In reply to Alexandre Demers from comment #18)\n> I think copying recurrent events have nothing to do with the\n> original events being recurrent. They should probably be transformed into\n> none recurrent events (removing for the need of RDATEs) or be shifted as\n> none recurrent events. Any opinion?\n\nSee related discussion in Bug 536796", "count": 19, "author": "matthew.mecca@gmail.com", "creator": "matthew.mecca@gmail.com", "creation_time": "2012-12-03T04:26:50Z", "is_private": false, "id": 6873166, "bug_id": 705596, "raw_text": "(In reply to Alexandre Demers from comment #18)\n> I think copying recurrent events have nothing to do with the\n> original events being recurrent. They should probably be transformed into\n> none recurrent events (removing for the need of RDATEs) or be shifted as\n> none recurrent events. Any opinion?\n\nSee related discussion in Bug 536796", "attachment_id": null, "time": "2012-12-03T04:26:50Z", "tags": []}, {"id": 7508951, "bug_id": 705596, "text": "Hello\n\nAny news...What it is needed to make it moving\n\nThanks", "count": 20, "author": "chrissc.humbert@gmail.com", "time": "2013-06-07T07:40:56Z", "raw_text": "Hello\n\nAny news...What it is needed to make it moving\n\nThanks", "creation_time": "2013-06-07T07:40:56Z", "is_private": false, "creator": "chrissc.humbert@gmail.com", "tags": [], "attachment_id": null}, {"raw_text": "(In reply to Christophe Humbert from comment #20)\n> Hello\n> \n> Any news...What it is needed to make it moving\n> \n> Thanks\n\nI haven't had too much time to work on this. If you want to take lead on it, go ahead. I moved into a house lately and it has been taking most of my free time.", "time": "2013-06-08T14:27:23Z", "text": "(In reply to Christophe Humbert from comment #20)\n> Hello\n> \n> Any news...What it is needed to make it moving\n> \n> Thanks\n\nI haven't had too much time to work on this. If you want to take lead on it, go ahead. I moved into a house lately and it has been taking most of my free time.", "count": 21, "author": "alexandre.f.demers@gmail.com", "bug_id": 705596, "id": 7513024, "attachment_id": null, "tags": [], "creator": "alexandre.f.demers@gmail.com", "creation_time": "2013-06-08T14:27:23Z", "is_private": false}]}}, "comments": {}}