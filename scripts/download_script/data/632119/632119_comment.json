{"comments": {}, "bugs": {"632119": {"comments": [{"is_private": false, "count": 0, "attachment_id": null, "time": "2011-02-07T19:24:12Z", "bug_id": 632119, "id": 5260771, "author": "dholbert@mozilla.com", "tags": [], "raw_text": "STEPS TO REPRODUCE:\n 1. Load the following data: URI (for a green 100x100 block):\n\ndata:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00d%00%00%00d%08%06%00%00%00p%E2%95T%00%00%00%01sRGB%00%AE%CE%1C%E9%00%00%00%A2IDATx%DA%ED%D1%01%0D%00%00%08%C3%B0%83%7F%CF%60%83%90N%C2Z%99Lt%A6%B6%00%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%08%10%01%11%10%20%02%02D%40%BE%B7%EBM%02%C6h%7D%EAl%00%00%00%00IEND%AEB%60%82\n\n 2. Right-click on the loaded image, and choose \"View Image Info\"\n\nACTUAL RESULTS: The Image Info contains:\n  \"Dimensions: 0px x 0px\"\n\nEXPECTED:\n  \"Dimensions: 100px x 100px\"\n\nIf I view the actual PNG image (not as a data URI), I get EXPECTED RESULTS.", "text": "STEPS TO REPRODUCE:\n 1. Load the following data: URI (for a green 100x100 block):\n\ndata:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00d%00%00%00d%08%06%00%00%00p%E2%95T%00%00%00%01sRGB%00%AE%CE%1C%E9%00%00%00%A2IDATx%DA%ED%D1%01%0D%00%00%08%C3%B0%83%7F%CF%60%83%90N%C2Z%99Lt%A6%B6%00%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%88%80%00%11%10%20%02%02D%40%80%08%08%10%01%11%10%20%02%02D%40%BE%B7%EBM%02%C6h%7D%EAl%00%00%00%00IEND%AEB%60%82\n\n 2. Right-click on the loaded image, and choose \"View Image Info\"\n\nACTUAL RESULTS: The Image Info contains:\n  \"Dimensions: 0px x 0px\"\n\nEXPECTED:\n  \"Dimensions: 100px x 100px\"\n\nIf I view the actual PNG image (not as a data URI), I get EXPECTED RESULTS.", "creation_time": "2011-02-07T19:24:12Z", "creator": "dholbert@mozilla.com"}, {"tags": [], "bug_id": 632119, "id": 5260775, "count": 1, "time": "2011-02-07T19:25:40Z", "attachment_id": 510334, "is_private": false, "raw_text": "Here's the image that's encoded by the data URI in comment 0.  When you view this attached image directly (not as a data URI), you get EXPECTED RESULTS.", "creator": "dholbert@mozilla.com", "text": "Created attachment 510334\nreference case (same image, as a file)\n\nHere's the image that's encoded by the data URI in comment 0.  When you view this attached image directly (not as a data URI), you get EXPECTED RESULTS.", "creation_time": "2011-02-07T19:25:40Z", "author": "dholbert@mozilla.com"}, {"tags": [], "author": "dholbert@mozilla.com", "text": "Additionally - for data URIs, there's a broken-image icon instead of the actual image, in the \"Media Preview\" box (at the bottom of the View Image Info).", "creation_time": "2011-02-07T19:35:14Z", "creator": "dholbert@mozilla.com", "raw_text": "Additionally - for data URIs, there's a broken-image icon instead of the actual image, in the \"Media Preview\" box (at the bottom of the View Image Info).", "is_private": false, "count": 2, "time": "2011-02-07T19:35:14Z", "attachment_id": null, "id": 5260816, "bug_id": 632119}, {"author": "dholbert@mozilla.com", "tags": [], "raw_text": "See also Bug 599756, which was filed a few months back on similar issues with \"moz-filedata:\" images.", "creation_time": "2011-02-07T19:38:38Z", "text": "See also Bug 599756, which was filed a few months back on similar issues with \"moz-filedata:\" images.", "creator": "dholbert@mozilla.com", "is_private": false, "attachment_id": null, "time": "2011-02-07T19:38:38Z", "count": 3, "bug_id": 632119, "id": 5260831}, {"attachment_id": null, "count": 4, "time": "2011-02-11T05:38:42Z", "is_private": false, "id": 5271770, "bug_id": 632119, "tags": [], "author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu", "creation_time": "2011-02-11T05:38:42Z", "text": "Hmm.  So the page info code sets img.url and immediately reads the size.  So it assumes some sort of sync cache hit or something happening here.", "raw_text": "Hmm.  So the page info code sets img.url and immediately reads the size.  So it assumes some sort of sync cache hit or something happening here."}, {"tags": [], "author": "bzbarsky@mit.edu", "text": "Actually, it looks like it never sets .url.  Investigating.", "creation_time": "2011-02-11T05:49:17Z", "creator": "bzbarsky@mit.edu", "raw_text": "Actually, it looks like it never sets .url.  Investigating.", "is_private": false, "count": 5, "attachment_id": null, "time": "2011-02-11T05:49:17Z", "id": 5271782, "bug_id": 632119}, {"is_private": false, "attachment_id": null, "count": 6, "time": "2011-02-11T05:58:20Z", "id": 5271793, "bug_id": 632119, "author": "bzbarsky@mit.edu", "creation_time": "2011-02-11T05:58:20Z", "text": "And in particular, this check returns false:\n\n  if (/^data:/.test(url) && /^image\\//.test(img[COL_IMAGE_NODE].type))\n\nbecause img[COL_IMAGE_NODE].type is undefined.  So checkProtocol returns false, and page info doesn't do anything with this image.\n\nThis is a regression from bug 377349 which moved some code around incorrectly (and replaced \"mimeType\" with \"type\" in the process).", "creator": "bzbarsky@mit.edu", "raw_text": "And in particular, this check returns false:\n\n  if (/^data:/.test(url) && /^image\\//.test(img[COL_IMAGE_NODE].type))\n\nbecause img[COL_IMAGE_NODE].type is undefined.  So checkProtocol returns false, and page info doesn't do anything with this image.\n\nThis is a regression from bug 377349 which moved some code around incorrectly (and replaced \"mimeType\" with \"type\" in the process).", "tags": []}, {"tags": [], "text": "Setting to All/All as I can reproduce this on Win7", "creation_time": "2011-02-11T08:19:42Z", "creator": "philip.chee@gmail.com", "raw_text": "Setting to All/All as I can reproduce this on Win7", "author": "philip.chee@gmail.com", "id": 5271970, "bug_id": 632119, "is_private": false, "count": 7, "attachment_id": null, "time": "2011-02-11T08:19:42Z"}, {"author": "alice0775@gmail.com", "creation_time": "2011-06-24T08:13:12Z", "text": "*** Bug 666861 has been marked as a duplicate of this bug. ***", "creator": "alice0775@gmail.com", "raw_text": "", "is_private": false, "time": "2011-06-24T08:13:12Z", "attachment_id": null, "count": 8, "id": 5553459, "bug_id": 632119, "tags": []}, {"tags": [], "author": "dindog@163.com", "text": "so any plan to deal with this in recent? Maybe firefox 8?", "creation_time": "2011-06-25T16:31:14Z", "creator": "dindog@163.com", "raw_text": "so any plan to deal with this in recent? Maybe firefox 8?", "is_private": false, "attachment_id": null, "count": 9, "time": "2011-06-25T16:31:14Z", "id": 5556134, "bug_id": 632119}, {"creator": "bzbarsky@mit.edu", "creation_time": "2011-06-27T16:59:34Z", "text": "Since tmyoung is not around, over to the bug 377349 reviewer.", "raw_text": "Since tmyoung is not around, over to the bug 377349 reviewer.", "tags": [], "author": "bzbarsky@mit.edu", "id": 5558948, "bug_id": 632119, "attachment_id": null, "time": "2011-06-27T16:59:34Z", "count": 10, "is_private": false}, {"tags": [], "author": "jidanni@jidanni.org", "creator": "jidanni@jidanni.org", "creation_time": "2011-11-18T22:04:59Z", "text": "Indeed Firefox 10 users wonder\n\"speaking of which, why in Firefox when I click \"View Background\nImage\" on an average Wikipedia page do I get\ndata:image/png;base64,iVBORw0... \"1x1\" pixels and all just white?\nand in Page Info > Media there are several more, all \"0x0\" pixels.\nAre they just all white nothingness, or is this a Firefox bug?\"", "raw_text": "Indeed Firefox 10 users wonder\n\"speaking of which, why in Firefox when I click \"View Background\nImage\" on an average Wikipedia page do I get\ndata:image/png;base64,iVBORw0... \"1x1\" pixels and all just white?\nand in Page Info > Media there are several more, all \"0x0\" pixels.\nAre they just all white nothingness, or is this a Firefox bug?\"", "count": 11, "time": "2011-11-18T22:04:59Z", "attachment_id": null, "is_private": false, "id": 5859313, "bug_id": 632119}, {"raw_text": "(In reply to jidanni from comment #11)\n> Are they just all white nothingness, or is this a Firefox bug?\"\n\nThey're not white nothingness -- what you're describing is a firefox bug. (It's this bug, in fact! :) )\n\nNote that this affects moz-filedata: URIs as well (e.g. it affects http://mxr.mozilla.org/mozilla-central/source/layout/reftests/svg/as-image/img-blobBuilder-1.html )", "text": "(In reply to jidanni from comment #11)\n> Are they just all white nothingness, or is this a Firefox bug?\"\n\nThey're not white nothingness -- what you're describing is a firefox bug. (It's this bug, in fact! :) )\n\nNote that this affects moz-filedata: URIs as well (e.g. it affects http://mxr.mozilla.org/mozilla-central/source/layout/reftests/svg/as-image/img-blobBuilder-1.html )", "creation_time": "2011-11-18T22:29:05Z", "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com", "tags": [], "bug_id": 632119, "id": 5859387, "is_private": false, "time": "2011-11-18T22:29:05Z", "attachment_id": null, "count": 12}, {"is_private": false, "time": "2011-11-18T22:33:23Z", "attachment_id": null, "count": 13, "id": 5859400, "bug_id": 632119, "author": "dholbert@mozilla.com", "text": "(ah, sorry -- the moz-filedata brokenness is covered by bug 599756)", "creation_time": "2011-11-18T22:33:23Z", "creator": "dholbert@mozilla.com", "raw_text": "(ah, sorry -- the moz-filedata brokenness is covered by bug 599756)", "tags": []}, {"id": 5859420, "bug_id": 632119, "time": "2011-11-18T22:39:13Z", "count": 14, "attachment_id": null, "is_private": false, "creator": "bzbarsky@mit.edu", "creation_time": "2011-11-18T22:39:13Z", "text": "Gavin, can you find someone to fix this, please?\n\nNote that the \"View background image\" issue is separate from this bug.  Please file a bug on it, with steps to reproduce.", "raw_text": "Gavin, can you find someone to fix this, please?\n\nNote that the \"View background image\" issue is separate from this bug.  Please file a bug on it, with steps to reproduce.", "tags": [], "author": "bzbarsky@mit.edu"}, {"bug_id": 632119, "id": 5859469, "time": "2011-11-18T22:56:55Z", "count": 15, "attachment_id": null, "is_private": false, "raw_text": "(In reply to Boris Zbarsky (:bz) from comment #14)\n> Note that the \"View background image\" issue is separate from this bug. \n> Please file a bug on it, with steps to reproduce.\nJust view the background image on Wikipedia. Same problem.", "creator": "jidanni@jidanni.org", "creation_time": "2011-11-18T22:56:55Z", "text": "(In reply to Boris Zbarsky (:bz) from comment #14)\n> Note that the \"View background image\" issue is separate from this bug. \n> Please file a bug on it, with steps to reproduce.\nJust view the background image on Wikipedia. Same problem.", "author": "jidanni@jidanni.org", "tags": []}, {"raw_text": "That works fine for me (it loads a 1x1 PNG image with a data URI directly). That's all correct so far.\n\nAt that point, if I then do view-page-info, *then* we hit this bug (because at that point we're basically following my STR from comment 0).\n\nIf that's what you're talking about, cool. If not, please file another bug, as bz requested.", "creation_time": "2011-11-18T23:01:44Z", "text": "That works fine for me (it loads a 1x1 PNG image with a data URI directly). That's all correct so far.\n\nAt that point, if I then do view-page-info, *then* we hit this bug (because at that point we're basically following my STR from comment 0).\n\nIf that's what you're talking about, cool. If not, please file another bug, as bz requested.", "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com", "tags": [], "bug_id": 632119, "id": 5859486, "is_private": false, "attachment_id": null, "count": 16, "time": "2011-11-18T23:01:44Z"}, {"tags": [], "is_private": false, "count": 17, "attachment_id": null, "time": "2011-11-18T23:21:43Z", "id": 5859557, "bug_id": 632119, "author": "jidanni@jidanni.org", "creation_time": "2011-11-18T23:21:43Z", "text": "OK filed Bug 703784.", "creator": "jidanni@jidanni.org", "raw_text": "OK filed Bug 703784."}, {"author": "felix.the.cheshire.cat@gmail.com", "tags": [], "raw_text": "- Fixed and simplified checkProtocol", "creation_time": "2011-12-02T15:34:29Z", "text": "Created attachment 578578\nFix View Image Info for Data URIs\n\n- Fixed and simplified checkProtocol", "creator": "felix.the.cheshire.cat@gmail.com", "is_private": false, "count": 18, "attachment_id": 578578, "time": "2011-12-02T15:34:29Z", "bug_id": 632119, "id": 5888186}, {"tags": [], "author": "felix.the.cheshire.cat@gmail.com", "text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/71b2a65fe3f0", "creation_time": "2011-12-02T18:24:43Z", "creator": "felix.the.cheshire.cat@gmail.com", "raw_text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/71b2a65fe3f0", "is_private": false, "time": "2011-12-02T18:24:43Z", "count": 19, "attachment_id": null, "id": 5888659, "bug_id": 632119}, {"creator": "felix.the.cheshire.cat@gmail.com", "text": "This fixes the bug introduced by bug 377349 and makes data image URIs work. Is there any reason we don't allow _all_ data URIs to work as long as pageInfo.js can handle the object type (e.g. audio/video elements)?", "creation_time": "2011-12-02T22:11:06Z", "raw_text": "This fixes the bug introduced by bug 377349 and makes data image URIs work. Is there any reason we don't allow _all_ data URIs to work as long as pageInfo.js can handle the object type (e.g. audio/video elements)?", "tags": [], "author": "felix.the.cheshire.cat@gmail.com", "id": 5889487, "bug_id": 632119, "count": 20, "attachment_id": null, "time": "2011-12-02T22:11:06Z", "is_private": false}, {"bug_id": 632119, "id": 5889518, "count": 21, "attachment_id": null, "time": "2011-12-02T22:17:24Z", "is_private": false, "raw_text": "Felix: since we support audio and video tags already in page info, I would see no harm in this, but I can't remember if there is any other object type that can be handled through data:, if there is something like flash/javascript or another security-sensitive item (since page info currently runs in chrome), that would cause a problem--otherwise, being the person who wrote the original code, I see no problem.", "creator": "mozilla.bugs@alyoung.com", "text": "Felix: since we support audio and video tags already in page info, I would see no harm in this, but I can't remember if there is any other object type that can be handled through data:, if there is something like flash/javascript or another security-sensitive item (since page info currently runs in chrome), that would cause a problem--otherwise, being the person who wrote the original code, I see no problem.", "creation_time": "2011-12-02T22:17:24Z", "author": "mozilla.bugs@alyoung.com", "tags": []}, {"bug_id": 632119, "id": 5890470, "count": 22, "attachment_id": null, "time": "2011-12-03T11:16:51Z", "is_private": false, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/71b2a65fe3f0", "creator": "mak@mozilla.com", "creation_time": "2011-12-03T11:16:51Z", "text": "https://hg.mozilla.org/mozilla-central/rev/71b2a65fe3f0", "author": "mak@mozilla.com", "tags": []}, {"author": "bzbarsky@mit.edu", "creation_time": "2012-01-04T08:10:28Z", "text": "*** Bug 715075 has been marked as a duplicate of this bug. ***", "creator": "bzbarsky@mit.edu", "raw_text": "", "is_private": false, "time": "2012-01-04T08:10:28Z", "attachment_id": null, "count": 23, "id": 5953411, "bug_id": 632119, "tags": []}, {"tags": [], "creator": "dholbert@mozilla.com", "creation_time": "2012-01-04T09:54:00Z", "text": "For reference, here's a base64-encoded version of the image in comment 0:\ndata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAKJJREFUeNrt0QENAAAIw7CDf89gg5BOwlqZTHSmtgCIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAgIEAERECACAkRAvrfrTQLGaH3qbAAAAABJRU5ErkJggg%3D%3D\n(mostly posting for the purposes of discussion on bug 715075)", "raw_text": "For reference, here's a base64-encoded version of the image in comment 0:\ndata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAKJJREFUeNrt0QENAAAIw7CDf89gg5BOwlqZTHSmtgCIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAiIgAARECACAkRAgAgIEAERECACAkRAvrfrTQLGaH3qbAAAAABJRU5ErkJggg%3D%3D\n(mostly posting for the purposes of discussion on bug 715075)", "author": "dholbert@mozilla.com", "id": 5953504, "bug_id": 632119, "time": "2012-01-04T09:54:00Z", "attachment_id": null, "count": 24, "is_private": false}]}}}