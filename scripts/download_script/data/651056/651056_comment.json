{"comments": {}, "bugs": {"651056": {"comments": [{"author": "u238590@disabled.tld", "attachment_id": null, "bug_id": 651056, "creator": "u238590@disabled.tld", "count": 0, "tags": [], "time": "2011-04-19T09:02:13Z", "raw_text": "I created 1000 Virtual Servers with 1000 certs. At server startup for SNI, each Virtual Server will call PK11_ListCerts(). This call is very slow.\n\nIts a 32 core system with 8 cores enabled.\n\n$prtconf\nSystem Configuration:  Sun Microsystems  sun4v\nMemory size: 32760 Megabytes\nSystem Peripherals (Software Nodes): SUNW,Sun-Fire-T200\n...\n\nWith cert8.db : \n~~~~~~~~~~~~~~\n# date\nMon Apr 18 06:33:15 PDT 2011\n# ../bin/startserv\n# date\nMon Apr 18 15:23:00 PDT 2011\n\nThis took almost 9 hours for the server to startup. \n\nWith cert9.db its still going on....\n-------------------------------------------------------------------\nAttached is the sample program and NSS Dbs :\n server.cpp (has sql: hardcoded for cert9.db change it when u use cert8.db)  \n Makefile  \n cert8.db key3.db secmod.db\n cert9.db key4.db pkcs11.txt  \n-------------------------------------------------------------------\nAs a workaround I will try to call PK11_ListCerts() outside the loop once for the whole server instance. But still it would be nice if its performance could be improved.", "id": 5418031, "text": "I created 1000 Virtual Servers with 1000 certs. At server startup for SNI, each Virtual Server will call PK11_ListCerts(). This call is very slow.\n\nIts a 32 core system with 8 cores enabled.\n\n$prtconf\nSystem Configuration:  Sun Microsystems  sun4v\nMemory size: 32760 Megabytes\nSystem Peripherals (Software Nodes): SUNW,Sun-Fire-T200\n...\n\nWith cert8.db : \n~~~~~~~~~~~~~~\n# date\nMon Apr 18 06:33:15 PDT 2011\n# ../bin/startserv\n# date\nMon Apr 18 15:23:00 PDT 2011\n\nThis took almost 9 hours for the server to startup. \n\nWith cert9.db its still going on....\n-------------------------------------------------------------------\nAttached is the sample program and NSS Dbs :\n server.cpp (has sql: hardcoded for cert9.db change it when u use cert8.db)  \n Makefile  \n cert8.db key3.db secmod.db\n cert9.db key4.db pkcs11.txt  \n-------------------------------------------------------------------\nAs a workaround I will try to call PK11_ListCerts() outside the loop once for the whole server instance. But still it would be nice if its performance could be improved.", "is_private": false, "creation_time": "2011-04-19T09:02:13Z"}, {"time": "2011-04-19T10:06:01Z", "is_private": false, "attachment_id": 526948, "tags": [], "count": 1, "creator": "u238590@disabled.tld", "bug_id": 651056, "id": 5418110, "raw_text": "", "creation_time": "2011-04-19T10:06:01Z", "text": "Created attachment 526948\nAttached is the sample program and NSS cert8 Dbs", "author": "u238590@disabled.tld"}, {"attachment_id": null, "is_private": false, "time": "2011-04-20T08:04:34Z", "author": "u238590@disabled.tld", "creation_time": "2011-04-20T08:04:34Z", "text": "Note that the time taken is random.\n\nWhen I started Web Server with cert9.db with all 32 cores it took almost 6 hours :\n#date \nTue Apr 19 00:52:36 PDT 2011\n# date\nTue Apr 19 06:36:56 PDT 2011\n\ncert9.db sample program attached took 12 hours:\n#date\nTue Apr 19 01:34:07 PDT 2011\n# ./a.out && date\nTue Apr 19 13:09:21 PDT 2011", "id": 5420769, "raw_text": "Note that the time taken is random.\n\nWhen I started Web Server with cert9.db with all 32 cores it took almost 6 hours :\n#date \nTue Apr 19 00:52:36 PDT 2011\n# date\nTue Apr 19 06:36:56 PDT 2011\n\ncert9.db sample program attached took 12 hours:\n#date\nTue Apr 19 01:34:07 PDT 2011\n# ./a.out && date\nTue Apr 19 13:09:21 PDT 2011", "tags": [], "count": 2, "creator": "u238590@disabled.tld", "bug_id": 651056}]}}}