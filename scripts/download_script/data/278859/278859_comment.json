{"bugs": {"278859": {"comments": [{"id": 2389741, "bug_id": 278859, "count": 0, "time": "2005-01-18T17:52:25Z", "attachment_id": null, "is_private": false, "creator": "bzbarsky@mit.edu", "text": "BUILD: Current trunk Firefox (before bsmedberg's command-line landing)\n\nSTEPS TO REPRODUCE:\n1) Build debug Firefox with --enable-extensions=all\n2) Try to run it with the -layoutdebug command-line option\n\nEXPECTED RESULT: See layout debugger, with working menus and all.\n\nACTUAL RESULT: Totally horked UI.  Menus don't work.\n\nThis is pretty basic dogfood here... People are having to build SeaMonkey for\nsomething as basic as running the layout regression tests.\n\nI did some testing, and on first startup the menus that are present do work (the\nothers presumably reference overlays that don't exist in Firefox).  On second\nstartup I get some nice fastload errors:\n\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 140\n\nfollowed by layout being confused:\n\n###!!! ASSERTION: initial containing block already created: 'nsnull ==\nmInitialContainingBlock', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsCSSFrameConstructor.cpp, line\n8971\n\nfollowed by XUL being confused:\n\n###!!! ASSERTION: Popup set is already defined! Only 1 allowed.: 'Not Reached',\nfile\n/home/bzbarsky/mozilla/debug/mozilla/layout/xul/base/src/nsRootBoxFrame.cpp,\nline 296\n###!!! ASSERTION: node in map twice: 'Not Reached', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 1897\n###!!! ASSERTION: unexpected second call to SetInitialChildList: 'Not Reached',\nfile /home/bzbarsky/mozilla/debug/mozilla/layout/generic/nsContainerFrame.cpp,\nline 109\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 1403\n###!!! ASSERTION: Bug 119310, perhaps overlayinfo referenced a overlay that\ndoesn't exist: 'mPlaceHolderRequest', file\n/home/bzbarsky/mozilla/debug/mozilla/content/xul/document/src/nsXULDocument.cpp,\nline 2985\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 1403\n###!!! ASSERTION: forward references have already been resolved: 'Error', file\n/home/bzbarsky/mozilla/debug/mozilla/content/xul/document/src/nsXULDocument.cpp,\nline 1321\n\nSeveral repeats of this last one, then all of the above from the top, with lots\nof copies of:\n\n###!!! ASSERTION: node in map twice: 'Not Reached', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 1897\n\nthen (from nsBoxFrame.cpp):\n\nWARNING: Warning add child failed!!\n\nthen (because the root session history is null, I bet):\n\nWARNING: NS_ENSURE_TRUE(webnav) failed, file\n/home/bzbarsky/mozilla/debug/mozilla/docshell/base/nsDocShell.cpp, line 2652\n\nWARNING: NS_ENSURE_TRUE(aContent) failed, file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 372\n\n###!!! ASSERTION: Found more undisplayed content data after removal: 'context ==\nnsnull', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 660\n\nThis last message is repeated half a dozen times.  Then all is quiet, and the UI\nis dead.\n\nInterestingly, after this I can't get the initial \"ok\" state no matter what I do\n(I tried deleting the XUL.mfasl file and deleting all of .mozilla/firefox, but\nneither helped).", "creation_time": "2005-01-18T17:52:25Z", "raw_text": "BUILD: Current trunk Firefox (before bsmedberg's command-line landing)\n\nSTEPS TO REPRODUCE:\n1) Build debug Firefox with --enable-extensions=all\n2) Try to run it with the -layoutdebug command-line option\n\nEXPECTED RESULT: See layout debugger, with working menus and all.\n\nACTUAL RESULT: Totally horked UI.  Menus don't work.\n\nThis is pretty basic dogfood here... People are having to build SeaMonkey for\nsomething as basic as running the layout regression tests.\n\nI did some testing, and on first startup the menus that are present do work (the\nothers presumably reference overlays that don't exist in Firefox).  On second\nstartup I get some nice fastload errors:\n\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 140\n\nfollowed by layout being confused:\n\n###!!! ASSERTION: initial containing block already created: 'nsnull ==\nmInitialContainingBlock', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsCSSFrameConstructor.cpp, line\n8971\n\nfollowed by XUL being confused:\n\n###!!! ASSERTION: Popup set is already defined! Only 1 allowed.: 'Not Reached',\nfile\n/home/bzbarsky/mozilla/debug/mozilla/layout/xul/base/src/nsRootBoxFrame.cpp,\nline 296\n###!!! ASSERTION: node in map twice: 'Not Reached', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 1897\n###!!! ASSERTION: unexpected second call to SetInitialChildList: 'Not Reached',\nfile /home/bzbarsky/mozilla/debug/mozilla/layout/generic/nsContainerFrame.cpp,\nline 109\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 1403\n###!!! ASSERTION: Bug 119310, perhaps overlayinfo referenced a overlay that\ndoesn't exist: 'mPlaceHolderRequest', file\n/home/bzbarsky/mozilla/debug/mozilla/content/xul/document/src/nsXULDocument.cpp,\nline 2985\n###!!! ASSERTION: redundant multiplexed document?: 'docMapEntry->mString ==\nnsnull', file /home/bzbarsky/mozilla/debug/mozilla/xpcom/io/nsFastLoadFile.cpp,\nline 1403\n###!!! ASSERTION: forward references have already been resolved: 'Error', file\n/home/bzbarsky/mozilla/debug/mozilla/content/xul/document/src/nsXULDocument.cpp,\nline 1321\n\nSeveral repeats of this last one, then all of the above from the top, with lots\nof copies of:\n\n###!!! ASSERTION: node in map twice: 'Not Reached', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 1897\n\nthen (from nsBoxFrame.cpp):\n\nWARNING: Warning add child failed!!\n\nthen (because the root session history is null, I bet):\n\nWARNING: NS_ENSURE_TRUE(webnav) failed, file\n/home/bzbarsky/mozilla/debug/mozilla/docshell/base/nsDocShell.cpp, line 2652\n\nWARNING: NS_ENSURE_TRUE(aContent) failed, file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 372\n\n###!!! ASSERTION: Found more undisplayed content data after removal: 'context ==\nnsnull', file\n/home/bzbarsky/mozilla/debug/mozilla/layout/base/nsFrameManager.cpp, line 660\n\nThis last message is repeated half a dozen times.  Then all is quiet, and the UI\nis dead.\n\nInterestingly, after this I can't get the initial \"ok\" state no matter what I do\n(I tried deleting the XUL.mfasl file and deleting all of .mozilla/firefox, but\nneither helped).", "tags": [], "author": "bzbarsky@mit.edu"}, {"id": 2389746, "bug_id": 278859, "attachment_id": null, "count": 1, "time": "2005-01-18T17:57:23Z", "is_private": false, "creator": "bzbarsky@mit.edu", "text": "Oh, this is trunk, of course.", "creation_time": "2005-01-18T17:57:23Z", "raw_text": "Oh, this is trunk, of course.", "tags": [], "author": "bzbarsky@mit.edu"}, {"bug_id": 278859, "id": 2420924, "is_private": false, "count": 2, "attachment_id": null, "time": "2005-02-21T18:11:14Z", "raw_text": "brendan: top assertion is in fastload, so that seems a likely culprit. Could you\ntake a look? This is stopping Gecko devs from using Firefox for their work.", "text": "brendan: top assertion is in fastload, so that seems a likely culprit. Could you\ntake a look? This is stopping Gecko devs from using Firefox for their work.", "creation_time": "2005-02-21T18:11:14Z", "creator": "ian@hixie.ch", "author": "ian@hixie.ch", "tags": []}, {"is_private": false, "attachment_id": null, "count": 3, "time": "2005-02-21T18:47:08Z", "id": 2420957, "bug_id": 278859, "tags": [], "author": "brendan@mozilla.org", "text": "Hixie, we've been over this via IRC.  FastLoad has not regressed, but the way it\nis used has.  Since no one else seems willing to dig in, I'll take a look with\ndbaron's or bz's help tomorrow.  I expect to reassign this bug.\n\n/be", "creation_time": "2005-02-21T18:47:08Z", "creator": "brendan@mozilla.org", "raw_text": "Hixie, we've been over this via IRC.  FastLoad has not regressed, but the way it\nis used has.  Since no one else seems willing to dig in, I'll take a look with\ndbaron's or bz's help tomorrow.  I expect to reassign this bug.\n\n/be"}, {"count": 4, "attachment_id": null, "time": "2005-03-14T06:41:08Z", "is_private": false, "bug_id": 278859, "id": 2443405, "author": "mrbkap@gmail.com", "tags": [], "raw_text": "I've been poking at fastload recently, so stealing from Brendan so I remember to\nlook at this.", "creator": "mrbkap@gmail.com", "text": "I've been poking at fastload recently, so stealing from Brendan so I remember to\nlook at this.", "creation_time": "2005-03-14T06:41:08Z"}, {"tags": [], "attachment_id": null, "count": 5, "time": "2005-03-14T07:02:08Z", "is_private": false, "id": 2443415, "bug_id": 278859, "author": "darin.moz@gmail.com", "creator": "darin.moz@gmail.com", "creation_time": "2005-03-14T07:02:08Z", "text": "BTW, I got layout-debug working just fine as a standalone XULRunner application\nover the weekend.  I didn't have to edit any of the source files.  So, I figure\nthat these problems must be overlay related.", "raw_text": "BTW, I got layout-debug working just fine as a standalone XULRunner application\nover the weekend.  I didn't have to edit any of the source files.  So, I figure\nthat these problems must be overlay related."}, {"raw_text": "(In reply to comment #5)\n> BTW, I got layout-debug working just fine as a standalone XULRunner application\n> over the weekend.  I didn't have to edit any of the source files.  So, I figure\n> that these problems must be overlay related.\n\nBug 243119 ?", "creation_time": "2005-03-21T19:04:23Z", "text": "(In reply to comment #5)\n> BTW, I got layout-debug working just fine as a standalone XULRunner application\n> over the weekend.  I didn't have to edit any of the source files.  So, I figure\n> that these problems must be overlay related.\n\nBug 243119 ?", "creator": "asaf@sent.com", "author": "asaf@sent.com", "tags": [], "bug_id": 278859, "id": 2450488, "is_private": false, "count": 6, "time": "2005-03-21T19:04:23Z", "attachment_id": null}, {"tags": [], "attachment_id": null, "count": 7, "time": "2005-07-20T02:08:26Z", "is_private": false, "bug_id": 278859, "id": 2556574, "author": "ian@hixie.ch", "raw_text": "Blake: Any news on this?", "creator": "ian@hixie.ch", "text": "Blake: Any news on this?", "creation_time": "2005-07-20T02:08:26Z"}, {"tags": [], "author": "bernd_mozilla@gmx.de", "creator": "bernd_mozilla@gmx.de", "text": "I think <?xul-overlay href=\"chrome://communicator/content/tasksOverlay.xul\"?>\nshould be <?xul-overlay href=\"chrome://browser/content/tasksOverlay.xul\"?> to\nget it running in firefox. There are a couple of references to communicator\nwhich AFAIK will not work in firefox", "creation_time": "2005-07-24T08:52:56Z", "raw_text": "I think <?xul-overlay href=\"chrome://communicator/content/tasksOverlay.xul\"?>\nshould be <?xul-overlay href=\"chrome://browser/content/tasksOverlay.xul\"?> to\nget it running in firefox. There are a couple of references to communicator\nwhich AFAIK will not work in firefox", "time": "2005-07-24T08:52:56Z", "attachment_id": null, "count": 8, "is_private": false, "id": 2560538, "bug_id": 278859}, {"tags": [], "bug_id": 278859, "id": 2560633, "is_private": false, "time": "2005-07-24T13:41:29Z", "count": 9, "attachment_id": null, "raw_text": "So with the checkin for bug 296102 the behavior here is slightly different.  The\nmenus no longer freeze up completely.  Some of the menu options work (eg \"Dump\nFrames\").  Some others do not for no reason I can see (eg the paint flashing\none).  It's still not possible to run the regression tests because the relevant\nsubmenus never come up.  But maybe they're actually defined in the overlays that\nfail to load...", "creation_time": "2005-07-24T13:41:29Z", "text": "So with the checkin for bug 296102 the behavior here is slightly different.  The\nmenus no longer freeze up completely.  Some of the menu options work (eg \"Dump\nFrames\").  Some others do not for no reason I can see (eg the paint flashing\none).  It's still not possible to run the regression tests because the relevant\nsubmenus never come up.  But maybe they're actually defined in the overlays that\nfail to load...", "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu"}, {"author": "dbaron@dbaron.org", "tags": [], "raw_text": "(In reply to comment #9)\n> Some others do not for no reason I can see (eg the paint flashing\n> one).\n\nPaint flashing on GTK1 requires Caps-Lock; I don't think it's implemented on GTK2.\n\n> It's still not possible to run the regression tests because the relevant\n> submenus never come up.  But maybe they're actually defined in the overlays that\n> fail to load...\n\nThey shouldn't be.", "creator": "dbaron@dbaron.org", "creation_time": "2005-07-24T15:22:08Z", "text": "(In reply to comment #9)\n> Some others do not for no reason I can see (eg the paint flashing\n> one).\n\nPaint flashing on GTK1 requires Caps-Lock; I don't think it's implemented on GTK2.\n\n> It's still not possible to run the regression tests because the relevant\n> submenus never come up.  But maybe they're actually defined in the overlays that\n> fail to load...\n\nThey shouldn't be.", "count": 10, "attachment_id": null, "time": "2005-07-24T15:22:08Z", "is_private": false, "bug_id": 278859, "id": 2560675}, {"author": "dbaron@dbaron.org", "raw_text": "Also, most of the overlay stuff can just be removed and the small parts that are\nactually needed can be written by hand.", "text": "Also, most of the overlay stuff can just be removed and the small parts that are\nactually needed can be written by hand.", "creation_time": "2005-07-24T15:23:03Z", "creator": "dbaron@dbaron.org", "is_private": false, "count": 11, "time": "2005-07-24T15:23:03Z", "attachment_id": null, "bug_id": 278859, "id": 2560677, "tags": []}, {"creator": "bzbarsky@mit.edu", "text": "> I don't think it's implemented on GTK2.\n\nThat would do it... but the menuitem wasn't even reflecting the current pref value.", "creation_time": "2005-07-24T15:36:32Z", "raw_text": "> I don't think it's implemented on GTK2.\n\nThat would do it... but the menuitem wasn't even reflecting the current pref value.", "tags": [], "author": "bzbarsky@mit.edu", "id": 2560683, "bug_id": 278859, "attachment_id": null, "time": "2005-07-24T15:36:32Z", "count": 12, "is_private": false}, {"raw_text": "just for the record: bryner did allready port layout-debug to firefox we only\nneed to build it. See\nhttp://lxr.mozilla.org/mozilla/source/browser/extensions/layout-debug/", "creator": "bernd_mozilla@gmx.de", "creation_time": "2005-07-27T05:20:35Z", "text": "just for the record: bryner did allready port layout-debug to firefox we only\nneed to build it. See\nhttp://lxr.mozilla.org/mozilla/source/browser/extensions/layout-debug/", "author": "bernd_mozilla@gmx.de", "tags": [], "bug_id": 278859, "id": 2563569, "attachment_id": null, "count": 13, "time": "2005-07-27T05:20:35Z", "is_private": false}, {"bug_id": 278859, "id": 2563598, "time": "2005-07-27T05:45:17Z", "attachment_id": 190674, "count": 14, "is_private": false, "raw_text": "", "creator": "bernd_mozilla@gmx.de", "creation_time": "2005-07-27T05:45:17Z", "text": "Created attachment 190674\nff ui fixup", "author": "bernd_mozilla@gmx.de", "tags": []}, {"id": 3055370, "bug_id": 278859, "count": 15, "attachment_id": 247748, "time": "2006-12-07T00:25:30Z", "is_private": false, "creator": "gavin.sharp@gmail.com", "text": "Created attachment 247748\npatch\n\nThis patch does the following:\n-Adds a Firefox-specific overlay so that it's possible to start the layout debugger from the Firefox tools menu\n-Stops overlaying utilityOverlay.xul (all it did was populate the help menu in SeaMonkey and caused a \"no chrome package\" warning in Firefox)\n-Removes the edit menu, which as far as I can tell is currently broken in both SeaMonkey and Firefox, and isn't really all that useful anyways.\n\nI don't see any of the assertions mentioned earlier in this bug, and everything seems to work fine in a recent Firefox debug build. I've tested this patch with SeaMonkey to make sure all the menus that are still there still work. I think that once this patch lands, we should close this bug and file more specific bugs on any remaining issues.", "creation_time": "2006-12-07T00:25:30Z", "raw_text": "This patch does the following:\n-Adds a Firefox-specific overlay so that it's possible to start the layout debugger from the Firefox tools menu\n-Stops overlaying utilityOverlay.xul (all it did was populate the help menu in SeaMonkey and caused a \"no chrome package\" warning in Firefox)\n-Removes the edit menu, which as far as I can tell is currently broken in both SeaMonkey and Firefox, and isn't really all that useful anyways.\n\nI don't see any of the assertions mentioned earlier in this bug, and everything seems to work fine in a recent Firefox debug build. I've tested this patch with SeaMonkey to make sure all the menus that are still there still work. I think that once this patch lands, we should close this bug and file more specific bugs on any remaining issues.", "tags": [], "author": "gavin.sharp@gmail.com"}, {"author": "dbaron@dbaron.org", "creator": "dbaron@dbaron.org", "text": "Comment on attachment 247748\npatch\n\nr=dbaron.  Thanks for doing this.", "creation_time": "2006-12-07T00:43:14Z", "raw_text": "r=dbaron.  Thanks for doing this.", "time": "2006-12-07T00:43:14Z", "attachment_id": 247748, "count": 16, "is_private": false, "id": 3055383, "bug_id": 278859, "tags": []}, {"tags": [], "id": 3056107, "bug_id": 278859, "is_private": false, "attachment_id": null, "count": 17, "time": "2006-12-07T21:24:27Z", "creation_time": "2006-12-07T21:24:27Z", "text": "I've checked in that patch. I'm going to call this FIXED now, since I can't see any differences in the layout debugger when being used in Firefox or SeaMonkey, and can't reproduce the assertions mentioned earlier. New issues should go in other bugs, feel free to CC me.\n\nmozilla/extensions/layout-debug/ui/content/contents.rdf \t1.3\nmozilla/extensions/layout-debug/ui/content/layoutdebug-overlay.xul \t1.3\nmozilla/extensions/layout-debug/ui/content/layoutdebug.xul \t1.5", "creator": "gavin.sharp@gmail.com", "raw_text": "I've checked in that patch. I'm going to call this FIXED now, since I can't see any differences in the layout debugger when being used in Firefox or SeaMonkey, and can't reproduce the assertions mentioned earlier. New issues should go in other bugs, feel free to CC me.\n\nmozilla/extensions/layout-debug/ui/content/contents.rdf \t1.3\nmozilla/extensions/layout-debug/ui/content/layoutdebug-overlay.xul \t1.3\nmozilla/extensions/layout-debug/ui/content/layoutdebug.xul \t1.5", "author": "gavin.sharp@gmail.com"}]}}, "comments": {}}