{"bugs": {"1637194": {"comments": [{"id": 14813716, "author": "dlee@mozilla.com", "attachment_id": null, "text": "Currently dFPI doesn't work in Fission since storagePrincipal has a incorrect first-party domain.\nIt's because when we call `StoragePrincipalHelper::ChooseOriginAttributes()`[1] , it sets FPD through loadInfo's `topLevelPrincipal`, which is wrong in Fission because `topLevelPrincipal` is from the in-process top. \n\nWe are considering putting FPD in `CookieJarSettings`.\n\n[1] https://searchfox.org/mozilla-central/rev/446160560bf32ebf4cb7c4e25d7386ee22667255/toolkit/components/antitracking/StoragePrincipalHelper.cpp#19", "bug_id": 1637194, "is_private": false, "raw_text": "Currently dFPI doesn't work in Fission since storagePrincipal has a incorrect first-party domain.\nIt's because when we call `StoragePrincipalHelper::ChooseOriginAttributes()`[1] , it sets FPD through loadInfo's `topLevelPrincipal`, which is wrong in Fission because `topLevelPrincipal` is from the in-process top. \n\nWe are considering putting FPD in `CookieJarSettings`.\n\n[1] https://searchfox.org/mozilla-central/rev/446160560bf32ebf4cb7c4e25d7386ee22667255/toolkit/components/antitracking/StoragePrincipalHelper.cpp#19", "count": 0, "creation_time": "2020-05-12T09:55:03Z", "tags": [], "creator": "dlee@mozilla.com", "time": "2020-05-12T09:55:03Z"}, {"raw_text": "", "count": 1, "creation_time": "2020-05-14T10:15:54Z", "tags": [], "creator": "dlee@mozilla.com", "time": "2020-05-14T10:15:54Z", "author": "dlee@mozilla.com", "id": 14818983, "attachment_id": 9148305, "text": "Created attachment 9148305\nBug 1637194 - P1. Add firstPartyDomain to CookieJarSetting", "is_private": false, "bug_id": 1637194}, {"id": 14818984, "author": "dlee@mozilla.com", "attachment_id": 9148306, "raw_text": "\nFirstPartyDomain is only set while loading a top-level document.\nWe added in nsHttpChannel::AsyncOpen to ensure that the value is updated\nwhenever we open a channel.\n\nDepends on D75276", "text": "Created attachment 9148306\nBug 1637194 - P2. Set firstPartyDomain to CookieJarSetting in nsHttpChannel::AsyncOpen\n\n\nFirstPartyDomain is only set while loading a top-level document.\nWe added in nsHttpChannel::AsyncOpen to ensure that the value is updated\nwhenever we open a channel.\n\nDepends on D75276", "count": 2, "creation_time": "2020-05-14T10:16:09Z", "is_private": false, "bug_id": 1637194, "tags": [], "time": "2020-05-14T10:16:09Z", "creator": "dlee@mozilla.com"}, {"creator": "dlee@mozilla.com", "time": "2020-05-14T10:16:18Z", "tags": [], "creation_time": "2020-05-14T10:16:18Z", "count": 3, "raw_text": "\n\nDepends on D75277", "bug_id": 1637194, "is_private": false, "text": "Created attachment 9148307\nBug 1637194 - P3. StoragePrincipalHelper uses firstPartyDomain in CookieJarSetting\n\n\n\nDepends on D75277", "attachment_id": 9148307, "author": "dlee@mozilla.com", "id": 14818985}, {"bug_id": 1637194, "is_private": false, "text": "Created attachment 9149831\nBug 1637194 - P3. StoragePrincipalHelper uses firstPartyDomain in CookieJarSetting", "author": "dlee@mozilla.com", "id": 14828320, "attachment_id": 9149831, "creator": "dlee@mozilla.com", "time": "2020-05-18T12:06:28Z", "tags": [], "count": 4, "creation_time": "2020-05-18T12:06:28Z", "raw_text": ""}, {"bug_id": 1637194, "is_private": false, "id": 14828321, "author": "dlee@mozilla.com", "attachment_id": 9149832, "text": "Created attachment 9149832\nBug 1637194 - P4. Inherit the first-party domain from the parent document when creating CookieJarSetting in document\n\n\nThis fixes a issue that about:blank page can't get correct first-party\ndomain when fission is enabled.\n\nDepends on D75783", "tags": [], "creator": "dlee@mozilla.com", "time": "2020-05-18T12:06:37Z", "raw_text": "\nThis fixes a issue that about:blank page can't get correct first-party\ndomain when fission is enabled.\n\nDepends on D75783", "count": 5, "creation_time": "2020-05-18T12:06:37Z"}, {"bug_id": 1637194, "is_private": false, "attachment_id": null, "id": 14830288, "author": "pulsebot@bots.tld", "text": "Pushed by dlee@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/e7dfa75d822d\nP1. Add firstPartyDomain to CookieJarSetting r=timhuang,baku\nhttps://hg.mozilla.org/integration/autoland/rev/57be6fd91c48\nP2. Set firstPartyDomain to CookieJarSetting in nsHttpChannel::AsyncOpen r=necko-reviewers,timhuang,baku,kershaw\nhttps://hg.mozilla.org/integration/autoland/rev/bd808346ec6e\nP3. StoragePrincipalHelper uses firstPartyDomain in CookieJarSetting r=timhuang,baku\nhttps://hg.mozilla.org/integration/autoland/rev/643eb857ad96\nP4. Inherit the first-party domain from the parent document when creating CookieJarSetting in document r=timhuang,baku", "tags": [], "creator": "pulsebot@bots.tld", "time": "2020-05-19T09:57:49Z", "raw_text": "Pushed by dlee@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/e7dfa75d822d\nP1. Add firstPartyDomain to CookieJarSetting r=timhuang,baku\nhttps://hg.mozilla.org/integration/autoland/rev/57be6fd91c48\nP2. Set firstPartyDomain to CookieJarSetting in nsHttpChannel::AsyncOpen r=necko-reviewers,timhuang,baku,kershaw\nhttps://hg.mozilla.org/integration/autoland/rev/bd808346ec6e\nP3. StoragePrincipalHelper uses firstPartyDomain in CookieJarSetting r=timhuang,baku\nhttps://hg.mozilla.org/integration/autoland/rev/643eb857ad96\nP4. Inherit the first-party domain from the parent document when creating CookieJarSetting in document r=timhuang,baku", "creation_time": "2020-05-19T09:57:49Z", "count": 6}, {"bug_id": 1637194, "is_private": false, "text": "https://hg.mozilla.org/mozilla-central/rev/e7dfa75d822d\nhttps://hg.mozilla.org/mozilla-central/rev/57be6fd91c48\nhttps://hg.mozilla.org/mozilla-central/rev/bd808346ec6e\nhttps://hg.mozilla.org/mozilla-central/rev/643eb857ad96", "attachment_id": null, "author": "csabou@mozilla.com", "id": 14830998, "creator": "csabou@mozilla.com", "time": "2020-05-19T16:07:51Z", "tags": ["bugherder"], "creation_time": "2020-05-19T16:07:51Z", "count": 7, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/e7dfa75d822d\nhttps://hg.mozilla.org/mozilla-central/rev/57be6fd91c48\nhttps://hg.mozilla.org/mozilla-central/rev/bd808346ec6e\nhttps://hg.mozilla.org/mozilla-central/rev/643eb857ad96"}]}}, "comments": {}}