{"comments": {}, "bugs": {"1370051": {"comments": [{"attachment_id": null, "id": 12370490, "tags": [], "creation_time": "2017-06-04T07:59:19Z", "text": "User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.9) Gecko/20100101 Goanna/3.2 Firefox/45.9 PaleMoon/27.3.0\nBuild ID: 20170422220104\n\nSteps to reproduce:\n\n- Go to a folder of livemarks\n- In the context menu, select \"Delete\"\n\n\n\nActual results:\n\nBookmarks is deleted, but throws an errors in Browser Console:\n[Exception... \"Invalid livemark\"  nsresult: \"0x80070057 (NS_ERROR_ILLEGAL_VALUE)\"  location: \"JS frame :: resource://gre/components/nsLivemarkService.js :: getLivemark/< :: line 302\"  data: no]\n\n\n\nExpected results:\n\nBookmarks is deleted, and Browser Console is empty.", "raw_text": "User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.9) Gecko/20100101 Goanna/3.2 Firefox/45.9 PaleMoon/27.3.0\nBuild ID: 20170422220104\n\nSteps to reproduce:\n\n- Go to a folder of livemarks\n- In the context menu, select \"Delete\"\n\n\n\nActual results:\n\nBookmarks is deleted, but throws an errors in Browser Console:\n[Exception... \"Invalid livemark\"  nsresult: \"0x80070057 (NS_ERROR_ILLEGAL_VALUE)\"  location: \"JS frame :: resource://gre/components/nsLivemarkService.js :: getLivemark/< :: line 302\"  data: no]\n\n\n\nExpected results:\n\nBookmarks is deleted, and Browser Console is empty.", "creator": "janekptacijarabaci@seznam.cz", "is_private": false, "count": 0, "author": "janekptacijarabaci@seznam.cz", "time": "2017-06-04T07:59:19Z", "bug_id": 1370051}, {"attachment_id": null, "id": 12371572, "tags": [], "creation_time": "2017-06-05T06:20:23Z", "raw_text": "Patch proposal to fix issue can be:\nhttps://github.com/MoonchildProductions/Pale-Moon/pull/1139", "text": "Patch proposal to fix issue can be:\nhttps://github.com/MoonchildProductions/Pale-Moon/pull/1139", "creator": "janekptacijarabaci@seznam.cz", "is_private": false, "bug_id": 1370051, "author": "janekptacijarabaci@seznam.cz", "count": 1, "time": "2017-06-05T06:20:23Z"}, {"is_private": false, "bug_id": 1370051, "count": 2, "raw_text": "That patch doesn't look good. If the error is unexpected we should just not make it reportError, if the error is real, then we should figure out what causes it, rather than workarounding the error. Here looks like something is invoking removeLivemark on an item that is not a livemark, or not recognized by the Livemarks service, we need to figure out why that happens.", "creator": "mak@mozilla.com", "tags": [], "attachment_id": null, "id": 12371669, "author": "mak@mozilla.com", "time": "2017-06-05T07:39:34Z", "text": "That patch doesn't look good. If the error is unexpected we should just not make it reportError, if the error is real, then we should figure out what causes it, rather than workarounding the error. Here looks like something is invoking removeLivemark on an item that is not a livemark, or not recognized by the Livemarks service, we need to figure out why that happens.", "creation_time": "2017-06-05T07:39:34Z"}, {"raw_text": "OK. \n\nIn this case, I propose the following change:\n\nAd https://hg.mozilla.org/mozilla-central/file/291fe1a6a375/toolkit/components/places/PlacesUtils.jsm#l3307\n\nFrom:\n\nfor (let i = 0; i < contents.childCount; ++i) {\n  let txn = new PlacesRemoveItemTransaction(contents.getChild(i).itemId);\n  transactions.push(txn);\n}\n\nTo:\n\nfor (let i = 0; i < contents.childCount; ++i) {\n  let childId = contents.getChild(i).itemId;\n  if (!PlacesUtils.annotations.itemHasAnnotation(childId,\n                                                 PlacesUtils.LMANNO_FEEDURI)) {\n    let txn = new PlacesRemoveItemTransaction(childId);\n    transactions.push(txn);\n  }\n}", "creator": "janekptacijarabaci@seznam.cz", "is_private": false, "bug_id": 1370051, "count": 3, "attachment_id": null, "id": 12371909, "tags": [], "text": "OK. \n\nIn this case, I propose the following change:\n\nAd https://hg.mozilla.org/mozilla-central/file/291fe1a6a375/toolkit/components/places/PlacesUtils.jsm#l3307\n\nFrom:\n\nfor (let i = 0; i < contents.childCount; ++i) {\n  let txn = new PlacesRemoveItemTransaction(contents.getChild(i).itemId);\n  transactions.push(txn);\n}\n\nTo:\n\nfor (let i = 0; i < contents.childCount; ++i) {\n  let childId = contents.getChild(i).itemId;\n  if (!PlacesUtils.annotations.itemHasAnnotation(childId,\n                                                 PlacesUtils.LMANNO_FEEDURI)) {\n    let txn = new PlacesRemoveItemTransaction(childId);\n    transactions.push(txn);\n  }\n}", "author": "janekptacijarabaci@seznam.cz", "time": "2017-06-05T09:34:46Z", "creation_time": "2017-06-05T09:34:46Z"}, {"tags": [], "creation_time": "2017-06-05T09:42:13Z", "attachment_id": null, "id": 12371927, "is_private": false, "author": "mak@mozilla.com", "time": "2017-06-05T09:42:13Z", "count": 4, "bug_id": 1370051, "raw_text": "(In reply to janekptacijarabaci from comment #3)\n> for (let i = 0; i < contents.childCount; ++i) {\n>   let childId = contents.getChild(i).itemId;\n>   if (!PlacesUtils.annotations.itemHasAnnotation(childId,\n>                                                 \n> PlacesUtils.LMANNO_FEEDURI)) {\n\nThis is still doing main-thread IO for every item to check if it has an annotation. \nThe view should already know if it's a livemark or not, IIRC we keep some sort of local property to track those.", "text": "(In reply to janekptacijarabaci from comment #3)\n> for (let i = 0; i < contents.childCount; ++i) {\n>   let childId = contents.getChild(i).itemId;\n>   if (!PlacesUtils.annotations.itemHasAnnotation(childId,\n>                                                 \n> PlacesUtils.LMANNO_FEEDURI)) {\n\nThis is still doing main-thread IO for every item to check if it has an annotation. \nThe view should already know if it's a livemark or not, IIRC we keep some sort of local property to track those.", "creator": "mak@mozilla.com"}, {"tags": [], "attachment_id": null, "id": 12502729, "is_private": false, "bug_id": 1370051, "count": 5, "raw_text": "* Regressed by:\n\nBug 969318 - \"A promise chain failed to handle a rejection\" from the livemarks service (deprecate passing a callback)\n\nChangeset 173276 - Mute \"A promise chain failed to handle a rejection\" error from the livemarks service. r=mano: \nhttps://hg.mozilla.org/mozilla-central/rev/60c1af78091a\n\nPushlog:\nhttps://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=44ae8462d6ab&tochange=46041cc216fd\n\nFirst bad: 30.0a1 (2014-03-13)\nBuilt from https://hg.mozilla.org/mozilla-central/rev/46041cc216fd\n\nLast good: 30.0a1 (2014-03-12)\nBuilt from https://hg.mozilla.org/mozilla-central/rev/44ae8462d6ab\n\n\n* The earliest error flavor:\n\n[Exception... \"Illegal value\"  nsresult: \"0x80070057 (NS_ERROR_ILLEGAL_VALUE)\"  location: \"JS frame :: resource://gre/components/nsLivemarkService.js :: LS_getLivemark/< :: line 397\"  data: no]\nSource File: resource://gre/modules/Promise.jsm -> resource://gre/modules/Promise-backend.js\nLine: 870", "creator": "loriennah@yandex.com", "creation_time": "2017-07-25T02:56:18Z", "time": "2017-07-25T02:56:18Z", "author": "loriennah@yandex.com", "text": "* Regressed by:\n\nBug 969318 - \"A promise chain failed to handle a rejection\" from the livemarks service (deprecate passing a callback)\n\nChangeset 173276 - Mute \"A promise chain failed to handle a rejection\" error from the livemarks service. r=mano: \nhttps://hg.mozilla.org/mozilla-central/rev/60c1af78091a\n\nPushlog:\nhttps://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=44ae8462d6ab&tochange=46041cc216fd\n\nFirst bad: 30.0a1 (2014-03-13)\nBuilt from https://hg.mozilla.org/mozilla-central/rev/46041cc216fd\n\nLast good: 30.0a1 (2014-03-12)\nBuilt from https://hg.mozilla.org/mozilla-central/rev/44ae8462d6ab\n\n\n* The earliest error flavor:\n\n[Exception... \"Illegal value\"  nsresult: \"0x80070057 (NS_ERROR_ILLEGAL_VALUE)\"  location: \"JS frame :: resource://gre/components/nsLivemarkService.js :: LS_getLivemark/< :: line 397\"  data: no]\nSource File: resource://gre/modules/Promise.jsm -> resource://gre/modules/Promise-backend.js\nLine: 870"}, {"bug_id": 1370051, "count": 6, "is_private": false, "creator": "mak@mozilla.com", "raw_text": "Wontfixing because live bookmarks are going away - See Bug 1477667.", "tags": [], "id": 13498607, "attachment_id": null, "author": "mak@mozilla.com", "time": "2018-07-25T15:56:19Z", "text": "Wontfixing because live bookmarks are going away - See Bug 1477667.", "creation_time": "2018-07-25T15:56:19Z"}]}}}