{"bugs": {"315557": {"comments": [{"is_private": false, "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12) Gecko/20050915 Firefox/1.0.7\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12) Gecko/20050915 Firefox/1.0.7\n\nExcution of the following snippet of code causes the javascript engine to throw an exception. (This snippet works in IE6)\n\n<snippet>\n   document.writeln(\"Hooking document.writeln\");\n  \n   var oldWriteln = document.writeln;\n   var counter = 0;\n   document.writeln = function(m) {\n       oldWriteln((++counter) + \": \" + m);\n   }\n   \n   document.writeln(\"Foo\");\n   document.writeln(\"Bar\");\n</snippet>\n\nTe javascript console displays this error:\nError: uncaught exception: [Exception... \"Illegal operation on WrappedNative prototype object\"   nsresult: \"0x8057000c (NS_ERROR_XPC_BAD_OP_ON_WN_PROTO)\"  location: \"JS frame ::  file:///C:/Documents%20and%20Settings/Administrator/Desktop/test.html :: anonymous :: line 36\"   data: no]\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Create a page with mentioned javascript\n2. Open the page in Firefox\n3. Done\n\nActual Results:  \nThe javascript isn't executed, and the javascript console showed the metioned error.\n\nExpected Results:  \nThe function should've been replaced by the custom function.", "attachment_id": null, "creator": "julius.schwartzenberg@gmail.com", "time": "2005-11-08T15:02:27Z", "creation_time": "2005-11-08T15:02:27Z", "author": "julius.schwartzenberg@gmail.com", "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12) Gecko/20050915 Firefox/1.0.7\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12) Gecko/20050915 Firefox/1.0.7\n\nExcution of the following snippet of code causes the javascript engine to throw an exception. (This snippet works in IE6)\n\n<snippet>\n   document.writeln(\"Hooking document.writeln\");\n  \n   var oldWriteln = document.writeln;\n   var counter = 0;\n   document.writeln = function(m) {\n       oldWriteln((++counter) + \": \" + m);\n   }\n   \n   document.writeln(\"Foo\");\n   document.writeln(\"Bar\");\n</snippet>\n\nTe javascript console displays this error:\nError: uncaught exception: [Exception... \"Illegal operation on WrappedNative prototype object\"   nsresult: \"0x8057000c (NS_ERROR_XPC_BAD_OP_ON_WN_PROTO)\"  location: \"JS frame ::  file:///C:/Documents%20and%20Settings/Administrator/Desktop/test.html :: anonymous :: line 36\"   data: no]\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Create a page with mentioned javascript\n2. Open the page in Firefox\n3. Done\n\nActual Results:  \nThe javascript isn't executed, and the javascript console showed the metioned error.\n\nExpected Results:  \nThe function should've been replaced by the custom function.", "tags": [], "bug_id": 315557, "count": 0, "id": 2691231}, {"attachment_id": 202248, "creator": "julius.schwartzenberg@gmail.com", "raw_text": "", "time": "2005-11-08T15:05:10Z", "creation_time": "2005-11-08T15:05:10Z", "id": 2691232, "count": 1, "text": "Created attachment 202248\nA small testcase which always reproduces the bug.", "author": "julius.schwartzenberg@gmail.com", "bug_id": 315557, "is_private": false, "tags": []}, {"count": 2, "id": 2691272, "tags": [], "bug_id": 315557, "author": "sync2d@gmail.com", "text": "The construction:\n  oldWriteln((++counter) + \": \" + m);\nsupplies the global object as |this| value for the method.\nThe original |writeln| method does not accept such |this| value and fails.\nThis behavior is not a bug.\n\nPossible fix for your code, which works in both of Mozilla and IE:\n   var oldWriteln = document.writeln;\n   var counter = 0;\n   document.writeln = function(m) {\n       this.oldWriteln = oldWriteln;\n       this.oldWriteln((++counter) + \": \" + m);\n   }\nAlternatively, you can use oldWriteln.call() too, but it will not work in IE.", "time": "2005-11-08T15:43:18Z", "creation_time": "2005-11-08T15:43:18Z", "raw_text": "The construction:\n  oldWriteln((++counter) + \": \" + m);\nsupplies the global object as |this| value for the method.\nThe original |writeln| method does not accept such |this| value and fails.\nThis behavior is not a bug.\n\nPossible fix for your code, which works in both of Mozilla and IE:\n   var oldWriteln = document.writeln;\n   var counter = 0;\n   document.writeln = function(m) {\n       this.oldWriteln = oldWriteln;\n       this.oldWriteln((++counter) + \": \" + m);\n   }\nAlternatively, you can use oldWriteln.call() too, but it will not work in IE.", "attachment_id": null, "creator": "sync2d@gmail.com", "is_private": false}]}}, "comments": {}}