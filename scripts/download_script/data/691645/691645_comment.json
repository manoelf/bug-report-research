{"bugs": {"691645": {"comments": [{"id": 5756283, "attachment_id": null, "raw_text": "I tried working around bug 641340 by simply sticking \"-moz-transform: translate(0,0)\" in the rule for .marker using DOM Inspector.\n\nIf I do that, we're still slow, but now it's all painting (building display lists and the actual painting we do).  I wonder why we end up invalidating more than just the markers that actually get moved...  I tried turning off hardware acceleration and using the Quartz Debug paint flashing, and the whole maze flashes a good bit.", "author": "bzbarsky@mit.edu", "creation_time": "2011-10-04T02:53:18Z", "tags": [], "time": "2011-10-04T02:53:18Z", "text": "I tried working around bug 641340 by simply sticking \"-moz-transform: translate(0,0)\" in the rule for .marker using DOM Inspector.\n\nIf I do that, we're still slow, but now it's all painting (building display lists and the actual painting we do).  I wonder why we end up invalidating more than just the markers that actually get moved...  I tried turning off hardware acceleration and using the Quartz Debug paint flashing, and the whole maze flashes a good bit.", "creator": "bzbarsky@mit.edu", "is_private": false, "bug_id": 691645, "count": 0}, {"id": 5756338, "raw_text": "It's possible that we're still doing some reflow here (see bug 524925).  Odd that I did not see it in my profile....", "attachment_id": null, "text": "It's possible that we're still doing some reflow here (see bug 524925).  Odd that I did not see it in my profile....", "time": "2011-10-04T03:23:31Z", "tags": [], "bug_id": 691645, "creation_time": "2011-10-04T03:23:31Z", "author": "bzbarsky@mit.edu", "count": 1, "is_private": false, "creator": "bzbarsky@mit.edu"}, {"raw_text": "The MazeContainer is float: left so if we reflow anything inside it we will invalidate the whole maze because of this code http://mxr.mozilla.org/mozilla-central/source/layout/generic/nsBlockFrame.cpp#2505 , no?", "attachment_id": null, "id": 5756366, "count": 2, "creator": "tnikkel@gmail.com", "is_private": false, "time": "2011-10-04T03:44:43Z", "tags": [], "bug_id": 691645, "text": "The MazeContainer is float: left so if we reflow anything inside it we will invalidate the whole maze because of this code http://mxr.mozilla.org/mozilla-central/source/layout/generic/nsBlockFrame.cpp#2505 , no?", "author": "tnikkel@gmail.com", "creation_time": "2011-10-04T03:44:43Z"}, {"raw_text": "Could be, yes.  Hence the dependency.", "attachment_id": null, "id": 5756369, "is_private": false, "creator": "bzbarsky@mit.edu", "text": "Could be, yes.  Hence the dependency.", "tags": [], "time": "2011-10-04T03:46:24Z", "creation_time": "2011-10-04T03:46:24Z", "author": "bzbarsky@mit.edu", "count": 3, "bug_id": 691645}, {"raw_text": "This test is repeatedly being used as a benchmark in editions of Tom's Hardware's  \"Web Browser Grand Prix\" so it's worth having a closer look at. Profile data coming.", "attachment_id": null, "id": 6086281, "count": 4, "creator": "jacob.benoit.1@gmail.com", "is_private": false, "time": "2012-02-23T14:18:05Z", "bug_id": 691645, "tags": [], "text": "This test is repeatedly being used as a benchmark in editions of Tom's Hardware's  \"Web Browser Grand Prix\" so it's worth having a closer look at. Profile data coming.", "author": "jacob.benoit.1@gmail.com", "creation_time": "2012-02-23T14:18:05Z"}, {"author": "jacob.benoit.1@gmail.com", "creation_time": "2012-02-23T14:19:54Z", "tags": [], "time": "2012-02-23T14:19:54Z", "text": "Created attachment 599972\nraw data from 'perf'  (you need perf to use that)\n\nUncompress with xz -d, and run `perf report` in the same directory.\n\nIf you don't have perf / are not on Linux, plain text files are coming.", "creator": "jacob.benoit.1@gmail.com", "is_private": false, "id": 6086285, "attachment_id": 599972, "raw_text": "Uncompress with xz -d, and run `perf report` in the same directory.\n\nIf you don't have perf / are not on Linux, plain text files are coming.", "bug_id": 691645, "count": 5}, {"id": 6086288, "attachment_id": 599973, "raw_text": "Just uncompress with xz -d, this is a plain text file.", "creation_time": "2012-02-23T14:21:13Z", "author": "jacob.benoit.1@gmail.com", "text": "Created attachment 599973\nprofile call graph, as plain text (xz compressed)\n\nJust uncompress with xz -d, this is a plain text file.", "tags": [], "time": "2012-02-23T14:21:13Z", "bug_id": 691645, "is_private": false, "creator": "jacob.benoit.1@gmail.com", "count": 6}, {"id": 6086293, "attachment_id": 599974, "raw_text": "Use that if you can't be bothered to use xz -d ;-)", "author": "jacob.benoit.1@gmail.com", "creation_time": "2012-02-23T14:22:14Z", "tags": [], "time": "2012-02-23T14:22:14Z", "bug_id": 691645, "text": "Created attachment 599974\nflat profile, just plain text (for the lazy!)\n\nUse that if you can't be bothered to use xz -d ;-)", "creator": "jacob.benoit.1@gmail.com", "is_private": false, "count": 7}, {"id": 6232548, "attachment_id": null, "raw_text": "Has anyone had time to look at the profiles?\nWe've been hit again by this bug in this new Browser Grand Prix:\nhttp://www.tomshardware.com/reviews/windows-xp-web-browser-performance,3167-8.html", "author": "jacob.benoit.1@gmail.com", "creation_time": "2012-04-18T05:23:58Z", "tags": [], "time": "2012-04-18T05:23:58Z", "bug_id": 691645, "text": "Has anyone had time to look at the profiles?\nWe've been hit again by this bug in this new Browser Grand Prix:\nhttp://www.tomshardware.com/reviews/windows-xp-web-browser-performance,3167-8.html", "creator": "jacob.benoit.1@gmail.com", "is_private": false, "count": 8}, {"count": 9, "bug_id": 691645, "is_private": false, "creator": "tnikkel@gmail.com", "creation_time": "2012-04-18T05:29:48Z", "author": "tnikkel@gmail.com", "text": "There has been work on this, but it happened off of bug 641341. Specifically bug 730769 and bug 730771. The bugs show that Mats has done some of his own profiling, and bz has profiled this before too.", "tags": [], "time": "2012-04-18T05:29:48Z", "attachment_id": null, "raw_text": "There has been work on this, but it happened off of bug 641341. Specifically bug 730769 and bug 730771. The bugs show that Mats has done some of his own profiling, and bz has profiled this before too.", "id": 6232560}, {"id": 6233746, "attachment_id": null, "raw_text": "What comment 9 said.  But more importantly, we've been hit by this _testcase_.  There are a number of separate performance issues here (see also the bug linked in comment 0), which we're working on fixing one by one.  This bug is about the painting parts specifically.  It's possible that bug 539356 will more or less ameliorate it.", "author": "bzbarsky@mit.edu", "creation_time": "2012-04-18T15:27:29Z", "time": "2012-04-18T15:27:29Z", "bug_id": 691645, "tags": [], "text": "What comment 9 said.  But more importantly, we've been hit by this _testcase_.  There are a number of separate performance issues here (see also the bug linked in comment 0), which we're working on fixing one by one.  This bug is about the painting parts specifically.  It's possible that bug 539356 will more or less ameliorate it.", "creator": "bzbarsky@mit.edu", "is_private": false, "count": 10}, {"attachment_id": null, "raw_text": "Oh, and maybe we do just need a single tracker bug for this testcase....", "id": 6233759, "creator": "bzbarsky@mit.edu", "is_private": false, "count": 11, "author": "bzbarsky@mit.edu", "creation_time": "2012-04-18T15:31:08Z", "tags": [], "time": "2012-04-18T15:31:08Z", "bug_id": 691645, "text": "Oh, and maybe we do just need a single tracker bug for this testcase...."}, {"creator": "roc@ocallahan.org", "is_private": false, "author": "roc@ocallahan.org", "creation_time": "2012-08-07T21:50:54Z", "tags": [], "time": "2012-08-07T21:50:54Z", "text": "The worst of the over-invalidation is because of this code in nsFrame::InvalidateInternalAfterResize:\n    nsRect newDamageRect = nsDisplayTransform::TransformRectOut\n                             (aDamageRect, this, nsPoint(-aX, -aY));\n    if (!(GetStateBits() & NS_FRAME_SVG_LAYOUT)) {\n      newDamageRect.UnionRect(newDamageRect, aDamageRect);\n    }\nBasically, because callers of Invalidate are confused about whether the incoming rect is before applying transforms or after applying transforms, we're super-conservative here and assume it could be either. We can improve this, but DLBI will fix it too, so I think we should just focus on finishing DLBI.", "attachment_id": null, "raw_text": "The worst of the over-invalidation is because of this code in nsFrame::InvalidateInternalAfterResize:\n    nsRect newDamageRect = nsDisplayTransform::TransformRectOut\n                             (aDamageRect, this, nsPoint(-aX, -aY));\n    if (!(GetStateBits() & NS_FRAME_SVG_LAYOUT)) {\n      newDamageRect.UnionRect(newDamageRect, aDamageRect);\n    }\nBasically, because callers of Invalidate are confused about whether the incoming rect is before applying transforms or after applying transforms, we're super-conservative here and assume it could be either. We can improve this, but DLBI will fix it too, so I think we should just focus on finishing DLBI.", "id": 6538392, "count": 12, "bug_id": 691645}, {"id": 6552073, "attachment_id": null, "raw_text": "DLBI, as landed today (cset 75cdb3f932c6), only marginally fixes this.\n\nOn my WinXP system, Firefox takes 49 seconds, whereas Chrome takes 6.1 seconds.", "author": "fehe@hotmail.com", "creation_time": "2012-08-14T00:24:43Z", "bug_id": 691645, "tags": [], "time": "2012-08-14T00:24:43Z", "text": "DLBI, as landed today (cset 75cdb3f932c6), only marginally fixes this.\n\nOn my WinXP system, Firefox takes 49 seconds, whereas Chrome takes 6.1 seconds.", "creator": "fehe@hotmail.com", "is_private": false, "count": 13}, {"id": 6552608, "raw_text": "DBLI has definitely not landed today. Only some parts landed, and not the parts that help with this bug.", "attachment_id": null, "text": "DBLI has definitely not landed today. Only some parts landed, and not the parts that help with this bug.", "tags": [], "bug_id": 691645, "time": "2012-08-14T06:12:12Z", "creation_time": "2012-08-14T06:12:12Z", "author": "roc@ocallahan.org", "count": 14, "is_private": false, "creator": "roc@ocallahan.org"}, {"creator": "brunis@gmail.com", "is_private": false, "count": 15, "author": "brunis@gmail.com", "creation_time": "2012-08-15T10:52:38Z", "time": "2012-08-15T10:52:38Z", "bug_id": 691645, "tags": [], "text": "I'm now seeing 7,4 seconds on Nightly, excellent progress!", "attachment_id": null, "raw_text": "I'm now seeing 7,4 seconds on Nightly, excellent progress!", "id": 6556206}, {"bug_id": 691645, "count": 16, "author": "mayankleoboy1@gmail.com", "creation_time": "2012-08-19T14:10:25Z", "tags": [], "time": "2012-08-19T14:10:25Z", "text": "i am seeing much better performance now on a 40x40 maze. Excellent work!", "creator": "mayankleoboy1@gmail.com", "is_private": false, "id": 6565731, "attachment_id": null, "raw_text": "i am seeing much better performance now on a 40x40 maze. Excellent work!"}, {"count": 17, "bug_id": 691645, "attachment_id": null, "raw_text": "I'm seeing a consistent 6 second run on 40x40 even with paintflashing on. DLBI is still over-invalidating in the 40x40 maze, but i'll report that in dlbi.", "id": 6710900, "creator": "brunis@gmail.com", "is_private": false, "author": "brunis@gmail.com", "creation_time": "2012-10-09T13:38:12Z", "tags": [], "time": "2012-10-09T13:38:12Z", "text": "I'm seeing a consistent 6 second run on 40x40 even with paintflashing on. DLBI is still over-invalidating in the 40x40 maze, but i'll report that in dlbi."}, {"count": 18, "is_private": false, "creator": "pascalc@gmail.com", "text": "I am noticing something interesting with this perf testcase and its interaction with Flash and Facebook, it may be another bug affecting the overall performance of this specific test though, just tell me if I need to open a separate bug.\n\nHere is what I am seeing: \n- if I only have the IE Maze page open in Nightly on Linux, I get results around 12 seconds for the 30x30 maze\n- if I also have a facebook tab open + flash activated, the same 30x30 maze is 112 second\n- if I disable Flash in about:plugins, I get results around 12s with or without a Facebook tab open\n- If I activate Flash, have a flash video on youtube in a tab running, no facebook page open and run the IE maze, I get about 14s\n\nThat makes:\n\nIt seems that Facebook is using Flash in ways that impact painting a lot in the IE maze tab.", "tags": [], "time": "2012-10-19T14:53:26Z", "bug_id": 691645, "creation_time": "2012-10-19T14:53:26Z", "author": "pascalc@gmail.com", "raw_text": "I am noticing something interesting with this perf testcase and its interaction with Flash and Facebook, it may be another bug affecting the overall performance of this specific test though, just tell me if I need to open a separate bug.\n\nHere is what I am seeing: \n- if I only have the IE Maze page open in Nightly on Linux, I get results around 12 seconds for the 30x30 maze\n- if I also have a facebook tab open + flash activated, the same 30x30 maze is 112 second\n- if I disable Flash in about:plugins, I get results around 12s with or without a Facebook tab open\n- If I activate Flash, have a flash video on youtube in a tab running, no facebook page open and run the IE maze, I get about 14s\n\nThat makes:\n\nIt seems that Facebook is using Flash in ways that impact painting a lot in the IE maze tab.", "attachment_id": null, "id": 6745941}, {"is_private": false, "creator": "tnikkel@gmail.com", "count": 19, "creation_time": "2012-10-19T16:54:18Z", "author": "tnikkel@gmail.com", "text": "Are you testing with a nightly that has bug 642257 (so 2012-10-19 or newer)?", "time": "2012-10-19T16:54:18Z", "tags": [], "bug_id": 691645, "attachment_id": null, "raw_text": "Are you testing with a nightly that has bug 642257 (so 2012-10-19 or newer)?", "id": 6746344}, {"id": 6746487, "attachment_id": null, "raw_text": "I was testing with yesterday's nightly, I am going to test today's and report back.", "creation_time": "2012-10-19T17:20:31Z", "author": "pascalc@gmail.com", "text": "I was testing with yesterday's nightly, I am going to test today's and report back.", "tags": [], "bug_id": 691645, "time": "2012-10-19T17:20:31Z", "is_private": false, "creator": "pascalc@gmail.com", "count": 20}, {"bug_id": 691645, "tags": [], "time": "2012-10-19T17:30:20Z", "text": "(In reply to Timothy Nikkel (:tn) from comment #19)\n> Are you testing with a nightly that has bug 642257 (so 2012-10-19 or newer)?\n\nThis is fixed with today's nightly, so that was the bug I was seeing :)", "author": "pascalc@gmail.com", "creation_time": "2012-10-19T17:30:20Z", "count": 21, "creator": "pascalc@gmail.com", "is_private": false, "id": 6746533, "raw_text": "(In reply to Timothy Nikkel (:tn) from comment #19)\n> Are you testing with a nightly that has bug 642257 (so 2012-10-19 or newer)?\n\nThis is fixed with today's nightly, so that was the bug I was seeing :)", "attachment_id": null}, {"count": 22, "bug_id": 691645, "attachment_id": null, "raw_text": "Maze 30x30 - 6 seconds with more tabs activated (including Facebook)\nMaze 40x40 - 10 seconds\n\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/19.0 Firefox/19.0 ID:20121019030551\n\nabout:me 0.5\nAdblock Plus 2.1.2\nAdd-on Compatibility Reporter 1.1\nAdobe Acrobat - Create PDF 1.2\nAdobe Acrobat 10.1.4.38\nAdobe Acrobat 11.0.0.379\nANIMATED - Snowflake Village 1320945460 [DISABLED]\nBritish English Dictionary 1.19.1\nBugzilla Tweaks 1.12.1\nCheevos 1.4\nCollusion 0.16.3 [DISABLED]\nDic\u021bionar rom\u00e2nesc de corectare ortografic\u0103. 1.12\nDownload Statusbar 0.9.10\nfireblur 1260925626 [DISABLED]\nGoogle Earth Plugin 6.2.0.5788\nGoogle Shortcuts 2.1.7.1\nGoogle Update 1.3.21.123\nHP Smart Web Printing 4.5 [DISABLED]\nImplicit 19.0a1\nJava Deployment Toolkit 7.0.70.11 10.7.2.11\nJava(TM) Platform SE 7 U7 10.7.2.11\nMicrosoft Office 2010 14.0.4730.1010\nMicrosoft Office 2010 14.0.4761.1000\nMozilla QA Companion 1.2.3\nMozilla Reps Companion 1.1\nMozMill 1.5.19\nMozmill Crowd 0.1.5\nNightly Tester Tools 3.3\nNoScript 2.5.8\nNVIDIA 3D Vision 7.17.13.697\nNVIDIA 3D VISION 7.17.13.697\nPuppy Dogs... 1291695684 [DISABLED]\nSage 1.4.12\nShockwave Flash 11.4.402.287\nSilverlight Plug-In 5.1.10411.0\nSubmit Word 1.1.0\nTest Pilot 1.2.2\nVLC Web Plugin 2.0.2.0\nYahoo Application State Plugin 1.0.0.7", "id": 6746606, "creator": "raul.malea@gmail.com", "is_private": false, "author": "raul.malea@gmail.com", "creation_time": "2012-10-19T17:46:14Z", "time": "2012-10-19T17:46:14Z", "tags": [], "text": "Maze 30x30 - 6 seconds with more tabs activated (including Facebook)\nMaze 40x40 - 10 seconds\n\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/19.0 Firefox/19.0 ID:20121019030551\n\nabout:me 0.5\nAdblock Plus 2.1.2\nAdd-on Compatibility Reporter 1.1\nAdobe Acrobat - Create PDF 1.2\nAdobe Acrobat 10.1.4.38\nAdobe Acrobat 11.0.0.379\nANIMATED - Snowflake Village 1320945460 [DISABLED]\nBritish English Dictionary 1.19.1\nBugzilla Tweaks 1.12.1\nCheevos 1.4\nCollusion 0.16.3 [DISABLED]\nDic\u021bionar rom\u00e2nesc de corectare ortografic\u0103. 1.12\nDownload Statusbar 0.9.10\nfireblur 1260925626 [DISABLED]\nGoogle Earth Plugin 6.2.0.5788\nGoogle Shortcuts 2.1.7.1\nGoogle Update 1.3.21.123\nHP Smart Web Printing 4.5 [DISABLED]\nImplicit 19.0a1\nJava Deployment Toolkit 7.0.70.11 10.7.2.11\nJava(TM) Platform SE 7 U7 10.7.2.11\nMicrosoft Office 2010 14.0.4730.1010\nMicrosoft Office 2010 14.0.4761.1000\nMozilla QA Companion 1.2.3\nMozilla Reps Companion 1.1\nMozMill 1.5.19\nMozmill Crowd 0.1.5\nNightly Tester Tools 3.3\nNoScript 2.5.8\nNVIDIA 3D Vision 7.17.13.697\nNVIDIA 3D VISION 7.17.13.697\nPuppy Dogs... 1291695684 [DISABLED]\nSage 1.4.12\nShockwave Flash 11.4.402.287\nSilverlight Plug-In 5.1.10411.0\nSubmit Word 1.1.0\nTest Pilot 1.2.2\nVLC Web Plugin 2.0.2.0\nYahoo Application State Plugin 1.0.0.7"}, {"raw_text": "This CSS3 layout benchmark is slower when Stylo is enabled. Results for solving the large 40x40 maze on my Windows 10 laptop:\n\nFirefox 54 = 20 seconds\nFirefox Nightly 56 without Stylo = 17 seconds\nFirefox Nightly 56 with Stylo pref enabled = 21 seconds\nEdge = 31 seconds\nChrome Beta 60 = 6.4 seconds!", "attachment_id": null, "id": 12468099, "creator": "cpeterson@mozilla.com", "is_private": false, "time": "2017-07-12T19:14:01Z", "tags": [], "text": "This CSS3 layout benchmark is slower when Stylo is enabled. Results for solving the large 40x40 maze on my Windows 10 laptop:\n\nFirefox 54 = 20 seconds\nFirefox Nightly 56 without Stylo = 17 seconds\nFirefox Nightly 56 with Stylo pref enabled = 21 seconds\nEdge = 31 seconds\nChrome Beta 60 = 6.4 seconds!", "author": "cpeterson@mozilla.com", "creation_time": "2017-07-12T19:14:01Z", "count": 23, "bug_id": 691645}, {"id": 12468121, "attachment_id": null, "raw_text": "We're still not ready for people to run performance benchmarks on stylo. We need Manish to land his stuff and do a few other things before any performance comparisons will be meaningful.", "author": "bholley@mozilla.com", "creation_time": "2017-07-12T19:19:50Z", "time": "2017-07-12T19:19:50Z", "tags": [], "bug_id": 691645, "text": "We're still not ready for people to run performance benchmarks on stylo. We need Manish to land his stuff and do a few other things before any performance comparisons will be meaningful.", "creator": "bholley@mozilla.com", "is_private": false, "count": 24}, {"attachment_id": null, "raw_text": "Please do not hijack bugs.  This bug was about a specific issue which had nothing to do with stylo.  Please file a separate bug for whatever stylo issue you see.", "id": 12468147, "creator": "bzbarsky@mit.edu", "is_private": false, "author": "bzbarsky@mit.edu", "creation_time": "2017-07-12T19:25:57Z", "tags": [], "time": "2017-07-12T19:25:57Z", "text": "Please do not hijack bugs.  This bug was about a specific issue which had nothing to do with stylo.  Please file a separate bug for whatever stylo issue you see.", "count": 25, "bug_id": 691645}]}}, "comments": {}}