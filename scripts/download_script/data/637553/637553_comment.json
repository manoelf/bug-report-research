{"comments": {}, "bugs": {"637553": {"comments": [{"bug_id": 637553, "text": "I've been looking at object allocation for my add-on with a custom build that prints out when/where js_NewGCObject is called (thanks philikon, gal! bug 636304 comment 3)\nhttp://hg.mozilla.org/try/rev/7a2ee58f7c13\n\nI noticed that there's a new object being created at the entry to certain functions unrelated to what's actually on the first line of the function.\n\nTurns out an object is being created for upvars that are assigned from an inner function:\n\nfunction outer() {\n  return;\n  let val;\n  let noHoist = function() {\n    val = 0;\n  };\n}\n\nI'm still not sure what the js_NewGCObject is being called for exactly, but it only appears if I declare a local variable (including function parameter names) and have a line in an inner function that assigns to it. This happens even if the inner function has no way of being called. (My example code here always returns, but my actual code conditionally returns.)", "tags": [], "creation_time": "2011-03-01T02:50:49Z", "attachment_id": null, "raw_text": "I've been looking at object allocation for my add-on with a custom build that prints out when/where js_NewGCObject is called (thanks philikon, gal! bug 636304 comment 3)\nhttp://hg.mozilla.org/try/rev/7a2ee58f7c13\n\nI noticed that there's a new object being created at the entry to certain functions unrelated to what's actually on the first line of the function.\n\nTurns out an object is being created for upvars that are assigned from an inner function:\n\nfunction outer() {\n  return;\n  let val;\n  let noHoist = function() {\n    val = 0;\n  };\n}\n\nI'm still not sure what the js_NewGCObject is being called for exactly, but it only appears if I declare a local variable (including function parameter names) and have a line in an inner function that assigns to it. This happens even if the inner function has no way of being called. (My example code here always returns, but my actual code conditionally returns.)", "creator": "edilee@mozilla.com", "id": 5310573, "is_private": false, "time": "2011-03-01T02:50:49Z", "author": "edilee@mozilla.com", "count": 0}, {"count": 1, "time": "2011-03-01T02:55:42Z", "text": "> I'm still not sure what the js_NewGCObject is being called for exactly\n\nThe Call object, presumably.", "creator": "bzbarsky@mit.edu", "raw_text": "> I'm still not sure what the js_NewGCObject is being called for exactly\n\nThe Call object, presumably.", "id": 5310584, "is_private": false, "author": "bzbarsky@mit.edu", "bug_id": 637553, "attachment_id": null, "creation_time": "2011-03-01T02:55:42Z", "tags": []}]}}}