{"bugs": {"651483": {"comments": [{"count": 0, "raw_text": "While investigating on http://forums.informaction.com/viewtopic.php?p=27144 I've found that attaching any DOMContentLoaded event listener (even an empty function) to the chrome window significantly alters the reload behavior of (some?) framesets.\n\nSteps to reproduce on a clean profile (either Nightly or any maintained branch):\n\n1) Open a new tab and load http://nagios.mozilla.org\n2) Click the \"Tactical overview\" link on the side menu, and wait for the \"Tactical overview\" page to be loaded.\n3) Hit the Reload button and observe that the main page still contains the \"Tactical overview\" page after the reload.\n4) Now \"Open Tools>Error Console\" (after enabling console support if required by the tested Firefox version) and evaluate the following script:\n\ntop.opener.addEventListener(\"DOMContentLoaded\", function(){}, false)\n\n5) Close the previously opened tab, open a new one and repeat steps 1-3\n\nActual result: the second reload, after the DOMContentLoaded listener had been attached, yields a different result: after reloading, the main frame doesn't contain the \"Tactical overview\" page anymore, but  frameset is reset to its initial state instead, i.e. the URLs initially specified in the <frame> elements are restored, rather than keeping the navigated ones.\n\nExpected result: attaching an empty DOMContentLoaded listener to the chrome window should cause no observable difference in reloading behavior.\n\nIt should be also noticed that, while trying to produce a contrived test case, I've found http://evil.hackademix.net/test/frames_dlc/ (a bare-bones frameset) similar to Nagios') exhibits the second behavior (reloading resets the initial frameset layout) no matter whether a listener is attached or not, so I'm not sure about which behavior should be considered normal: however, it shouldn't be changed by empty chrome listeners...", "bug_id": 651483, "is_private": false, "tags": [], "time": "2011-04-20T13:36:46Z", "creation_time": "2011-04-20T13:36:46Z", "author": "g.maone@informaction.com", "id": 5421107, "attachment_id": null, "creator": "g.maone@informaction.com", "text": "While investigating on http://forums.informaction.com/viewtopic.php?p=27144 I've found that attaching any DOMContentLoaded event listener (even an empty function) to the chrome window significantly alters the reload behavior of (some?) framesets.\n\nSteps to reproduce on a clean profile (either Nightly or any maintained branch):\n\n1) Open a new tab and load http://nagios.mozilla.org\n2) Click the \"Tactical overview\" link on the side menu, and wait for the \"Tactical overview\" page to be loaded.\n3) Hit the Reload button and observe that the main page still contains the \"Tactical overview\" page after the reload.\n4) Now \"Open Tools>Error Console\" (after enabling console support if required by the tested Firefox version) and evaluate the following script:\n\ntop.opener.addEventListener(\"DOMContentLoaded\", function(){}, false)\n\n5) Close the previously opened tab, open a new one and repeat steps 1-3\n\nActual result: the second reload, after the DOMContentLoaded listener had been attached, yields a different result: after reloading, the main frame doesn't contain the \"Tactical overview\" page anymore, but  frameset is reset to its initial state instead, i.e. the URLs initially specified in the <frame> elements are restored, rather than keeping the navigated ones.\n\nExpected result: attaching an empty DOMContentLoaded listener to the chrome window should cause no observable difference in reloading behavior.\n\nIt should be also noticed that, while trying to produce a contrived test case, I've found http://evil.hackademix.net/test/frames_dlc/ (a bare-bones frameset) similar to Nagios') exhibits the second behavior (reloading resets the initial frameset layout) no matter whether a listener is attached or not, so I'm not sure about which behavior should be considered normal: however, it shouldn't be changed by empty chrome listeners..."}, {"bug_id": 651483, "count": 1, "time": "2011-04-21T01:35:13Z", "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu", "raw_text": "> 3) Hit the Reload button and observe that the main page still contains the\n> \"Tactical overview\" page after the reload.\n\nI can't reproduce this using a clean profile with a 2011-04-20 m-c nightly.  When I click the reload button, we reload showing the original nagios landing page.  At least on Mac.\n\nNote that this could well be a timing issue; I'm a little surprised I'm getting the landing page and not the tactical overview page, given what that code looks like.", "is_private": false, "tags": [], "creation_time": "2011-04-21T01:35:13Z", "attachment_id": null, "id": 5423136, "text": "> 3) Hit the Reload button and observe that the main page still contains the\n> \"Tactical overview\" page after the reload.\n\nI can't reproduce this using a clean profile with a 2011-04-20 m-c nightly.  When I click the reload button, we reload showing the original nagios landing page.  At least on Mac.\n\nNote that this could well be a timing issue; I'm a little surprised I'm getting the landing page and not the tactical overview page, given what that code looks like."}]}}, "comments": {}}