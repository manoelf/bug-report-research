{"bugs": {"625117": {"comments": [{"is_private": false, "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\n\nThere is no way to include a default domain in network.negotiate-auth.trusted-uris setting. I can include a specific domain like .mydomain.com and negotiate authentication works if I access site like http://site.mydomain.com but it does not work when I access site using just the host name http://site. The mydomain.com is the default domain and the http://site should still work. \n\nIE does not have this 'bug'. Negotiate authentication works in IE for both FQDN and hosts only after adding *.mydomain.com to Local Sites in Internet Settings. I imagine Firefox should work similarly. The local host must be translated to FQDN and then checked against network.negotiate-auth.trusted-uris setting. The negotiate authentication is mostly useful for intranet, and most companies use just host names in intranet urls.\n\nI also noticed that Firefox respects the Internet Settings. If I do not add site to Local Sites in Internet Settings but add it to network.negotiate-auth.trusted-uris the Firefox would not be able to authenticate using negotiate authentication. Instead it sends NTLM key in response to `WWW-Authenticate: Negotiate`. I don't have a problem with this behavior, I just wanted to point it out.\n\nHere is the header capture. The \"Authorization: Negotiate TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAFASgKAAAADw==\" is an NTLM key masked as Negotiate. The true Negotiate key is much longer.\n\nhttp://dev02-congo.ceresource.com/supervisor/\n\nGET /supervisor/ HTTP/1.1\nHost: dev02-congo.ceresource.com\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 115\nConnection: keep-alive\n\nHTTP/1.1 401 Authorization Required\nDate: Tue, 11 Jan 2011 18:03:42 GMT\nServer: Apache/2.2.17\nWWW-Authenticate: Negotiate\nVary: accept-language,accept-charset\nAccept-Ranges: bytes\nKeep-Alive: timeout=15, max=100\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=iso-8859-1\nContent-Language: en\n----------------------------------------------------------\nhttp://dev02-congo.ceresource.com/supervisor/\n\nGET /supervisor/ HTTP/1.1\nHost: dev02-congo.ceresource.com\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 115\nConnection: keep-alive\nAuthorization: Negotiate TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAFASgKAAAADw==\n\nHTTP/1.1 401 Authorization Required\nDate: Tue, 11 Jan 2011 18:03:42 GMT\nServer: Apache/2.2.17\nVary: accept-language,accept-charset\nAccept-Ranges: bytes\nKeep-Alive: timeout=15, max=99\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=iso-8859-1\nContent-Language: en\n----------------------------------------------------------\n\n\nReproducible: Always", "count": 0, "id": 5194121, "creation_time": "2011-01-12T18:53:41Z", "tags": [], "bug_id": 625117, "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\n\nThere is no way to include a default domain in network.negotiate-auth.trusted-uris setting. I can include a specific domain like .mydomain.com and negotiate authentication works if I access site like http://site.mydomain.com but it does not work when I access site using just the host name http://site. The mydomain.com is the default domain and the http://site should still work. \n\nIE does not have this 'bug'. Negotiate authentication works in IE for both FQDN and hosts only after adding *.mydomain.com to Local Sites in Internet Settings. I imagine Firefox should work similarly. The local host must be translated to FQDN and then checked against network.negotiate-auth.trusted-uris setting. The negotiate authentication is mostly useful for intranet, and most companies use just host names in intranet urls.\n\nI also noticed that Firefox respects the Internet Settings. If I do not add site to Local Sites in Internet Settings but add it to network.negotiate-auth.trusted-uris the Firefox would not be able to authenticate using negotiate authentication. Instead it sends NTLM key in response to `WWW-Authenticate: Negotiate`. I don't have a problem with this behavior, I just wanted to point it out.\n\nHere is the header capture. The \"Authorization: Negotiate TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAFASgKAAAADw==\" is an NTLM key masked as Negotiate. The true Negotiate key is much longer.\n\nhttp://dev02-congo.ceresource.com/supervisor/\n\nGET /supervisor/ HTTP/1.1\nHost: dev02-congo.ceresource.com\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 115\nConnection: keep-alive\n\nHTTP/1.1 401 Authorization Required\nDate: Tue, 11 Jan 2011 18:03:42 GMT\nServer: Apache/2.2.17\nWWW-Authenticate: Negotiate\nVary: accept-language,accept-charset\nAccept-Ranges: bytes\nKeep-Alive: timeout=15, max=100\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=iso-8859-1\nContent-Language: en\n----------------------------------------------------------\nhttp://dev02-congo.ceresource.com/supervisor/\n\nGET /supervisor/ HTTP/1.1\nHost: dev02-congo.ceresource.com\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 ( .NET CLR 3.5.30729; .NET4.0E)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 115\nConnection: keep-alive\nAuthorization: Negotiate TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAFASgKAAAADw==\n\nHTTP/1.1 401 Authorization Required\nDate: Tue, 11 Jan 2011 18:03:42 GMT\nServer: Apache/2.2.17\nVary: accept-language,accept-charset\nAccept-Ranges: bytes\nKeep-Alive: timeout=15, max=99\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=iso-8859-1\nContent-Language: en\n----------------------------------------------------------\n\n\nReproducible: Always", "time": "2011-01-12T18:53:41Z", "author": "mike.starov@gmail.com", "creator": "mike.starov@gmail.com", "attachment_id": null}, {"creation_time": "2011-01-13T21:05:56Z", "tags": [], "is_private": false, "text": "Can someone on the security team please review this bug?  It's a bit over my head in expertise.  Thanks.", "count": 1, "id": 5197598, "time": "2011-01-13T21:05:56Z", "creator": "u279076@disabled.tld", "author": "u279076@disabled.tld", "attachment_id": null, "bug_id": 625117, "raw_text": "Can someone on the security team please review this bug?  It's a bit over my head in expertise.  Thanks."}, {"bug_id": 625117, "raw_text": "This is absolutely a valid issue that has plagued Firefox for a long time. In contrast, both IE and Chrome will use NTLM auth to plainhostnames (e.g. dotless) by default.\n\nAdding support for a \"<local>\" token to network.automatic-ntlm-auth.trusted-uris should be just a few lines of code and massively improve the deployability of Firefox in corporate environments.\n\njohnath passed my request for this to jduell back in September of 2010, but I don't think I ever heard back.", "time": "2011-06-29T21:32:55Z", "creator": "ericlaw1979@hotmail.com", "author": "ericlaw1979@hotmail.com", "attachment_id": null, "text": "This is absolutely a valid issue that has plagued Firefox for a long time. In contrast, both IE and Chrome will use NTLM auth to plainhostnames (e.g. dotless) by default.\n\nAdding support for a \"<local>\" token to network.automatic-ntlm-auth.trusted-uris should be just a few lines of code and massively improve the deployability of Firefox in corporate environments.\n\njohnath passed my request for this to jduell back in September of 2010, but I don't think I ever heard back.", "is_private": false, "count": 2, "id": 5565608, "creation_time": "2011-06-29T21:32:55Z", "tags": []}]}}, "comments": {}}