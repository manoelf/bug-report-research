{"comments": {}, "bugs": {"701288": {"comments": [{"author": "jd.bugzilla@gmail.com", "count": 0, "text": "This is a follow-up from bug 701262.  The code in nsFontDownloader keeps track of the initial channel used to start a request.  However, the stream loader will switch to another channel if a redirect occurs.  Since the timer code that handles whether to redraw with fallback fonts or not is using the initial channel, it won't give proper behavior when redirects occur.\n\nCode changes needed:\n\n- the stream loader code only updates the channel when requests have stopped, it really should be updating that channel when a channel change occurs\n\n- the timer code in nsFontDownloader should be using the stream loader to fetch the current channel when checking the progress of a font download", "creator": "jd.bugzilla@gmail.com", "is_private": false, "creation_time": "2011-11-10T05:58:32Z", "id": 5839336, "bug_id": 701288, "attachment_id": null, "raw_text": "This is a follow-up from bug 701262.  The code in nsFontDownloader keeps track of the initial channel used to start a request.  However, the stream loader will switch to another channel if a redirect occurs.  Since the timer code that handles whether to redraw with fallback fonts or not is using the initial channel, it won't give proper behavior when redirects occur.\n\nCode changes needed:\n\n- the stream loader code only updates the channel when requests have stopped, it really should be updating that channel when a channel change occurs\n\n- the timer code in nsFontDownloader should be using the stream loader to fetch the current channel when checking the progress of a font download", "time": "2011-11-10T05:58:32Z", "tags": []}, {"creator": "bzbarsky@mit.edu", "creation_time": "2011-11-10T06:22:58Z", "is_private": false, "attachment_id": null, "tags": [], "author": "bzbarsky@mit.edu", "count": 1, "text": "The other issue is that right now nsFontFaceLoader::Cancel is broken if mChannel gets redirected.\n\nWe could make the stream loader a redirect observer, I guess.  We could also make the nsFontFaceLoader a redirect observer on the channel...", "bug_id": 701288, "id": 5839355, "time": "2011-11-10T06:22:58Z", "raw_text": "The other issue is that right now nsFontFaceLoader::Cancel is broken if mChannel gets redirected.\n\nWe could make the stream loader a redirect observer, I guess.  We could also make the nsFontFaceLoader a redirect observer on the channel..."}, {"creator": "jd.bugzilla@gmail.com", "creation_time": "2011-11-10T06:55:04Z", "is_private": false, "attachment_id": null, "tags": [], "text": "But if the stream loader updates the current channel, then the cancel code just needs to access the channel via the stream loader, no?", "count": 2, "author": "jd.bugzilla@gmail.com", "id": 5839374, "bug_id": 701288, "time": "2011-11-10T06:55:04Z", "raw_text": "But if the stream loader updates the current channel, then the cancel code just needs to access the channel via the stream loader, no?"}, {"bug_id": 701288, "id": 5839381, "count": 3, "text": "Yes, once this bug is fixed Cancel will work.  Just pointing out that it's not just the timer thing that's broken right now.", "author": "bzbarsky@mit.edu", "raw_text": "Yes, once this bug is fixed Cancel will work.  Just pointing out that it's not just the timer thing that's broken right now.", "time": "2011-11-10T07:08:26Z", "is_private": false, "creation_time": "2011-11-10T07:08:26Z", "creator": "bzbarsky@mit.edu", "tags": [], "attachment_id": null}, {"creation_time": "2011-11-12T23:33:57Z", "is_private": false, "id": 5844976, "bug_id": 701288, "author": "brian@briansmith.org", "text": "Please make sure that redirects for fonts from https:// -> http:// have the same behavior regarding security indicators/mixed content as a direct http:// load would have. In particular, the font should not load in such a situation if the document is HTTPS, just like it shouldn't load if the original font URL was http://. (Do we have a test for that.)", "count": 4, "creator": "brian@briansmith.org", "tags": [], "attachment_id": null, "raw_text": "Please make sure that redirects for fonts from https:// -> http:// have the same behavior regarding security indicators/mixed content as a direct http:// load would have. In particular, the font should not load in such a situation if the document is HTTPS, just like it shouldn't load if the original font URL was http://. (Do we have a test for that.)", "time": "2011-11-12T23:33:57Z"}, {"tags": [], "attachment_id": null, "raw_text": "Brian, I will confirm that it does but if it does not the bug would be in nsCORSListenerProxy code.  The font loading code doesn't explicitly check for same origin.  See the code in layout/style/nsFontFaceLoader.cpp.", "time": "2011-11-13T04:16:49Z", "is_private": false, "creation_time": "2011-11-13T04:16:49Z", "bug_id": 701288, "id": 5845106, "author": "jd.bugzilla@gmail.com", "count": 5, "text": "Brian, I will confirm that it does but if it does not the bug would be in nsCORSListenerProxy code.  The font loading code doesn't explicitly check for same origin.  See the code in layout/style/nsFontFaceLoader.cpp.", "creator": "jd.bugzilla@gmail.com"}, {"author": "sledru@mozilla.com", "text": "Moving to p3 because no activity for at least 1 year(s).\nSee https://github.com/mozilla/bug-handling/blob/master/policy/triage-bugzilla.md#how-do-you-triage for more information", "count": 6, "creator": "sledru@mozilla.com", "is_private": false, "creation_time": "2018-11-05T12:52:21Z", "bug_id": 701288, "id": 13735539, "attachment_id": null, "raw_text": "Moving to p3 because no activity for at least 1 year(s).\nSee https://github.com/mozilla/bug-handling/blob/master/policy/triage-bugzilla.md#how-do-you-triage for more information", "time": "2018-11-05T12:52:21Z", "tags": []}]}}}