{"comments": {}, "bugs": {"661043": {"comments": [{"creator": "hikezoe.birchill@mozilla.com", "author": "hikezoe.birchill@mozilla.com", "bug_id": 661043, "tags": [], "is_private": false, "count": 0, "id": 5504860, "text": "For example, many tests have codes like this:\n\nwindow.addEventListener(\"needThisEvent\", function(event) {\n  window.removeEventListener(\"needThisEvent\", arguments.callee, false);\n  ...\n}, false);\n\nBut this listener is not removed when the test is timed out.\n\nSo we currently have to do something like this:\n\nvar listener = function(event) {\n ..\n}\nregisterCleanupFunction(function() {\n  window.removeEventListener(\"needThisEvent\", listener, false);\n});\nwindow.addEventListener(\"needThisEvent\", listener, false);\n\nBut this code is a little bit inconvenient to write, many test codes does actually not use registerCleanupFunction for removal of event listener.\n\nSo I'd propose more convenient way and testing frame work does remove event listener even if the test is timed out.", "time": "2011-05-31T23:32:50Z", "attachment_id": null, "creation_time": "2011-05-31T23:32:50Z", "raw_text": "For example, many tests have codes like this:\n\nwindow.addEventListener(\"needThisEvent\", function(event) {\n  window.removeEventListener(\"needThisEvent\", arguments.callee, false);\n  ...\n}, false);\n\nBut this listener is not removed when the test is timed out.\n\nSo we currently have to do something like this:\n\nvar listener = function(event) {\n ..\n}\nregisterCleanupFunction(function() {\n  window.removeEventListener(\"needThisEvent\", listener, false);\n});\nwindow.addEventListener(\"needThisEvent\", listener, false);\n\nBut this code is a little bit inconvenient to write, many test codes does actually not use registerCleanupFunction for removal of event listener.\n\nSo I'd propose more convenient way and testing frame work does remove event listener even if the test is timed out."}, {"creation_time": "2011-05-31T23:34:11Z", "raw_text": "Add registerEventListener and unregisterEventListener.", "attachment_id": 536470, "time": "2011-05-31T23:34:11Z", "text": "Created attachment 536470\nProposed patch\n\nAdd registerEventListener and unregisterEventListener.", "id": 5504863, "count": 1, "is_private": false, "tags": [], "bug_id": 661043, "author": "hikezoe.birchill@mozilla.com", "creator": "hikezoe.birchill@mozilla.com"}, {"id": 5505217, "tags": [], "is_private": false, "count": 2, "bug_id": 661043, "creation_time": "2011-06-01T02:55:25Z", "raw_text": "Bug 454717 is related.\n\nIIRC removeEventListener can't throw, so I don't think you need the try/catch.\n\nA unregisterListener(listeningObject) method would allow sharing some code.", "time": "2011-06-01T02:55:25Z", "attachment_id": null, "text": "Bug 454717 is related.\n\nIIRC removeEventListener can't throw, so I don't think you need the try/catch.\n\nA unregisterListener(listeningObject) method would allow sharing some code.", "author": "gavin.sharp@gmail.com", "creator": "gavin.sharp@gmail.com"}]}}}