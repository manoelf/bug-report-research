{"comments": {}, "bugs": {"707196": {"comments": [{"raw_text": "Bug 699820 is hurting us in terms of snappiness. Mishaps like bug 707090 and numerous add-ons demonstrate that purely the availability of blocking I/O calls will mean that people will inadvertently implement blocking I/O on the main thread.\n\nI propose that we deprecate and very quickly also *remove* ways to do blocking I/O on the main thread in JavaScript. I suggest starting with obvious culprits like Cc[\"@mozilla.org/network/file-input-stream;1\"].createInstance(Ci.nsIFileInputStream), and from there we can move on to the storage APIs and so on. Can we, perhaps, remove the [scriptable] flag from the relevant interface?", "creation_time": "2011-12-02T17:03:25Z", "text": "Bug 699820 is hurting us in terms of snappiness. Mishaps like bug 707090 and numerous add-ons demonstrate that purely the availability of blocking I/O calls will mean that people will inadvertently implement blocking I/O on the main thread.\n\nI propose that we deprecate and very quickly also *remove* ways to do blocking I/O on the main thread in JavaScript. I suggest starting with obvious culprits like Cc[\"@mozilla.org/network/file-input-stream;1\"].createInstance(Ci.nsIFileInputStream), and from there we can move on to the storage APIs and so on. Can we, perhaps, remove the [scriptable] flag from the relevant interface?", "time": "2011-12-02T17:03:25Z", "attachment_id": null, "tags": [], "count": 0, "is_private": false, "id": 5888460, "bug_id": 707196, "creator": "philipp@weitershausen.de", "author": "philipp@weitershausen.de"}, {"creation_time": "2011-12-02T17:10:25Z", "raw_text": "Well, the problem is not creating nsIFileInputStreams, it's reading from them synchronously ... killing nsIFileInputStream's scriptability would be a really big hammer.", "attachment_id": null, "time": "2011-12-02T17:10:25Z", "text": "Well, the problem is not creating nsIFileInputStreams, it's reading from them synchronously ... killing nsIFileInputStream's scriptability would be a really big hammer.", "id": 5888478, "count": 1, "is_private": false, "tags": [], "bug_id": 707196, "author": "khuey@kylehuey.com", "creator": "khuey@kylehuey.com"}, {"time": "2011-12-02T22:38:24Z", "attachment_id": null, "author": "taras.mozilla@glek.net", "text": "We could check js stacks in debug builds and abort on io on main thread from js - whitelisted legacy files.", "creator": "taras.mozilla@glek.net", "creation_time": "2011-12-02T22:38:24Z", "raw_text": "We could check js stacks in debug builds and abort on io on main thread from js - whitelisted legacy files.", "bug_id": 707196, "id": 5889619, "is_private": false, "count": 2, "tags": []}, {"text": "(In reply to Taras Glek (:taras) from comment #2)\n> We could check js stacks in debug builds and abort on io on main thread from\n> js - whitelisted legacy files.\nThat doesn't help at all in the fight against bad add-ons.", "creator": "sdwilsh@forerunnerdesigns.com", "attachment_id": null, "time": "2011-12-04T17:22:51Z", "author": "sdwilsh@forerunnerdesigns.com", "creation_time": "2011-12-04T17:22:51Z", "raw_text": "(In reply to Taras Glek (:taras) from comment #2)\n> We could check js stacks in debug builds and abort on io on main thread from\n> js - whitelisted legacy files.\nThat doesn't help at all in the fight against bad add-ons.", "bug_id": 707196, "is_private": false, "count": 3, "tags": [], "id": 5891419}, {"raw_text": "(In reply to Shawn Wilsher :sdwilsh from comment #3)\n> (In reply to Taras Glek (:taras) from comment #2)\n> > We could check js stacks in debug builds and abort on io on main thread from\n> > js - whitelisted legacy files.\n> That doesn't help at all in the fight against bad add-ons.\n\nIndeed. Doesn't meant we shouldn't start somewhere.", "creation_time": "2011-12-05T21:34:40Z", "attachment_id": null, "time": "2011-12-05T21:34:40Z", "text": "(In reply to Shawn Wilsher :sdwilsh from comment #3)\n> (In reply to Taras Glek (:taras) from comment #2)\n> > We could check js stacks in debug builds and abort on io on main thread from\n> > js - whitelisted legacy files.\n> That doesn't help at all in the fight against bad add-ons.\n\nIndeed. Doesn't meant we shouldn't start somewhere.", "id": 5893682, "is_private": false, "count": 4, "tags": [], "bug_id": 707196, "author": "taras.mozilla@glek.net", "creator": "taras.mozilla@glek.net"}]}}}