{"bugs": {"1632283": {"comments": [{"creator": "davidp99@gmail.com", "attachment_id": null, "author": "davidp99@gmail.com", "tags": [], "bug_id": 1632283, "id": 14772589, "count": 0, "raw_text": "IpdlQueue can batch at least most async WebGL messages to the compositor process.  This will lead to far fewer IPDL Send calls and improve latency is many cases.  The async buffer should be flushed on (1) a synchronous call or (2) on demand.  We'll need something like a recurring task that flushes to make sure that we don't starve the buffer.", "time": "2020-04-22T20:15:00Z", "text": "IpdlQueue can batch at least most async WebGL messages to the compositor process.  This will lead to far fewer IPDL Send calls and improve latency is many cases.  The async buffer should be flushed on (1) a synchronous call or (2) on demand.  We'll need something like a recurring task that flushes to make sure that we don't starve the buffer.", "creation_time": "2020-04-22T20:15:00Z", "is_private": false}, {"creator": "davidp99@gmail.com", "attachment_id": 9142537, "author": "davidp99@gmail.com", "tags": [], "bug_id": 1632283, "id": 14772614, "count": 1, "raw_text": "\nIpdlQueue currently sends an async Ipdl message for every async WebGL call.  This is a lot of overhead.  This patch buffers those calls so that they can be send in large batches when either a synchronous call happens or the client calls FlushAsyncCache.  The commands are then sent and processed in-order.", "time": "2020-04-22T20:21:25Z", "text": "Created attachment 9142537\nBug 1632283 : Part 1 - Extend IpdlQueue to allow caching async messages r=jgilbert!\n\n\nIpdlQueue currently sends an async Ipdl message for every async WebGL call.  This is a lot of overhead.  This patch buffers those calls so that they can be send in large batches when either a synchronous call happens or the client calls FlushAsyncCache.  The commands are then sent and processed in-order.", "creation_time": "2020-04-22T20:21:25Z", "is_private": false}, {"author": "davidp99@gmail.com", "tags": [], "attachment_id": 9146917, "text": "Created attachment 9146917\nBug 1632283: Part 2 - Add task to drain WebGL async Ipdl queue r=jgilbert!\n\n\nWhen an async message is buffered, we need to make sure that the message is eventually sent to avoid starvation.  This patch queues a future task to do this (currently, randomly, 4 milliseconds in the future) unless one is already queued.  The task may get scooped by a sync message or user call to FlushAsyncCache, in which case the task will have no effect.\n\nDepends on D72047", "creation_time": "2020-05-08T21:18:01Z", "id": 14805602, "bug_id": 1632283, "creator": "davidp99@gmail.com", "is_private": false, "raw_text": "\nWhen an async message is buffered, we need to make sure that the message is eventually sent to avoid starvation.  This patch queues a future task to do this (currently, randomly, 4 milliseconds in the future) unless one is already queued.  The task may get scooped by a sync message or user call to FlushAsyncCache, in which case the task will have no effect.\n\nDepends on D72047", "time": "2020-05-08T21:18:01Z", "count": 2}, {"count": 3, "is_private": false, "time": "2020-05-29T03:48:44Z", "raw_text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/7e47a8d17381\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert", "creator": "pulsebot@bots.tld", "id": 14850875, "bug_id": 1632283, "creation_time": "2020-05-29T03:48:44Z", "text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/7e47a8d17381\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert", "tags": [], "author": "pulsebot@bots.tld", "attachment_id": null}, {"creation_time": "2020-05-29T04:08:03Z", "text": "Backed out for build bustages on IpdlQueue.h\n\nBackout link: https://hg.mozilla.org/integration/autoland/rev/e622ef3ca2a23a18b624b8dc253be5e8d64e9b8b\nLog link: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=304204222&repo=autoland&lineNumber=23016", "attachment_id": null, "author": "nbeleuzu@mozilla.com", "tags": [], "raw_text": "Backed out for build bustages on IpdlQueue.h\n\nBackout link: https://hg.mozilla.org/integration/autoland/rev/e622ef3ca2a23a18b624b8dc253be5e8d64e9b8b\nLog link: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=304204222&repo=autoland&lineNumber=23016", "time": "2020-05-29T04:08:03Z", "is_private": false, "count": 4, "bug_id": 1632283, "id": 14850883, "creator": "nbeleuzu@mozilla.com"}, {"is_private": false, "time": "2020-06-01T19:01:46Z", "raw_text": "rebased", "count": 5, "id": 14856456, "bug_id": 1632283, "creator": "davidp99@gmail.com", "creation_time": "2020-06-01T19:01:46Z", "text": "rebased", "tags": [], "author": "davidp99@gmail.com", "attachment_id": null}, {"creator": "pulsebot@bots.tld", "id": 14856461, "bug_id": 1632283, "count": 6, "is_private": false, "raw_text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/8cfbadcbe2e8\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert\nhttps://hg.mozilla.org/integration/autoland/rev/bad8fd79458d\nPart 2 - Add task to drain WebGL async Ipdl queue r=jgilbert", "time": "2020-06-01T19:03:19Z", "author": "pulsebot@bots.tld", "tags": [], "attachment_id": null, "creation_time": "2020-06-01T19:03:19Z", "text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/8cfbadcbe2e8\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert\nhttps://hg.mozilla.org/integration/autoland/rev/bad8fd79458d\nPart 2 - Add task to drain WebGL async Ipdl queue r=jgilbert"}, {"count": 7, "text": "Backed out for build bustages on IpdlQueue.h.\n\nPush with failure: https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedTaskRun=cieS1f8mRa-pGR1ImLVxyw-0&resultStatus=testfailed%2Cbusted%2Cexception&revision=bad8fd79458d86fcb58eb257b0361ff1c6903b47\n\nFailure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=304590709&repo=autoland&lineNumber=35535\n\nBackout: https://hg.mozilla.org/integration/autoland/rev/24a7fdfc9c9426481aaa4898c2949b4c7338aa07", "time": "2020-06-01T19:28:03Z", "creation_time": "2020-06-01T19:28:03Z", "raw_text": "Backed out for build bustages on IpdlQueue.h.\n\nPush with failure: https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedTaskRun=cieS1f8mRa-pGR1ImLVxyw-0&resultStatus=testfailed%2Cbusted%2Cexception&revision=bad8fd79458d86fcb58eb257b0361ff1c6903b47\n\nFailure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=304590709&repo=autoland&lineNumber=35535\n\nBackout: https://hg.mozilla.org/integration/autoland/rev/24a7fdfc9c9426481aaa4898c2949b4c7338aa07", "is_private": false, "attachment_id": null, "creator": "rmaries@mozilla.com", "tags": [], "author": "rmaries@mozilla.com", "bug_id": 1632283, "id": 14856504}, {"creator": "davidp99@gmail.com", "attachment_id": null, "author": "davidp99@gmail.com", "tags": [], "bug_id": 1632283, "id": 14856909, "count": 8, "raw_text": "FWIW: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=pending%2Crunning%2Cusercancel%2Csuccess%2Ctestfailed%2Cbusted%2Cexception&revision=fe796aa813c616c43d2440824a049b59ef9b5f5a", "creation_time": "2020-06-01T22:35:22Z", "text": "FWIW: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=pending%2Crunning%2Cusercancel%2Csuccess%2Ctestfailed%2Cbusted%2Cexception&revision=fe796aa813c616c43d2440824a049b59ef9b5f5a", "time": "2020-06-01T22:35:22Z", "is_private": false}, {"id": 14856912, "bug_id": 1632283, "author": "pulsebot@bots.tld", "tags": [], "creator": "pulsebot@bots.tld", "attachment_id": null, "is_private": false, "raw_text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/813b662b4ded\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert\nhttps://hg.mozilla.org/integration/autoland/rev/6b31077ebd14\nPart 2 - Add task to drain WebGL async Ipdl queue r=jgilbert", "text": "Pushed by daparks@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/813b662b4ded\nPart 1 - Extend IpdlQueue to allow caching async messages r=jgilbert\nhttps://hg.mozilla.org/integration/autoland/rev/6b31077ebd14\nPart 2 - Add task to drain WebGL async Ipdl queue r=jgilbert", "creation_time": "2020-06-01T22:37:09Z", "time": "2020-06-01T22:37:09Z", "count": 9}, {"bug_id": 1632283, "id": 14857223, "creator": "rmaries@mozilla.com", "attachment_id": null, "author": "rmaries@mozilla.com", "tags": ["bugherder"], "raw_text": "https://hg.mozilla.org/mozilla-central/rev/813b662b4ded\nhttps://hg.mozilla.org/mozilla-central/rev/6b31077ebd14", "creation_time": "2020-06-02T03:27:07Z", "time": "2020-06-02T03:27:07Z", "text": "https://hg.mozilla.org/mozilla-central/rev/813b662b4ded\nhttps://hg.mozilla.org/mozilla-central/rev/6b31077ebd14", "is_private": false, "count": 10}]}}, "comments": {}}