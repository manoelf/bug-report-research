{"comments": {}, "bugs": {"626563": {"comments": [{"bug_id": 626563, "attachment_id": null, "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "tags": [], "count": 0, "raw_text": "Two months ago, I fixed this test in bug 611231.\n...\nToday, after fixing bug 626294, a new failure was revealed.\n\nLinux doesn't run this test.\nMacOSX(64) and Windows are affected:\n\nhttp://tinderbox.mozilla.org/showlog.cgi?log=SeaMonkey/1295314368.1295315508.516.gz&fulltext=1\nWINNT 5.2 comm-central-trunk debug test mochitests-5/5 on 2011/01/17 17:32:48\n{\n7649 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"\n}\n\nNote that this test is (now) spamming with\n{\n###!!! ASSERTION: Popup is offscreen: 'screenPoint.x >= screenRect.x && screenPoint.y >= screenRect.y && screenPoint.x + mRect.width <= screenRect.XMost() && screenPoint.y + mRect.height <= screenRect.YMost()', file e:/builds/slave/comm-cen-trunk-w32-dbg/build/mozilla/layout/xul/base/src/nsMenuPopupFrame.cpp, line 1279\nxul!nsMenuPopupFrame::LayoutPopup+0x00000000000001F6 (e:\\builds\\slave\\comm-cen-trunk-w32-dbg\\build\\mozilla\\layout\\xul\\base\\src\\nsmenupopupframe.cpp, line 452)\n}", "creation_time": "2011-01-18T04:08:31Z", "creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "is_private": false, "time": "2011-01-18T04:08:31Z", "id": 5206507, "text": "Two months ago, I fixed this test in bug 611231.\n...\nToday, after fixing bug 626294, a new failure was revealed.\n\nLinux doesn't run this test.\nMacOSX(64) and Windows are affected:\n\nhttp://tinderbox.mozilla.org/showlog.cgi?log=SeaMonkey/1295314368.1295315508.516.gz&fulltext=1\nWINNT 5.2 comm-central-trunk debug test mochitests-5/5 on 2011/01/17 17:32:48\n{\n7649 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"\n}\n\nNote that this test is (now) spamming with\n{\n###!!! ASSERTION: Popup is offscreen: 'screenPoint.x >= screenRect.x && screenPoint.y >= screenRect.y && screenPoint.x + mRect.width <= screenRect.XMost() && screenPoint.y + mRect.height <= screenRect.YMost()', file e:/builds/slave/comm-cen-trunk-w32-dbg/build/mozilla/layout/xul/base/src/nsMenuPopupFrame.cpp, line 1279\nxul!nsMenuPopupFrame::LayoutPopup+0x00000000000001F6 (e:\\builds\\slave\\comm-cen-trunk-w32-dbg\\build\\mozilla\\layout\\xul\\base\\src\\nsmenupopupframe.cpp, line 452)\n}"}, {"raw_text": "(In reply to comment #0)\n> Today, after fixing bug 626294, a new failure was revealed.\n\nBug 616607 added a new 'input' test:\n*when run alone: panel is below the input, as expected by the check.\n*when run in the harness iframe: panel is above the input :-/", "count": 1, "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "tags": [], "bug_id": 626563, "attachment_id": null, "is_private": false, "time": "2011-01-18T05:27:15Z", "id": 5206601, "text": "(In reply to comment #0)\n> Today, after fixing bug 626294, a new failure was revealed.\n\nBug 616607 added a new 'input' test:\n*when run alone: panel is below the input, as expected by the check.\n*when run in the harness iframe: panel is above the input :-/", "creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "creation_time": "2011-01-18T05:27:15Z"}, {"count": 2, "raw_text": "On my Windows 2000:\n\na) iframe top=\"180\":\nthis bug.\n\nb) iframe top=\"135\":\npanel is below, as expected by the check :-)\n\nc) iframe top=\"155\":\npanel is above with arrow on top, as if bug 616607 wasn't (fully) fixed :-/\n(Yet, the test passes :-<)\n\nNow, I'm double-confused:\n\n1) it seems (from a very quick read of bug 616607) that the check should be designed so the panel is expected above the input, not below.\nActually, the failing log is \"got \"bottom\", expected \"top\"\", as if the display is correct but the check gets \"reversed\" values :-/\n\n2) it seems a bug 616607 (-like) issue remains.", "attachment_id": null, "bug_id": 626563, "tags": [], "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "id": 5206661, "text": "On my Windows 2000:\n\na) iframe top=\"180\":\nthis bug.\n\nb) iframe top=\"135\":\npanel is below, as expected by the check :-)\n\nc) iframe top=\"155\":\npanel is above with arrow on top, as if bug 616607 wasn't (fully) fixed :-/\n(Yet, the test passes :-<)\n\nNow, I'm double-confused:\n\n1) it seems (from a very quick read of bug 616607) that the check should be designed so the panel is expected above the input, not below.\nActually, the failing log is \"got \"bottom\", expected \"top\"\", as if the display is correct but the check gets \"reversed\" values :-/\n\n2) it seems a bug 616607 (-like) issue remains.", "time": "2011-01-18T06:07:14Z", "is_private": false, "creation_time": "2011-01-18T06:07:14Z", "creator": "bugzillamozillaorg_serge_20140323@gautherie.fr"}, {"creation_time": "2011-01-18T10:29:42Z", "bug_id": 626563, "attachment_id": null, "author": "neil@httl.net", "creator": "neil@httl.net", "tags": [], "count": 3, "is_private": false, "time": "2011-01-18T10:29:42Z", "text": "OK, so I tested a) by resizing the browser with the test loaded into it and b) by loading the test into differently sized frames, and on my PC the test fails if its window inner height is less than 325 pixels and succeds if it is 325 pixels or higher. And of course the harness frame is only 300 pixels high...", "id": 5206868, "raw_text": "OK, so I tested a) by resizing the browser with the test loaded into it and b) by loading the test into differently sized frames, and on my PC the test fails if its window inner height is less than 325 pixels and succeds if it is 325 pixels or higher. And of course the harness frame is only 300 pixels high..."}, {"creation_time": "2011-01-18T10:40:05Z", "creator": "neil@httl.net", "time": "2011-01-18T10:40:05Z", "id": 5206889, "text": "(In reply to comment #3)\n> succeds\ns/succeds/succeeds/\n\nI still get the assertions when it succeeds, so maybe they're not relevant.", "is_private": false, "bug_id": 626563, "attachment_id": null, "author": "neil@httl.net", "tags": [], "count": 4, "raw_text": "(In reply to comment #3)\n> succeds\ns/succeds/succeeds/\n\nI still get the assertions when it succeeds, so maybe they're not relevant."}, {"author": "neil@httl.net", "tags": [], "bug_id": 626563, "attachment_id": null, "raw_text": "The assertions are caused by the popup flipping code not handling negative margins. For instance:\n\n[X]\n/ \\_______________________________\nThe negative margin pushes this  |\npanel off the left of the screen.|\n---------------------------------+\n\nIn this configuration, because the popup is to the left of the screen, the flipping code thinks that it needs to be flipped to the right of the anchor.", "count": 5, "creator": "neil@httl.net", "creation_time": "2011-01-18T10:59:39Z", "is_private": false, "time": "2011-01-18T10:59:39Z", "id": 5206907, "text": "The assertions are caused by the popup flipping code not handling negative margins. For instance:\n\n[X]\n/ \\_______________________________\nThe negative margin pushes this  |\npanel off the left of the screen.|\n---------------------------------+\n\nIn this configuration, because the popup is to the left of the screen, the flipping code thinks that it needs to be flipped to the right of the anchor."}, {"attachment_id": null, "bug_id": 626563, "tags": [], "author": "enndeakin@gmail.com", "count": 6, "raw_text": "You'll likely want the patch in bug 524545 for this.", "creation_time": "2011-01-18T14:29:00Z", "creator": "enndeakin@gmail.com", "is_private": false, "text": "You'll likely want the patch in bug 524545 for this.", "id": 5207165, "time": "2011-01-18T14:29:00Z"}, {"raw_text": "That only gets rid of the unrelated assertions. It doesn't stop the test from failing because it wants a bigger iframe.", "count": 7, "author": "neil@httl.net", "tags": [], "bug_id": 626563, "attachment_id": null, "is_private": false, "time": "2011-01-18T15:30:18Z", "text": "That only gets rid of the unrelated assertions. It doesn't stop the test from failing because it wants a bigger iframe.", "id": 5207297, "creator": "neil@httl.net", "creation_time": "2011-01-18T15:30:18Z"}, {"time": "2011-01-18T15:45:54Z", "raw_text": "In fact, with the patch applied, things are even worse, since there are two tests that only work in a maximised window (or in a normal size window that's slightly off the right-hand side of the screen).", "text": "In fact, with the patch applied, things are even worse, since there are two tests that only work in a maximised window (or in a normal size window that's slightly off the right-hand side of the screen).", "id": 5207341, "is_private": false, "count": 8, "author": "neil@httl.net", "creator": "neil@httl.net", "tags": [], "bug_id": 626563, "attachment_id": null, "creation_time": "2011-01-18T15:45:54Z"}, {"count": 9, "id": 5208816, "raw_text": "So, I built Firefox.\n\nAnd I actually get 17 failures on this test...", "text": "So, I built Firefox.\n\nAnd I actually get 17 failures on this test...", "time": "2011-01-18T22:37:51Z", "is_private": false, "attachment_id": null, "bug_id": 626563, "creation_time": "2011-01-18T22:37:51Z", "tags": [], "creator": "neil@httl.net", "author": "neil@httl.net"}, {"attachment_id": null, "bug_id": 626563, "tags": [], "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "count": 10, "raw_text": "(In reply to comment #9)\n> So, I built Firefox.\n> And I actually get 17 failures on this test...\n\nFtr, see bug 625561 about Firefox ;->", "creation_time": "2011-01-18T22:56:23Z", "creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "id": 5208878, "text": "(In reply to comment #9)\n> So, I built Firefox.\n> And I actually get 17 failures on this test...\n\nFtr, see bug 625561 about Firefox ;->", "time": "2011-01-18T22:56:23Z", "is_private": false}, {"time": "2011-01-18T22:59:41Z", "id": 5208890, "text": "(In reply to comment #10)\n> Ftr, see bug 625561 about Firefox ;->\n\nArf, bug 626561 !", "is_private": false, "creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "creation_time": "2011-01-18T22:59:41Z", "raw_text": "(In reply to comment #10)\n> Ftr, see bug 625561 about Firefox ;->\n\nArf, bug 626561 !", "count": 11, "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "tags": [], "bug_id": 626563, "attachment_id": null}, {"text": "dbaron\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Try/1304119005.1304119937.5781.gz\nRev3 Fedora 12 try debug test mochitests-5/5 on 2011/04/29 16:16:45\n\ns: talos-r3-fed-023\n7922 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"", "id": 5440886, "time": "2011-04-30T02:20:25Z", "is_private": false, "creator": "tbplbot@gmail.com", "creation_time": "2011-04-30T02:20:25Z", "raw_text": "dbaron\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Try/1304119005.1304119937.5781.gz\nRev3 Fedora 12 try debug test mochitests-5/5 on 2011/04/29 16:16:45\n\ns: talos-r3-fed-023\n7922 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"", "count": 12, "tags": [], "author": "tbplbot@gmail.com", "attachment_id": null, "bug_id": 626563}, {"is_private": false, "time": "2011-08-05T12:35:22Z", "text": "bz%mit.edu\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Try/1312524351.1312524947.10705.gz\nRev3 Fedora 12 try debug test mochitests-5/5 on 2011/08/04 23:05:51\n\ns: talos-r3-fed-038\n7404 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"", "id": 5635570, "raw_text": "bz%mit.edu\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Try/1312524351.1312524947.10705.gz\nRev3 Fedora 12 try debug test mochitests-5/5 on 2011/08/04 23:05:51\n\ns: talos-r3-fed-038\n7404 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"", "count": 13, "author": "tbplbot@gmail.com", "creator": "tbplbot@gmail.com", "tags": [], "creation_time": "2011-08-05T12:35:22Z", "bug_id": 626563, "attachment_id": null}, {"creation_time": "2011-08-05T19:15:09Z", "creator": "bzbarsky@mit.edu", "time": "2011-08-05T19:15:09Z", "id": 5636450, "text": "As far as I can tell, this is now blocking bug 659350.  Every single test run with the patches for that bug has this failure on try....\n\nNeil, any idea why the changes there would cause this to be permaorange in Firefox?", "is_private": false, "bug_id": 626563, "attachment_id": null, "author": "bzbarsky@mit.edu", "tags": [], "count": 14, "raw_text": "As far as I can tell, this is now blocking bug 659350.  Every single test run with the patches for that bug has this failure on try....\n\nNeil, any idea why the changes there would cause this to be permaorange in Firefox?"}, {"bug_id": 626563, "attachment_id": null, "author": "bzbarsky@mit.edu", "tags": [], "count": 15, "raw_text": "Given comment 3, I also don't understand how this can possibly be green on Tinderbox... what gives?", "creation_time": "2011-08-05T19:19:39Z", "creator": "bzbarsky@mit.edu", "is_private": false, "time": "2011-08-05T19:19:39Z", "id": 5636471, "text": "Given comment 3, I also don't understand how this can possibly be green on Tinderbox... what gives?"}, {"tags": [], "author": "enndeakin@gmail.com", "attachment_id": null, "bug_id": 626563, "raw_text": "I think we should just disable the part of the test that fails. (the part that was added by http://hg.mozilla.org/mozilla-central/rev/f13474da3875 ) as it's caused no end of problems, and instead move it into a separate test.\n\nThe particular test in question relies on arrow panel positioning inside nested frames.", "count": 16, "creator": "enndeakin@gmail.com", "creation_time": "2011-08-05T19:39:32Z", "text": "I think we should just disable the part of the test that fails. (the part that was added by http://hg.mozilla.org/mozilla-central/rev/f13474da3875 ) as it's caused no end of problems, and instead move it into a separate test.\n\nThe particular test in question relies on arrow panel positioning inside nested frames.", "id": 5636535, "time": "2011-08-05T19:39:32Z", "is_private": false}, {"author": "bzbarsky@mit.edu", "tags": [], "creator": "bzbarsky@mit.edu", "creation_time": "2011-08-05T19:54:12Z", "bug_id": 626563, "attachment_id": null, "is_private": false, "time": "2011-08-05T19:54:12Z", "raw_text": "That's ok by me, but I'm still not sure why my changes trigger it reliably... they shouldn't really affect this, I'd think.", "id": 5636567, "text": "That's ok by me, but I'm still not sure why my changes trigger it reliably... they shouldn't really affect this, I'd think.", "count": 17}, {"creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "tags": [], "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "creation_time": "2011-08-06T01:44:28Z", "attachment_id": null, "bug_id": 626563, "is_private": false, "id": 5637210, "raw_text": "(In reply to TinderboxPushlog Robot from comment #13)\n> http://tinderbox.mozilla.org/showlog.cgi?log=Try/1312524351.1312524947.10705.\n> gz\n> Rev3 Fedora 12 try debug test mochitests-5/5 on 2011/08/04 23:05:51\n\n{\n...\n7403 INFO TEST-PASS | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | anchor - [object HTMLInputElement @ 0xa22a588 (native @ 0xbc84558)] should equal [object HTMLInputElement @ 0xa22a588 (native @ 0xbc84558)]\n7404 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"\n7405 INFO TEST-PASS | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel hidden - false should equal false\n7406 INFO TEST-END | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | finished in 2239ms\n}\n\n(In reply to Boris Zbarsky (:bz) from comment #15)\n> Given comment 3, I also don't understand how this can possibly be green on\n> Tinderbox... what gives?\n\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Firefox/1312573536.1312574205.11573.gz&fulltext=1\nRev3 Fedora 12 mozilla-central debug test mochitests-5/5 on 2011/08/05 12:45:36\n{\n7256 INFO TEST-START | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul\n7257 INFO TEST-END | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | finished in 136ms\n}\n\nI would guess your patch in bug 659350 is eventually fixing bug 626561 (see comment 9 to 11)...", "text": "(In reply to TinderboxPushlog Robot from comment #13)\n> http://tinderbox.mozilla.org/showlog.cgi?log=Try/1312524351.1312524947.10705.\n> gz\n> Rev3 Fedora 12 try debug test mochitests-5/5 on 2011/08/04 23:05:51\n\n{\n...\n7403 INFO TEST-PASS | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | anchor - [object HTMLInputElement @ 0xa22a588 (native @ 0xbc84558)] should equal [object HTMLInputElement @ 0xa22a588 (native @ 0xbc84558)]\n7404 ERROR TEST-UNEXPECTED-FAIL | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel arrow side - got \"bottom\", expected \"top\"\n7405 INFO TEST-PASS | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | panel hidden - false should equal false\n7406 INFO TEST-END | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | finished in 2239ms\n}\n\n(In reply to Boris Zbarsky (:bz) from comment #15)\n> Given comment 3, I also don't understand how this can possibly be green on\n> Tinderbox... what gives?\n\nhttp://tinderbox.mozilla.org/showlog.cgi?log=Firefox/1312573536.1312574205.11573.gz&fulltext=1\nRev3 Fedora 12 mozilla-central debug test mochitests-5/5 on 2011/08/05 12:45:36\n{\n7256 INFO TEST-START | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul\n7257 INFO TEST-END | /tests/toolkit/content/tests/widgets/test_arrowpanel.xul | finished in 136ms\n}\n\nI would guess your patch in bug 659350 is eventually fixing bug 626561 (see comment 9 to 11)...", "time": "2011-08-06T01:44:28Z", "count": 18}, {"raw_text": "disable part of the arrowpanels test that tends to fail\nhttp://hg.mozilla.org/mozilla-central/rev/ded3ea236715", "count": 19, "tags": [], "author": "mak@mozilla.com", "attachment_id": null, "bug_id": 626563, "is_private": false, "text": "disable part of the arrowpanels test that tends to fail\nhttp://hg.mozilla.org/mozilla-central/rev/ded3ea236715", "id": 5637449, "time": "2011-08-06T09:57:14Z", "creator": "mak@mozilla.com", "creation_time": "2011-08-06T09:57:14Z"}]}}}