{"bugs": {"686713": {"comments": [{"raw_text": "We're seeing 80mb of RSS in the parent process. This is too much.", "attachment_id": null, "tags": [], "bug_id": 686713, "text": "We're seeing 80mb of RSS in the parent process. This is too much.", "id": 5717209, "count": 0, "is_private": false, "author": "jmuizelaar@mozilla.com", "time": "2011-09-14T17:50:11Z", "creation_time": "2011-09-14T17:50:11Z", "creator": "jmuizelaar@mozilla.com"}, {"tags": [], "bug_id": 686713, "text": "I took a look at this and I'm seeing 95.99 MB of resident and 47 mb of explicit. \n\nof the explicit allocation:\n21 MB -- js\n20 MB -- heap-unclassified", "raw_text": "I took a look at this and I'm seeing 95.99 MB of resident and 47 mb of explicit. \n\nof the explicit allocation:\n21 MB -- js\n20 MB -- heap-unclassified", "attachment_id": null, "author": "jmuizelaar@mozilla.com", "creator": "jmuizelaar@mozilla.com", "time": "2011-09-20T20:39:03Z", "creation_time": "2011-09-20T20:39:03Z", "is_private": false, "id": 5726625, "count": 1}, {"attachment_id": null, "raw_text": "How many tabs do you have opened? Or which one. I get like 13.17 at start up and 69 with one or two tabs.", "tags": [], "text": "How many tabs do you have opened? Or which one. I get like 13.17 at start up and 69 with one or two tabs.", "bug_id": 686713, "is_private": false, "id": 5733334, "count": 2, "creator": "ioana.chiorean@softvision.ro", "time": "2011-09-23T11:37:29Z", "creation_time": "2011-09-23T11:37:29Z", "author": "ioana.chiorean@softvision.ro"}, {"creator": "jstenback+bmo@gmail.com", "creation_time": "2011-10-04T20:40:40Z", "time": "2011-10-04T20:40:40Z", "author": "jstenback+bmo@gmail.com", "is_private": false, "count": 3, "id": 5758456, "bug_id": 686713, "text": "Alon, are you still investigating here? I haven't seen any traction for a while now...", "tags": [], "attachment_id": null, "raw_text": "Alon, are you still investigating here? I haven't seen any traction for a while now..."}, {"attachment_id": null, "raw_text": "Sorry, things have been crazy the last two weeks with preparing for jsconf and then jsconf itself. I am back now and will look into this.", "tags": [], "bug_id": 686713, "text": "Sorry, things have been crazy the last two weeks with preparing for jsconf and then jsconf itself. I am back now and will look into this.", "is_private": false, "id": 5759268, "count": 4, "creator": "azakai@mozilla.com", "time": "2011-10-05T01:40:41Z", "creation_time": "2011-10-05T01:40:41Z", "author": "azakai@mozilla.com"}, {"count": 5, "id": 5761371, "is_private": false, "creation_time": "2011-10-05T20:13:34Z", "time": "2011-10-05T20:13:34Z", "creator": "azakai@mozilla.com", "author": "azakai@mozilla.com", "attachment_id": 564976, "raw_text": "Just loading and closing Fennec (on linux desktop) shows 2 leaked nsGlobalWindows. Attached is the addref tree for one of them, which has one extra (non-COMPtr) reference than it should. (The other has 3 extra refs, 2 of which are COMPtrs, so I am hoping that depends on the first one.)", "tags": [], "text": "Created attachment 564976\naddref tree\n\nJust loading and closing Fennec (on linux desktop) shows 2 leaked nsGlobalWindows. Attached is the addref tree for one of them, which has one extra (non-COMPtr) reference than it should. (The other has 3 extra refs, 2 of which are COMPtrs, so I am hoping that depends on the first one.)", "bug_id": 686713}, {"is_private": false, "count": 6, "id": 5761379, "creator": "azakai@mozilla.com", "creation_time": "2011-10-05T20:15:20Z", "time": "2011-10-05T20:15:20Z", "author": "azakai@mozilla.com", "attachment_id": null, "raw_text": "The tree doesn't have any obvious things that look bad, and is quite big. mccr8, khuey, do either of you have any tricks for narrowing down the search?", "bug_id": 686713, "text": "The tree doesn't have any obvious things that look bad, and is quite big. mccr8, khuey, do either of you have any tricks for narrowing down the search?", "tags": []}, {"count": 7, "id": 5761511, "is_private": false, "author": "continuation@gmail.com", "time": "2011-10-05T20:53:07Z", "creation_time": "2011-10-05T20:53:07Z", "creator": "continuation@gmail.com", "raw_text": "Have you tried a cycle collector dump?  That will at least tell you why the window is alive.  It may be something aside from the window itself that has a mystery reference.", "attachment_id": null, "tags": [], "text": "Have you tried a cycle collector dump?  That will at least tell you why the window is alive.  It may be something aside from the window itself that has a mystery reference.", "bug_id": 686713}, {"author": "azakai@mozilla.com", "creation_time": "2011-10-05T21:06:05Z", "time": "2011-10-05T21:06:05Z", "creator": "azakai@mozilla.com", "id": 5761560, "count": 8, "is_private": false, "text": "Is there a way to get it to dump the cycle collector graph during the leak test? I know how to get a manual dump interactively but that wouldn't be useful I don't think.", "bug_id": 686713, "tags": [], "raw_text": "Is there a way to get it to dump the cycle collector graph during the leak test? I know how to get a manual dump interactively but that wouldn't be useful I don't think.", "attachment_id": null}, {"raw_text": "Set gAlwaysLogCCGraphs to true in xpcom/base/nsCycleCollector.cpp and rebuild.\n\nThat will make it always dump a CC graph.  You'll only care about the last one.  Eventually I plan to make it so that a pref or an environment variable can be used.\n\nIf you have any thoughts about what would be easier or whatnot let me know.", "attachment_id": null, "bug_id": 686713, "text": "Set gAlwaysLogCCGraphs to true in xpcom/base/nsCycleCollector.cpp and rebuild.\n\nThat will make it always dump a CC graph.  You'll only care about the last one.  Eventually I plan to make it so that a pref or an environment variable can be used.\n\nIf you have any thoughts about what would be easier or whatnot let me know.", "tags": [], "id": 5761577, "count": 9, "is_private": false, "author": "continuation@gmail.com", "time": "2011-10-05T21:09:19Z", "creation_time": "2011-10-05T21:09:19Z", "creator": "continuation@gmail.com"}, {"attachment_id": null, "raw_text": "Update for the investigation and discussion on IRC: Appending the PID to the cc dump logs (bug 692305) helped confirm the leak is in the parent. However, the leaked window does not show up in the cc dumps. So there is no shortcut here to find the issue.\n\nAs this approach looks very difficult, perhaps it is easier to try to bisect this, since it must be a regression (we were free of such leaks last year at some point). That would take a lot of time too. Mostly waiting for builds though.", "tags": [], "bug_id": 686713, "text": "Update for the investigation and discussion on IRC: Appending the PID to the cc dump logs (bug 692305) helped confirm the leak is in the parent. However, the leaked window does not show up in the cc dumps. So there is no shortcut here to find the issue.\n\nAs this approach looks very difficult, perhaps it is easier to try to bisect this, since it must be a regression (we were free of such leaks last year at some point). That would take a lot of time too. Mostly waiting for builds though.", "is_private": false, "count": 10, "id": 5762048, "creator": "azakai@mozilla.com", "creation_time": "2011-10-05T23:36:10Z", "time": "2011-10-05T23:36:10Z", "author": "azakai@mozilla.com"}, {"tags": [], "bug_id": 686713, "text": "If you know it's a regression, we should just bisect.  I can put my fast box on it if you like.  Can you give a revision that doesn't leak on desktop linux fennec?", "raw_text": "If you know it's a regression, we should just bisect.  I can put my fast box on it if you like.  Can you give a revision that doesn't leak on desktop linux fennec?", "attachment_id": null, "author": "khuey@kylehuey.com", "creation_time": "2011-10-06T01:01:44Z", "time": "2011-10-06T01:01:44Z", "creator": "khuey@kylehuey.com", "id": 5762244, "count": 11, "is_private": false}, {"tags": [], "bug_id": 686713, "text": "Sadly I don't know a good revision. I've started to go back in time, just finished a build from 4 months ago (d8e48951c3ef). The leak is still there just like on trunk (2 nsGlobalWindows leaked and tons of other stuff), so need to go further back.\n\nThis will take quite a while on my machine (macbook), if you want to steal this bug and use your fast box then that would be great.", "attachment_id": null, "raw_text": "Sadly I don't know a good revision. I've started to go back in time, just finished a build from 4 months ago (d8e48951c3ef). The leak is still there just like on trunk (2 nsGlobalWindows leaked and tons of other stuff), so need to go further back.\n\nThis will take quite a while on my machine (macbook), if you want to steal this bug and use your fast box then that would be great.", "time": "2011-10-06T01:20:12Z", "creation_time": "2011-10-06T01:20:12Z", "creator": "azakai@mozilla.com", "author": "azakai@mozilla.com", "count": 12, "id": 5762271, "is_private": false}, {"tags": [], "bug_id": 686713, "text": "Ok.  What's the STR?  Start it up and close it?", "attachment_id": null, "raw_text": "Ok.  What's the STR?  Start it up and close it?", "creator": "khuey@kylehuey.com", "time": "2011-10-06T01:33:03Z", "creation_time": "2011-10-06T01:33:03Z", "author": "khuey@kylehuey.com", "is_private": false, "id": 5762291, "count": 13}, {"raw_text": "Yes (and with XPCOM_MEM_LEAK_LOG=1 of course).", "attachment_id": null, "text": "Yes (and with XPCOM_MEM_LEAK_LOG=1 of course).", "bug_id": 686713, "tags": [], "is_private": false, "count": 14, "id": 5762327, "author": "azakai@mozilla.com", "creator": "azakai@mozilla.com", "time": "2011-10-06T01:54:51Z", "creation_time": "2011-10-06T01:54:51Z"}, {"author": "n.nethercote@gmail.com", "creator": "n.nethercote@gmail.com", "time": "2011-10-19T03:29:23Z", "creation_time": "2011-10-19T03:29:23Z", "is_private": false, "id": 5791106, "count": 15, "tags": [], "bug_id": 686713, "text": "With the Native chrome process going ahead, do we still need this bug open?", "raw_text": "With the Native chrome process going ahead, do we still need this bug open?", "attachment_id": null}, {"attachment_id": null, "raw_text": "I think this bug should remain open, but it should probably be de-prioritized", "tags": [], "text": "I think this bug should remain open, but it should probably be de-prioritized", "bug_id": 686713, "is_private": false, "count": 16, "id": 5791889, "creator": "lassey@chromium.org", "time": "2011-10-19T15:08:14Z", "creation_time": "2011-10-19T15:08:14Z", "author": "lassey@chromium.org"}, {"bug_id": 686713, "text": "I think the goal in this bug should be to run leak checks on Fennec as soon as the new UI is ready enough.", "tags": [], "raw_text": "I think the goal in this bug should be to run leak checks on Fennec as soon as the new UI is ready enough.", "attachment_id": null, "author": "azakai@mozilla.com", "creator": "azakai@mozilla.com", "time": "2011-10-19T16:46:45Z", "creation_time": "2011-10-19T16:46:45Z", "is_private": false, "count": 17, "id": 5792158}, {"is_private": false, "id": 5833235, "count": 18, "creator": "n.nethercote@gmail.com", "time": "2011-11-08T04:57:07Z", "creation_time": "2011-11-08T04:57:07Z", "author": "n.nethercote@gmail.com", "attachment_id": null, "raw_text": "(In reply to Alon Zakai (:azakai) from comment #17)\n> I think the goal in this bug should be to run leak checks on Fennec as soon\n> as the new UI is ready enough.\n\nI've retitled and re-prioritized this bug accordingly.", "tags": [], "bug_id": 686713, "text": "(In reply to Alon Zakai (:azakai) from comment #17)\n> I think the goal in this bug should be to run leak checks on Fennec as soon\n> as the new UI is ready enough.\n\nI've retitled and re-prioritized this bug accordingly."}, {"tags": [], "bug_id": 686713, "text": "This requires running debug builds of Android.  I don't know if there's a bug for that or not.", "attachment_id": null, "raw_text": "This requires running debug builds of Android.  I don't know if there's a bug for that or not.", "creation_time": "2012-04-18T05:40:08Z", "time": "2012-04-18T05:40:08Z", "creator": "continuation@gmail.com", "author": "continuation@gmail.com", "id": 6232577, "count": 19, "is_private": false}]}}, "comments": {}}