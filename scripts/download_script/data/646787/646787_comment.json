{"bugs": {"646787": {"comments": [{"author": "janesconference@gmail.com", "count": 0, "text": "User-Agent:       Mozilla/5.0 (X11; Linux i686; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Firefox 4.0\n\nI have a canvas element on which I draw text with the fillText function. textBaseline is set to \"top\" and textAlignment is set to \"left\". The font I use is an embedded one (I use @font-face).\n\nIf I try to launch the linked demo on FF 4.0 / ubuntu, FF 4.0 / W7 or FF 3.x / ubuntu, I get a certain text position, pictured in the screenshot below (look at the green LCD box):\n[ Note: None of these browsers has WebGL (Mozilla showcase tells me I must check my drivers) ]\n\nhttp://dl.dropbox.com/u/6767816/ff4W7.png\n\nThe very same demo on Firefox 4, Windows Vista with WebGL is displayed like that:\n\nhttp://dl.dropbox.com/u/6767816/ff4Vista.png\n\nAs you can see, the embedded-font text is a little bit higher in this last example, while its position is unchanged in the code.\n\nReproducible: Always\n\nSteps to Reproduce:\nOpen the demo with different browsers, and see the differences in the embedded font text rendering.\nActual Results:  \nFF 4.0 on Vista with WebGL enabled rendered the text in a position higher than the other FF 4.0 I tried.\n\nExpected Results:  \nFF 4.0 on Vista with WebGL enabled should have rendered the text in the same position the other FF 4.0 I tried.", "attachment_id": null, "creator": "janesconference@gmail.com", "time": "2011-03-31T11:00:57Z", "id": 5382867, "is_private": false, "creation_time": "2011-03-31T11:00:57Z", "bug_id": 646787, "raw_text": "User-Agent:       Mozilla/5.0 (X11; Linux i686; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Firefox 4.0\n\nI have a canvas element on which I draw text with the fillText function. textBaseline is set to \"top\" and textAlignment is set to \"left\". The font I use is an embedded one (I use @font-face).\n\nIf I try to launch the linked demo on FF 4.0 / ubuntu, FF 4.0 / W7 or FF 3.x / ubuntu, I get a certain text position, pictured in the screenshot below (look at the green LCD box):\n[ Note: None of these browsers has WebGL (Mozilla showcase tells me I must check my drivers) ]\n\nhttp://dl.dropbox.com/u/6767816/ff4W7.png\n\nThe very same demo on Firefox 4, Windows Vista with WebGL is displayed like that:\n\nhttp://dl.dropbox.com/u/6767816/ff4Vista.png\n\nAs you can see, the embedded-font text is a little bit higher in this last example, while its position is unchanged in the code.\n\nReproducible: Always\n\nSteps to Reproduce:\nOpen the demo with different browsers, and see the differences in the embedded font text rendering.\nActual Results:  \nFF 4.0 on Vista with WebGL enabled rendered the text in a position higher than the other FF 4.0 I tried.\n\nExpected Results:  \nFF 4.0 on Vista with WebGL enabled should have rendered the text in the same position the other FF 4.0 I tried.", "tags": []}, {"tags": [], "creation_time": "2011-03-31T14:02:16Z", "bug_id": 646787, "raw_text": "What happens if you turn off DirectWrite in about:config?\n\nFor what it's worth, I see the rendering from your screenshot on Mac, where WebGL is very much enabled.  So I really doubt this has to do with WebGL.", "is_private": false, "id": 5383144, "time": "2011-03-31T14:02:16Z", "creator": "bzbarsky@mit.edu", "attachment_id": null, "text": "What happens if you turn off DirectWrite in about:config?\n\nFor what it's worth, I see the rendering from your screenshot on Mac, where WebGL is very much enabled.  So I really doubt this has to do with WebGL.", "count": 1, "author": "bzbarsky@mit.edu"}, {"time": "2011-03-31T14:18:20Z", "id": 5383163, "is_private": false, "creation_time": "2011-03-31T14:18:20Z", "bug_id": 646787, "raw_text": "I'm guessing the Vista machine is *not* using directwrite by default, whereas the Win7 one is. Setting gfx.font_rendering.directwrite.enabled to true on the Vista machine may therefore make them match better.\n\n(If I'm right, this is essentially the _opposite_ of the complaints we've had about D2D/DW giving larger line spacing; here, the problem is that the tighter line spacing used under GDI doesn't match the behavior on other platforms.)\n\nThis raises the question of what the textBaseline values \"top\" and \"bottom\" are supposed to mean. https://developer.mozilla.org/en/drawing_text_using_a_canvas says that \"top...is the top of the em square\", but \"bottom...is the bottom of the bounding box\", which is a strange and inconsistent way to define them, and probably not what we actually do in practice.\n\nAh.... http://dev.w3.org/html5/2dcontext/#text is more consistent, saying that \"top\" and \"bottom\" are \"The [top/bottom] of the em square\" respectively. I suspect we're not using the right metrics here, then.", "tags": [], "author": "jfkthame@gmail.com", "text": "I'm guessing the Vista machine is *not* using directwrite by default, whereas the Win7 one is. Setting gfx.font_rendering.directwrite.enabled to true on the Vista machine may therefore make them match better.\n\n(If I'm right, this is essentially the _opposite_ of the complaints we've had about D2D/DW giving larger line spacing; here, the problem is that the tighter line spacing used under GDI doesn't match the behavior on other platforms.)\n\nThis raises the question of what the textBaseline values \"top\" and \"bottom\" are supposed to mean. https://developer.mozilla.org/en/drawing_text_using_a_canvas says that \"top...is the top of the em square\", but \"bottom...is the bottom of the bounding box\", which is a strange and inconsistent way to define them, and probably not what we actually do in practice.\n\nAh.... http://dev.w3.org/html5/2dcontext/#text is more consistent, saying that \"top\" and \"bottom\" are \"The [top/bottom] of the em square\" respectively. I suspect we're not using the right metrics here, then.", "count": 2, "attachment_id": null, "creator": "jfkthame@gmail.com"}, {"time": "2011-03-31T17:34:53Z", "author": "janesconference@gmail.com", "id": 5383625, "text": "gfx.font_rendering.directwrite.enabled was false on my Vista box. I set it to true, but nothing changed at all (I tried several times to reload the demo, even after a few reboots). The text is still at the center of its box, like in the second screenshot.\nPlease let me know if I can do something else to make this bug reproducible for you.\n\n(Johnatan: the W7 machine was run in VirtualBox, while all the others are physical machines. Unfortunately, I lost its data and can't check if gfx.font_rendering.directwrite.enabled was true right now).", "count": 3, "is_private": false, "attachment_id": null, "creation_time": "2011-03-31T17:34:53Z", "bug_id": 646787, "raw_text": "gfx.font_rendering.directwrite.enabled was false on my Vista box. I set it to true, but nothing changed at all (I tried several times to reload the demo, even after a few reboots). The text is still at the center of its box, like in the second screenshot.\nPlease let me know if I can do something else to make this bug reproducible for you.\n\n(Johnatan: the W7 machine was run in VirtualBox, while all the others are physical machines. Unfortunately, I lost its data and can't check if gfx.font_rendering.directwrite.enabled was true right now).", "tags": [], "creator": "janesconference@gmail.com"}, {"raw_text": "Any chanche that someone could confirm this bug?", "bug_id": 646787, "creation_time": "2011-04-04T11:09:51Z", "creator": "janesconference@gmail.com", "tags": [], "attachment_id": null, "is_private": false, "text": "Any chanche that someone could confirm this bug?", "count": 4, "author": "janesconference@gmail.com", "time": "2011-04-04T11:09:51Z", "id": 5389941}, {"id": 5455832, "author": "mischdele@gmx.de", "time": "2011-05-08T12:18:59Z", "count": 5, "text": "Created attachment 530912\nTesting Arial and Arial Black rendering on Canvas", "is_private": false, "attachment_id": 530912, "creator": "mischdele@gmx.de", "tags": [], "raw_text": "", "bug_id": 646787, "creation_time": "2011-05-08T12:18:59Z"}, {"tags": [], "creator": "mischdele@gmx.de", "creation_time": "2011-05-08T12:20:30Z", "bug_id": 646787, "raw_text": "I'm experiencing an issue which might be related to that one: Certain fonts are displayed too far at the bottom when using fillText() on a <canvas> element.\n\nI've attached a demo using Arial and Arial Black (where Arial Black is rendered wrong).\n\nHere are the results for FF 4.0.1 on Linux (Arial Black too far at the bottom)\nhttp://dl.dropbox.com/u/2417961/canvas-font-firefox.png\n\nand here on Chrome (11.0.696.65, also on Linux)\nhttp://dl.dropbox.com/u/2417961/canvas-font-chrome.png", "attachment_id": null, "is_private": false, "count": 6, "text": "I'm experiencing an issue which might be related to that one: Certain fonts are displayed too far at the bottom when using fillText() on a <canvas> element.\n\nI've attached a demo using Arial and Arial Black (where Arial Black is rendered wrong).\n\nHere are the results for FF 4.0.1 on Linux (Arial Black too far at the bottom)\nhttp://dl.dropbox.com/u/2417961/canvas-font-firefox.png\n\nand here on Chrome (11.0.696.65, also on Linux)\nhttp://dl.dropbox.com/u/2417961/canvas-font-chrome.png", "id": 5455834, "time": "2011-05-08T12:20:30Z", "author": "mischdele@gmx.de"}]}}, "comments": {}}