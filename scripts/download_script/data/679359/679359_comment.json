{"bugs": {"679359": {"comments": [{"attachment_id": null, "raw_text": "Once we get rid of old style jemalloc, all builds will require the CRT to work on non development environments, and thus a properly set WIN32_REDIST_DIR. We can make that easier if we can autodetect it.\n\nWe could already do that before getting rid of old style jemalloc, but it doesn't make much sense to add the adequate tests to remove them then.", "time": "2011-08-16T15:21:49Z", "tags": [], "author": "mh+mozilla@glandium.org", "text": "Once we get rid of old style jemalloc, all builds will require the CRT to work on non development environments, and thus a properly set WIN32_REDIST_DIR. We can make that easier if we can autodetect it.\n\nWe could already do that before getting rid of old style jemalloc, but it doesn't make much sense to add the adequate tests to remove them then.", "count": 0, "creator": "mh+mozilla@glandium.org", "is_private": false, "creation_time": "2011-08-16T15:21:49Z", "id": 5657070, "bug_id": 679359}, {"attachment_id": null, "tags": [], "creator": "benjamin@smedbergs.us", "creation_time": "2011-08-16T15:42:48Z", "is_private": false, "raw_text": "I do not think that we should automatically do this. We didn't automatically do it to begin with because the MS DLLs are not free software and you have to follow the redistribution agreement. We should require people to pass a flag to acknowledge that they understand what they are getting into, technically and legally.", "time": "2011-08-16T15:42:48Z", "count": 1, "text": "I do not think that we should automatically do this. We didn't automatically do it to begin with because the MS DLLs are not free software and you have to follow the redistribution agreement. We should require people to pass a flag to acknowledge that they understand what they are getting into, technically and legally.", "author": "benjamin@smedbergs.us", "bug_id": 679359, "id": 5657143}, {"time": "2011-08-16T16:11:00Z", "attachment_id": null, "raw_text": "(In reply to Benjamin Smedberg  [:bsmedberg] from comment #1)\n> I do not think that we should automatically do this. We didn't automatically\n> do it to begin with because the MS DLLs are not free software and you have\n> to follow the redistribution agreement.\n\nDon't you already have to do that if you link with MSVC (which includes static bits of the CRT)?", "tags": [], "creator": "mh+mozilla@glandium.org", "author": "mh+mozilla@glandium.org", "count": 2, "text": "(In reply to Benjamin Smedberg  [:bsmedberg] from comment #1)\n> I do not think that we should automatically do this. We didn't automatically\n> do it to begin with because the MS DLLs are not free software and you have\n> to follow the redistribution agreement.\n\nDon't you already have to do that if you link with MSVC (which includes static bits of the CRT)?", "bug_id": 679359, "id": 5657209, "is_private": false, "creation_time": "2011-08-16T16:11:00Z"}, {"time": "2011-08-16T17:03:00Z", "attachment_id": null, "raw_text": "We could simplify this to \"--enable-crt-redist\" or something.", "tags": [], "creator": "ted@mielczarek.org", "author": "ted@mielczarek.org", "count": 3, "text": "We could simplify this to \"--enable-crt-redist\" or something.", "bug_id": 679359, "id": 5657360, "creation_time": "2011-08-16T17:03:00Z", "is_private": false}, {"time": "2011-08-16T17:10:14Z", "attachment_id": null, "raw_text": "IMO this is twofold,\n\nFirst WIN32_REDIST_DIR is not required to build, but is necessary if you are distributing the build. That said, if your users locally install the necessary MSVC dll's etc. then you don't necessary have to ship the dll's either.\n\nThat said, I also feel this should be a factor of MOZBUILD to locate, since we already do the magic for the MSVC setting in there. We should also only USE the setting if we pass a flag to configure, imo.\n\nSo MozBuild will find/set MOZ_WIN32_REDIST_DIR, configure will see that and use it if --enable-crt-redist is passed.\n\nDoes all that sound accurate/a good plan?", "tags": [], "creator": "bugspam.Callek@gmail.com", "author": "bugspam.Callek@gmail.com", "text": "IMO this is twofold,\n\nFirst WIN32_REDIST_DIR is not required to build, but is necessary if you are distributing the build. That said, if your users locally install the necessary MSVC dll's etc. then you don't necessary have to ship the dll's either.\n\nThat said, I also feel this should be a factor of MOZBUILD to locate, since we already do the magic for the MSVC setting in there. We should also only USE the setting if we pass a flag to configure, imo.\n\nSo MozBuild will find/set MOZ_WIN32_REDIST_DIR, configure will see that and use it if --enable-crt-redist is passed.\n\nDoes all that sound accurate/a good plan?", "count": 4, "bug_id": 679359, "id": 5657392, "is_private": false, "creation_time": "2011-08-16T17:10:14Z"}, {"id": 5657404, "bug_id": 679359, "creation_time": "2011-08-16T17:12:40Z", "is_private": false, "creator": "benjamin@smedbergs.us", "text": "Yes, I support automagically locating the directory.\n\nNo, statically linking the CRT does not trigger the same license restrictions as the dynamic CRT does. It's not a huge deal, but people should be aware of it before using it.", "count": 5, "author": "benjamin@smedbergs.us", "tags": [], "time": "2011-08-16T17:12:40Z", "raw_text": "Yes, I support automagically locating the directory.\n\nNo, statically linking the CRT does not trigger the same license restrictions as the dynamic CRT does. It's not a huge deal, but people should be aware of it before using it.", "attachment_id": null}, {"tags": [], "raw_text": "I'll leave the MozBuild fiddling to Kyle, then, since he's been playing with it recently.", "attachment_id": null, "time": "2011-08-17T08:47:25Z", "is_private": false, "creation_time": "2011-08-17T08:47:25Z", "bug_id": 679359, "id": 5659115, "count": 6, "text": "I'll leave the MozBuild fiddling to Kyle, then, since he's been playing with it recently.", "author": "mh+mozilla@glandium.org", "creator": "mh+mozilla@glandium.org"}, {"creator": "mh+mozilla@glandium.org", "is_private": false, "creation_time": "2011-08-17T08:49:46Z", "attachment_id": 553698, "tags": [], "count": 7, "text": "Created attachment 553698\nAutodetect WIN32_REDIST_DIR\n\nJust for the record, this is the configure change I was working on. Only attaching here because it contains details about the REDIST_DIR path differences between versions of MSVC and between architectures.", "author": "mh+mozilla@glandium.org", "id": 5659121, "bug_id": 679359, "time": "2011-08-17T08:49:46Z", "raw_text": "Just for the record, this is the configure change I was working on. Only attaching here because it contains details about the REDIST_DIR path differences between versions of MSVC and between architectures."}, {"time": "2011-08-18T05:54:09Z", "raw_text": "We already autodetect a location of d3dx9_*.dll and D3DCompiler_*.dll\nand MOZ_ANGLE is enabled by default.\nDoesn't it cause a problem?", "id": 5661772, "bug_id": 679359, "text": "We already autodetect a location of d3dx9_*.dll and D3DCompiler_*.dll\nand MOZ_ANGLE is enabled by default.\nDoesn't it cause a problem?", "count": 8, "author": "VYV03354@nifty.ne.jp", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-08-18T05:54:09Z", "creator": "VYV03354@nifty.ne.jp"}, {"time": "2011-08-18T05:56:49Z", "attachment_id": null, "raw_text": "(In reply to Masatoshi Kimura [:emk] from comment #8)\n> We already autodetect a location of d3dx9_*.dll and D3DCompiler_*.dll\n> and MOZ_ANGLE is enabled by default.\n> Doesn't it cause a problem?\n\nIt probably causes the very same problem.", "tags": [], "creator": "mh+mozilla@glandium.org", "author": "mh+mozilla@glandium.org", "count": 9, "text": "(In reply to Masatoshi Kimura [:emk] from comment #8)\n> We already autodetect a location of d3dx9_*.dll and D3DCompiler_*.dll\n> and MOZ_ANGLE is enabled by default.\n> Doesn't it cause a problem?\n\nIt probably causes the very same problem.", "id": 5661774, "bug_id": 679359, "is_private": false, "creation_time": "2011-08-18T05:56:49Z"}, {"attachment_id": null, "tags": [], "creator": "rain@sunshowers.io", "is_private": false, "creation_time": "2011-12-24T12:32:07Z", "time": "2011-12-24T12:32:07Z", "raw_text": "Note that once bug 515374 lands and package-manifest warnings are made fatal for an app, any attempt to create a package (make -C $app/installer) without setting WIN32_REDIST_DIR will fail. I think this is the right thing to do, though.", "count": 10, "text": "Note that once bug 515374 lands and package-manifest warnings are made fatal for an app, any attempt to create a package (make -C $app/installer) without setting WIN32_REDIST_DIR will fail. I think this is the right thing to do, though.", "author": "rain@sunshowers.io", "bug_id": 679359, "id": 5938569}, {"creator": "bugzillamozillaorg_serge_20140323@gautherie.fr", "is_private": false, "creation_time": "2012-03-14T19:44:06Z", "attachment_id": null, "tags": [], "author": "bugzillamozillaorg_serge_20140323@gautherie.fr", "count": 11, "text": "(In reply to Siddharth Agarwal [:sid0] from comment #10)\n\n> Note that once bug 515374 lands and package-manifest warnings are made fatal\n> for an app, any attempt to create a package (make -C $app/installer) without\n\n(After SeaMonkey actually hit this case...)\nI filed Firefox bug 735810.\n\n> setting WIN32_REDIST_DIR will fail. I think this is the right thing to do,\n> though.\n\nIt shouldn't fail, as long as these dlls are not actually required (in all cases).", "id": 6140124, "bug_id": 679359, "raw_text": "(In reply to Siddharth Agarwal [:sid0] from comment #10)\n\n> Note that once bug 515374 lands and package-manifest warnings are made fatal\n> for an app, any attempt to create a package (make -C $app/installer) without\n\n(After SeaMonkey actually hit this case...)\nI filed Firefox bug 735810.\n\n> setting WIN32_REDIST_DIR will fail. I think this is the right thing to do,\n> though.\n\nIt shouldn't fail, as long as these dlls are not actually required (in all cases).", "time": "2012-03-14T19:44:06Z"}, {"creator": "rain@sunshowers.io", "author": "rain@sunshowers.io", "count": 12, "text": "(In reply to Serge Gautherie (:sgautherie) from comment #11)\n> It shouldn't fail, as long as these dlls are not actually required (in all\n> cases).\n\nThey are required in all reasonable cases. We actually shipped a broken Thunderbird 9.0 because we didn't catch this in time. A warning isn't good enough: we need red on tinderbox.", "id": 6140221, "bug_id": 679359, "is_private": false, "creation_time": "2012-03-14T20:09:22Z", "time": "2012-03-14T20:09:22Z", "attachment_id": null, "raw_text": "(In reply to Serge Gautherie (:sgautherie) from comment #11)\n> It shouldn't fail, as long as these dlls are not actually required (in all\n> cases).\n\nThey are required in all reasonable cases. We actually shipped a broken Thunderbird 9.0 because we didn't catch this in time. A warning isn't good enough: we need red on tinderbox.", "tags": []}, {"id": 6140656, "bug_id": 679359, "is_private": false, "creation_time": "2012-03-14T21:52:50Z", "creator": "mh+mozilla@glandium.org", "author": "mh+mozilla@glandium.org", "text": "You need red on tinderbox, but you don't need red when doing make package locally", "count": 13, "tags": [], "time": "2012-03-14T21:52:50Z", "attachment_id": null, "raw_text": "You need red on tinderbox, but you don't need red when doing make package locally"}, {"tags": [], "attachment_id": null, "raw_text": "How about only failing when --enable-official-branding is set? I don't know how many devs use it, but this would at least fail with builds on beta - in time to catch it before release, but shouldn't affect the majority of devs.", "time": "2012-03-16T08:52:22Z", "is_private": false, "creation_time": "2012-03-16T08:52:22Z", "id": 6145590, "bug_id": 679359, "author": "standard8@mozilla.com", "text": "How about only failing when --enable-official-branding is set? I don't know how many devs use it, but this would at least fail with builds on beta - in time to catch it before release, but shouldn't affect the majority of devs.", "count": 14, "creator": "standard8@mozilla.com"}, {"raw_text": "I was going to suggest keying on MOZILLA_OFFICIAL. Either of those would probably work.", "attachment_id": null, "time": "2012-03-20T12:50:30Z", "tags": [], "text": "I was going to suggest keying on MOZILLA_OFFICIAL. Either of those would probably work.", "count": 15, "author": "ted@mielczarek.org", "creator": "ted@mielczarek.org", "creation_time": "2012-03-20T12:50:30Z", "is_private": false, "id": 6154789, "bug_id": 679359}, {"tags": [], "attachment_id": null, "creation_time": "2012-03-20T14:12:51Z", "is_private": false, "creator": "rain@sunshowers.io", "raw_text": "Sure, makes sense.", "time": "2012-03-20T14:12:51Z", "id": 6154987, "bug_id": 679359, "author": "rain@sunshowers.io", "count": 16, "text": "Sure, makes sense."}, {"creation_time": "2015-01-31T01:52:32Z", "is_private": false, "creator": "blair@theunfocused.net", "tags": [], "attachment_id": null, "bug_id": 679359, "id": 9865564, "count": 17, "text": "Can this be moved forward? It's a footgun for anyone attempting to responsibly test on multiple machines/VMs.", "author": "blair@theunfocused.net", "raw_text": "Can this be moved forward? It's a footgun for anyone attempting to responsibly test on multiple machines/VMs.", "time": "2015-01-31T01:52:32Z"}]}}, "comments": {}}