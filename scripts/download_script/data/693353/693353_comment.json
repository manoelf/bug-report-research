{"comments": {}, "bugs": {"693353": {"comments": [{"raw_text": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 20110928134238\n\nSteps to reproduce:\n\nTried to detach an attachment from a message still in (IMAP) Inbox.\n\n\nActual results:\n\nThe detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days), then message disappears from Inbox\n\n\nExpected results:\n\nThe message should be left intact (rather than disappears) after unsuccessful detach operation.", "attachment_id": null, "bug_id": 693353, "text": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\nBuild ID: 20110928134238\n\nSteps to reproduce:\n\nTried to detach an attachment from a message still in (IMAP) Inbox.\n\n\nActual results:\n\nThe detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days), then message disappears from Inbox\n\n\nExpected results:\n\nThe message should be left intact (rather than disappears) after unsuccessful detach operation.", "tags": [], "is_private": false, "count": 0, "id": 5771950, "author": "digixmax@gmail.com", "creator": "digixmax@gmail.com", "creation_time": "2011-10-10T17:42:55Z", "time": "2011-10-10T17:42:55Z"}, {"text": "(In reply to digixmax from comment #0)\n> Steps to reproduce:\n> Tried to detach an attachment from a message still in (IMAP) Inbox.\n> \n> Actual results:\n> The detachment operation is unsuccessful (due to Mail server not allowing\n> changes to messages older than, say, 2-3 days), then message disappears from\n> Inbox\n\nTb's detach/delete operation when IMAP is;\n 1. append(upload) of new version of mail without data lines in\n    detached/deleted MIME part(s) of mail, with modified headers in the part(s).\n 2. uid xxx store Flags (\\Deleted), for original mail.\nStep 1 is ordinally never \"modification of existent mail data\" for IMAP server, if ordinal IMAP server. There is no way to replace data of existent mail in protocol named IMAP.\nSo, \"The detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days)\" can't occur if ordinal IMAP server, unless IMAP server refuses to accept mail of same Message-ID:, Subject:, From:/To:/CC: etc. with slightly altered mail data lines in part(s) upon the append request(upload request).\n\nWhat phenomenon or IMAP level flow do you call by your \"The detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days)\"?", "bug_id": 693353, "tags": [], "attachment_id": null, "raw_text": "(In reply to digixmax from comment #0)\n> Steps to reproduce:\n> Tried to detach an attachment from a message still in (IMAP) Inbox.\n> \n> Actual results:\n> The detachment operation is unsuccessful (due to Mail server not allowing\n> changes to messages older than, say, 2-3 days), then message disappears from\n> Inbox\n\nTb's detach/delete operation when IMAP is;\n 1. append(upload) of new version of mail without data lines in\n    detached/deleted MIME part(s) of mail, with modified headers in the part(s).\n 2. uid xxx store Flags (\\Deleted), for original mail.\nStep 1 is ordinally never \"modification of existent mail data\" for IMAP server, if ordinal IMAP server. There is no way to replace data of existent mail in protocol named IMAP.\nSo, \"The detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days)\" can't occur if ordinal IMAP server, unless IMAP server refuses to accept mail of same Message-ID:, Subject:, From:/To:/CC: etc. with slightly altered mail data lines in part(s) upon the append request(upload request).\n\nWhat phenomenon or IMAP level flow do you call by your \"The detachment operation is unsuccessful (due to Mail server not allowing changes to messages older than, say, 2-3 days)\"?", "creation_time": "2011-10-10T18:47:28Z", "time": "2011-10-10T18:47:28Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com", "count": 1, "id": 5772190, "is_private": false}, {"author": "digixmax@gmail.com", "creation_time": "2011-10-11T00:52:35Z", "time": "2011-10-11T00:52:35Z", "creator": "digixmax@gmail.com", "count": 2, "id": 5773341, "is_private": false, "bug_id": 693353, "text": "Your description of TB's detach/delete operation is consistent with the explanation I got from our Mail Server folks.  According to them the message is lost because TB still proceeds with step 2, rather than aborts it, even when step 1 fails.", "tags": [], "raw_text": "Your description of TB's detach/delete operation is consistent with the explanation I got from our Mail Server folks.  According to them the message is lost because TB still proceeds with step 2, rather than aborts it, even when step 1 fails.", "attachment_id": null}, {"raw_text": "Can you attach(not paste) IMAP log? (timestamp,imap:5)\n> https://wiki.mozilla.org/MailNews:Logging", "is_private": false, "attachment_id": null, "count": 3, "id": 5773443, "author": "m-wada@usa.com", "tags": [], "bug_id": 693353, "text": "Can you attach(not paste) IMAP log? (timestamp,imap:5)\n> https://wiki.mozilla.org/MailNews:Logging", "creator": "m-wada@usa.com", "time": "2011-10-11T02:00:09Z", "creation_time": "2011-10-11T02:00:09Z"}, {"creator": "digixmax@gmail.com", "creation_time": "2011-10-26T17:13:44Z", "time": "2011-10-26T17:13:44Z", "author": "digixmax@gmail.com", "is_private": false, "id": 5806550, "count": 4, "tags": [], "bug_id": 693353, "text": "Created attachment 569708\nMail Server Log file extract for the failed Detach transaction", "attachment_id": 569708, "raw_text": ""}, {"creation_time": "2011-10-27T00:02:02Z", "time": "2011-10-27T00:02:02Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com", "id": 5807811, "count": 5, "is_private": false, "tags": [], "text": "(In reply to digixmax from comment #4)\n> Mail Server Log file extract for the failed Detach transaction\n\n[1] Tb opens Inbox\n> 20:31:04 yim TLOG xi=17 cm=7 select \"INBOX\"\n> OPENED\n> 20:31:04 yim TLOG xi=17 cm=8 getquotaroot \"INBOX\"\n> 20:31:04 yim TLOG xi=17 cm=9 UID fetch 1:* (FLAGS)\n\n[2] Tb deletes UID= 551330\n> 20:31:05 yim TLOG xi=17 cm=10 uid store 551330 +Flags (\\Seen \\Deleted)\n> FLAGGED\n> 20:31:05 yim TLOG xi=17 cm=11 IDLE\n\n[3] Check for new messages in Inbox. Highest UID=552948, because of fetch 552949:* (FLAGS)\"\n> 20:32:45 yim TLOG xi=17 cm=12 noop\n> 20:32:45 yim TLOG xi=17 cm=13 getquotaroot \"INBOX\"\n> 20:32:45 yim TLOG xi=17 cm=14 UID fetch 552949:* (FLAGS)\n> 20:32:45 yim TLOG xi=17 cm=15 IDLE\n\n[4] Tb changes UID=552916 to Read status\n> 20:33:54 yim TLOG xi=17 cm=16 uid store 552916 +Flags (\\Seen)\n> FLAGGED\n> 20:33:54 yim TLOG xi=17 cm=17 IDLE\n\n[5] Tb starts upload of modified mail data\n> 20:35:00 yim TLOG xi=17 cm=18 append \"INBOX\" (\\Seen) \"09-Oct-2011 22:38:33 -0400\" {215610}\n\n[6] It seems something wrong happens at server, even sent data is data of appended mail.\n> 20:35:00 yim TLOG xi=17 cm=Received: from flpi407.ffdc.sbc.com ([150.234.117.113])\n> UNKNOWN COMMAND\n> 20:35:00 yim UNKN no=mailpo3 ms=unknown_command cm=from flpi407.ffdc.sbc.com ([150.234.117.113]) xi=17 ip=135.91.66.239\n\n> (many next log pattern lines are snipped)\n> (log pattern)\n>   \" TLOG xi=17 cm={message header line data of appended mail}\"\n>   => some \"UNKN no=mailpo3 ...\", some \"TLOG xi=17 cm=??\"\n>      some \"ms=unknown_command cm=...\"\n\n> 20:35:00 yim TLOG xi=17 cm=UEsDBBQABgAIAAAAIQA1PI0W7QEAAHgMAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAAC\n> (572 lines of \"TLOG xi=17 cm=...\" for base64 encoded data for pptx file is snipped)\n\n> (many log lines of \"TLOG xi=17 cm=...\" and \"PIPE no=mailpo3 ms=received_SIGPIPE ...\" \n\n[7] Tb seems to execute login again after one second.\n> 20:35:01 yim TLOG xi=17 cm=1 capability\n> 20:35:01 yim TLOG xi=17 cm=2 authenticate plain\n> 20:35:01 yim TLOG ms=sasl_trace co=+  xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG ms=sasl_trace cm=AGhhbgBhbGljaWEt?? xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG ms=sasl_trace co= xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG xi=17 cm=3 ID (\"name\" \"Thunderbird\" \"version\" \"7.0.1\")\n> 20:35:01 yim TLOG xi=17 cm=4 select \"INBOX\"\n> 20:35:01 yim FOPN no=mailpo3 xi=17 to=[ml00000000003055@po100groupb]han@maillennium.att.com ui=2 zf=137 fo=inbox\n> 20:35:01 yim TLOG xi=17 cm=5 getquotaroot \"INBOX\"\n> 20:35:01 yim TLOG xi=17 cm=6 UID fetch 1:* (FLAGS)\n\n[8] Tb deletes UID=551337\n> 20:35:01 yim TLOG xi=17 cm=7 uid store 551337 +Flags (\\Seen \\Deleted)\n> 20:35:01 yim TLOG xi=17 cm=8 IDLE\n\n[9] Next new mail check. \n    Because \"fetch 552949:* (FLAGS)\", Tb doesn't know UID of appended mail yet.\n> 20:35:31 yim TLOG xi=17 cm=9 noop\n> 20:35:31 yim TLOG xi=17 cm=10 getquotaroot \"INBOX\"\n> 20:35:31 yim TLOG xi=17 cm=11 UID fetch 552949:* (FLAGS)\n> 20:35:31 yim TLOG xi=17 cm=12 IDLE\n> 20:36:35 yim TLOG xi=17 cm=13 uid store 552948 +Flags (\\Seen)\n> 20:36:35 yim TLOG xi=17 cm=14 IDLE\n\nIt looks \"detach or delete operation on UID=551337\".\nDoes your server return OK or ERR or BAD to append command?\nOr silently kills connection?\nCan you attach Tb side IMAP log with timestamp too?\n\nAt step [2], delete of UID=551330 is seen during IDLE interval. Do you enable automatic purge of mail by Retention Policy, by option to delete Read mail automatically, and so on?\n\nDoes your problem occur even on small mail? (detach/delete of small text/plain mail with an attachment of one line text/plain file)", "bug_id": 693353, "attachment_id": null, "raw_text": "(In reply to digixmax from comment #4)\n> Mail Server Log file extract for the failed Detach transaction\n\n[1] Tb opens Inbox\n> 20:31:04 yim TLOG xi=17 cm=7 select \"INBOX\"\n> OPENED\n> 20:31:04 yim TLOG xi=17 cm=8 getquotaroot \"INBOX\"\n> 20:31:04 yim TLOG xi=17 cm=9 UID fetch 1:* (FLAGS)\n\n[2] Tb deletes UID= 551330\n> 20:31:05 yim TLOG xi=17 cm=10 uid store 551330 +Flags (\\Seen \\Deleted)\n> FLAGGED\n> 20:31:05 yim TLOG xi=17 cm=11 IDLE\n\n[3] Check for new messages in Inbox. Highest UID=552948, because of fetch 552949:* (FLAGS)\"\n> 20:32:45 yim TLOG xi=17 cm=12 noop\n> 20:32:45 yim TLOG xi=17 cm=13 getquotaroot \"INBOX\"\n> 20:32:45 yim TLOG xi=17 cm=14 UID fetch 552949:* (FLAGS)\n> 20:32:45 yim TLOG xi=17 cm=15 IDLE\n\n[4] Tb changes UID=552916 to Read status\n> 20:33:54 yim TLOG xi=17 cm=16 uid store 552916 +Flags (\\Seen)\n> FLAGGED\n> 20:33:54 yim TLOG xi=17 cm=17 IDLE\n\n[5] Tb starts upload of modified mail data\n> 20:35:00 yim TLOG xi=17 cm=18 append \"INBOX\" (\\Seen) \"09-Oct-2011 22:38:33 -0400\" {215610}\n\n[6] It seems something wrong happens at server, even sent data is data of appended mail.\n> 20:35:00 yim TLOG xi=17 cm=Received: from flpi407.ffdc.sbc.com ([150.234.117.113])\n> UNKNOWN COMMAND\n> 20:35:00 yim UNKN no=mailpo3 ms=unknown_command cm=from flpi407.ffdc.sbc.com ([150.234.117.113]) xi=17 ip=135.91.66.239\n\n> (many next log pattern lines are snipped)\n> (log pattern)\n>   \" TLOG xi=17 cm={message header line data of appended mail}\"\n>   => some \"UNKN no=mailpo3 ...\", some \"TLOG xi=17 cm=??\"\n>      some \"ms=unknown_command cm=...\"\n\n> 20:35:00 yim TLOG xi=17 cm=UEsDBBQABgAIAAAAIQA1PI0W7QEAAHgMAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAAC\n> (572 lines of \"TLOG xi=17 cm=...\" for base64 encoded data for pptx file is snipped)\n\n> (many log lines of \"TLOG xi=17 cm=...\" and \"PIPE no=mailpo3 ms=received_SIGPIPE ...\" \n\n[7] Tb seems to execute login again after one second.\n> 20:35:01 yim TLOG xi=17 cm=1 capability\n> 20:35:01 yim TLOG xi=17 cm=2 authenticate plain\n> 20:35:01 yim TLOG ms=sasl_trace co=+  xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG ms=sasl_trace cm=AGhhbgBhbGljaWEt?? xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG ms=sasl_trace co= xi=17 ip=135.91.66.239\n> 20:35:01 yim TLOG xi=17 cm=3 ID (\"name\" \"Thunderbird\" \"version\" \"7.0.1\")\n> 20:35:01 yim TLOG xi=17 cm=4 select \"INBOX\"\n> 20:35:01 yim FOPN no=mailpo3 xi=17 to=[ml00000000003055@po100groupb]han@maillennium.att.com ui=2 zf=137 fo=inbox\n> 20:35:01 yim TLOG xi=17 cm=5 getquotaroot \"INBOX\"\n> 20:35:01 yim TLOG xi=17 cm=6 UID fetch 1:* (FLAGS)\n\n[8] Tb deletes UID=551337\n> 20:35:01 yim TLOG xi=17 cm=7 uid store 551337 +Flags (\\Seen \\Deleted)\n> 20:35:01 yim TLOG xi=17 cm=8 IDLE\n\n[9] Next new mail check. \n    Because \"fetch 552949:* (FLAGS)\", Tb doesn't know UID of appended mail yet.\n> 20:35:31 yim TLOG xi=17 cm=9 noop\n> 20:35:31 yim TLOG xi=17 cm=10 getquotaroot \"INBOX\"\n> 20:35:31 yim TLOG xi=17 cm=11 UID fetch 552949:* (FLAGS)\n> 20:35:31 yim TLOG xi=17 cm=12 IDLE\n> 20:36:35 yim TLOG xi=17 cm=13 uid store 552948 +Flags (\\Seen)\n> 20:36:35 yim TLOG xi=17 cm=14 IDLE\n\nIt looks \"detach or delete operation on UID=551337\".\nDoes your server return OK or ERR or BAD to append command?\nOr silently kills connection?\nCan you attach Tb side IMAP log with timestamp too?\n\nAt step [2], delete of UID=551330 is seen during IDLE interval. Do you enable automatic purge of mail by Retention Policy, by option to delete Read mail automatically, and so on?\n\nDoes your problem occur even on small mail? (detach/delete of small text/plain mail with an attachment of one line text/plain file)"}, {"is_private": false, "id": 5807843, "count": 6, "creator": "m-wada@usa.com", "creation_time": "2011-10-27T00:11:33Z", "time": "2011-10-27T00:11:33Z", "author": "m-wada@usa.com", "attachment_id": null, "raw_text": "Can you see your problem with \"max cached connections=1\"?\n(Server Settings/Advanced of Tb, Disable \"IDLE command use\" too, for ease of problem analysis.)", "bug_id": 693353, "text": "Can you see your problem with \"max cached connections=1\"?\n(Server Settings/Advanced of Tb, Disable \"IDLE command use\" too, for ease of problem analysis.)", "tags": []}, {"is_private": false, "id": 5807863, "count": 7, "author": "m-wada@usa.com", "creator": "m-wada@usa.com", "time": "2011-10-27T00:17:26Z", "creation_time": "2011-10-27T00:17:26Z", "raw_text": "For ease of problem analysis, show \"Order Received\" column to know UID of detached/deleted mail and newly uploaded mail. The column value of Tb is UID of mail when IMAP folder.", "attachment_id": null, "bug_id": 693353, "text": "For ease of problem analysis, show \"Order Received\" column to know UID of detached/deleted mail and newly uploaded mail. The column value of Tb is UID of mail when IMAP folder.", "tags": []}, {"count": 8, "id": 5954852, "is_private": false, "creation_time": "2012-01-04T19:31:45Z", "time": "2012-01-04T19:31:45Z", "creator": "vseerror@lehigh.edu", "author": "vseerror@lehigh.edu", "attachment_id": null, "raw_text": "digixmax, can you reply please?", "text": "digixmax, can you reply please?", "bug_id": 693353, "tags": []}, {"count": 9, "id": 5956419, "is_private": false, "author": "m-wada@usa.com", "time": "2012-01-05T07:42:57Z", "creation_time": "2012-01-05T07:42:57Z", "creator": "m-wada@usa.com", "raw_text": "I could see \"uid store xx Flag (\\Deleted)\" by Tb 9 after connection error while moving a mail in IMAP offline-use=off folder to local mail folder by Drag&Drop, during test for bug 522675.\nSimilar \"uid store xx Flag (\\Deleted)\" perhaps happens when \"append of mail data for detach/delete\"(similar to moving of mail in IMAP folder to other IMAP server's mail folder).\n\nSetting dependency to bug 522675 for ease of problem analysis.", "attachment_id": null, "tags": [], "text": "I could see \"uid store xx Flag (\\Deleted)\" by Tb 9 after connection error while moving a mail in IMAP offline-use=off folder to local mail folder by Drag&Drop, during test for bug 522675.\nSimilar \"uid store xx Flag (\\Deleted)\" perhaps happens when \"append of mail data for detach/delete\"(similar to moving of mail in IMAP folder to other IMAP server's mail folder).\n\nSetting dependency to bug 522675 for ease of problem analysis.", "bug_id": 693353}, {"attachment_id": null, "raw_text": "Sorry Wayne, but it would virtually impossible for me to get new or more server-side diagnostic info/logs (as folks who can do this have other work as their real assignments :-) ).\n\nIf there is Tb side diagnostic info/log I can gather, I would be happy to try reproducing the errors and capture the info/log with how-to pointers from you/WADA.", "bug_id": 693353, "text": "Sorry Wayne, but it would virtually impossible for me to get new or more server-side diagnostic info/logs (as folks who can do this have other work as their real assignments :-) ).\n\nIf there is Tb side diagnostic info/log I can gather, I would be happy to try reproducing the errors and capture the info/log with how-to pointers from you/WADA.", "tags": [], "count": 10, "id": 5958208, "is_private": false, "creation_time": "2012-01-05T20:11:17Z", "time": "2012-01-05T20:11:17Z", "creator": "digixmax@gmail.com", "author": "digixmax@gmail.com"}, {"attachment_id": null, "raw_text": "I just experienced another type of message-loss problem: declassifying as \"Junk\" a message in the Junk folder caused that message to disappear rather than get moved to the Inbox.", "text": "I just experienced another type of message-loss problem: declassifying as \"Junk\" a message in the Junk folder caused that message to disappear rather than get moved to the Inbox.", "bug_id": 693353, "tags": [], "is_private": false, "count": 11, "id": 5959477, "creator": "digixmax@gmail.com", "time": "2012-01-06T02:54:19Z", "creation_time": "2012-01-06T02:54:19Z", "author": "digixmax@gmail.com"}, {"attachment_id": null, "raw_text": "Tb side diagnostic info/log you can gather: See bug 402793 comment #28, please.", "tags": [], "text": "Tb side diagnostic info/log you can gather: See bug 402793 comment #28, please.", "bug_id": 693353, "id": 5959786, "count": 12, "is_private": false, "time": "2012-01-06T06:47:12Z", "creation_time": "2012-01-06T06:47:12Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"bug_id": 693353, "text": "Created attachment 588872\nThunderbird log file for a failed Detach transaction\n\nThis is the TB-side log file for a failed Detach transaction.\n\nAt TB start-up, the Inbox contained a single message with attachment.  The message's attachment was detached (and was successfully saved to the user-designated location), then the message irrecoverably disappeared from Inbox.", "tags": [], "attachment_id": 588872, "raw_text": "This is the TB-side log file for a failed Detach transaction.\n\nAt TB start-up, the Inbox contained a single message with attachment.  The message's attachment was detached (and was successfully saved to the user-designated location), then the message irrecoverably disappeared from Inbox.", "creator": "digixmax@gmail.com", "creation_time": "2012-01-16T15:15:26Z", "time": "2012-01-16T15:15:26Z", "author": "digixmax@gmail.com", "is_private": false, "count": 13, "id": 5982748}, {"is_private": false, "id": 5982780, "count": 14, "creator": "digixmax@gmail.com", "time": "2012-01-16T15:37:37Z", "creation_time": "2012-01-16T15:37:37Z", "author": "digixmax@gmail.com", "attachment_id": null, "raw_text": "The Junk box message problem I identified in my Comment #11 appear to pertain only to those Junk box messages that contain some attachment(s). Thus the common thread between this problem and the original problem is that the affected messages in both cases all contain attachment(s); the difference is in this case the trigger is a Declassifying of the message's \"Junk\" status and not a Detach operation on the message's Attachments.", "bug_id": 693353, "text": "The Junk box message problem I identified in my Comment #11 appear to pertain only to those Junk box messages that contain some attachment(s). Thus the common thread between this problem and the original problem is that the affected messages in both cases all contain attachment(s); the difference is in this case the trigger is a Declassifying of the message's \"Junk\" status and not a Detach operation on the message's Attachments.", "tags": []}, {"attachment_id": null, "raw_text": "(In reply to digixmax from comment #13)\n> Thunderbird log file for a failed Detach transaction\n\n(1) Tb tries APPEND at Inbox for detach'ed mail\n(2) Server rejects APPEND by NO, because too old mail\n(3) Even though NO response, Tb sends mail data, then server returns BAD\n(4) Tb sends LOGOUT, close socket \n(5) Tb opens new connection, SELECT Inbox, and stores \\Deleted flag(UID=588694) \nIt looks problem like \"NO response to APPEND command is not processed well or is ignored\".\n\n\"Declassifying of the message's Junk status\" currently forces \"Move unmarked mail from Junk to Inbox\", and Tb executes UID COPY(to Inbox) & UID STORE Flags \\Deleted at Junk. If server rejects UID COPY by NO response because of \"too old mail\", same thing may occur.\n\nRecovery operation:\n  At Server Settings, set IMAP delete model = Just mark it as deleted,\n  Undelete mail, to which \\Deleted is wrongly stored, which is shown with\n  strike-thru line at thread pane.\n\n(At first socket, 4488[31f7680]: 583f800:, call Socket-1, session #1 starts)\n> 2012-01-16 14:49:45.953000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:SendData: 2 authenticate plain\n> 2012-01-16 14:49:46.047000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: 2 OK LOGIN session #1\n(At Socket-1/session #1, APPEND to Inbox is executed)\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: 8 UID fetch 1:* (FLAGS)\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (UID 588694 FLAGS (\\Seen))\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 8 OK UID fetch completed\n> 2012-01-16 14:50:06.755000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL: entering\n> 2012-01-16 14:50:06.755000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL:imap://han@proxy.maillennium.att.com:3143/appendmsgfromfile%3E/INBOX:  = currentUrl\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\" {6638}\n(However, server rejects it by NO response, because too old mail for server)\n( 86400 seconds = 24 hours = 1 day )\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 10 NO APPEND attempt to set internal date back more than 86400 seconds\n(Even though NO to APPEND, Tb sends mail data)\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: Received: from alpd052.aldc.att.com ([130.8.42.31])\n          by maillennium.att.com (mailgw1) with ESMTP\n          id <20120113173014gw100e1il0e>; Fri, 13 Jan 2012 17:30:14 +0000\n(snip)\nMessage-ID: <4F106A86.7040000@maillennium.att.com>\nDate: Fri, 13 Jan 2012 12:31:50 -0500\n(snip)\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: \n(So, server reject it by BAD response)\n> 2012-01-16 14:50:06.786000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: Received: BAD Try 'HELP' - unrecognized\n(Tb detects something wrong by BAD, then sends LOGOUT, and close Socket-1. session #1 is closed)\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:SendData: 11 logout\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: * BAD Try 'HELP' - unrecognized\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: * ID (\"name\" \"maillennium\" \"version\" \"V05.40c++\" \"os\" \"os_solaris_bsd\" \"vendor\" \"AT&T Labs\")\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:TellThreadToDie: close socket connection\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: ImapThreadMainLoop leaving [this=583f800]\n(At second socket, 5372[31f8440]: 3fcf800:, call Socket-2, session #1 starts again)\n> 2012-01-16 14:50:07.083000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:NA:SendData: 2 authenticate plain\n> 2012-01-16 14:50:07.099000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: 2 OK LOGIN session #1\n(At Socket-2/session #1, Tb select Inbox and store \\Deleted flag to UID=588694)\n> 2012-01-16 14:50:07.099000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:SendData: 6 UID fetch 1:* (FLAGS)\n> 2012-01-16 14:50:07.130000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (UID 588694 FLAGS (\\Seen))\n> 2012-01-16 14:50:07.130000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 6 OK UID fetch completed\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: queuing url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: considering playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: failed creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: considering playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL: entering\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL:imap://han@proxy.maillennium.att.com:3143/addmsgflags%3EUID%3E/INBOX%3E588694%3E9:  = currentUrl\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:SendData: 7 uid store 588694 +Flags (\\Seen \\Deleted)\n> 2012-01-16 14:50:07.224000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (FLAGS (\\Deleted \\Seen) UID 588694)\n> 2012-01-16 14:50:07.224000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 7 OK UID store completed", "tags": [], "text": "(In reply to digixmax from comment #13)\n> Thunderbird log file for a failed Detach transaction\n\n(1) Tb tries APPEND at Inbox for detach'ed mail\n(2) Server rejects APPEND by NO, because too old mail\n(3) Even though NO response, Tb sends mail data, then server returns BAD\n(4) Tb sends LOGOUT, close socket \n(5) Tb opens new connection, SELECT Inbox, and stores \\Deleted flag(UID=588694) \nIt looks problem like \"NO response to APPEND command is not processed well or is ignored\".\n\n\"Declassifying of the message's Junk status\" currently forces \"Move unmarked mail from Junk to Inbox\", and Tb executes UID COPY(to Inbox) & UID STORE Flags \\Deleted at Junk. If server rejects UID COPY by NO response because of \"too old mail\", same thing may occur.\n\nRecovery operation:\n  At Server Settings, set IMAP delete model = Just mark it as deleted,\n  Undelete mail, to which \\Deleted is wrongly stored, which is shown with\n  strike-thru line at thread pane.\n\n(At first socket, 4488[31f7680]: 583f800:, call Socket-1, session #1 starts)\n> 2012-01-16 14:49:45.953000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:SendData: 2 authenticate plain\n> 2012-01-16 14:49:46.047000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: 2 OK LOGIN session #1\n(At Socket-1/session #1, APPEND to Inbox is executed)\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: 8 UID fetch 1:* (FLAGS)\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (UID 588694 FLAGS (\\Seen))\n> 2012-01-16 14:49:46.500000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 8 OK UID fetch completed\n> 2012-01-16 14:50:06.755000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL: entering\n> 2012-01-16 14:50:06.755000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL:imap://han@proxy.maillennium.att.com:3143/appendmsgfromfile%3E/INBOX:  = currentUrl\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\" {6638}\n(However, server rejects it by NO response, because too old mail for server)\n( 86400 seconds = 24 hours = 1 day )\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 10 NO APPEND attempt to set internal date back more than 86400 seconds\n(Even though NO to APPEND, Tb sends mail data)\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: Received: from alpd052.aldc.att.com ([130.8.42.31])\n          by maillennium.att.com (mailgw1) with ESMTP\n          id <20120113173014gw100e1il0e>; Fri, 13 Jan 2012 17:30:14 +0000\n(snip)\nMessage-ID: <4F106A86.7040000@maillennium.att.com>\nDate: Fri, 13 Jan 2012 12:31:50 -0500\n(snip)\n> 2012-01-16 14:50:06.771000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:SendData: \n(So, server reject it by BAD response)\n> 2012-01-16 14:50:06.786000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: Received: BAD Try 'HELP' - unrecognized\n(Tb detects something wrong by BAD, then sends LOGOUT, and close Socket-1. session #1 is closed)\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:SendData: 11 logout\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: * BAD Try 'HELP' - unrecognized\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: * ID (\"name\" \"maillennium\" \"version\" \"V05.40c++\" \"os\" \"os_solaris_bsd\" \"vendor\" \"AT&T Labs\")\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: 583f800:proxy.maillennium.att.com:NA:TellThreadToDie: close socket connection\n> 2012-01-16 14:50:07.083000 UTC - 4488[31f7680]: ImapThreadMainLoop leaving [this=583f800]\n(At second socket, 5372[31f8440]: 3fcf800:, call Socket-2, session #1 starts again)\n> 2012-01-16 14:50:07.083000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:NA:SendData: 2 authenticate plain\n> 2012-01-16 14:50:07.099000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:NA:CreateNewLineFromSocket: 2 OK LOGIN session #1\n(At Socket-2/session #1, Tb select Inbox and store \\Deleted flag to UID=588694)\n> 2012-01-16 14:50:07.099000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:SendData: 6 UID fetch 1:* (FLAGS)\n> 2012-01-16 14:50:07.130000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (UID 588694 FLAGS (\\Seen))\n> 2012-01-16 14:50:07.130000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 6 OK UID fetch completed\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: queuing url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: considering playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.130000 UTC - 0[f0f140]: failed creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: considering playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: creating protocol instance to play queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 0[f0f140]: playing queued url:imap://han@proxy.maillennium.att.com:3143/addmsgflags>UID>/INBOX>588694>9\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL: entering\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:ProcessCurrentURL:imap://han@proxy.maillennium.att.com:3143/addmsgflags%3EUID%3E/INBOX%3E588694%3E9:  = currentUrl\n> 2012-01-16 14:50:07.193000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:SendData: 7 uid store 588694 +Flags (\\Seen \\Deleted)\n> 2012-01-16 14:50:07.224000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: * 1 FETCH (FLAGS (\\Deleted \\Seen) UID 588694)\n> 2012-01-16 14:50:07.224000 UTC - 5372[31f8440]: 3fcf800:proxy.maillennium.att.com:S-INBOX:CreateNewLineFromSocket: 7 OK UID store completed", "bug_id": 693353, "count": 15, "id": 5983991, "is_private": false, "time": "2012-01-17T00:19:03Z", "creation_time": "2012-01-17T00:19:03Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"count": 16, "id": 5984067, "is_private": false, "author": "m-wada@usa.com", "time": "2012-01-17T01:02:08Z", "creation_time": "2012-01-17T01:02:08Z", "creator": "m-wada@usa.com", "raw_text": "Confirming per IMAP log.", "attachment_id": null, "tags": [], "bug_id": 693353, "text": "Confirming per IMAP log."}, {"author": "m-wada@usa.com", "creation_time": "2012-01-17T02:09:03Z", "time": "2012-01-17T02:09:03Z", "creator": "m-wada@usa.com", "id": 5984186, "count": 17, "is_private": false, "tags": [], "bug_id": 693353, "text": "> :S-INBOX:SendData: 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\" {6638}\n> :S-INBOX:CreateNewLineFromSocket: 10 NO APPEND attempt to set internal date back more than 86400 seconds\n> ( 86400 seconds = 24 hours = 1 day )\n\nIf your server rejects \"UID xx COPY Inbox\" at other than Inbox if old mail(before 1 day or more) too, your server rejects any of next.\n- Copy old mail to Inbox from other folder of same IMAP account \n- Move old mail to Inbox from other folder of same IMAP account\n  (Mark as Non-Junk currently forces \"Move of the mail from Junk to Inbox\")\nIs it right?", "raw_text": "> :S-INBOX:SendData: 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\" {6638}\n> :S-INBOX:CreateNewLineFromSocket: 10 NO APPEND attempt to set internal date back more than 86400 seconds\n> ( 86400 seconds = 24 hours = 1 day )\n\nIf your server rejects \"UID xx COPY Inbox\" at other than Inbox if old mail(before 1 day or more) too, your server rejects any of next.\n- Copy old mail to Inbox from other folder of same IMAP account \n- Move old mail to Inbox from other folder of same IMAP account\n  (Mark as Non-Junk currently forces \"Move of the mail from Junk to Inbox\")\nIs it right?", "attachment_id": null}, {"tags": [], "text": "Yes, Re-marking a message in Junk box as \"not Junk\" would normally move the message to Inbox.", "bug_id": 693353, "raw_text": "Yes, Re-marking a message in Junk box as \"not Junk\" would normally move the message to Inbox.", "attachment_id": null, "author": "digixmax@gmail.com", "creation_time": "2012-01-17T04:41:42Z", "time": "2012-01-17T04:41:42Z", "creator": "digixmax@gmail.com", "id": 5984380, "count": 18, "is_private": false}, {"tags": [], "bug_id": 693353, "text": "For NO to APPEND with date/time string.\n> 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\"\n> 10 NO APPEND attempt to set internal date back more than 86400 seconds\n\n(A) Because of SHOULD and not MUST, \"NO\" response due to old date/time is never RFC violation by server.\n\n(B) \"13-Jan-2012 12:31:50 -0500\" is perhaps come from Date: header of mail.\n> Date: Fri, 13 Jan 2012 12:31:50 -0500\nIs append request with \"internal date of mail's Date:\" mandatory?\nWhat's wrong with no data/time parameter? (current date is set as internal date)\n\nhttp://tools.ietf.org/html/rfc3501#section-6.3.11\n> 6.3.11. APPEND Command\n>    Arguments:  mailbox name\n>                OPTIONAL flag parenthesized list\n>                OPTIONAL date/time string\n>                message literal\n>(snip) \n>       If a date-time is specified, the internal date SHOULD be set in\n>       the resulting message; otherwise, the internal date of the\n>       resulting message is set to the current date and time by default.", "attachment_id": null, "raw_text": "For NO to APPEND with date/time string.\n> 10 append \"INBOX\" (\\Seen) \"13-Jan-2012 12:31:50 -0500\"\n> 10 NO APPEND attempt to set internal date back more than 86400 seconds\n\n(A) Because of SHOULD and not MUST, \"NO\" response due to old date/time is never RFC violation by server.\n\n(B) \"13-Jan-2012 12:31:50 -0500\" is perhaps come from Date: header of mail.\n> Date: Fri, 13 Jan 2012 12:31:50 -0500\nIs append request with \"internal date of mail's Date:\" mandatory?\nWhat's wrong with no data/time parameter? (current date is set as internal date)\n\nhttp://tools.ietf.org/html/rfc3501#section-6.3.11\n> 6.3.11. APPEND Command\n>    Arguments:  mailbox name\n>                OPTIONAL flag parenthesized list\n>                OPTIONAL date/time string\n>                message literal\n>(snip) \n>       If a date-time is specified, the internal date SHOULD be set in\n>       the resulting message; otherwise, the internal date of the\n>       resulting message is set to the current date and time by default.", "time": "2012-01-17T05:44:58Z", "creation_time": "2012-01-17T05:44:58Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com", "count": 19, "id": 5984440, "is_private": false}, {"author": "digixmax@gmail.com", "creation_time": "2012-01-18T14:27:10Z", "time": "2012-01-18T14:27:10Z", "creator": "digixmax@gmail.com", "id": 5988616, "count": 20, "is_private": false, "text": "I want to amend my comment #14: I just had two incidents of re-marked Junk box message disappearing in which the lost messages do not contain any attachment nor are the messages over a day old (thereby would be rejected by the IMAP mail server).", "bug_id": 693353, "tags": [], "raw_text": "I want to amend my comment #14: I just had two incidents of re-marked Junk box message disappearing in which the lost messages do not contain any attachment nor are the messages over a day old (thereby would be rejected by the IMAP mail server).", "attachment_id": null}, {"author": "digixmax@gmail.com", "creator": "digixmax@gmail.com", "time": "2012-01-18T22:04:53Z", "creation_time": "2012-01-18T22:04:53Z", "is_private": false, "count": 21, "id": 5990171, "tags": [], "bug_id": 693353, "text": "Created attachment 589640\nThunderbird log file for a failed Junk Re-Marking transaction\n\nTwo messages in Junk box, one old and one new, were selected successfully and re-marked as \"not Junk\", i.e., they got moved into the Inbox.  These same two messages were next re-marked as \"Junk\": they then disappeared instead of getting moved (back) into Junk box.", "raw_text": "Two messages in Junk box, one old and one new, were selected successfully and re-marked as \"not Junk\", i.e., they got moved into the Inbox.  These same two messages were next re-marked as \"Junk\": they then disappeared instead of getting moved (back) into Junk box.", "attachment_id": 589640}, {"raw_text": "FYI. I've opened bug 720919 for issue of comment #19.", "attachment_id": null, "tags": [], "bug_id": 693353, "text": "FYI. I've opened bug 720919 for issue of comment #19.", "id": 6006623, "count": 22, "is_private": false, "author": "m-wada@usa.com", "time": "2012-01-25T02:24:08Z", "creation_time": "2012-01-25T02:24:08Z", "creator": "m-wada@usa.com"}, {"is_private": false, "id": 6006723, "count": 23, "creator": "m-wada@usa.com", "creation_time": "2012-01-25T03:35:21Z", "time": "2012-01-25T03:35:21Z", "author": "m-wada@usa.com", "attachment_id": null, "raw_text": "(In reply to digixmax from comment #21)\n> Thunderbird log file for a failed Junk Re-Marking transaction\n\n(A) UID is not always returned to \"uid copy\". It looks to depend on Mbox or existent mail.\n(A-1) Your server supports UIDPLUS.\n> * CAPABILITY IMAP4rev1 AUTH=ANONYMOUS AUTH=CRAM-MD5 AUTH=LOGIN AUTH=NTLM\n>   AUTH=PLAIN ID IDLE QUOTA VND.ATT.MIGRATE STARTTLS UIDPLUS XMEXT\n(A-2) uid copy to Inbox returns UID. \n> At Junk\n> 15 uid copy 589570 \"INBOX\"\n> 15 OK [COPYUID 2 589570 589581] UID COPY complete\n(A-3) uid copy to Junk doesn't return UID. \n> At INBOX\n> 26 uid copy 589582 \"Junk\"\n> 26 OK UID COPY complete\n\n(B) Your server looks to do nothing for \"uid copy from other Mbox\" if same mail already exists in copy destination Mbox.\n(B-1) At Junk, Mark As Non-Junk, store \\Deleted after copy to INBOX\n> At Junk\n> 16 uid store 589570 +FLAGS (\\Deleted \\Seen)\n> * 7 FETCH (FLAGS (\\Deleted \\Recent \\Seen) UID 589570)\n> 16 OK UID store completed\n> 25 uid store 576300 +FLAGS (\\Deleted \\Seen)\n> * 2 FETCH (FLAGS (\\Answered \\Deleted \\Seen) UID 576300)\n> 25 OK UID store completed\n(B-2) At INBOX, Mark As Junk again, copy to Junk, and store \\Deleted at INBOX.\n      UID is not returned even though UIDPLUS is returned in CAPABILITY response.\n> At INBOX\n> 26 uid copy 589582 \"Junk\"\n> 26 OK UID COPY complete\n> 36 uid copy 589581 \"Junk\"\n> 36 OK UID COPY complete\n(B-3) At Junk, Tb request fetch of newest mails in Junk.\n      Because highest UID in Junk just before (B-2) was UID=589570,\n      Tb requests UID fetch 589571:* (FLAGS), but nothing is returned.\n> 28 UID fetch 589571:* (FLAGS)\n> * 7 FETCH (UID 589570 FLAGS (\\Deleted \\Recent \\Seen))\n> 28 OK UID fetch completed\n(B-4) Because OK is returned to copy from INBOX to Junk at (B-2), (B-3) means;\n(1) By copy to Junk at (B-2), UID=589571(seq=8), UID=589572(seq=9) is crated.\n(2) Between (B-2) and (B-3), UID=589571(seq=8), UID=589572(seq=9) is deleted\n    and purged by other IMAP client or IMAP server.\n(3) Because \"UID 589570 FLAGS (\\Deleted \\Recent \\Seen)\" was returned, \n    your server didn't do \"Undelete\" operation when same mail is copied from\n    other Mbox.\n\nBecause your IMAP server doesn't return data for copied back mail in Junk even though your server returned OK to uid copy(but without UID even though UIDPLUS enabled), Tb can do nothing.\n\"OK to uid copy but without UID even though UIDPLUS enabled\" of your server may be a phenomenon of \"rejection due to too old mail date\" in \"uid copy\".\n\nAbove repeated \"Mark As Junk, Mark as Non-Junk\" is same as repeated \"Move a mail from Inbox to Junk, move back the mail from Junk to Inbox, Move back the mail from Inbox to Junk, Move back the mail from Junk to Inbox, ...\".\nNo problem if other mailer when such operation?\n\nWorkaround is \"Just mark it as deleted\" with showing \"order Received\" column(UID). Even if your servers behaviour is confusing, and even if Tb has bug in \"NO to append\" processing, deleted mail is shown with strike-thru line at threadd pane of Tb. So, worst \"data loss\" is avoided.", "tags": [], "bug_id": 693353, "text": "(In reply to digixmax from comment #21)\n> Thunderbird log file for a failed Junk Re-Marking transaction\n\n(A) UID is not always returned to \"uid copy\". It looks to depend on Mbox or existent mail.\n(A-1) Your server supports UIDPLUS.\n> * CAPABILITY IMAP4rev1 AUTH=ANONYMOUS AUTH=CRAM-MD5 AUTH=LOGIN AUTH=NTLM\n>   AUTH=PLAIN ID IDLE QUOTA VND.ATT.MIGRATE STARTTLS UIDPLUS XMEXT\n(A-2) uid copy to Inbox returns UID. \n> At Junk\n> 15 uid copy 589570 \"INBOX\"\n> 15 OK [COPYUID 2 589570 589581] UID COPY complete\n(A-3) uid copy to Junk doesn't return UID. \n> At INBOX\n> 26 uid copy 589582 \"Junk\"\n> 26 OK UID COPY complete\n\n(B) Your server looks to do nothing for \"uid copy from other Mbox\" if same mail already exists in copy destination Mbox.\n(B-1) At Junk, Mark As Non-Junk, store \\Deleted after copy to INBOX\n> At Junk\n> 16 uid store 589570 +FLAGS (\\Deleted \\Seen)\n> * 7 FETCH (FLAGS (\\Deleted \\Recent \\Seen) UID 589570)\n> 16 OK UID store completed\n> 25 uid store 576300 +FLAGS (\\Deleted \\Seen)\n> * 2 FETCH (FLAGS (\\Answered \\Deleted \\Seen) UID 576300)\n> 25 OK UID store completed\n(B-2) At INBOX, Mark As Junk again, copy to Junk, and store \\Deleted at INBOX.\n      UID is not returned even though UIDPLUS is returned in CAPABILITY response.\n> At INBOX\n> 26 uid copy 589582 \"Junk\"\n> 26 OK UID COPY complete\n> 36 uid copy 589581 \"Junk\"\n> 36 OK UID COPY complete\n(B-3) At Junk, Tb request fetch of newest mails in Junk.\n      Because highest UID in Junk just before (B-2) was UID=589570,\n      Tb requests UID fetch 589571:* (FLAGS), but nothing is returned.\n> 28 UID fetch 589571:* (FLAGS)\n> * 7 FETCH (UID 589570 FLAGS (\\Deleted \\Recent \\Seen))\n> 28 OK UID fetch completed\n(B-4) Because OK is returned to copy from INBOX to Junk at (B-2), (B-3) means;\n(1) By copy to Junk at (B-2), UID=589571(seq=8), UID=589572(seq=9) is crated.\n(2) Between (B-2) and (B-3), UID=589571(seq=8), UID=589572(seq=9) is deleted\n    and purged by other IMAP client or IMAP server.\n(3) Because \"UID 589570 FLAGS (\\Deleted \\Recent \\Seen)\" was returned, \n    your server didn't do \"Undelete\" operation when same mail is copied from\n    other Mbox.\n\nBecause your IMAP server doesn't return data for copied back mail in Junk even though your server returned OK to uid copy(but without UID even though UIDPLUS enabled), Tb can do nothing.\n\"OK to uid copy but without UID even though UIDPLUS enabled\" of your server may be a phenomenon of \"rejection due to too old mail date\" in \"uid copy\".\n\nAbove repeated \"Mark As Junk, Mark as Non-Junk\" is same as repeated \"Move a mail from Inbox to Junk, move back the mail from Junk to Inbox, Move back the mail from Inbox to Junk, Move back the mail from Junk to Inbox, ...\".\nNo problem if other mailer when such operation?\n\nWorkaround is \"Just mark it as deleted\" with showing \"order Received\" column(UID). Even if your servers behaviour is confusing, and even if Tb has bug in \"NO to append\" processing, deleted mail is shown with strike-thru line at threadd pane of Tb. So, worst \"data loss\" is avoided."}, {"author": "vseerror@lehigh.edu", "creator": "vseerror@lehigh.edu", "creation_time": "2014-02-07T14:12:22Z", "time": "2014-02-07T14:12:22Z", "is_private": false, "id": 8388527, "count": 24, "tags": [], "text": "(bleh - dataloss is ALWAYS critical)", "bug_id": 693353, "raw_text": "(bleh - dataloss is ALWAYS critical)", "attachment_id": null}]}}}