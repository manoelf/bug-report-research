{"bugs": {"642530": {"comments": [{"author": "mozilla@bakerweb.biz", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 0, "bug_id": 642530, "creation_time": "2011-03-17T18:39:28Z", "text": "I have a patch that will disable the \"Reply All\" button if none of the recipients known email addresses appear in the To: or Cc: list.\n\nThe way I did it was to simply add the following code to mailWindowOverlay.js:\n\nif (!imInAddresses) return false;\n\nAfter much consternation I discovered that mail3PaneWindowCommands.js and messageWindow.js were enabling the ReplyAll button by checking IsReplyEnabled() instead of IsReplyAllEnabled(). After fixing those issues I noticed that the Reply All code doesn't enable the Reply All button unless there is more than one recipient of a message (not including myself). That's not how users are used to seeing Thunderbird behave due to the code for that button being hooked up to the IsReplyEnabled(), so I changed the behavior for IsReplyAllEnabled() to match.\n\nHopefully someone will let me know if this is an acceptable direction to go before I clean up the code and submit a clean patch (I have to make a build environment to diff against). If this is not an acceptable default behavior, what about if it's controlled by a preference?", "id": 5351356, "raw_text": "I have a patch that will disable the \"Reply All\" button if none of the recipients known email addresses appear in the To: or Cc: list.\n\nThe way I did it was to simply add the following code to mailWindowOverlay.js:\n\nif (!imInAddresses) return false;\n\nAfter much consternation I discovered that mail3PaneWindowCommands.js and messageWindow.js were enabling the ReplyAll button by checking IsReplyEnabled() instead of IsReplyAllEnabled(). After fixing those issues I noticed that the Reply All code doesn't enable the Reply All button unless there is more than one recipient of a message (not including myself). That's not how users are used to seeing Thunderbird behave due to the code for that button being hooked up to the IsReplyEnabled(), so I changed the behavior for IsReplyAllEnabled() to match.\n\nHopefully someone will let me know if this is an acceptable direction to go before I clean up the code and submit a clean patch (I have to make a build environment to diff against). If this is not an acceptable default behavior, what about if it's controlled by a preference?", "attachment_id": null, "time": "2011-03-17T18:39:28Z", "is_private": false}, {"bug_id": 642530, "tags": [], "count": 1, "creator": "mozilla@bakerweb.biz", "raw_text": "if (!imInAddresses) return false; is added to IsReplyAllEnabled() of course.", "id": 5351424, "text": "if (!imInAddresses) return false; is added to IsReplyAllEnabled() of course.", "creation_time": "2011-03-17T18:55:07Z", "author": "mozilla@bakerweb.biz", "time": "2011-03-17T18:55:07Z", "is_private": false, "attachment_id": null}, {"is_private": false, "creation_time": "2011-03-17T19:26:38Z", "text": "I also have a version that uses a pref. For a placeholder I just tested with:\n\nif (!imInAddresses) return gPrefBranch.getBoolPref(\"mail.test.ReplyAll\");\n\nThe name of the pref doesn't matter.", "id": 5351531, "raw_text": "I also have a version that uses a pref. For a placeholder I just tested with:\n\nif (!imInAddresses) return gPrefBranch.getBoolPref(\"mail.test.ReplyAll\");\n\nThe name of the pref doesn't matter.", "tags": [], "time": "2011-03-17T19:26:38Z", "creator": "mozilla@bakerweb.biz", "count": 2, "bug_id": 642530, "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"attachment_id": null, "time": "2011-03-18T08:26:58Z", "is_private": false, "author": "ludovic@hirlimann.net", "bug_id": 642530, "tags": [], "count": 3, "creator": "ludovic@hirlimann.net", "raw_text": "Jerry could you provide the patch in the normal mozilla way see https://developer.mozilla.org/en/creating_a_patch and attach it here ?\n\nBryan would this behavior something we would want into the product ?", "id": 5352877, "text": "Jerry could you provide the patch in the normal mozilla way see https://developer.mozilla.org/en/creating_a_patch and attach it here ?\n\nBryan would this behavior something we would want into the product ?", "creation_time": "2011-03-18T08:26:58Z"}, {"time": "2011-03-18T14:29:37Z", "is_private": false, "attachment_id": null, "count": 4, "creator": "mozilla@bakerweb.biz", "tags": [], "bug_id": 642530, "id": 5353234, "raw_text": "(In reply to comment #3)\n> Jerry could you provide the patch in the normal mozilla way see\n> https://developer.mozilla.org/en/creating_a_patch and attach it here ?\n\nI am working on it. I'm not sure why, but context menus do not use the same code to see whether Reply or Reply All should be enabled, so I'm hunting down just how those work. I also plan to work on popping a dialog that warns the user but allows them to continue. I figure this can then be an intpref with 0 being to behave as Thunderbird does now, 1 to completely disable the ability to Reply All to messages where you are not in the To: or CC: fields, and 3 to pop a confirmation dialog if you Reply All to a message where you are not in the To: or Cc: field. Once I reach that stage I will make it a patch.\n\nI do have the changes packaged up in an XPI for anyone who would like to try it as it is now. Just be aware that you can still Reply All from a context menu.", "creation_time": "2011-03-18T14:29:37Z", "text": "(In reply to comment #3)\n> Jerry could you provide the patch in the normal mozilla way see\n> https://developer.mozilla.org/en/creating_a_patch and attach it here ?\n\nI am working on it. I'm not sure why, but context menus do not use the same code to see whether Reply or Reply All should be enabled, so I'm hunting down just how those work. I also plan to work on popping a dialog that warns the user but allows them to continue. I figure this can then be an intpref with 0 being to behave as Thunderbird does now, 1 to completely disable the ability to Reply All to messages where you are not in the To: or CC: fields, and 3 to pop a confirmation dialog if you Reply All to a message where you are not in the To: or Cc: field. Once I reach that stage I will make it a patch.\n\nI do have the changes packaged up in an XPI for anyone who would like to try it as it is now. Just be aware that you can still Reply All from a context menu.", "author": "mozilla@bakerweb.biz"}, {"attachment_id": null, "time": "2011-03-18T15:03:42Z", "is_private": false, "author": "mozilla@bakerweb.biz", "creator": "mozilla@bakerweb.biz", "count": 5, "tags": [], "bug_id": 642530, "creation_time": "2011-03-18T15:03:42Z", "text": "Attaching XPI to demonstrate the proposed behavior. This XPI includes my fix to force the \"Reply to All\" context menu item to clone the state of the Reply All button and menu item.\n\nIt might be worth a separate bug to note the fact that a lot of the context menu items do not check whether they should be enabled or not, or at least not the same code as the corresponding toolbar buttons and command menu items.", "id": 5353295, "raw_text": "Attaching XPI to demonstrate the proposed behavior. This XPI includes my fix to force the \"Reply to All\" context menu item to clone the state of the Reply All button and menu item.\n\nIt might be worth a separate bug to note the fact that a lot of the context menu items do not check whether they should be enabled or not, or at least not the same code as the corresponding toolbar buttons and command menu items."}, {"author": "mozilla@bakerweb.biz", "tags": [], "creator": "mozilla@bakerweb.biz", "count": 6, "bug_id": 642530, "creation_time": "2011-03-18T15:05:29Z", "text": "Created attachment 520199\nAn extension demonstrating the proposed changes.", "id": 5353297, "raw_text": "", "attachment_id": 520199, "time": "2011-03-18T15:05:29Z", "is_private": false}, {"is_private": false, "time": "2011-03-18T16:55:07Z", "attachment_id": null, "raw_text": "Ok. I've added in a confirm dialog. I'm stuck at how to properly localize the string literal contained in the confirm dialog as there is no XUL involved.", "id": 5353557, "text": "Ok. I've added in a confirm dialog. I'm stuck at how to properly localize the string literal contained in the confirm dialog as there is no XUL involved.", "creation_time": "2011-03-18T16:55:07Z", "bug_id": 642530, "tags": [], "count": 7, "creator": "mozilla@bakerweb.biz", "author": "mozilla@bakerweb.biz"}, {"bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 8, "text": "Created attachment 520260\nNow with confirm dialog option\n\nSorry for all the bugspam. Here is an extension that is configurable by preference. The default is to check whether a configured email address in Thunderbird is in the To: or Cc: field upon initializing a Reply All and popping a confirm dialog if not. The user can also choose to completely disable Reply All on messages where they're  or just have Thunderbird behave as if it did not have the extension installed.\n\nI believe I have properly localized the JavaScript strings used in the confirm dialog and properly accounted for whether we're looking at a news message vs. email message. Please test and comment before I create a patch (I'm being lazy and don't want to create a build environment just to make a patch until I really have to).", "creation_time": "2011-03-18T18:46:19Z", "raw_text": "Sorry for all the bugspam. Here is an extension that is configurable by preference. The default is to check whether a configured email address in Thunderbird is in the To: or Cc: field upon initializing a Reply All and popping a confirm dialog if not. The user can also choose to completely disable Reply All on messages where they're  or just have Thunderbird behave as if it did not have the extension installed.\n\nI believe I have properly localized the JavaScript strings used in the confirm dialog and properly accounted for whether we're looking at a news message vs. email message. Please test and comment before I create a patch (I'm being lazy and don't want to create a build environment just to make a patch until I really have to).", "id": 5353874, "author": "mozilla@bakerweb.biz", "time": "2011-03-18T18:46:19Z", "is_private": false, "attachment_id": 520260}, {"time": "2011-03-18T21:48:22Z", "is_private": false, "attachment_id": null, "creator": "mozilla@bakerweb.biz", "count": 9, "tags": [], "bug_id": 642530, "id": 5354401, "raw_text": "Trying to create a patch, but there seem to be multiple locations in the tree for the same files. Not sure which ones to update. I need to update the following files:\n\nmail3PaneWindowCommands.js\nmailCommands.js\nmailWindowOverlay.js\nmessageWindow.js\nnsContextMenu.js\n\nBut those files reside in /suite/mailnews/ and in /mail/base/content/\n\nI patched against /mail/base/content/, but I'm still working on adding a .properties file and the proper place to add a default pref.", "creation_time": "2011-03-18T21:48:22Z", "text": "Trying to create a patch, but there seem to be multiple locations in the tree for the same files. Not sure which ones to update. I need to update the following files:\n\nmail3PaneWindowCommands.js\nmailCommands.js\nmailWindowOverlay.js\nmessageWindow.js\nnsContextMenu.js\n\nBut those files reside in /suite/mailnews/ and in /mail/base/content/\n\nI patched against /mail/base/content/, but I'm still working on adding a .properties file and the proper place to add a default pref.", "author": "mozilla@bakerweb.biz"}, {"author": "mozilla@bakerweb.biz", "attachment_id": 520327, "raw_text": "Probably a lot wrong with it, but it's the first stab. Prefer getting this merged into the tree as opposed to as an extension since there a lot of opportunity to collide with other extensions by overriding five different base files.", "id": 5354461, "text": "Created attachment 520327\nFirst stab at a patch\n\nProbably a lot wrong with it, but it's the first stab. Prefer getting this merged into the tree as opposed to as an extension since there a lot of opportunity to collide with other extensions by overriding five different base files.", "creation_time": "2011-03-18T22:10:22Z", "is_private": false, "bug_id": 642530, "time": "2011-03-18T22:10:22Z", "tags": [], "creator": "mozilla@bakerweb.biz", "count": 10}, {"creator": "jporterbugs@gmail.com", "tags": [], "count": 11, "time": "2011-03-18T22:18:16Z", "bug_id": 642530, "is_private": false, "creation_time": "2011-03-18T22:18:16Z", "text": "(In reply to comment #9)\n> But those files reside in /suite/mailnews/ and in /mail/base/content/\n\nsuite/ is Seamonkey and mail/ is Thunderbird. You can probably just patch mail/, but I'm sure the Seamonkey folks wouldn't mind if you made a patch for their stuff too. :)", "id": 5354476, "raw_text": "(In reply to comment #9)\n> But those files reside in /suite/mailnews/ and in /mail/base/content/\n\nsuite/ is Seamonkey and mail/ is Thunderbird. You can probably just patch mail/, but I'm sure the Seamonkey folks wouldn't mind if you made a patch for their stuff too. :)", "attachment_id": null, "author": "jporterbugs@gmail.com"}, {"text": "Created attachment 520338\nFixed patch\n\nFixed a couple small issues. Waiting to get feedback before I go patching Seamonkey.", "creation_time": "2011-03-18T22:42:50Z", "is_private": false, "raw_text": "Fixed a couple small issues. Waiting to get feedback before I go patching Seamonkey.", "id": 5354540, "bug_id": 642530, "time": "2011-03-18T22:42:50Z", "count": 12, "creator": "mozilla@bakerweb.biz", "tags": [], "author": "mozilla@bakerweb.biz", "attachment_id": 520338}, {"time": "2011-03-19T03:59:27Z", "is_private": false, "attachment_id": 520393, "creator": "mozilla@bakerweb.biz", "count": 13, "tags": [], "bug_id": 642530, "creation_time": "2011-03-19T03:59:27Z", "text": "Created attachment 520393\nLatest patch\n\nOK. Work continues. Now the confirmation dialog uses nsIPromptService's confirmEx to present a dialog with YES/NO buttons and a checkbox for \"Don't ask me again.\"", "id": 5355013, "raw_text": "OK. Work continues. Now the confirmation dialog uses nsIPromptService's confirmEx to present a dialog with YES/NO buttons and a checkbox for \"Don't ask me again.\"", "author": "mozilla@bakerweb.biz"}, {"attachment_id": 520396, "is_private": false, "time": "2011-03-19T04:13:06Z", "author": "mozilla@bakerweb.biz", "id": 5355019, "raw_text": "", "creation_time": "2011-03-19T04:13:06Z", "text": "Created attachment 520396\nLatest patch", "count": 14, "creator": "mozilla@bakerweb.biz", "tags": [], "bug_id": 642530}, {"creator": "mozilla@bakerweb.biz", "tags": [], "count": 15, "time": "2011-03-19T15:13:30Z", "bug_id": 642530, "is_private": false, "creation_time": "2011-03-19T15:13:30Z", "text": "Created attachment 520446\nPatch\n\nFixed location of default pref and updated pref documentation. Also updated confirm prompt to be more descriptive.", "id": 5355314, "raw_text": "Fixed location of default pref and updated pref documentation. Also updated confirm prompt to be more descriptive.", "attachment_id": 520446, "author": "mozilla@bakerweb.biz"}, {"id": 5355316, "raw_text": "In extension format for those who would like to try it out without building Thunderbird from source.", "creation_time": "2011-03-19T15:20:03Z", "text": "Created attachment 520447\nExtension format with latest changes\n\nIn extension format for those who would like to try it out without building Thunderbird from source.", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 16, "bug_id": 642530, "author": "mozilla@bakerweb.biz", "is_private": false, "time": "2011-03-19T15:20:03Z", "attachment_id": 520447}, {"is_private": false, "time": "2011-03-19T16:43:27Z", "attachment_id": 520451, "raw_text": "Previous versions did not iterate through known identities like I thought they did. It was only checking the identity associated with the current server.", "id": 5355362, "text": "Created attachment 520451\nLatest patch\n\nPrevious versions did not iterate through known identities like I thought they did. It was only checking the identity associated with the current server.", "creation_time": "2011-03-19T16:43:27Z", "bug_id": 642530, "tags": [], "creator": "mozilla@bakerweb.biz", "count": 17, "author": "mozilla@bakerweb.biz"}, {"attachment_id": null, "author": "mozilla@bakerweb.biz", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 18, "time": "2011-03-19T22:33:33Z", "bug_id": 642530, "id": 5355581, "raw_text": "", "creation_time": "2011-03-19T22:33:33Z", "is_private": false, "text": "*** Bug 295503 has been marked as a duplicate of this bug. ***"}, {"time": "2011-03-19T22:42:21Z", "is_private": false, "attachment_id": 520473, "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 19, "text": "Created attachment 520473\nThis patch in extension format", "creation_time": "2011-03-19T22:42:21Z", "raw_text": "", "id": 5355587, "author": "mozilla@bakerweb.biz"}, {"time": "2011-03-20T13:45:38Z", "count": 20, "tags": [], "creator": "ludovic@hirlimann.net", "bug_id": 642530, "id": 5355977, "raw_text": "Jerry try to carry the flags over when you obsolete an attachment. The ui-review is the best way to get feedback from our UI lead ;-)", "is_private": false, "creation_time": "2011-03-20T13:45:38Z", "text": "Comment on attachment 520473\nThis patch in extension format\n\nJerry try to carry the flags over when you obsolete an attachment. The ui-review is the best way to get feedback from our UI lead ;-)", "attachment_id": 520473, "author": "ludovic@hirlimann.net"}, {"time": "2011-03-20T13:52:49Z", "is_private": false, "attachment_id": null, "bug_id": 642530, "creator": "ludovic@hirlimann.net", "count": 21, "tags": [], "raw_text": "(In reply to comment #17)\n> Created attachment 520451 [details]\n> Latest patch\n> \n> Previous versions did not iterate through known identities like I thought they\n> did. It was only checking the identity associated with the current server.\n\nJerry I don't know if you are aware of our policy about patches - we do requires unit test for them to be accepted (or tests descriptions to add to our list of tests in litmus). We use mozmill for our unit tests and the documentation is at : https://developer.mozilla.org/en/Thunderbird/Thunderbird_MozMill_Testing .", "id": 5355982, "text": "(In reply to comment #17)\n> Created attachment 520451 [details]\n> Latest patch\n> \n> Previous versions did not iterate through known identities like I thought they\n> did. It was only checking the identity associated with the current server.\n\nJerry I don't know if you are aware of our policy about patches - we do requires unit test for them to be accepted (or tests descriptions to add to our list of tests in litmus). We use mozmill for our unit tests and the documentation is at : https://developer.mozilla.org/en/Thunderbird/Thunderbird_MozMill_Testing .", "creation_time": "2011-03-20T13:52:49Z", "author": "ludovic@hirlimann.net"}, {"author": "mozilla@bakerweb.biz", "bug_id": 642530, "tags": [], "creator": "mozilla@bakerweb.biz", "count": 22, "text": "Wow. It's not easy to share a fix with the community.\n\nPerhaps I'll just leave it as an extension. How does Thunderbird handle the case where a user has two extensions that override the same file?", "creation_time": "2011-03-20T15:30:52Z", "raw_text": "Wow. It's not easy to share a fix with the community.\n\nPerhaps I'll just leave it as an extension. How does Thunderbird handle the case where a user has two extensions that override the same file?", "id": 5356041, "attachment_id": null, "time": "2011-03-20T15:30:52Z", "is_private": false}, {"creation_time": "2011-03-20T16:02:21Z", "text": "Well, I tried. It looks like you have to have a Microsoft build environment to run mozmill properly. I'll leave it to someone who has a Microsoft compiler installed. I tried hacking my way through it, but python was getting angry.", "id": 5356062, "raw_text": "Well, I tried. It looks like you have to have a Microsoft build environment to run mozmill properly. I'll leave it to someone who has a Microsoft compiler installed. I tried hacking my way through it, but python was getting angry.", "creator": "mozilla@bakerweb.biz", "count": 23, "tags": [], "bug_id": 642530, "author": "mozilla@bakerweb.biz", "is_private": false, "time": "2011-03-20T16:02:21Z", "attachment_id": null}, {"time": "2011-03-20T16:03:56Z", "is_private": false, "attachment_id": 520529, "tags": [], "creator": "mozilla@bakerweb.biz", "count": 24, "bug_id": 642530, "id": 5356063, "raw_text": "Going back and forth between the patch and extension file versions takes a toll. I had to correct a chrome uri that was pointing to an extension's location.", "creation_time": "2011-03-20T16:03:56Z", "text": "Created attachment 520529\nLatest patch\n\nGoing back and forth between the patch and extension file versions takes a toll. I had to correct a chrome uri that was pointing to an extension's location.", "author": "mozilla@bakerweb.biz"}, {"text": "It seems like a pretty high barrier to entry to require a that a contributor submitting a JavaScript patch go through the process of getting, installing, and configuring Microsoft Visual Studio, Python, MozBuild, and MozMill and then learn the ins and outs of building Thunderbird. That's already after having to download and configure a Mercurial client and the Thunderbird source just to generate a patch file. That's much more work than the actual research and programming required to address whatever it was that needed fixing.\n\nI'm not clear where this bug stands. Since I do not have the capabilities to run unit testing, should I just abandon this bug?", "creation_time": "2011-03-21T18:00:36Z", "raw_text": "It seems like a pretty high barrier to entry to require a that a contributor submitting a JavaScript patch go through the process of getting, installing, and configuring Microsoft Visual Studio, Python, MozBuild, and MozMill and then learn the ins and outs of building Thunderbird. That's already after having to download and configure a Mercurial client and the Thunderbird source just to generate a patch file. That's much more work than the actual research and programming required to address whatever it was that needed fixing.\n\nI'm not clear where this bug stands. Since I do not have the capabilities to run unit testing, should I just abandon this bug?", "id": 5357657, "bug_id": 642530, "count": 25, "tags": [], "creator": "mozilla@bakerweb.biz", "author": "mozilla@bakerweb.biz", "is_private": false, "time": "2011-03-21T18:00:36Z", "attachment_id": null}, {"id": 5357681, "raw_text": "Hi Jerry.\n\nYes, I agree the barrier is a little too high for comfort, and I believe we're looking at making it easier to run and write UI tests. However I think I can look at writing some tests for this.\n\nWe also need UI feedback for this. In particular, I'm worried about the case where an e-mail is sent to you via a mailing list.", "creation_time": "2011-03-21T18:11:30Z", "is_private": false, "text": "Hi Jerry.\n\nYes, I agree the barrier is a little too high for comfort, and I believe we're looking at making it easier to run and write UI tests. However I think I can look at writing some tests for this.\n\nWe also need UI feedback for this. In particular, I'm worried about the case where an e-mail is sent to you via a mailing list.", "time": "2011-03-21T18:11:30Z", "tags": [], "creator": "rain@sunshowers.io", "count": 26, "bug_id": 642530, "attachment_id": null, "author": "rain@sunshowers.io"}, {"attachment_id": null, "author": "mozilla@bakerweb.biz", "is_private": false, "creation_time": "2011-03-21T18:19:40Z", "text": "Here's what it does in a nutshell:\n\nIf your preference is set to the default, all this does when you use Reply All is look in the To:, From:, and Cc: header fields of the original message for an email address associated with an identity in Thunderbird. If none of your configured email addresses are present it presents you with a dialog that says:\n\nIt appears that this message is not addressed to any of your configured email addresses. This may be because the sender intended your receipt of this message to be a secret. Using 'Reply All' will reveal your receipt of this message to all recipients. Are you sure you wish to continue?\n\nThe dialog has a \"Yes\" and \"No\" button as well as a \"Don't ask me again\" checkbox. If you select don't ask me again Thunderbird will revert to behaving as it does now, which is to allow Reply All on everything.\n\nThe only other option is for people who want to completely disable Reply All when Thunderbird cannot find a preconfigured email address in the From:, To:, or Cc: fields.", "id": 5357698, "raw_text": "Here's what it does in a nutshell:\n\nIf your preference is set to the default, all this does when you use Reply All is look in the To:, From:, and Cc: header fields of the original message for an email address associated with an identity in Thunderbird. If none of your configured email addresses are present it presents you with a dialog that says:\n\nIt appears that this message is not addressed to any of your configured email addresses. This may be because the sender intended your receipt of this message to be a secret. Using 'Reply All' will reveal your receipt of this message to all recipients. Are you sure you wish to continue?\n\nThe dialog has a \"Yes\" and \"No\" button as well as a \"Don't ask me again\" checkbox. If you select don't ask me again Thunderbird will revert to behaving as it does now, which is to allow Reply All on everything.\n\nThe only other option is for people who want to completely disable Reply All when Thunderbird cannot find a preconfigured email address in the From:, To:, or Cc: fields.", "tags": [], "creator": "mozilla@bakerweb.biz", "time": "2011-03-21T18:19:40Z", "count": 27, "bug_id": 642530}, {"attachment_id": null, "author": "mozilla@bakerweb.biz", "tags": [], "creator": "mozilla@bakerweb.biz", "count": 28, "time": "2011-03-21T18:22:35Z", "bug_id": 642530, "id": 5357708, "raw_text": "If a list you belong to blind-copies you, the default will be to show this dialog if you use Reply All. I've thought about it a lot, but there's really no way around it. The whole point is to make users pause for a second and contemplate whether they really want to Reply All to a BCC message. It only has to happen once like the warning on submitting forms.", "creation_time": "2011-03-21T18:22:35Z", "is_private": false, "text": "If a list you belong to blind-copies you, the default will be to show this dialog if you use Reply All. I've thought about it a lot, but there's really no way around it. The whole point is to make users pause for a second and contemplate whether they really want to Reply All to a BCC message. It only has to happen once like the warning on submitting forms."}, {"id": 5358073, "raw_text": "I was worried about any potential UI delays that might be caused by looping through identities each time a new messages was selected, but Venkman shows this:\n\n  Function Name: IsReplyAllEnabled  (Lines 856 - 932)\n  Total Calls: 241 (max recurse 0)\n  Total Time: 238.27 (min/max/avg 0.85/1.63/0.99)\n  Time (ex. calls): 61.32 (min/max/avg 0.23/0.38/0.25)\n\nWithout my code, the speed looks like this:\n\n    Function Name: IsReplyAllEnabled  (Lines 852 - 904)\n    Total Calls: 47 (max recurse 0)\n    Total Time: 39.76 (min/max/avg 0.75/1.16/0.85)\n    Time (ex. calls): 6.48 (min/max/avg 0.13/0.17/0.14)\n\nSo, it appears that this code adds a min/max/avg of 0.10/0.47/0.14 ms to the time spent in IsReplyAll() enabled. Not too shabby.", "is_private": false, "creation_time": "2011-03-21T20:15:19Z", "text": "I was worried about any potential UI delays that might be caused by looping through identities each time a new messages was selected, but Venkman shows this:\n\n  Function Name: IsReplyAllEnabled  (Lines 856 - 932)\n  Total Calls: 241 (max recurse 0)\n  Total Time: 238.27 (min/max/avg 0.85/1.63/0.99)\n  Time (ex. calls): 61.32 (min/max/avg 0.23/0.38/0.25)\n\nWithout my code, the speed looks like this:\n\n    Function Name: IsReplyAllEnabled  (Lines 852 - 904)\n    Total Calls: 47 (max recurse 0)\n    Total Time: 39.76 (min/max/avg 0.75/1.16/0.85)\n    Time (ex. calls): 6.48 (min/max/avg 0.13/0.17/0.14)\n\nSo, it appears that this code adds a min/max/avg of 0.10/0.47/0.14 ms to the time spent in IsReplyAll() enabled. Not too shabby.", "tags": [], "count": 29, "creator": "mozilla@bakerweb.biz", "time": "2011-03-21T20:15:19Z", "bug_id": 642530, "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"author": "clarkbw@mozilla.com", "text": "Just catching up with this now.  I've read through the comments and I'm going to try out the extension now.  Thanks!", "creation_time": "2011-03-21T21:42:10Z", "raw_text": "Just catching up with this now.  I've read through the comments and I'm going to try out the extension now.  Thanks!", "id": 5358394, "bug_id": 642530, "tags": [], "count": 30, "creator": "clarkbw@mozilla.com", "attachment_id": null, "is_private": false, "time": "2011-03-21T21:42:10Z"}, {"author": "mozilla@bakerweb.biz", "attachment_id": null, "text": "Beat it up and try to kill it. Don't forget to try out the different pref values.\n\n// 0 - Do nothing (Reply All works normally).\n// 1 - Reply All buttons and menu items disabled.\n// 2 - User is presented with a confirmation dialog.\n\nextensions.ReplyAllControl.ReplyAllBehavior", "is_private": false, "creation_time": "2011-03-21T21:54:37Z", "raw_text": "Beat it up and try to kill it. Don't forget to try out the different pref values.\n\n// 0 - Do nothing (Reply All works normally).\n// 1 - Reply All buttons and menu items disabled.\n// 2 - User is presented with a confirmation dialog.\n\nextensions.ReplyAllControl.ReplyAllBehavior", "id": 5358438, "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "count": 31, "time": "2011-03-21T21:54:37Z", "tags": []}, {"author": "mozilla@bakerweb.biz", "text": "Created attachment 520825\nLatest patch\n\nCleans up some tab/space issues, wrap the code in an IF statement to prevent execution when the preference is to allow Reply All to any message.", "creation_time": "2011-03-22T01:22:33Z", "raw_text": "Cleans up some tab/space issues, wrap the code in an IF statement to prevent execution when the preference is to allow Reply All to any message.", "id": 5359009, "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 32, "attachment_id": 520825, "is_private": false, "time": "2011-03-22T01:22:33Z"}, {"attachment_id": 520828, "is_private": false, "time": "2011-03-22T01:24:53Z", "author": "mozilla@bakerweb.biz", "raw_text": "", "id": 5359015, "text": "Created attachment 520828\nExtension implementing the patch", "creation_time": "2011-03-22T01:24:53Z", "bug_id": 642530, "count": 33, "tags": [], "creator": "mozilla@bakerweb.biz"}, {"attachment_id": null, "is_private": false, "time": "2011-03-22T15:42:35Z", "author": "mozilla@bakerweb.biz", "raw_text": "There's a ton of code in IsReplyAllEnabled() that exists for the sole purpose of determining whether there is more than one email address to reply to (aside from the owner's). All of this effort is wasted because the Reply All button has historically been hooked up to the IsReplyEnabled() function, which only returns false if the message is a feed. Historical functionality (i.e., transparent to the user) can be retained while removing some 30 lines of code and improving the execution speed of that function by 56% according to Venkman. 1) Is there some reason that the email address counting code should remain (it's not been used as far as I can tell), and 2) should this be a separate bug?", "id": 5359908, "text": "There's a ton of code in IsReplyAllEnabled() that exists for the sole purpose of determining whether there is more than one email address to reply to (aside from the owner's). All of this effort is wasted because the Reply All button has historically been hooked up to the IsReplyEnabled() function, which only returns false if the message is a feed. Historical functionality (i.e., transparent to the user) can be retained while removing some 30 lines of code and improving the execution speed of that function by 56% according to Venkman. 1) Is there some reason that the email address counting code should remain (it's not been used as far as I can tell), and 2) should this be a separate bug?", "creation_time": "2011-03-22T15:42:35Z", "bug_id": 642530, "tags": [], "creator": "mozilla@bakerweb.biz", "count": 34}, {"count": 35, "tags": [], "creator": "bwinton@latte.ca", "bug_id": 642530, "id": 5359914, "raw_text": "(In reply to comment #28)\n> If a list you belong to blind-copies you, the default will be to show this\n> dialog if you use Reply All. I've thought about it a lot, but there's really no\n> way around it. The whole point is to make users pause for a second and\n> contemplate whether they really want to Reply All to a BCC message. It only has\n> to happen once like the warning on submitting forms.\n\nMy understanding is that lists you're on always have the effect of blind-copying you, so you'll always show the dialog\u2026\n\nI think I would like this patch more if you also did nothing if the ReplyList button was enabled.  (i.e. \"IsReplyListEnabled() == true\" had the same behaviour as \"extensions.ReplyAllControl.ReplyAllBehavior == 0\".)  How does that sound to you?\n\nThanks,\nBlake.", "creation_time": "2011-03-22T15:44:59Z", "text": "(In reply to comment #28)\n> If a list you belong to blind-copies you, the default will be to show this\n> dialog if you use Reply All. I've thought about it a lot, but there's really no\n> way around it. The whole point is to make users pause for a second and\n> contemplate whether they really want to Reply All to a BCC message. It only has\n> to happen once like the warning on submitting forms.\n\nMy understanding is that lists you're on always have the effect of blind-copying you, so you'll always show the dialog\u2026\n\nI think I would like this patch more if you also did nothing if the ReplyList button was enabled.  (i.e. \"IsReplyListEnabled() == true\" had the same behaviour as \"extensions.ReplyAllControl.ReplyAllBehavior == 0\".)  How does that sound to you?\n\nThanks,\nBlake.", "author": "bwinton@latte.ca", "time": "2011-03-22T15:44:59Z", "is_private": false, "attachment_id": null}, {"bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 36, "text": "Created attachment 520928\nExtension implementing the patch\n\nSeems reasonable to me. See if this extension behaves as you're describing.\n\nAs an aside, we may want to look deeper into improving the list detection capabilities of IsReplyListEnabled() to include List-Id or other list headers in another bug.", "creation_time": "2011-03-22T16:07:36Z", "raw_text": "Seems reasonable to me. See if this extension behaves as you're describing.\n\nAs an aside, we may want to look deeper into improving the list detection capabilities of IsReplyListEnabled() to include List-Id or other list headers in another bug.", "id": 5359950, "author": "mozilla@bakerweb.biz", "time": "2011-03-22T16:07:36Z", "is_private": false, "attachment_id": 520928}, {"time": "2011-03-22T16:19:59Z", "is_private": false, "attachment_id": null, "bug_id": 642530, "creator": "bwinton@latte.ca", "tags": [], "count": 37, "raw_text": "I was thinking of that, but if there isn't a List-Post header, then we have no way to post to the list, and so enabling the ReplyList button would be the wrong thing.  (Also, I don't think checking for other headers would really get us any benefit, since I haven't seen a list which has some of the headers, and not List-Post.)\n\nThanks,\nBlake.", "id": 5359984, "text": "I was thinking of that, but if there isn't a List-Post header, then we have no way to post to the list, and so enabling the ReplyList button would be the wrong thing.  (Also, I don't think checking for other headers would really get us any benefit, since I haven't seen a list which has some of the headers, and not List-Post.)\n\nThanks,\nBlake.", "creation_time": "2011-03-22T16:19:59Z", "author": "bwinton@latte.ca"}, {"id": 5359997, "raw_text": "Stupid missing parenthesis :)", "is_private": false, "creation_time": "2011-03-22T16:25:17Z", "text": "Created attachment 520936\nExtension implementing the patch\n\nStupid missing parenthesis :)", "time": "2011-03-22T16:25:17Z", "count": 38, "creator": "mozilla@bakerweb.biz", "tags": [], "bug_id": 642530, "attachment_id": 520936, "author": "mozilla@bakerweb.biz"}, {"attachment_id": null, "author": "mozilla@bakerweb.biz", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 39, "time": "2011-03-22T16:30:17Z", "bug_id": 642530, "id": 5360005, "raw_text": "Yahoo Groups send messages with List-Id but no List-Post headers. Their List-Id is set to the List-Post address. RFC 2919 doesn't require that a List-Post address be used for List-Id, but it might be worth checking if List-Id == Reply-To.", "creation_time": "2011-03-22T16:30:17Z", "is_private": false, "text": "Yahoo Groups send messages with List-Id but no List-Post headers. Their List-Id is set to the List-Post address. RFC 2919 doesn't require that a List-Post address be used for List-Id, but it might be worth checking if List-Id == Reply-To."}, {"author": "mozilla@bakerweb.biz", "bug_id": 642530, "tags": [], "count": 40, "creator": "mozilla@bakerweb.biz", "text": "I'm having some trouble with IsReplyListEnabled(). It's returning true and false on the same message. Sounds impossible, but if you stick an alert(IsReplyListEnabled()) in the IsReplyAllEnabled() function, you get\n\ntrue\ntrue\ntrue\ntrue\nfalse\ntrue\n\non each message. That false is mucking up the code. I'm looking into it.", "creation_time": "2011-03-22T21:40:30Z", "raw_text": "I'm having some trouble with IsReplyListEnabled(). It's returning true and false on the same message. Sounds impossible, but if you stick an alert(IsReplyListEnabled()) in the IsReplyAllEnabled() function, you get\n\ntrue\ntrue\ntrue\ntrue\nfalse\ntrue\n\non each message. That false is mucking up the code. I'm looking into it.", "id": 5360982, "attachment_id": null, "time": "2011-03-22T21:40:30Z", "is_private": false}, {"author": "mozilla@bakerweb.biz", "count": 41, "creator": "mozilla@bakerweb.biz", "tags": [], "bug_id": 642530, "creation_time": "2011-03-22T22:06:43Z", "text": "Well, the problem is not in the IsReplyListEnabled() function. I changed it to this and it still returns false sometimes when called from IsReplyAllEnabled():\n\nfunction IsReplyListEnabled() {\n  return true;\n}", "id": 5361083, "raw_text": "Well, the problem is not in the IsReplyListEnabled() function. I changed it to this and it still returns false sometimes when called from IsReplyAllEnabled():\n\nfunction IsReplyListEnabled() {\n  return true;\n}", "attachment_id": null, "time": "2011-03-22T22:06:43Z", "is_private": false}, {"attachment_id": null, "is_private": false, "time": "2011-03-22T22:15:11Z", "author": "mozilla@bakerweb.biz", "creation_time": "2011-03-22T22:15:11Z", "text": "Sorry, that should read:\n\nif (\"list-post\" in currentHeaderData)\n  return true;\nelse\n  return false;\n\nI can't figure out why it returns true sometimes and false sometimes on the same message.", "id": 5361107, "raw_text": "Sorry, that should read:\n\nif (\"list-post\" in currentHeaderData)\n  return true;\nelse\n  return false;\n\nI can't figure out why it returns true sometimes and false sometimes on the same message.", "tags": [], "count": 42, "creator": "mozilla@bakerweb.biz", "bug_id": 642530}, {"bug_id": 642530, "count": 43, "creator": "jporterbugs@gmail.com", "tags": [], "raw_text": "How are you replying when you get \"false\"? That is, what button/menu item do you select? Is the message you're replying to currently displayed?", "id": 5361115, "text": "How are you replying when you get \"false\"? That is, what button/menu item do you select? Is the message you're replying to currently displayed?", "creation_time": "2011-03-22T22:16:55Z", "author": "jporterbugs@gmail.com", "time": "2011-03-22T22:16:55Z", "is_private": false, "attachment_id": null}, {"id": 5361210, "raw_text": "It's when the message is selected in the header view. That triggers some UI updates which call IsReplyAllEnabled(). If I stick an alert(IsReplyListEnabled()) in the IsReplyAllEnabled(), I get several alerts (each button and menu item triggers) and some are true and some are false.", "is_private": false, "creation_time": "2011-03-22T22:46:12Z", "text": "It's when the message is selected in the header view. That triggers some UI updates which call IsReplyAllEnabled(). If I stick an alert(IsReplyListEnabled()) in the IsReplyAllEnabled(), I get several alerts (each button and menu item triggers) and some are true and some are false.", "creator": "mozilla@bakerweb.biz", "count": 44, "time": "2011-03-22T22:46:12Z", "tags": [], "bug_id": 642530, "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"author": "bwinton@latte.ca", "attachment_id": null, "bug_id": 642530, "count": 45, "time": "2011-03-22T23:21:23Z", "tags": [], "creator": "bwinton@latte.ca", "text": "I wonder if the alerts are stealing focus, and causing things to be unselected somehow.\n\nWhat happens if you change the line to:\ndump(IsReplyListEnabled()+\"\\n\");\nor:\nApplication.console.log(IsReplyListEnabled());\n?", "creation_time": "2011-03-22T23:21:23Z", "is_private": false, "raw_text": "I wonder if the alerts are stealing focus, and causing things to be unselected somehow.\n\nWhat happens if you change the line to:\ndump(IsReplyListEnabled()+\"\\n\");\nor:\nApplication.console.log(IsReplyListEnabled());\n?", "id": 5361323}, {"time": "2011-03-23T00:25:39Z", "creator": "mozilla@bakerweb.biz", "count": 46, "tags": [], "bug_id": 642530, "id": 5361448, "raw_text": "Upon selecting a message that DOES have a List-Post header, the Error Console displays:\n\nfalse\ntrue\ntrue\n\nUpon selecting a message that does NOT have a List-Post header, the Error Console displays:\n\ntrue\nfalse\nfalse\n\nSomething's backwards when that first call is made.", "creation_time": "2011-03-23T00:25:39Z", "is_private": false, "text": "Upon selecting a message that DOES have a List-Post header, the Error Console displays:\n\nfalse\ntrue\ntrue\n\nUpon selecting a message that does NOT have a List-Post header, the Error Console displays:\n\ntrue\nfalse\nfalse\n\nSomething's backwards when that first call is made.", "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"is_private": false, "time": "2011-03-23T00:29:17Z", "attachment_id": null, "id": 5361462, "raw_text": "I'm getting a suspicion that somehow currentHeaderData is holding on to data from the previously selected message. If I select two messages with a List-Post header in a row, the first reads like described before:\n\nfalse\ntrue\ntrue\n\nBut, the second one reads:\n\ntrue\ntrue\ntrue\n\nThe same holds true going the other way. The first message without a List-Post header returns:\n\ntrue\nfalse\nfalse\n\nBut if I select another message without a List-Post header, it returns:\n\nfalse\nfalse\nfalse", "creation_time": "2011-03-23T00:29:17Z", "text": "I'm getting a suspicion that somehow currentHeaderData is holding on to data from the previously selected message. If I select two messages with a List-Post header in a row, the first reads like described before:\n\nfalse\ntrue\ntrue\n\nBut, the second one reads:\n\ntrue\ntrue\ntrue\n\nThe same holds true going the other way. The first message without a List-Post header returns:\n\ntrue\nfalse\nfalse\n\nBut if I select another message without a List-Post header, it returns:\n\nfalse\nfalse\nfalse", "tags": [], "creator": "mozilla@bakerweb.biz", "count": 47, "bug_id": 642530, "author": "mozilla@bakerweb.biz"}, {"id": 5361607, "raw_text": "The problem is originating in the call to IsReplyAllEnabled() from mail3PaneWindowCommands.js. If I remove the call there the problem goes away. I just can't figure out why. Unfortunately, removing the call there removes the ability to disable buttons and menu items.", "is_private": false, "creation_time": "2011-03-23T01:37:28Z", "text": "The problem is originating in the call to IsReplyAllEnabled() from mail3PaneWindowCommands.js. If I remove the call there the problem goes away. I just can't figure out why. Unfortunately, removing the call there removes the ability to disable buttons and menu items.", "creator": "mozilla@bakerweb.biz", "time": "2011-03-23T01:37:28Z", "count": 48, "tags": [], "bug_id": 642530, "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"is_private": false, "time": "2011-03-23T01:52:50Z", "attachment_id": null, "raw_text": "I have confirmed that the first incorrect IsReplyListEnabled() value is being caused by an incorrect message reference. I used \n\nApplication.console.log(currentHeaderData[\"message-id\"][\"headerValue\"] + \": \" + IsReplyListEnabled());\n\nAnd where the incorrect value was appearing, the message-id of the previously selected message was appearing. I'm going to see what I can find out by debugging it with Venkman.", "id": 5361654, "text": "I have confirmed that the first incorrect IsReplyListEnabled() value is being caused by an incorrect message reference. I used \n\nApplication.console.log(currentHeaderData[\"message-id\"][\"headerValue\"] + \": \" + IsReplyListEnabled());\n\nAnd where the incorrect value was appearing, the message-id of the previously selected message was appearing. I'm going to see what I can find out by debugging it with Venkman.", "creation_time": "2011-03-23T01:52:50Z", "bug_id": 642530, "tags": [], "count": 49, "creator": "mozilla@bakerweb.biz", "author": "mozilla@bakerweb.biz"}, {"author": "mozilla@bakerweb.biz", "attachment_id": null, "bug_id": 642530, "time": "2011-03-23T02:18:04Z", "count": 50, "creator": "mozilla@bakerweb.biz", "tags": [], "raw_text": "It appears it might be a timing issue. The error goes away depending on where I set the breakpoint. :(", "id": 5361694, "text": "It appears it might be a timing issue. The error goes away depending on where I set the breakpoint. :(", "creation_time": "2011-03-23T02:18:04Z", "is_private": false}, {"author": "mozilla@bakerweb.biz", "attachment_id": null, "bug_id": 642530, "count": 51, "creator": "mozilla@bakerweb.biz", "time": "2011-03-23T02:25:46Z", "tags": [], "raw_text": "It's a timing issue for sure. Putting a simple alert() in mail3PaneWindowCommands.js just before the call to IsReplyAllEnabled() cures the problem.\n\nI don't know where to go from here. There appears to be a problem with trying to read header values too early in the process. I think resolving this is beyond my expertise. Should I give up on checking for list-post headers until this is fixed?", "id": 5361704, "text": "It's a timing issue for sure. Putting a simple alert() in mail3PaneWindowCommands.js just before the call to IsReplyAllEnabled() cures the problem.\n\nI don't know where to go from here. There appears to be a problem with trying to read header values too early in the process. I think resolving this is beyond my expertise. Should I give up on checking for list-post headers until this is fixed?", "creation_time": "2011-03-23T02:25:46Z", "is_private": false}, {"time": "2011-03-23T14:31:22Z", "is_private": false, "attachment_id": null, "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "count": 52, "tags": [], "raw_text": "I'm trying to figure out how currentHeaderData works, but it's apparently a magical property. According to MXR, it only appears in two JS files across the entire Mozilla tree. It is only defined as an empty object. I cannot find when and where it is populated with data.", "id": 5362422, "text": "I'm trying to figure out how currentHeaderData works, but it's apparently a magical property. According to MXR, it only appears in two JS files across the entire Mozilla tree. It is only defined as an empty object. I cannot find when and where it is populated with data.", "creation_time": "2011-03-23T14:31:22Z", "author": "mozilla@bakerweb.biz"}, {"is_private": false, "time": "2011-03-23T15:06:25Z", "attachment_id": null, "creation_time": "2011-03-23T15:06:25Z", "text": "Ok. currentHeaderData appears to be populated by processHeaders: function(headerNameEnumerator, headerValueEnumerator, dontCollectAddress) in msgHdrViewOverlay.js.\n\nIt looks like the problem is that mail3PaneWindowCommands.js has events firing before currentHeaderData has a chance to get populated. I put this as the first line in processHeaders:\n\nApplication.console.log(\"Starting processHeaders()\");\n\nNow, when I switch messages in the header pane to a message that has a List-Post header this is what appears in my error console:\n\nfalse\nStarting processHeaders()\ntrue\ntrue\n\nThe question now is how to wait for processHeaders().", "id": 5362526, "raw_text": "Ok. currentHeaderData appears to be populated by processHeaders: function(headerNameEnumerator, headerValueEnumerator, dontCollectAddress) in msgHdrViewOverlay.js.\n\nIt looks like the problem is that mail3PaneWindowCommands.js has events firing before currentHeaderData has a chance to get populated. I put this as the first line in processHeaders:\n\nApplication.console.log(\"Starting processHeaders()\");\n\nNow, when I switch messages in the header pane to a message that has a List-Post header this is what appears in my error console:\n\nfalse\nStarting processHeaders()\ntrue\ntrue\n\nThe question now is how to wait for processHeaders().", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 53, "bug_id": 642530, "author": "mozilla@bakerweb.biz"}, {"attachment_id": null, "time": "2011-03-23T15:09:54Z", "is_private": false, "author": "bwinton@latte.ca", "bug_id": 642530, "count": 54, "tags": [], "creator": "bwinton@latte.ca", "raw_text": "Could you check that the id of the selected message is the same as currentHeaderData[\"message-id\"][\"headerValue\"]?\n\nI'm not sure of the implementation of processHeaders, but we might finish processing the headers before the next event fires\u2026", "id": 5362532, "text": "Could you check that the id of the selected message is the same as currentHeaderData[\"message-id\"][\"headerValue\"]?\n\nI'm not sure of the implementation of processHeaders, but we might finish processing the headers before the next event fires\u2026", "creation_time": "2011-03-23T15:09:54Z"}, {"attachment_id": null, "is_private": false, "time": "2011-03-23T15:16:10Z", "author": "mozilla@bakerweb.biz", "text": "Here's how it looks with the message-id included in the log. Keep in mind these are all events fired after selecting a message with a list-post header:\n\n<4d7bd735991a5_4f2f157fde14c29c3d8@patchwrkr-d02.ihost.aol.com.tmail>: false\nStarting processHeaders()\n<009f01cbe11a$f909a7f0$eb1cf7d0$@net>: true\n<009f01cbe11a$f909a7f0$eb1cf7d0$@net>: true\n\nThe AOL message-id is the message-id of the message that was selected before selecting the message with the list-post header.", "creation_time": "2011-03-23T15:16:10Z", "raw_text": "Here's how it looks with the message-id included in the log. Keep in mind these are all events fired after selecting a message with a list-post header:\n\n<4d7bd735991a5_4f2f157fde14c29c3d8@patchwrkr-d02.ihost.aol.com.tmail>: false\nStarting processHeaders()\n<009f01cbe11a$f909a7f0$eb1cf7d0$@net>: true\n<009f01cbe11a$f909a7f0$eb1cf7d0$@net>: true\n\nThe AOL message-id is the message-id of the message that was selected before selecting the message with the list-post header.", "id": 5362544, "bug_id": 642530, "count": 55, "tags": [], "creator": "mozilla@bakerweb.biz"}, {"attachment_id": 521182, "author": "mozilla@bakerweb.biz", "creation_time": "2011-03-23T15:22:35Z", "is_private": false, "text": "Created attachment 521182\nextension with console messages\n\nUse this extension to test it out in your Thunderbird. It's probably easier to see what I'm describing first-hand.", "id": 5362556, "raw_text": "Use this extension to test it out in your Thunderbird. It's probably easier to see what I'm describing first-hand.", "tags": [], "creator": "mozilla@bakerweb.biz", "time": "2011-03-23T15:22:35Z", "count": 56, "bug_id": 642530}, {"attachment_id": 521193, "time": "2011-03-23T16:12:01Z", "is_private": false, "author": "mozilla@bakerweb.biz", "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 57, "text": "Created attachment 521193\nExtension implementing the patch\n\nWell, I don't want to look into the asynchronous nature of complicated things like header parsing so I just put a flag in the IsReplyListEnabled() function and it now seems to work perfectly. Please test it. I will submit a source patch shortly.", "creation_time": "2011-03-23T16:12:01Z", "raw_text": "Well, I don't want to look into the asynchronous nature of complicated things like header parsing so I just put a flag in the IsReplyListEnabled() function and it now seems to work perfectly. Please test it. I will submit a source patch shortly.", "id": 5362689}, {"attachment_id": 521205, "is_private": false, "time": "2011-03-23T16:30:07Z", "author": "mozilla@bakerweb.biz", "raw_text": "This should take care of it.", "id": 5362750, "text": "Created attachment 521205\nLatest patch\n\nThis should take care of it.", "creation_time": "2011-03-23T16:30:07Z", "bug_id": 642530, "tags": [], "count": 58, "creator": "mozilla@bakerweb.biz"}, {"attachment_id": 521214, "time": "2011-03-23T16:49:55Z", "is_private": false, "author": "mozilla@bakerweb.biz", "bug_id": 642530, "tags": [], "count": 59, "creator": "mozilla@bakerweb.biz", "raw_text": "Sorry for the bugspam. Fixed an edge case where right-clicking on a message while another message was selected did not check the status of IsReplyAllEnabled().", "id": 5362816, "text": "Created attachment 521214\nLatest patch\n\nSorry for the bugspam. Fixed an edge case where right-clicking on a message while another message was selected did not check the status of IsReplyAllEnabled().", "creation_time": "2011-03-23T16:49:55Z"}, {"count": 60, "creator": "mozilla@bakerweb.biz", "tags": [], "time": "2011-03-23T16:52:52Z", "bug_id": 642530, "is_private": false, "creation_time": "2011-03-23T16:52:52Z", "text": "Created attachment 521216\nExtension implementing the patch", "id": 5362827, "raw_text": "", "attachment_id": 521216, "author": "mozilla@bakerweb.biz"}, {"creation_time": "2011-04-11T14:42:09Z", "text": "Comment on attachment 521214\nLatest patch\n\n(So that I don't get distracted by this while I can't review it, I'm going to clear out the r? flag, but please re-ask me for review once you've gotten a ui-r+ from Bryan.)", "id": 5400319, "raw_text": "(So that I don't get distracted by this while I can't review it, I'm going to clear out the r? flag, but please re-ask me for review once you've gotten a ui-r+ from Bryan.)", "tags": [], "count": 61, "creator": "bwinton@latte.ca", "bug_id": 642530, "author": "bwinton@latte.ca", "is_private": false, "time": "2011-04-11T14:42:09Z", "attachment_id": 521214}, {"attachment_id": 521216, "time": "2011-04-22T18:12:14Z", "is_private": false, "author": "clarkbw@mozilla.com", "bug_id": 642530, "tags": [], "count": 62, "creator": "clarkbw@mozilla.com", "raw_text": "Sorry for the delay.  I played with this a little while and things seemed ok to me.  Mostly I have concerns about the complexity.  Blake should make the call here.", "id": 5426609, "text": "Comment on attachment 521216\nExtension implementing the patch\n\nSorry for the delay.  I played with this a little while and things seemed ok to me.  Mostly I have concerns about the complexity.  Blake should make the call here.", "creation_time": "2011-04-22T18:12:14Z"}, {"time": "2011-04-27T20:29:44Z", "is_private": false, "attachment_id": 521216, "bug_id": 642530, "count": 63, "tags": [], "creator": "bwinton@latte.ca", "raw_text": "I dunno\u2026  While I appreciate the idea behind this extension, I don't really like the interactions I'm seeing, particularly with mailing lists.\n\nSetting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the ability to reply to mailing lists which don't set the List-Post header entirely for me, leaving no workarounds.\n\nWhen I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all the time, instead of only seeing it when the reply would have gone to more than one person.\n\nI think this is because, while we want to enable the Reply All menu item if there are one or more email addresses, we only want to enable the button if there are two or more.  This is so that we can let the user always use Ctrl-Shift-R to reply to everyone, while also showing them the correct button for what will actually happen.  I think this might have been the source of your confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so, that could definitely use some documentation!)\n\nAnd while I'm here, I've got a couple of comments.\n1) The patch doesn't apply cleanly for me anymore.  :(\n\n2) You should probably be using Services.strings instead of var strBundleService = Components.classes[\"@mozilla.org/intl/stringbundle;1\"].getService().QueryInterface(Components.interfaces.nsIStringBundleService);\nand Services.prompt instead of gPromptService.\n\nThanks,\nBlake.", "id": 5435596, "text": "Comment on attachment 521216\nExtension implementing the patch\n\nI dunno\u2026  While I appreciate the idea behind this extension, I don't really like the interactions I'm seeing, particularly with mailing lists.\n\nSetting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the ability to reply to mailing lists which don't set the List-Post header entirely for me, leaving no workarounds.\n\nWhen I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all the time, instead of only seeing it when the reply would have gone to more than one person.\n\nI think this is because, while we want to enable the Reply All menu item if there are one or more email addresses, we only want to enable the button if there are two or more.  This is so that we can let the user always use Ctrl-Shift-R to reply to everyone, while also showing them the correct button for what will actually happen.  I think this might have been the source of your confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so, that could definitely use some documentation!)\n\nAnd while I'm here, I've got a couple of comments.\n1) The patch doesn't apply cleanly for me anymore.  :(\n\n2) You should probably be using Services.strings instead of var strBundleService = Components.classes[\"@mozilla.org/intl/stringbundle;1\"].getService().QueryInterface(Components.interfaces.nsIStringBundleService);\nand Services.prompt instead of gPromptService.\n\nThanks,\nBlake.", "creation_time": "2011-04-27T20:29:44Z", "author": "bwinton@latte.ca"}, {"bug_id": 642530, "creator": "mozilla@bakerweb.biz", "tags": [], "count": 64, "text": "(In reply to comment #63)\n> Setting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the\n> ability to reply to mailing lists which don't set the List-Post header entirely\n> for me, leaving no workarounds.\n\nDoesn't just \"Reply\" work? I never knew there was a such thing as \"Reply List\" until I wrote this despite using Netscape and Mozilla since 1994. I didn't add any code to disable \"Reply List\" under any circumstances. Whatever code is doing that was there before this patch. The only thing I changed was to add code to enable \"Reply All\" when there was a List-Post header.\n\n\n> When I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all\n> the time, instead of only seeing it when the reply would have gone to more than\n> one person.\n\nThat's how it's always behaved. The code in mail3PaneWindowCommands.js hooks the \"Reply All\" button to IsReplyEnabled(). The \"Reply All\" and \"Reply\" button states will always be identical the way the current code is written.\n\n> I think this is because, while we want to enable the Reply All menu item if\n> there are one or more email addresses, we only want to enable the button if\n> there are two or more.  This is so that we can let the user always use\n> Ctrl-Shift-R to reply to everyone, while also showing them the correct button\n> for what will actually happen.  I think this might have been the source of your\n> confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so,\n> that could definitely use some documentation!)\n\nThere was no confusion. Reply All is never disabled in the original code. That's because the \"Reply All\" button is checking IsReplyEnabled() not IsReplyAllEnabled().\n \n> And while I'm here, I've got a couple of comments.\n> 1) The patch doesn't apply cleanly for me anymore.  :(\n\nBit rot sucks.", "creation_time": "2011-04-27T21:21:23Z", "raw_text": "(In reply to comment #63)\n> Setting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the\n> ability to reply to mailing lists which don't set the List-Post header entirely\n> for me, leaving no workarounds.\n\nDoesn't just \"Reply\" work? I never knew there was a such thing as \"Reply List\" until I wrote this despite using Netscape and Mozilla since 1994. I didn't add any code to disable \"Reply List\" under any circumstances. Whatever code is doing that was there before this patch. The only thing I changed was to add code to enable \"Reply All\" when there was a List-Post header.\n\n\n> When I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all\n> the time, instead of only seeing it when the reply would have gone to more than\n> one person.\n\nThat's how it's always behaved. The code in mail3PaneWindowCommands.js hooks the \"Reply All\" button to IsReplyEnabled(). The \"Reply All\" and \"Reply\" button states will always be identical the way the current code is written.\n\n> I think this is because, while we want to enable the Reply All menu item if\n> there are one or more email addresses, we only want to enable the button if\n> there are two or more.  This is so that we can let the user always use\n> Ctrl-Shift-R to reply to everyone, while also showing them the correct button\n> for what will actually happen.  I think this might have been the source of your\n> confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so,\n> that could definitely use some documentation!)\n\nThere was no confusion. Reply All is never disabled in the original code. That's because the \"Reply All\" button is checking IsReplyEnabled() not IsReplyAllEnabled().\n \n> And while I'm here, I've got a couple of comments.\n> 1) The patch doesn't apply cleanly for me anymore.  :(\n\nBit rot sucks.", "id": 5435747, "author": "mozilla@bakerweb.biz", "time": "2011-04-27T21:21:23Z", "is_private": false, "attachment_id": null}, {"text": "I should clarify: In mail3PaneWindowCommands.js both the \"Reply All\" menu item AND button are enabled for all messages that \"Reply\" is by the following (line 354):\n\nif (command == \"cmd_replyall\" ||command == \"button_replyall\")\n  return IsReplyEnabled();\n\nIt's easy enough to change the behavior, but I was just trying to avoid \"fixing\" a lot of things at once.", "creation_time": "2011-04-27T21:29:24Z", "is_private": false, "raw_text": "I should clarify: In mail3PaneWindowCommands.js both the \"Reply All\" menu item AND button are enabled for all messages that \"Reply\" is by the following (line 354):\n\nif (command == \"cmd_replyall\" ||command == \"button_replyall\")\n  return IsReplyEnabled();\n\nIt's easy enough to change the behavior, but I was just trying to avoid \"fixing\" a lot of things at once.", "id": 5435764, "bug_id": 642530, "time": "2011-04-27T21:29:24Z", "creator": "mozilla@bakerweb.biz", "tags": [], "count": 65, "author": "mozilla@bakerweb.biz", "attachment_id": null}, {"time": "2011-04-27T21:39:20Z", "count": 66, "creator": "bwinton@latte.ca", "tags": [], "bug_id": 642530, "is_private": false, "creation_time": "2011-04-27T21:39:20Z", "text": "(In reply to comment #64)\n> (In reply to comment #63)\n> > Setting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the\n> > ability to reply to mailing lists which don't set the List-Post header entirely\n> > for me, leaving no workarounds.\n> Doesn't just \"Reply\" work?\n\nSo, I get email from Bob@example.com addressed to EveryoneInToronto@example.com, which is some sort of group, but apparently not an official mailing list, because it has no List-Post or List-ID header.  \"Reply\" will reply just to Bob.  There is no \"Reply to List\" because there's no List-Post header.  If I want to reply to the EveryoneInToronto@example.com address, I need to use \"Reply All\", but it no longer exists\u2026  :(\n\n> I never knew there was a such thing as \"Reply List\"\n> until I wrote this despite using Netscape and Mozilla since 1994.\n\nThere wasn't for a while, but we added it in 3.0, I believe.  Maybe in 3.1.\n\n> I didn't add\n> any code to disable \"Reply List\" under any circumstances. Whatever code is\n> doing that was there before this patch. The only thing I changed was to add\n> code to enable \"Reply All\" when there was a List-Post header.\n\nNo, I wrote the code to disable \"Reply to List\" if there's no List-Post header.  :)\nAnd I believe that code is correct, since these strange things aren't really mailing lists per se, and don't contain any sort of header that would let us know that they were.\n\n> > When I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all\n> > the time, instead of only seeing it when the reply would have gone to more than\n> > one person.\n> That's how it's always behaved. The code in mail3PaneWindowCommands.js hooks\n> the \"Reply All\" button to IsReplyEnabled(). The \"Reply All\" and \"Reply\" button\n> states will always be identical the way the current code is written.\n\nYou may think so, but I promise you, I can see the \"Reply All\" button sometimes, and just the \"Reply\" button other times, so I think there's a piece of code you're missing somewhere.  Perhaps it's http://mxr.mozilla.org/comm-central/source/mail/base/content/mailWindowOverlay.js#982 ?\n\n> > I think this is because, while we want to enable the Reply All menu item if\n> > there are one or more email addresses, we only want to enable the button if\n> > there are two or more.  This is so that we can let the user always use\n> > Ctrl-Shift-R to reply to everyone, while also showing them the correct button\n> > for what will actually happen.  I think this might have been the source of your\n> > confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so,\n> > that could definitely use some documentation!)\n> There was no confusion. Reply All is never disabled in the original code.\n\nThe Reply All menu item is never disabled, yes.\nBut the Reply All button sometimes isn't shown, and the Reply button is.\n\n> > And while I'm here, I've got a couple of comments.\n> > 1) The patch doesn't apply cleanly for me anymore.  :(\n> Bit rot sucks.\n\nYeah, I agree.  But, now that I'm (mostly) on top of my reviews, you should see less bit rot, at least less due to me.  :)\n\nThanks,\nBlake.", "id": 5435788, "raw_text": "(In reply to comment #64)\n> (In reply to comment #63)\n> > Setting mail.ReplyAllBehavior to 1 seems particularly bad, since it removes the\n> > ability to reply to mailing lists which don't set the List-Post header entirely\n> > for me, leaving no workarounds.\n> Doesn't just \"Reply\" work?\n\nSo, I get email from Bob@example.com addressed to EveryoneInToronto@example.com, which is some sort of group, but apparently not an official mailing list, because it has no List-Post or List-ID header.  \"Reply\" will reply just to Bob.  There is no \"Reply to List\" because there's no List-Post header.  If I want to reply to the EveryoneInToronto@example.com address, I need to use \"Reply All\", but it no longer exists\u2026  :(\n\n> I never knew there was a such thing as \"Reply List\"\n> until I wrote this despite using Netscape and Mozilla since 1994.\n\nThere wasn't for a while, but we added it in 3.0, I believe.  Maybe in 3.1.\n\n> I didn't add\n> any code to disable \"Reply List\" under any circumstances. Whatever code is\n> doing that was there before this patch. The only thing I changed was to add\n> code to enable \"Reply All\" when there was a List-Post header.\n\nNo, I wrote the code to disable \"Reply to List\" if there's no List-Post header.  :)\nAnd I believe that code is correct, since these strange things aren't really mailing lists per se, and don't contain any sort of header that would let us know that they were.\n\n> > When I set mail.ReplyAllBehavior to 0 or 2, I then saw the ReplyAll button all\n> > the time, instead of only seeing it when the reply would have gone to more than\n> > one person.\n> That's how it's always behaved. The code in mail3PaneWindowCommands.js hooks\n> the \"Reply All\" button to IsReplyEnabled(). The \"Reply All\" and \"Reply\" button\n> states will always be identical the way the current code is written.\n\nYou may think so, but I promise you, I can see the \"Reply All\" button sometimes, and just the \"Reply\" button other times, so I think there's a piece of code you're missing somewhere.  Perhaps it's http://mxr.mozilla.org/comm-central/source/mail/base/content/mailWindowOverlay.js#982 ?\n\n> > I think this is because, while we want to enable the Reply All menu item if\n> > there are one or more email addresses, we only want to enable the button if\n> > there are two or more.  This is so that we can let the user always use\n> > Ctrl-Shift-R to reply to everyone, while also showing them the correct button\n> > for what will actually happen.  I think this might have been the source of your\n> > confusion as to what was calling IsReplyAllEnabled vs. IsReplyEnabled\u2026  (If so,\n> > that could definitely use some documentation!)\n> There was no confusion. Reply All is never disabled in the original code.\n\nThe Reply All menu item is never disabled, yes.\nBut the Reply All button sometimes isn't shown, and the Reply button is.\n\n> > And while I'm here, I've got a couple of comments.\n> > 1) The patch doesn't apply cleanly for me anymore.  :(\n> Bit rot sucks.\n\nYeah, I agree.  But, now that I'm (mostly) on top of my reviews, you should see less bit rot, at least less due to me.  :)\n\nThanks,\nBlake.", "attachment_id": null, "author": "bwinton@latte.ca"}, {"attachment_id": null, "is_private": false, "time": "2011-04-27T21:49:21Z", "author": "mozilla@bakerweb.biz", "creation_time": "2011-04-27T21:49:21Z", "text": "Perhaps I have something set differently, but I see the \"Reply All\" button all the time no matter what the nature of the message I select. I just tried it on several dozen messages with only myself as the recipient, mailing lists, and messages with multiple recipients. I have never seen Thunderbird behave differently across a half-dozen machines. Perhaps it's due to the fact that I've customized all of my toolbars to add the \"Next\" and \"Previous\" buttons?", "id": 5435819, "raw_text": "Perhaps I have something set differently, but I see the \"Reply All\" button all the time no matter what the nature of the message I select. I just tried it on several dozen messages with only myself as the recipient, mailing lists, and messages with multiple recipients. I have never seen Thunderbird behave differently across a half-dozen machines. Perhaps it's due to the fact that I've customized all of my toolbars to add the \"Next\" and \"Previous\" buttons?", "creator": "mozilla@bakerweb.biz", "count": 67, "tags": [], "bug_id": 642530}, {"creation_time": "2011-04-27T21:53:21Z", "is_private": false, "text": "I tried restoring the default toolbar set, but then there's not a \"Reply\" or \"Reply All\" button at all. Color me confused.", "id": 5435826, "raw_text": "I tried restoring the default toolbar set, but then there's not a \"Reply\" or \"Reply All\" button at all. Color me confused.", "tags": [], "time": "2011-04-27T21:53:21Z", "count": 68, "creator": "mozilla@bakerweb.biz", "bug_id": 642530, "attachment_id": null, "author": "mozilla@bakerweb.biz"}, {"author": "bwinton@latte.ca", "tags": [], "count": 69, "creator": "bwinton@latte.ca", "bug_id": 642530, "id": 5436021, "raw_text": "Ah, I get it.  I was talking about the one in the message header in the preview pane, not the one on the main toolbar\u2026\n\nThanks,\nBlake.", "creation_time": "2011-04-27T22:59:54Z", "text": "Ah, I get it.  I was talking about the one in the message header in the preview pane, not the one on the main toolbar\u2026\n\nThanks,\nBlake.", "attachment_id": null, "time": "2011-04-27T22:59:54Z", "is_private": false}, {"attachment_id": null, "time": "2011-04-28T01:00:26Z", "is_private": false, "author": "mozilla@bakerweb.biz", "bug_id": 642530, "creator": "mozilla@bakerweb.biz", "count": 70, "tags": [], "raw_text": "I don't have any buttons on the message headers. Is that a pref?", "id": 5436267, "text": "I don't have any buttons on the message headers. Is that a pref?", "creation_time": "2011-04-28T01:00:26Z"}, {"creator": "bwinton@latte.ca", "count": 71, "tags": [], "bug_id": 642530, "creation_time": "2011-04-28T01:38:02Z", "text": "I mean the ones highlighted in pink in http://dl.dropbox.com/u/2301433/Buttons.png  I don't think it's a pref.  Are you running with any extensions enabled?  (Also in that screenshot, you can see the Reply button, and no Reply All button\u2026 :)", "id": 5436325, "raw_text": "I mean the ones highlighted in pink in http://dl.dropbox.com/u/2301433/Buttons.png  I don't think it's a pref.  Are you running with any extensions enabled?  (Also in that screenshot, you can see the Reply button, and no Reply All button\u2026 :)", "author": "bwinton@latte.ca", "time": "2011-04-28T01:38:02Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "time": "2011-04-28T01:42:35Z", "is_private": false, "author": "mozilla@bakerweb.biz", "bug_id": 642530, "tags": [], "count": 72, "creator": "mozilla@bakerweb.biz", "text": "Weird. My Thunderbird does not look like that.\n\nhttp://i.imgur.com/we4K5.png", "creation_time": "2011-04-28T01:42:35Z", "raw_text": "Weird. My Thunderbird does not look like that.\n\nhttp://i.imgur.com/we4K5.png", "id": 5436332}, {"attachment_id": null, "is_private": false, "time": "2011-04-28T01:55:34Z", "author": "bwinton@latte.ca", "creation_time": "2011-04-28T01:55:34Z", "text": "(In reply to comment #72)\n> Weird. My Thunderbird does not look like that.\n> http://i.imgur.com/we4K5.png\n\nHmm.  Try right-clicking on the area above the date/time, and choose \"Restore Default Set\", and see what that does\u2026\n\nThanks,\nBlake.", "id": 5436350, "raw_text": "(In reply to comment #72)\n> Weird. My Thunderbird does not look like that.\n> http://i.imgur.com/we4K5.png\n\nHmm.  Try right-clicking on the area above the date/time, and choose \"Restore Default Set\", and see what that does\u2026\n\nThanks,\nBlake.", "count": 73, "creator": "bwinton@latte.ca", "tags": [], "bug_id": 642530}, {"bug_id": 642530, "tags": [], "creator": "mozilla@bakerweb.biz", "count": 74, "time": "2011-04-28T02:18:11Z", "text": "It was a userchrome.css change I made to get rid of them (I hate them). I just had forgotten.", "is_private": false, "creation_time": "2011-04-28T02:18:11Z", "raw_text": "It was a userchrome.css change I made to get rid of them (I hate them). I just had forgotten.", "id": 5436369, "author": "mozilla@bakerweb.biz", "attachment_id": null}]}}, "comments": {}}