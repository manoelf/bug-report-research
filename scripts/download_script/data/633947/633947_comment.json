{"bugs": {"633947": {"comments": [{"raw_text": "User-Agent:       Mozilla/5.0 (X11; Linux i686; rv:2.0b12pre) Gecko/20110212 Firefox/4.0b12pre\nBuild Identifier: Mozilla/5.0 (X11; Linux i686; rv:2.0b12pre) Gecko/20110212 Firefox/4.0b12pre\n\nI\u2019m trying to make a little texture editor with a webgl preview.\nDrawing with canvas & updating textures works correctly, but trying to erase (put pixels back to alpha 0.0) is not working.\n\nFollowing advice on the Internets, I am doing:\nskineditorc.save();\nskineditorc.globalCompositeOperation = 'copy';\nskineditorc.fillStyle = \"rgba(0,0,0,0.0)\";\nskineditorc.fillRect( x, y, 1, 1);\nskineditorc.restore();\nTo erase.\n\nCalling\ntexels = skineditorc.getImageData(0, 0, 64, 32);\nis giving me data that only contains the change. Which is a whole lot of transparency.\n\nAm I doing something silly (is copy the wrong composite?), or is this a sync/canvas bug? Prone to think its a bug because getImageData should return what I can *see*.\n\nReproducible: Always\n\nActual Results:  \ncanvascontext.getImageData() returns only the \u2018updates\u2019 of the image.\n\nExpected Results:  \ncanvascontext.getImageData() returns the current image on display.", "id": 5276920, "text": "User-Agent:       Mozilla/5.0 (X11; Linux i686; rv:2.0b12pre) Gecko/20110212 Firefox/4.0b12pre\nBuild Identifier: Mozilla/5.0 (X11; Linux i686; rv:2.0b12pre) Gecko/20110212 Firefox/4.0b12pre\n\nI\u2019m trying to make a little texture editor with a webgl preview.\nDrawing with canvas & updating textures works correctly, but trying to erase (put pixels back to alpha 0.0) is not working.\n\nFollowing advice on the Internets, I am doing:\nskineditorc.save();\nskineditorc.globalCompositeOperation = 'copy';\nskineditorc.fillStyle = \"rgba(0,0,0,0.0)\";\nskineditorc.fillRect( x, y, 1, 1);\nskineditorc.restore();\nTo erase.\n\nCalling\ntexels = skineditorc.getImageData(0, 0, 64, 32);\nis giving me data that only contains the change. Which is a whole lot of transparency.\n\nAm I doing something silly (is copy the wrong composite?), or is this a sync/canvas bug? Prone to think its a bug because getImageData should return what I can *see*.\n\nReproducible: Always\n\nActual Results:  \ncanvascontext.getImageData() returns only the \u2018updates\u2019 of the image.\n\nExpected Results:  \ncanvascontext.getImageData() returns the current image on display.", "creation_time": "2011-02-14T15:08:03Z", "bug_id": 633947, "count": 0, "tags": [], "creator": "john@nextraweb.com", "author": "john@nextraweb.com", "is_private": false, "time": "2011-02-14T15:08:03Z", "attachment_id": null}, {"is_private": false, "time": "2011-02-14T20:41:55Z", "attachment_id": null, "creation_time": "2011-02-14T20:41:55Z", "text": "It's really hard to tell what's going on here without a testcase.  Could you attach or point to a complete HTML page showing the problem?", "id": 5277858, "raw_text": "It's really hard to tell what's going on here without a testcase.  Could you attach or point to a complete HTML page showing the problem?", "count": 1, "tags": [], "creator": "bzbarsky@mit.edu", "bug_id": 633947, "author": "bzbarsky@mit.edu"}, {"id": 5284815, "raw_text": "It\u2019s hard to produce a testcase, because when I try to replicate it with just two 2d canvases, it doesn\u2019t appear. It feels like restore() doesn\u2019t reset globalCompositeOperation or there\u2019s a double buffer issue.\nOn Friday I\u2019ll get more time to whittle the code down, once I\u2019m done building it up.", "creation_time": "2011-02-16T23:15:41Z", "text": "It\u2019s hard to produce a testcase, because when I try to replicate it with just two 2d canvases, it doesn\u2019t appear. It feels like restore() doesn\u2019t reset globalCompositeOperation or there\u2019s a double buffer issue.\nOn Friday I\u2019ll get more time to whittle the code down, once I\u2019m done building it up.", "creator": "john@nextraweb.com", "tags": [], "count": 2, "bug_id": 633947, "author": "john@nextraweb.com", "is_private": false, "time": "2011-02-16T23:15:41Z", "attachment_id": null}, {"author": "john@nextraweb.com", "attachment_id": 512946, "bug_id": 633947, "time": "2011-02-16T23:20:40Z", "count": 3, "tags": [], "creator": "john@nextraweb.com", "text": "Created attachment 512946\ncomposite screenshot of before and after operation\n\nLeft half is after page load, right is after I have clicked on the green bit (called a leg). It runs the above code on the canvas, calls getImageData to update the texture, and I\u2019m left with a 3d view with a transparent texture. I know 3D isn\u2019t dying, because the alpha background is from gl.clearColor(0.0, 0.0, 0.0, 0.5);\nIf I change the fillStyle in the code above so its not alpha 0.0 for erase, I\u2019m left with *one* pixel drawn on the model, rest is transparent.", "is_private": false, "creation_time": "2011-02-16T23:20:40Z", "raw_text": "Left half is after page load, right is after I have clicked on the green bit (called a leg). It runs the above code on the canvas, calls getImageData to update the texture, and I\u2019m left with a 3d view with a transparent texture. I know 3D isn\u2019t dying, because the alpha background is from gl.clearColor(0.0, 0.0, 0.0, 0.5);\nIf I change the fillStyle in the code above so its not alpha 0.0 for erase, I\u2019m left with *one* pixel drawn on the model, rest is transparent.", "id": 5284832}]}}, "comments": {}}