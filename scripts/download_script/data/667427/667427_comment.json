{"comments": {}, "bugs": {"667427": {"comments": [{"creator": "sebi.auer@web.de", "text": "Created attachment 542131\nScreenshot\n\nUser Agent: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild ID: 20110413222027\n\nSteps to reproduce:\n\nI tried to add a menulist via DOMParser.\n\nThis is the code:\n\n==============\ntest.xul:\n==============\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<?xml-stylesheet href=\"chrome://global/skin/\" type=\"text/css\"?>\n<window xmlns=\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\"\n    xmlns:html=\"http://www.w3.org/1999/xhtml\"\n    buttons=\"accept,cancel\"\n    buttonlabelcancel=\"Cancel\" buttonlabelaccept=\"OK\"\n    ondialogaccept=\"\" ondialogcancel=\"\">\n<script type=\"application/javascript\" src=\"chrome://hello/content/test.js\"/>\n    \n<vbox id=\"something\">\n\t<button label=\"add\" oncommand=\"addMenu();\" />\n\t<menulist>\n\t  <menupopup>\n\t    <menuitem label=\"Item 1\" selected=\"true\" />\n\t    <menuitem label=\"Item 2\" />\n\t    <menuitem label=\"Item 3\" />\n\t  </menupopup>\n\t</menulist>\n</vbox>\n\n</window>\n\n\n\n===========\ntest.js\n===========\nfunction addNameSpace(src) {\n\tvar tags = [\"menulist\", \"menuitem\", \"menupopup\"];\n\n\tfor(var i in tags) {\n    \tsrc = src.replace(new RegExp( \"<\"+tags[i], \"gi\" ), \"<\"+tags[i]+\" xmlns=\\\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\\\"\");\n\t}\n\treturn src;\n}\n\nfunction srcToNode(src) {\n\tsrc = addNameSpace(src);\n    var xul = (new DOMParser()).parseFromString(src, \"text/xml\");\n    return xul.documentElement;\n}\n\nfunction addMenu(id) {\n\tvar parent = document.getElementById(\"something\");\n\t\n\tvar src = '\\\n\t\t\t\t<menulist>\\\n\t\t\t        <menupopup>\\\n\t\t\t          <menuitem label=\"Item 1\" selected=\"true\" />\\\n\t\t\t          <menuitem label=\"Item 2\" />\\\n\t\t\t          <menuitem label=\"Item 3\" />\\\n\t\t\t        </menupopup>\\\n\t\t\t\t</menulist>';\n   \tparent.appendChild(srcToNode(src));\n}\n\n\n\nActual results:\n\nWhen I press the \"add\" button a thin line is being added to the the window. When you click on the line the menupopup is being shown (see Screenshot).\n\n\nExpected results:\n\nWhen you press the \"add\" button a menulist like the one that is already visible should be added to the window. There was only the thin line visible instead (see Screenshot).", "count": 0, "author": "sebi.auer@web.de", "bug_id": 667427, "id": 5558412, "is_private": false, "creation_time": "2011-06-27T12:16:24Z", "time": "2011-06-27T12:16:24Z", "raw_text": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild ID: 20110413222027\n\nSteps to reproduce:\n\nI tried to add a menulist via DOMParser.\n\nThis is the code:\n\n==============\ntest.xul:\n==============\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<?xml-stylesheet href=\"chrome://global/skin/\" type=\"text/css\"?>\n<window xmlns=\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\"\n    xmlns:html=\"http://www.w3.org/1999/xhtml\"\n    buttons=\"accept,cancel\"\n    buttonlabelcancel=\"Cancel\" buttonlabelaccept=\"OK\"\n    ondialogaccept=\"\" ondialogcancel=\"\">\n<script type=\"application/javascript\" src=\"chrome://hello/content/test.js\"/>\n    \n<vbox id=\"something\">\n\t<button label=\"add\" oncommand=\"addMenu();\" />\n\t<menulist>\n\t  <menupopup>\n\t    <menuitem label=\"Item 1\" selected=\"true\" />\n\t    <menuitem label=\"Item 2\" />\n\t    <menuitem label=\"Item 3\" />\n\t  </menupopup>\n\t</menulist>\n</vbox>\n\n</window>\n\n\n\n===========\ntest.js\n===========\nfunction addNameSpace(src) {\n\tvar tags = [\"menulist\", \"menuitem\", \"menupopup\"];\n\n\tfor(var i in tags) {\n    \tsrc = src.replace(new RegExp( \"<\"+tags[i], \"gi\" ), \"<\"+tags[i]+\" xmlns=\\\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\\\"\");\n\t}\n\treturn src;\n}\n\nfunction srcToNode(src) {\n\tsrc = addNameSpace(src);\n    var xul = (new DOMParser()).parseFromString(src, \"text/xml\");\n    return xul.documentElement;\n}\n\nfunction addMenu(id) {\n\tvar parent = document.getElementById(\"something\");\n\t\n\tvar src = '\\\n\t\t\t\t<menulist>\\\n\t\t\t        <menupopup>\\\n\t\t\t          <menuitem label=\"Item 1\" selected=\"true\" />\\\n\t\t\t          <menuitem label=\"Item 2\" />\\\n\t\t\t          <menuitem label=\"Item 3\" />\\\n\t\t\t        </menupopup>\\\n\t\t\t\t</menulist>';\n   \tparent.appendChild(srcToNode(src));\n}\n\n\n\nActual results:\n\nWhen I press the \"add\" button a thin line is being added to the the window. When you click on the line the menupopup is being shown (see Screenshot).\n\n\nExpected results:\n\nWhen you press the \"add\" button a menulist like the one that is already visible should be added to the window. There was only the thin line visible instead (see Screenshot).", "attachment_id": 542131, "tags": []}, {"id": 5559083, "bug_id": 667427, "is_private": false, "creation_time": "2011-06-27T17:35:37Z", "creator": "bzbarsky@mit.edu", "text": "XUL parsing is not the same as normal XML parsing.  For example, it strips whitespace out.  This can matter.  Does removing the intertag whitespace in your string make things work?", "count": 1, "author": "bzbarsky@mit.edu", "tags": [], "time": "2011-06-27T17:35:37Z", "raw_text": "XUL parsing is not the same as normal XML parsing.  For example, it strips whitespace out.  This can matter.  Does removing the intertag whitespace in your string make things work?", "attachment_id": null}]}}}