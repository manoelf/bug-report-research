{"bugs": {"649247": {"comments": [{"id": 5402969, "time": "2011-04-12T06:38:06Z", "author": "fryn@frankyan.com", "count": 0, "text": "I plan to discuss style resolution in relation to CSS transitions with David Baron soon, but Gavin wanted me to file a bug and reference it in the patch I'm about to land, so here it is.\n\nA typical block of code that I write to skip the animation once is:\nCSS:\n#foo { width: 50px; -moz-transition: width 1s; }\nJS:\nvar foo = document.getElementById('foo');\nfoo.style.MozTransition = 'none';\nfoo.style.width = '100px';\nfoo.clientTop; // force style resolution\nfoo.style.MozTransition = '';\n\nUsing element.clientTop in this way is rather common in our codebase:\nhttps://mxr.mozilla.org/mozilla-central/search?string=.clientTop%3B\n\nGavin considers this to be a hack and would like some investigation and dicussion on why we need this or how to make it better.\n\nLast week, I made a few testcases for this here:\nhttp://frankyan.com/labs/racy.html\nIt is so named for the race conditions.\nWhether or not the transitions occur seem to be unpredictable for the last two boxes on Linux.", "is_private": false, "attachment_id": null, "tags": [], "creator": "fryn@frankyan.com", "creation_time": "2011-04-12T06:38:06Z", "bug_id": 649247, "raw_text": "I plan to discuss style resolution in relation to CSS transitions with David Baron soon, but Gavin wanted me to file a bug and reference it in the patch I'm about to land, so here it is.\n\nA typical block of code that I write to skip the animation once is:\nCSS:\n#foo { width: 50px; -moz-transition: width 1s; }\nJS:\nvar foo = document.getElementById('foo');\nfoo.style.MozTransition = 'none';\nfoo.style.width = '100px';\nfoo.clientTop; // force style resolution\nfoo.style.MozTransition = '';\n\nUsing element.clientTop in this way is rather common in our codebase:\nhttps://mxr.mozilla.org/mozilla-central/search?string=.clientTop%3B\n\nGavin considers this to be a hack and would like some investigation and dicussion on why we need this or how to make it better.\n\nLast week, I made a few testcases for this here:\nhttp://frankyan.com/labs/racy.html\nIt is so named for the race conditions.\nWhether or not the transitions occur seem to be unpredictable for the last two boxes on Linux."}, {"count": 1, "text": "So, a few thoughts here:\n\n * it would probably be good if we had common functions for flush_style, flush_frames(), flush_layout(), etc.  In this case we only need flush_style() (which you can do with something like getComputedStyle(document.documentElement, \"\").color -- at least so that we can spot intentional flushes easily, and perhaps work on figuring out how we can avoid them\n\n * a possible solution here would be an API like the one I proposed here:\nhttp://lists.w3.org/Archives/Public/www-style/2011Mar/0729.html though the only response so far: http://lists.w3.org/Archives/Public/www-style/2011Mar/0730.html is not exactly supportive.  With an API like this, if you're doing *all* your transitions from script, you could just use this API rather than using style-change-triggered transitions.", "author": "dbaron@dbaron.org", "creator": "dbaron@dbaron.org", "attachment_id": null, "id": 5412872, "time": "2011-04-15T21:34:09Z", "tags": [], "raw_text": "So, a few thoughts here:\n\n * it would probably be good if we had common functions for flush_style, flush_frames(), flush_layout(), etc.  In this case we only need flush_style() (which you can do with something like getComputedStyle(document.documentElement, \"\").color -- at least so that we can spot intentional flushes easily, and perhaps work on figuring out how we can avoid them\n\n * a possible solution here would be an API like the one I proposed here:\nhttp://lists.w3.org/Archives/Public/www-style/2011Mar/0729.html though the only response so far: http://lists.w3.org/Archives/Public/www-style/2011Mar/0730.html is not exactly supportive.  With an API like this, if you're doing *all* your transitions from script, you could just use this API rather than using style-change-triggered transitions.", "creation_time": "2011-04-15T21:34:09Z", "bug_id": 649247, "is_private": false}, {"creator": "bzbarsky@mit.edu", "attachment_id": null, "text": "> * it would probably be good if we had common functions for flush_style,\n> flush_frames(), flush_layout(), etc. \n\nYes!  Can we put them somewhere where reftest can trigger them too?", "count": 2, "author": "bzbarsky@mit.edu", "bug_id": 649247, "creation_time": "2011-04-16T00:36:17Z", "raw_text": "> * it would probably be good if we had common functions for flush_style,\n> flush_frames(), flush_layout(), etc. \n\nYes!  Can we put them somewhere where reftest can trigger them too?", "tags": [], "is_private": false, "time": "2011-04-16T00:36:17Z", "id": 5413295}, {"attachment_id": null, "creator": "dveditz@mozilla.com", "author": "dveditz@mozilla.com", "count": 3, "text": "Frank: What is the concern that caused you to mark this a security bug?", "is_private": false, "bug_id": 649247, "creation_time": "2016-01-26T18:08:01Z", "raw_text": "Frank: What is the concern that caused you to mark this a security bug?", "tags": [], "time": "2016-01-26T18:08:01Z", "id": 11109362}, {"time": "2016-01-26T20:32:24Z", "author": "fryn@frankyan.com", "id": 11110020, "text": "Accidental. Feel free to unmark.", "count": 4, "attachment_id": null, "is_private": false, "creation_time": "2016-01-26T20:32:24Z", "bug_id": 649247, "raw_text": "Accidental. Feel free to unmark.", "tags": [], "creator": "fryn@frankyan.com"}]}}, "comments": {}}