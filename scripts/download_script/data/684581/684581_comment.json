{"comments": {}, "bugs": {"684581": {"comments": [{"creator": "igor@mir2.org", "author": "igor@mir2.org", "raw_text": "Consider the following page:\n\n<script>\nalert(1);\n</script>\n\nWhen it shows the alert about:memory gives for it after I pressed minimize memory usage on 32-bit Linux:\n\n69,632 B (00.09%) -- gc-heap\n\u2502  \u2502      \u2502  \u251c\u2500\u250040,960 B (00.05%) -- arena-unused\n\u2502  \u2502      \u2502  \u251c\u2500\u250015,208 B (00.02%) -- objects\n\u2502  \u2502      \u2502  \u251c\u2500\u250011,520 B (00.01%) -- shapes\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500896 B (00.00%) -- type-objects\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500392 B (00.00%) -- arena-padding\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500384 B (00.00%) -- scripts\n\u2502  \u2502      \u2502  \u2514\u2500\u2500\u2500\u2500\u2500272 B (00.00%) -- arena-headers\n\nThat is, among almost 70K of GC aenas we waste 40K or 59% in arena tails.\n\nNow consider another page:\n\n<script>\nvar a = 1;\n</script>\n\nAfter it loads I have:\n\n110,592 B (00.10%) -- gc-heap\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250047,872 B (00.04%) -- arena-unused\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250032,680 B (00.03%) -- shapes\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250027,808 B (00.02%) -- objects\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u25001,152 B (00.00%) -- type-objects\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500432 B (00.00%) -- arena-headers\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500392 B (00.00%) -- arena-padding\n\u2502   \u2502     \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500256 B (00.00%) -- scripts \n\n\nhere again we waste over 40% in arena tail. It also shows way too much memory allocated for shapes, I file that in another bug.\n\nThis tells for pages with small amount of JS code 4K arenas are not suitable. So we should investigate 2K arenas and see how it would affect the memory usage.", "creation_time": "2011-09-04T12:45:55Z", "text": "Consider the following page:\n\n<script>\nalert(1);\n</script>\n\nWhen it shows the alert about:memory gives for it after I pressed minimize memory usage on 32-bit Linux:\n\n69,632 B (00.09%) -- gc-heap\n\u2502  \u2502      \u2502  \u251c\u2500\u250040,960 B (00.05%) -- arena-unused\n\u2502  \u2502      \u2502  \u251c\u2500\u250015,208 B (00.02%) -- objects\n\u2502  \u2502      \u2502  \u251c\u2500\u250011,520 B (00.01%) -- shapes\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500896 B (00.00%) -- type-objects\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500392 B (00.00%) -- arena-padding\n\u2502  \u2502      \u2502  \u251c\u2500\u2500\u2500\u2500\u2500384 B (00.00%) -- scripts\n\u2502  \u2502      \u2502  \u2514\u2500\u2500\u2500\u2500\u2500272 B (00.00%) -- arena-headers\n\nThat is, among almost 70K of GC aenas we waste 40K or 59% in arena tails.\n\nNow consider another page:\n\n<script>\nvar a = 1;\n</script>\n\nAfter it loads I have:\n\n110,592 B (00.10%) -- gc-heap\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250047,872 B (00.04%) -- arena-unused\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250032,680 B (00.03%) -- shapes\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u250027,808 B (00.02%) -- objects\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u25001,152 B (00.00%) -- type-objects\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500432 B (00.00%) -- arena-headers\n\u2502   \u2502     \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500392 B (00.00%) -- arena-padding\n\u2502   \u2502     \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500256 B (00.00%) -- scripts \n\n\nhere again we waste over 40% in arena tail. It also shows way too much memory allocated for shapes, I file that in another bug.\n\nThis tells for pages with small amount of JS code 4K arenas are not suitable. So we should investigate 2K arenas and see how it would affect the memory usage.", "attachment_id": null, "time": "2011-09-04T12:45:55Z", "tags": [], "is_private": false, "count": 0, "id": 5699011, "bug_id": 684581}, {"count": 1, "is_private": false, "tags": [], "id": 5699933, "bug_id": 684581, "creation_time": "2011-09-04T23:49:12Z", "raw_text": "If we didn't have so many different arena kinds the problem would also presumably be smaller.", "text": "If we didn't have so many different arena kinds the problem would also presumably be smaller.", "time": "2011-09-04T23:49:12Z", "attachment_id": null, "creator": "n.nethercote@gmail.com", "author": "n.nethercote@gmail.com"}]}}}