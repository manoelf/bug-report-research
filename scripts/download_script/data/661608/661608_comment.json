{"bugs": {"661608": {"comments": [{"text": "User-Agent:       Mozilla/5.0 (X11; Linux x86_64; rv:7.0a1) Gecko/20110602 Firefox/7.0a1\nBuild Identifier: \n\nhttp://html5demos.com/video-canvas \nwhen the FF are in the tab of the canvasvideo the Xorg process start to consume around 30% of CPU and FF start to use around 25% of CPU but the video are PAUSED...\n\nI have tested it with HWACCEL and without it, botch cases same consumption.\n\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1.open http://html5demos.com/video-canvas\n2.that's all, Xorg and FF process will start to use lot of CPU in PAUSE MODE\n3.\n\nActual Results:  \ntoo much CPU consumption, some friends told me they have in Windows around 1 to 3% of CPU usage in pause mode\n\nExpected Results:  \nto use minus CPU when the video are in PAUSE state.\n\nmy CPU it's an AMD Athlon X2 (2cores)\n\nthe guy of 1 to 3% of CPU have an Intel Core I7(4cores)\n\na friend told me it have around 18% of CPU usage in Windows with same canvasvideo with a AMD Sempron CPU at 32bit 1,8Ghz (1core)", "attachment_id": null, "time": "2011-06-02T18:45:38Z", "creation_time": "2011-06-02T18:45:38Z", "raw_text": "User-Agent:       Mozilla/5.0 (X11; Linux x86_64; rv:7.0a1) Gecko/20110602 Firefox/7.0a1\nBuild Identifier: \n\nhttp://html5demos.com/video-canvas \nwhen the FF are in the tab of the canvasvideo the Xorg process start to consume around 30% of CPU and FF start to use around 25% of CPU but the video are PAUSED...\n\nI have tested it with HWACCEL and without it, botch cases same consumption.\n\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1.open http://html5demos.com/video-canvas\n2.that's all, Xorg and FF process will start to use lot of CPU in PAUSE MODE\n3.\n\nActual Results:  \ntoo much CPU consumption, some friends told me they have in Windows around 1 to 3% of CPU usage in pause mode\n\nExpected Results:  \nto use minus CPU when the video are in PAUSE state.\n\nmy CPU it's an AMD Athlon X2 (2cores)\n\nthe guy of 1 to 3% of CPU have an Intel Core I7(4cores)\n\na friend told me it have around 18% of CPU usage in Windows with same canvasvideo with a AMD Sempron CPU at 32bit 1,8Ghz (1core)", "bug_id": 661608, "is_private": false, "count": 0, "tags": [], "id": 5509180, "creator": "maximi89@gmail.com", "author": "maximi89@gmail.com"}, {"author": "bzbarsky@mit.edu", "creator": "bzbarsky@mit.edu", "bug_id": 661608, "id": 5509560, "is_private": false, "count": 1, "tags": [], "time": "2011-06-02T21:17:44Z", "attachment_id": null, "text": "Why does being paused matter?  The page is drawing the video to the canvas every 60ms even when the video is paused.  The only thing that changes when not paused is that the video needs to be decoded too in that case; the canvas side is exactly that same.\n\nFor what it's worth, I see about the same low CPU usage on Mac as your friends on Windows are seeing.  But I bet on Linux just the X traffic back and forth could be killing us....", "raw_text": "Why does being paused matter?  The page is drawing the video to the canvas every 60ms even when the video is paused.  The only thing that changes when not paused is that the video needs to be decoded too in that case; the canvas side is exactly that same.\n\nFor what it's worth, I see about the same low CPU usage on Mac as your friends on Windows are seeing.  But I bet on Linux just the X traffic back and forth could be killing us....", "creation_time": "2011-06-02T21:17:44Z"}, {"bug_id": 661608, "is_private": false, "count": 2, "tags": [], "id": 5509759, "text": "i have tested epiphany browser and it use a total of 30% of CPU, 19% Xorg and 11% Epiphany but when i use Firefox 25% and Xorg 30%", "time": "2011-06-02T22:27:48Z", "attachment_id": null, "creation_time": "2011-06-02T22:27:48Z", "raw_text": "i have tested epiphany browser and it use a total of 30% of CPU, 19% Xorg and 11% Epiphany but when i use Firefox 25% and Xorg 30%", "creator": "maximi89@gmail.com", "author": "maximi89@gmail.com"}, {"creator": "karlt@mozbugz.karlt.net", "author": "karlt@mozbugz.karlt.net", "bug_id": 661608, "tags": [], "is_private": false, "count": 3, "id": 5509982, "text": "Some numbers from from my system with the video playing/paused and with window manager compositing on/off.  The scheduler ran the processes on the two hyperthreads of the first core of my 4-core system.\n\n                            firefox xorg\nplaying without compositing 52%     32%\npaused without compositing  12%     15%\nplaying with compositing    38%     36%\npaused with compositing     12%     18%\n\n(In reply to comment #1)\n> But I bet on Linux just the X traffic back\n> and forth could be killing us....\n\nThere shouldn't be any traffic coming back from the server (and I don't see any) but nsLayoutUtils::SurfaceFromElement() is getting a client-side system memory (\"image\") surface from the video layer each time and this gets uploaded to the server each canvas frame.\n\nThis particular situation would be better if the surface was an X pixmap (as it is with png/jpeg images), but I'm not sure that optimizing for repeatedly drawing a single frame of video would be sensible.", "time": "2011-06-02T23:48:44Z", "attachment_id": null, "raw_text": "Some numbers from from my system with the video playing/paused and with window manager compositing on/off.  The scheduler ran the processes on the two hyperthreads of the first core of my 4-core system.\n\n                            firefox xorg\nplaying without compositing 52%     32%\npaused without compositing  12%     15%\nplaying with compositing    38%     36%\npaused with compositing     12%     18%\n\n(In reply to comment #1)\n> But I bet on Linux just the X traffic back\n> and forth could be killing us....\n\nThere shouldn't be any traffic coming back from the server (and I don't see any) but nsLayoutUtils::SurfaceFromElement() is getting a client-side system memory (\"image\") surface from the video layer each time and this gets uploaded to the server each canvas frame.\n\nThis particular situation would be better if the surface was an X pixmap (as it is with png/jpeg images), but I'm not sure that optimizing for repeatedly drawing a single frame of video would be sensible.", "creation_time": "2011-06-02T23:48:44Z"}]}}, "comments": {}}