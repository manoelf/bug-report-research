{"bugs": {"858185": {"comments": [{"id": 7278436, "count": 0, "text": "+++ This bug was initially created as a clone of Bug #851520 +++\n\nFrom comment #0 there:\n\n<quote>\n\nSteps to reproduce:\n\nThis is new with the latest nightly build 22.0a1 (2013-03-15).  I have a Windows 7 (x64) PC with a high-res (200dpi) monitor and therefore have set text size 200% in Window's Control Panel.  With the 200% scaling, in most applications fonts appear at the same size as they would on a 100dpi monitor under normal scaling.\n\nTherefore I would expect Firefox to work the same way, with the default zoom level (View->Zoom->Reset) giving pixel sizes twice those you'd normally get (where 'normal' is a computer with the Windows font size set at its default 100%).\n\n\nActual results:\n\nHowever, in the latest nightly, the fonts are even bigger than would be expected.  For example the Google home page is rendered so large that it doesn't fit horizontally even though the screen is 2400 physical pixels wide.  I suspect that the 200% scaling is being double-counted somehow, so Firefox is now rendering everything at *four* times the number of pixels.\n\n</quote>\n\nThe user there had the Default FullZoom Level add-on configured for a default zoom of 200% (as a workaround for the lack of proper resolution-dependent scaling in Firefox). With the landing of hidpi support, this suddenly leads to 400% total scaling.\n\nThe patch in bug 851520 will fix this issue for the case where the zoom level is being remembered in Firefox content prefs (i.e., we normally restore the zoom when the user returns to a site where they had previously zoomed in manually). However, when an add-on such as Default FullZoom or NoSquint is used, the add-on will reimpose -its- zoom level, on top of the browser's default, and so the user still gets oversized pages.\n\nTo improve the user experience, we may want to reach out to authors of such add-ons and recommend adjustments.\n\n(We could also consider \"breaking\" compatibility with them by modifying the API that is used to zoom, but this would disrupt valid use-cases for the zoom API in addition to fixing the problem cases.)", "author": "jfkthame@gmail.com", "bug_id": 858185, "tags": [], "attachment_id": null, "creator": "jfkthame@gmail.com", "raw_text": "+++ This bug was initially created as a clone of Bug #851520 +++\n\nFrom comment #0 there:\n\n<quote>\n\nSteps to reproduce:\n\nThis is new with the latest nightly build 22.0a1 (2013-03-15).  I have a Windows 7 (x64) PC with a high-res (200dpi) monitor and therefore have set text size 200% in Window's Control Panel.  With the 200% scaling, in most applications fonts appear at the same size as they would on a 100dpi monitor under normal scaling.\n\nTherefore I would expect Firefox to work the same way, with the default zoom level (View->Zoom->Reset) giving pixel sizes twice those you'd normally get (where 'normal' is a computer with the Windows font size set at its default 100%).\n\n\nActual results:\n\nHowever, in the latest nightly, the fonts are even bigger than would be expected.  For example the Google home page is rendered so large that it doesn't fit horizontally even though the screen is 2400 physical pixels wide.  I suspect that the 200% scaling is being double-counted somehow, so Firefox is now rendering everything at *four* times the number of pixels.\n\n</quote>\n\nThe user there had the Default FullZoom Level add-on configured for a default zoom of 200% (as a workaround for the lack of proper resolution-dependent scaling in Firefox). With the landing of hidpi support, this suddenly leads to 400% total scaling.\n\nThe patch in bug 851520 will fix this issue for the case where the zoom level is being remembered in Firefox content prefs (i.e., we normally restore the zoom when the user returns to a site where they had previously zoomed in manually). However, when an add-on such as Default FullZoom or NoSquint is used, the add-on will reimpose -its- zoom level, on top of the browser's default, and so the user still gets oversized pages.\n\nTo improve the user experience, we may want to reach out to authors of such add-ons and recommend adjustments.\n\n(We could also consider \"breaking\" compatibility with them by modifying the API that is used to zoom, but this would disrupt valid use-cases for the zoom API in addition to fixing the problem cases.)", "time": "2013-04-04T19:04:28Z", "creation_time": "2013-04-04T19:04:28Z", "is_private": false}, {"raw_text": "Following up on https://bugzilla.mozilla.org/show_bug.cgi?id=844604#c32:\n\nAny add-on that sets the nsIMarkupDocumentViewer.fullZoom property is a candidate for closer examination as to why it's doing that and whether it should stop doing it, or at least adjust the zoom levels it's using.\n\nFor example, the Default FullZoom Level add-on does this in its ZoomManager.setZoomForBrowser method (among others) at:\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/199550/file/chrome/defaultfullzoomlevel.jar/content/viewZoomOverlay8.js#L59\n\nand NoSquint does it in its zoom method at:\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/200892/file/chrome/nosquint.jar/content/browser.js#L425", "attachment_id": null, "creator": "jfkthame@gmail.com", "count": 1, "time": "2013-04-05T19:07:10Z", "creation_time": "2013-04-05T19:07:10Z", "id": 7283064, "author": "jfkthame@gmail.com", "text": "Following up on https://bugzilla.mozilla.org/show_bug.cgi?id=844604#c32:\n\nAny add-on that sets the nsIMarkupDocumentViewer.fullZoom property is a candidate for closer examination as to why it's doing that and whether it should stop doing it, or at least adjust the zoom levels it's using.\n\nFor example, the Default FullZoom Level add-on does this in its ZoomManager.setZoomForBrowser method (among others) at:\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/199550/file/chrome/defaultfullzoomlevel.jar/content/viewZoomOverlay8.js#L59\n\nand NoSquint does it in its zoom method at:\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/200892/file/chrome/nosquint.jar/content/browser.js#L425", "tags": [], "is_private": false, "bug_id": 858185}, {"is_private": false, "raw_text": "Alice0775, the Default FullZoom Level add-on is yours, I believe; would you consider updating it to recognize when the browser switches to hidpi support, and discard or scale down any saved zoom levels?\n\nAs soon as we have a decision in bug 851520 on the exact API we'll expose to JS, I think it should be possible for add-ons to handle this situation. If there's anything further you need on the Gecko platform side, please let us know so we can provide the best possible user experience during the transition.\n\nJust FTR: on 2013-04-04, I emailed the author of NoSquint directly about this issue; have not had any response as yet.", "creator": "jfkthame@gmail.com", "attachment_id": null, "creation_time": "2013-04-08T15:27:24Z", "time": "2013-04-08T15:27:24Z", "author": "jfkthame@gmail.com", "text": "Alice0775, the Default FullZoom Level add-on is yours, I believe; would you consider updating it to recognize when the browser switches to hidpi support, and discard or scale down any saved zoom levels?\n\nAs soon as we have a decision in bug 851520 on the exact API we'll expose to JS, I think it should be possible for add-ons to handle this situation. If there's anything further you need on the Gecko platform side, please let us know so we can provide the best possible user experience during the transition.\n\nJust FTR: on 2013-04-04, I emailed the author of NoSquint directly about this issue; have not had any response as yet.", "tags": [], "bug_id": 858185, "count": 2, "id": 7289137}, {"tags": [], "bug_id": 858185, "author": "alice0775@gmail.com", "text": "I added migration code for hi-dpi display based on Bug 851520. \n\nhttps://addons.mozilla.org/en-US/firefox/addon/default-fullzoom-level/versions/?page=1#version-5.5", "count": 3, "id": 7297063, "is_private": false, "creation_time": "2013-04-10T00:08:23Z", "time": "2013-04-10T00:08:23Z", "raw_text": "I added migration code for hi-dpi display based on Bug 851520. \n\nhttps://addons.mozilla.org/en-US/firefox/addon/default-fullzoom-level/versions/?page=1#version-5.5", "creator": "alice0775@gmail.com", "attachment_id": null}, {"is_private": false, "raw_text": "Thanks for working on this so promptly. One question - is there a bug in the test here?\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/202800/file/chrome/defaultfullzoomlevel.jar/content/migration.js#L31\n\nIt looks to me like it should be >= 10, not > 10, if I'm understanding the intention correctly.", "creator": "jfkthame@gmail.com", "attachment_id": null, "creation_time": "2013-04-10T08:58:42Z", "time": "2013-04-10T08:58:42Z", "author": "jfkthame@gmail.com", "text": "Thanks for working on this so promptly. One question - is there a bug in the test here?\n\nhttps://addons.mozilla.org/en-US/firefox/files/browse/202800/file/chrome/defaultfullzoomlevel.jar/content/migration.js#L31\n\nIt looks to me like it should be >= 10, not > 10, if I'm understanding the intention correctly.", "tags": [], "bug_id": 858185, "count": 4, "id": 7298145}, {"is_private": false, "raw_text": "(In reply to Jonathan Kew (:jfkthame) from comment #2)\n> Just FTR: on 2013-04-04, I emailed the author of NoSquint directly about\n> this issue; have not had any response as yet.\n\nJorge - would you happen to have better contact with NoSquint?", "creator": "akeybl@mozilla.com", "attachment_id": null, "creation_time": "2013-04-10T19:14:46Z", "time": "2013-04-10T19:14:46Z", "author": "akeybl@mozilla.com", "text": "(In reply to Jonathan Kew (:jfkthame) from comment #2)\n> Just FTR: on 2013-04-04, I emailed the author of NoSquint directly about\n> this issue; have not had any response as yet.\n\nJorge - would you happen to have better contact with NoSquint?", "tags": [], "bug_id": 858185, "count": 5, "id": 7300584}, {"count": 6, "id": 7301117, "author": "jorgev@fastmail.fm", "text": "(In reply to Alex Keybl [:akeybl] from comment #5)\n> (In reply to Jonathan Kew (:jfkthame) from comment #2)\n> > Just FTR: on 2013-04-04, I emailed the author of NoSquint directly about\n> > this issue; have not had any response as yet.\n> \n> Jorge - would you happen to have better contact with NoSquint?\n\nHis user address is the same as the one available for support. The add-on is actively being worked on, though. Maybe it would be a good idea to create an issue on his tracker: https://github.com/jtackaberry/nosquint/issues?page=1&state=open", "tags": [], "bug_id": 858185, "raw_text": "(In reply to Alex Keybl [:akeybl] from comment #5)\n> (In reply to Jonathan Kew (:jfkthame) from comment #2)\n> > Just FTR: on 2013-04-04, I emailed the author of NoSquint directly about\n> > this issue; have not had any response as yet.\n> \n> Jorge - would you happen to have better contact with NoSquint?\n\nHis user address is the same as the one available for support. The add-on is actively being worked on, though. Maybe it would be a good idea to create an issue on his tracker: https://github.com/jtackaberry/nosquint/issues?page=1&state=open", "attachment_id": null, "creator": "jorgev@fastmail.fm", "time": "2013-04-10T21:15:20Z", "creation_time": "2013-04-10T21:15:20Z", "is_private": false}, {"id": 7312087, "count": 7, "text": "I've filed https://github.com/jtackaberry/nosquint/issues/75 about this.", "author": "jfkthame@gmail.com", "bug_id": 858185, "tags": [], "creator": "jfkthame@gmail.com", "attachment_id": null, "raw_text": "I've filed https://github.com/jtackaberry/nosquint/issues/75 about this.", "creation_time": "2013-04-13T16:35:00Z", "time": "2013-04-13T16:35:00Z", "is_private": false}, {"attachment_id": null, "creator": "jfkthame@gmail.com", "raw_text": "Alice0775, did you check the question raised in comment #4? I'm concerned the migration code in your add-on may not be quite correct.", "time": "2013-04-13T16:38:38Z", "id": 7312090, "creation_time": "2013-04-13T16:38:38Z", "count": 8, "text": "Alice0775, did you check the question raised in comment #4? I'm concerned the migration code in your add-on may not be quite correct.", "author": "jfkthame@gmail.com", "bug_id": 858185, "is_private": false, "tags": []}, {"author": "alice0775@gmail.com", "text": "I am waiting that Bug 851520 up lift to aurora22.0a2.\nAnd then I will re-check the  migration code.", "is_private": false, "tags": [], "bug_id": 858185, "raw_text": "I am waiting that Bug 851520 up lift to aurora22.0a2.\nAnd then I will re-check the  migration code.", "creator": "alice0775@gmail.com", "attachment_id": null, "count": 9, "creation_time": "2013-04-13T16:55:59Z", "id": 7312100, "time": "2013-04-13T16:55:59Z"}, {"tags": [], "bug_id": 858185, "author": "jfkthame@gmail.com", "text": "OK, thanks. I've just nominated 851520 for uplift.", "count": 10, "id": 7312112, "is_private": false, "time": "2013-04-13T17:13:04Z", "creation_time": "2013-04-13T17:13:04Z", "raw_text": "OK, thanks. I've just nominated 851520 for uplift.", "attachment_id": null, "creator": "jfkthame@gmail.com"}, {"is_private": false, "raw_text": "needsinfo on Alice to help with comment #9, since 851520 already landed on aurora.", "creator": "bajaj.bhavana@gmail.com", "attachment_id": null, "creation_time": "2013-04-24T20:09:50Z", "time": "2013-04-24T20:09:50Z", "author": "bajaj.bhavana@gmail.com", "text": "needsinfo on Alice to help with comment #9, since 851520 already landed on aurora.", "tags": [], "bug_id": 858185, "count": 11, "id": 7351860}, {"text": "(In reply to bhavana bajaj [:bajaj] from comment #11)\n> needsinfo on Alice to help with comment #9, since 851520 already landed on\n> aurora.\n\nI have checked with aurora and released revised version of the addon(ver5.8)", "author": "alice0775@gmail.com", "bug_id": 858185, "tags": [], "is_private": false, "attachment_id": null, "creator": "alice0775@gmail.com", "raw_text": "(In reply to bhavana bajaj [:bajaj] from comment #11)\n> needsinfo on Alice to help with comment #9, since 851520 already landed on\n> aurora.\n\nI have checked with aurora and released revised version of the addon(ver5.8)", "time": "2013-04-24T20:44:42Z", "creation_time": "2013-04-24T20:44:42Z", "id": 7352053, "count": 12}, {"creation_time": "2013-04-24T20:56:46Z", "time": "2013-04-24T20:56:46Z", "creator": "jfkthame@gmail.com", "attachment_id": null, "raw_text": "Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's NoSquint, are there other add-ons that people use to set a zoom level? Can we get help (from the AMO team? jorge?) to track down any other developers we should be reaching out to about this issue?", "is_private": false, "id": 7352084, "count": 13, "bug_id": 858185, "tags": [], "text": "Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's NoSquint, are there other add-ons that people use to set a zoom level? Can we get help (from the AMO team? jorge?) to track down any other developers we should be reaching out to about this issue?", "author": "jfkthame@gmail.com"}, {"text": "(In reply to Jonathan Kew (:jfkthame) from comment #13)\n> Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's\n> NoSquint, are there other add-ons that people use to set a zoom level? Can\n> we get help (from the AMO team? jorge?) to track down any other developers\n> we should be reaching out to about this issue?\n\nWhat code are we looking for that we know would break?\n\nIf I understand this correctly, bug 851520 should be flagged for addon-compat and we will notify add-on developers about it when we start looking into Firefox 22 compatibility (in a few weeks). If that's the case, this bug should be closed since we don't track individual add-on compatibility in Bugzilla.", "author": "jorgev@fastmail.fm", "bug_id": 858185, "tags": [], "id": 7372958, "count": 14, "is_private": false, "creator": "jorgev@fastmail.fm", "attachment_id": null, "raw_text": "(In reply to Jonathan Kew (:jfkthame) from comment #13)\n> Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's\n> NoSquint, are there other add-ons that people use to set a zoom level? Can\n> we get help (from the AMO team? jorge?) to track down any other developers\n> we should be reaching out to about this issue?\n\nWhat code are we looking for that we know would break?\n\nIf I understand this correctly, bug 851520 should be flagged for addon-compat and we will notify add-on developers about it when we start looking into Firefox 22 compatibility (in a few weeks). If that's the case, this bug should be closed since we don't track individual add-on compatibility in Bugzilla.", "creation_time": "2013-04-30T21:57:23Z", "time": "2013-04-30T21:57:23Z"}, {"id": 7374594, "count": 15, "text": "(In reply to Jorge Villalobos [:jorgev] from comment #14)\n> (In reply to Jonathan Kew (:jfkthame) from comment #13)\n> > Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's\n> > NoSquint, are there other add-ons that people use to set a zoom level? Can\n> > we get help (from the AMO team? jorge?) to track down any other developers\n> > we should be reaching out to about this issue?\n> \n> What code are we looking for that we know would break?\n\nSee comment #1.\n\n(Note that such add-on code won't \"break\", in the sense of throwing an error, failing to execute, etc.; the concern is that it will result in a poor/unexpected user experience because of the changed platform behavior.)", "author": "jfkthame@gmail.com", "bug_id": 858185, "tags": [], "creator": "jfkthame@gmail.com", "attachment_id": null, "raw_text": "(In reply to Jorge Villalobos [:jorgev] from comment #14)\n> (In reply to Jonathan Kew (:jfkthame) from comment #13)\n> > Besides Alice's Default FullZoom Level add-on and Jason Tackaberry's\n> > NoSquint, are there other add-ons that people use to set a zoom level? Can\n> > we get help (from the AMO team? jorge?) to track down any other developers\n> > we should be reaching out to about this issue?\n> \n> What code are we looking for that we know would break?\n\nSee comment #1.\n\n(Note that such add-on code won't \"break\", in the sense of throwing an error, failing to execute, etc.; the concern is that it will result in a poor/unexpected user experience because of the changed platform behavior.)", "creation_time": "2013-05-01T08:32:13Z", "time": "2013-05-01T08:32:13Z", "is_private": false}, {"raw_text": "There are a few add-ons that appear to set this property, probably a dozen or more:\nhttps://mxr.mozilla.org/addons/search?string=.fullZoom&find=&findi=&filter=^[^\\0]*%24&hitlimit=&tree=addons\n\nI flagges bug 851520 so that it is included in the compatibility communications.", "attachment_id": null, "creator": "jorgev@fastmail.fm", "count": 16, "time": "2013-05-02T19:55:33Z", "id": 7381496, "creation_time": "2013-05-02T19:55:33Z", "author": "jorgev@fastmail.fm", "text": "There are a few add-ons that appear to set this property, probably a dozen or more:\nhttps://mxr.mozilla.org/addons/search?string=.fullZoom&find=&findi=&filter=^[^\\0]*%24&hitlimit=&tree=addons\n\nI flagges bug 851520 so that it is included in the compatibility communications.", "tags": [], "is_private": false, "bug_id": 858185}, {"creation_time": "2013-05-13T16:52:48Z", "id": 7416804, "time": "2013-05-13T16:52:48Z", "count": 17, "creator": "jorgev@fastmail.fm", "attachment_id": null, "raw_text": "Closing this, per comment #14 and comment #16 (noting I meant to say \"flagged\"). We will notify developer about this when we send the compatibility communications for Firefox 22, hopefully within the next couple of weeks.", "bug_id": 858185, "tags": [], "is_private": false, "text": "Closing this, per comment #14 and comment #16 (noting I meant to say \"flagged\"). We will notify developer about this when we send the compatibility communications for Firefox 22, hopefully within the next couple of weeks.", "author": "jorgev@fastmail.fm"}, {"tags": [], "is_private": false, "bug_id": 858185, "author": "rjonna@gmail.com", "text": "What should we do to avoid th error while submitting the addon? I read all the comments on this page but couldn't quite understand what to do.\n\nError: Setting the `fullZoom` property can yield unexpected results in Gecko 22 and above.\nSee bug https://bugzilla.mozilla.org/show_bug.cgi?id=858185 for more information.", "count": 18, "time": "2013-06-18T22:56:00Z", "id": 7549670, "creation_time": "2013-06-18T22:56:00Z", "raw_text": "What should we do to avoid th error while submitting the addon? I read all the comments on this page but couldn't quite understand what to do.\n\nError: Setting the `fullZoom` property can yield unexpected results in Gecko 22 and above.\nSee bug https://bugzilla.mozilla.org/show_bug.cgi?id=858185 for more information.", "attachment_id": null, "creator": "rjonna@gmail.com"}, {"tags": [], "is_private": false, "bug_id": 858185, "author": "jorgev@fastmail.fm", "text": "On which add-on do you use fullZoom, and what for?", "count": 19, "time": "2013-06-19T17:59:38Z", "creation_time": "2013-06-19T17:59:38Z", "id": 7553307, "raw_text": "On which add-on do you use fullZoom, and what for?", "attachment_id": null, "creator": "jorgev@fastmail.fm"}, {"text": "We use it in CoolPreviews addon so the page auto-fits the preview window (which is usually smaller than regular window). We also give an option to the user to increase/decrease the zoom value.\n\n(In reply to Jorge Villalobos [:jorgev] from comment #19)\n> On which add-on do you use fullZoom, and what for?", "author": "rjonna@gmail.com", "bug_id": 858185, "is_private": false, "tags": [], "creator": "rjonna@gmail.com", "attachment_id": null, "raw_text": "We use it in CoolPreviews addon so the page auto-fits the preview window (which is usually smaller than regular window). We also give an option to the user to increase/decrease the zoom value.\n\n(In reply to Jorge Villalobos [:jorgev] from comment #19)\n> On which add-on do you use fullZoom, and what for?", "id": 7553360, "creation_time": "2013-06-19T18:13:13Z", "time": "2013-06-19T18:13:13Z", "count": 20}, {"count": 21, "id": 7569157, "creation_time": "2013-06-24T21:46:06Z", "time": "2013-06-24T21:46:06Z", "raw_text": "If you're only using it for your preview window, I don't think it's a big problem. Any visual bugs will only affect that window and not the main content area. You should test that it looks good in various configurations, though.", "creator": "jorgev@fastmail.fm", "attachment_id": null, "tags": [], "is_private": false, "bug_id": 858185, "author": "jorgev@fastmail.fm", "text": "If you're only using it for your preview window, I don't think it's a big problem. Any visual bugs will only affect that window and not the main content area. You should test that it looks good in various configurations, though."}]}}, "comments": {}}