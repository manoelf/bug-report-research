{"comments": {}, "bugs": {"660072": {"comments": [{"text": "Just like D3D Layers recover from D3D context losses, we need the same for GL layers.\n\nThis is probably harder, because when we lost the GL context, we lost all its state. Everything needs to be reinitialized from non-GL data.\n\nMy limited understanding is that we need to reconstruct the whole layers tree?\n\nRoc, do you have any pointers for me? How is the layers tree constructed in the first place?", "time": "2011-05-26T20:21:09Z", "attachment_id": null, "creation_time": "2011-05-26T20:21:09Z", "raw_text": "Just like D3D Layers recover from D3D context losses, we need the same for GL layers.\n\nThis is probably harder, because when we lost the GL context, we lost all its state. Everything needs to be reinitialized from non-GL data.\n\nMy limited understanding is that we need to reconstruct the whole layers tree?\n\nRoc, do you have any pointers for me? How is the layers tree constructed in the first place?", "bug_id": 660072, "count": 0, "is_private": false, "tags": [], "id": 5496037, "creator": "jacob.benoit.1@gmail.com", "author": "jacob.benoit.1@gmail.com"}, {"attachment_id": null, "time": "2011-05-26T23:54:25Z", "text": "Reconstructing the whole layer tree is not a problem. Just construct yourself a new LayerManager in nsWindow::GetLayerManager, just like Windows does (see the layerManagerD3D10->device() != gfxWindowsPlatform::GetPlatform()->GetD3D10Device() check).", "raw_text": "Reconstructing the whole layer tree is not a problem. Just construct yourself a new LayerManager in nsWindow::GetLayerManager, just like Windows does (see the layerManagerD3D10->device() != gfxWindowsPlatform::GetPlatform()->GetD3D10Device() check).", "creation_time": "2011-05-26T23:54:25Z", "bug_id": 660072, "id": 5496600, "tags": [], "count": 1, "is_private": false, "author": "roc@ocallahan.org", "creator": "roc@ocallahan.org"}, {"count": 2, "is_private": false, "tags": [], "id": 5511992, "bug_id": 660072, "raw_text": "Thanks for the pointer.\n\nIt turns out that implementing this is also likely a blocker for GL layers on mobile. Indeed, on Android, in Fennec with GL layers, pressing the 'back' button to go back to desktop, then clicking the Fennec icon to go back to Fennec, gives an entirely black window, and repeating these steps leads to GL_INVALID_OPERATION in innocent GL calls, so, while I haven't formally verified it, it seems that Android Application restore causes a GLES context loss.\n\n(And I'm not even talking about powering the device off and back on)", "creation_time": "2011-06-03T22:24:34Z", "text": "Thanks for the pointer.\n\nIt turns out that implementing this is also likely a blocker for GL layers on mobile. Indeed, on Android, in Fennec with GL layers, pressing the 'back' button to go back to desktop, then clicking the Fennec icon to go back to Fennec, gives an entirely black window, and repeating these steps leads to GL_INVALID_OPERATION in innocent GL calls, so, while I haven't formally verified it, it seems that Android Application restore causes a GLES context loss.\n\n(And I'm not even talking about powering the device off and back on)", "time": "2011-06-03T22:24:34Z", "attachment_id": null, "creator": "jacob.benoit.1@gmail.com", "author": "jacob.benoit.1@gmail.com"}, {"author": "roc@ocallahan.org", "creator": "roc@ocallahan.org", "time": "2011-06-03T23:49:47Z", "attachment_id": null, "text": "Note that losing the layers and resetting the layer manager means we lose the contents of canvases. We can also lose active video frames. I guess we can live with that for now.", "raw_text": "Note that losing the layers and resetting the layer manager means we lose the contents of canvases. We can also lose active video frames. I guess we can live with that for now.", "creation_time": "2011-06-03T23:49:47Z", "bug_id": 660072, "id": 5512198, "tags": [], "is_private": false, "count": 3}, {"creator": "jmuizelaar@mozilla.com", "author": "jmuizelaar@mozilla.com", "text": "(In reply to comment #2)\n> It turns out that implementing this is also likely a blocker for GL layers\n> on mobile. \n\nBenoit, can you update this bug? I recall you making some discoveries.", "attachment_id": null, "time": "2011-06-22T22:32:02Z", "raw_text": "(In reply to comment #2)\n> It turns out that implementing this is also likely a blocker for GL layers\n> on mobile. \n\nBenoit, can you update this bug? I recall you making some discoveries.", "creation_time": "2011-06-22T22:32:02Z", "bug_id": 660072, "is_private": false, "count": 4, "tags": [], "id": 5549596}, {"creator": "ajuma.bugzilla@alijuma.com", "author": "ajuma.bugzilla@alijuma.com", "bug_id": 660072, "count": 5, "is_private": false, "tags": [], "id": 5589747, "text": "(In reply to comment #2)\n> Indeed, on Android, in Fennec with GL layers, pressing the 'back'\n> button to go back to desktop, then clicking the Fennec icon to go back to\n> Fennec, gives an entirely black window,\n\nNote that in this case, rotating the device and then rotating it back \"resolves\" the problem -- the page is drawn correctly at the same position it was before.", "attachment_id": null, "time": "2011-07-13T19:42:55Z", "raw_text": "(In reply to comment #2)\n> Indeed, on Android, in Fennec with GL layers, pressing the 'back'\n> button to go back to desktop, then clicking the Fennec icon to go back to\n> Fennec, gives an entirely black window,\n\nNote that in this case, rotating the device and then rotating it back \"resolves\" the problem -- the page is drawn correctly at the same position it was before.", "creation_time": "2011-07-13T19:42:55Z"}, {"author": "florian.haenel@heeen.de", "creator": "florian.haenel@heeen.de", "raw_text": "I did some work on this same problem for meego about half a year ago - let me see if I can still find my patches.", "creation_time": "2011-07-15T19:00:27Z", "attachment_id": null, "time": "2011-07-15T19:00:27Z", "text": "I did some work on this same problem for meego about half a year ago - let me see if I can still find my patches.", "id": 5594004, "tags": [], "count": 6, "is_private": false, "bug_id": 660072}, {"author": "ajuma.bugzilla@alijuma.com", "creator": "ajuma.bugzilla@alijuma.com", "id": 5599630, "is_private": false, "count": 7, "tags": [], "bug_id": 660072, "raw_text": "The black window on restart problem seems to be a separate issue, so I've created a new bug: bug 672574", "creation_time": "2011-07-19T18:23:34Z", "time": "2011-07-19T18:23:34Z", "attachment_id": null, "text": "The black window on restart problem seems to be a separate issue, so I've created a new bug: bug 672574"}, {"author": "b56girard@gmail.com", "creator": "b56girard@gmail.com", "raw_text": "Hello nhirata, Douglas Sherk tells me that you have information on how to reproduce the EGL_CONTEXT_LOST on Android. Do you have any information you can share?", "creation_time": "2011-10-17T19:07:48Z", "attachment_id": null, "time": "2011-10-17T19:07:48Z", "text": "Hello nhirata, Douglas Sherk tells me that you have information on how to reproduce the EGL_CONTEXT_LOST on Android. Do you have any information you can share?", "id": 5786981, "count": 8, "is_private": false, "tags": [], "bug_id": 660072}, {"raw_text": "Ali, is this bug still valid?", "creation_time": "2012-06-19T12:41:40Z", "time": "2012-06-19T12:41:40Z", "attachment_id": null, "text": "Ali, is this bug still valid?", "id": 6402802, "tags": [], "is_private": false, "count": 9, "bug_id": 660072, "author": "jpr@mozilla.com", "creator": "jpr@mozilla.com"}, {"bug_id": 660072, "id": 6402838, "tags": [], "count": 10, "is_private": false, "time": "2012-06-19T12:55:53Z", "attachment_id": null, "text": "Sure is valid; might just not be a priority if context loss is exceedingly hard to reproduce.", "creation_time": "2012-06-19T12:55:53Z", "raw_text": "Sure is valid; might just not be a priority if context loss is exceedingly hard to reproduce.", "author": "jacob.benoit.1@gmail.com", "creator": "jacob.benoit.1@gmail.com"}, {"raw_text": "(In reply to Benoit Jacob [:bjacob] from comment #10)\n> Sure is valid; might just not be a priority if context loss is exceedingly\n> hard to reproduce.\n\nRight. Though we have no evidence that we're running into context loss with any non-negligible frequency, it's still something we should handle correctly.", "creation_time": "2012-06-19T16:00:19Z", "time": "2012-06-19T16:00:19Z", "attachment_id": null, "author": "ajuma.bugzilla@alijuma.com", "creator": "ajuma.bugzilla@alijuma.com", "text": "(In reply to Benoit Jacob [:bjacob] from comment #10)\n> Sure is valid; might just not be a priority if context loss is exceedingly\n> hard to reproduce.\n\nRight. Though we have no evidence that we're running into context loss with any non-negligible frequency, it's still something we should handle correctly.", "id": 6403489, "is_private": false, "count": 11, "tags": [], "bug_id": 660072}]}}}