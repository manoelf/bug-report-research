{"bugs": {"692225": {"comments": [{"raw_text": "Sync registers an idle observer with the nsIIdleService with an idle time of 5 minutes, to find out whether a machine is idle or the user has just come back to a machine. These events are used to adjust the sync interval and to trigger a sync.\n\nOn my MacBook Pro running OS X 10.6.8, I'm seeing the events like the following in the middle of the night (when nobody's using the machine) every 10 to 20 minutes:\n\n1317730539006\tSync.SyncScheduler\tTRACE\tWe're no longer idle.\n1317730539010\tSync.SyncScheduler\tTRACE\tWe're idle.\n\nThe first line gets printed on 'back', the second line gets printed on 'idle'. Notice they're only 4 milliseconds apart! It almost looks like we're notifying 'back' and then 'idle' within the same event loop tick.\n\n(In bug 691988 we are now working around the issue by debouncing the 'back' notification by 100ms.)", "attachment_id": null, "bug_id": 692225, "text": "Sync registers an idle observer with the nsIIdleService with an idle time of 5 minutes, to find out whether a machine is idle or the user has just come back to a machine. These events are used to adjust the sync interval and to trigger a sync.\n\nOn my MacBook Pro running OS X 10.6.8, I'm seeing the events like the following in the middle of the night (when nobody's using the machine) every 10 to 20 minutes:\n\n1317730539006\tSync.SyncScheduler\tTRACE\tWe're no longer idle.\n1317730539010\tSync.SyncScheduler\tTRACE\tWe're idle.\n\nThe first line gets printed on 'back', the second line gets printed on 'idle'. Notice they're only 4 milliseconds apart! It almost looks like we're notifying 'back' and then 'idle' within the same event loop tick.\n\n(In bug 691988 we are now working around the issue by debouncing the 'back' notification by 100ms.)", "tags": [], "is_private": false, "id": 5761274, "count": 0, "author": "philipp@weitershausen.de", "creator": "philipp@weitershausen.de", "creation_time": "2011-10-05T19:42:23Z", "time": "2011-10-05T19:42:23Z"}, {"attachment_id": null, "raw_text": "Are you able to test on other platforms?\n\nIf so, do you see it there, too?", "tags": [], "bug_id": 692225, "text": "Are you able to test on other platforms?\n\nIf so, do you see it there, too?", "id": 5761454, "count": 1, "is_private": false, "time": "2011-10-05T20:31:24Z", "creation_time": "2011-10-05T20:31:24Z", "creator": "smichaud@pobox.com", "author": "smichaud@pobox.com"}, {"raw_text": "As far as I can tell, my Windows 7 desktop is not getting those spurious idle events. At night it happily syncs only once per hour as it should, without ever waking up from idle on its own. It seems that this is an OS X only bug, though I haven't tested on Linux.\n\nIf you want to reproduce it with Sync, here's how:\n\n* Procure an OS X machine running Firefox 7 or later that doesn't have bug 691988 in it. (It hasn't landed anywhere yet, but I imagine it will soon.)\n* Connect to a Sync account that has at least one other device connected, so that with the OS X machine there are at least 2 devices in total.\n* In about:config, set 'services.sync.log.logger.service.main' to 'Trace' (without the quotes; note the capital T) and flip 'services.sync.log.appender.file.logOnSuccess' to true.\n* Restart the browser.\n* Walk away from the machine and don't touch it for a few hours.\n* Go to about:sync-log.\n\nExpected results:\n\nYou should see a success-NNN.txt log dump in an hourly interval.\n\nObserved results:\n\nSyncs occur every 10 to 20 minutes (irregular intervals) and the logfiles contain the output shown in comment 0.", "attachment_id": null, "text": "As far as I can tell, my Windows 7 desktop is not getting those spurious idle events. At night it happily syncs only once per hour as it should, without ever waking up from idle on its own. It seems that this is an OS X only bug, though I haven't tested on Linux.\n\nIf you want to reproduce it with Sync, here's how:\n\n* Procure an OS X machine running Firefox 7 or later that doesn't have bug 691988 in it. (It hasn't landed anywhere yet, but I imagine it will soon.)\n* Connect to a Sync account that has at least one other device connected, so that with the OS X machine there are at least 2 devices in total.\n* In about:config, set 'services.sync.log.logger.service.main' to 'Trace' (without the quotes; note the capital T) and flip 'services.sync.log.appender.file.logOnSuccess' to true.\n* Restart the browser.\n* Walk away from the machine and don't touch it for a few hours.\n* Go to about:sync-log.\n\nExpected results:\n\nYou should see a success-NNN.txt log dump in an hourly interval.\n\nObserved results:\n\nSyncs occur every 10 to 20 minutes (irregular intervals) and the logfiles contain the output shown in comment 0.", "bug_id": 692225, "tags": [], "is_private": false, "id": 5761561, "count": 2, "author": "philipp@weitershausen.de", "creator": "philipp@weitershausen.de", "time": "2011-10-05T21:06:09Z", "creation_time": "2011-10-05T21:06:09Z"}, {"author": "philipp@weitershausen.de", "creator": "philipp@weitershausen.de", "time": "2011-10-05T22:57:27Z", "creation_time": "2011-10-05T22:57:27Z", "is_private": false, "id": 5761949, "count": 3, "tags": [], "text": "FWIW, QA tested our wallpaper fix in bug 691988 on their Mac and the logs clearly show the spurious 'back' and 'idle' notifications, while a WinXP machine did not. So this isn't something that's just happening on my Mac but it's actually reproducible.", "bug_id": 692225, "raw_text": "FWIW, QA tested our wallpaper fix in bug 691988 on their Mac and the logs clearly show the spurious 'back' and 'idle' notifications, while a WinXP machine did not. So this isn't something that's just happening on my Mac but it's actually reproducible.", "attachment_id": null}, {"author": "philipp@weitershausen.de", "creator": "philipp@weitershausen.de", "creation_time": "2011-10-05T22:58:16Z", "time": "2011-10-05T22:58:16Z", "is_private": false, "id": 5761951, "count": 4, "bug_id": 692225, "text": "(In reply to Philipp von Weitershausen [:philikon] from comment #3)\n> FWIW, QA tested our wallpaper fix in bug 691988 on their Mac and the logs\n> clearly show the spurious 'back' and 'idle' notifications,\n\n(See attachment 565044 in bug 691988 for those logs.)", "tags": [], "raw_text": "(In reply to Philipp von Weitershausen [:philikon] from comment #3)\n> FWIW, QA tested our wallpaper fix in bug 691988 on their Mac and the logs\n> clearly show the spurious 'back' and 'idle' notifications,\n\n(See attachment 565044 in bug 691988 for those logs.)", "attachment_id": null}, {"tags": [], "text": "I use XP and have this problem for plugin:\n\nI create the class observer:\n\n...\nIdleService  = Components.classes[\"@mozilla.org/widget/idleservice;1\"].getService(Components.interfaces.nsIIdleService);\n...\nobserve: function(subject, topic, data) {\n\t\tswitch (topic) {\n\t\t\tcase 'idle': \n\t\t\t\t[1]\n\t\t\t\tbreak;\n\t\t\tcase 'back':\n\t\t\t\tbreak;\n\t\t}\n}\n\nif in 'idle [1]' put a simple commands gBrowser.loadURI, the observe return 'back' witch IdleService.idleTime = 0.\nIf not, the 'back' occurs only if keypress or mousemove/mouseclick.\nThe bug ocurs in firefox 7.x;", "bug_id": 692225, "raw_text": "I use XP and have this problem for plugin:\n\nI create the class observer:\n\n...\nIdleService  = Components.classes[\"@mozilla.org/widget/idleservice;1\"].getService(Components.interfaces.nsIIdleService);\n...\nobserve: function(subject, topic, data) {\n\t\tswitch (topic) {\n\t\t\tcase 'idle': \n\t\t\t\t[1]\n\t\t\t\tbreak;\n\t\t\tcase 'back':\n\t\t\t\tbreak;\n\t\t}\n}\n\nif in 'idle [1]' put a simple commands gBrowser.loadURI, the observe return 'back' witch IdleService.idleTime = 0.\nIf not, the 'back' occurs only if keypress or mousemove/mouseclick.\nThe bug ocurs in firefox 7.x;", "attachment_id": null, "author": "smarca@gmail.com", "creator": "smarca@gmail.com", "time": "2011-10-31T19:14:25Z", "creation_time": "2011-10-31T19:14:25Z", "is_private": false, "count": 5, "id": 5815912}, {"raw_text": "Looks like this happens on Windows, too (see: bug 670551). Comment #5 might provide a clue to what's going on here?", "attachment_id": null, "text": "Looks like this happens on Windows, too (see: bug 670551). Comment #5 might provide a clue to what's going on here?", "bug_id": 692225, "tags": [], "id": 5982721, "count": 6, "is_private": false, "author": "gijskruitbosch+bugs@gmail.com", "time": "2012-01-16T14:50:12Z", "creation_time": "2012-01-16T14:50:12Z", "creator": "gijskruitbosch+bugs@gmail.com"}]}}, "comments": {}}