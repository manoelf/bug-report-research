{"bugs": {"623658": {"comments": [{"is_private": false, "id": 5180348, "tags": [], "count": 0, "author": "brian@briansmith.org", "time": "2011-01-06T18:57:54Z", "creation_time": "2011-01-06T18:57:54Z", "bug_id": 623658, "text": "See https://lamp1-sesa.citic74.net. The weak key check passes (length >= 512 bits) but SSL_GetChannelInfo reports the key length is 504 bits.\n\nI also found an instance of this at https://www.avinetmail.com last night but I can't reproduce it now.\n\nI have also noticed that SSL_GetChannelInfo sometimes reports key lengths 8 bits shorter for a variety of key lengths:\n\n504 2\n512 305\n760 19\n768 3577\n1008 8\n1016 2083\n1024 457115\n2040 2\n2048 276\n\nAlso, should we be checking for only a single leading zero in ephemeral keys or do we need to strip all leading zeroes?", "raw_text": "See https://lamp1-sesa.citic74.net. The weak key check passes (length >= 512 bits) but SSL_GetChannelInfo reports the key length is 504 bits.\n\nI also found an instance of this at https://www.avinetmail.com last night but I can't reproduce it now.\n\nI have also noticed that SSL_GetChannelInfo sometimes reports key lengths 8 bits shorter for a variety of key lengths:\n\n504 2\n512 305\n760 19\n768 3577\n1008 8\n1016 2083\n1024 457115\n2040 2\n2048 276\n\nAlso, should we be checking for only a single leading zero in ephemeral keys or do we need to strip all leading zeroes?", "creator": "brian@briansmith.org", "attachment_id": null}, {"bug_id": 623658, "text": "We should strip all leading zeroes in the dh_p parameter\n(the prime modulus).", "time": "2011-01-09T01:17:42Z", "creation_time": "2011-01-09T01:17:42Z", "attachment_id": null, "raw_text": "We should strip all leading zeroes in the dh_p parameter\n(the prime modulus).", "creator": "wtc@google.com", "id": 5185353, "tags": [], "is_private": false, "count": 1, "author": "wtc@google.com"}, {"id": 5195088, "bug_id": 623658, "tags": [], "text": "Brian, \nI don't understand your table in comment 0.  Is this frequency by key size?\n\nThere are numerous interfaces that pass key lengths in BYTES, so when we need\nkey lengths in bits, we multiply by 8, and do not subtract the number of \nleading 0 bits.   This should account for up to 7 extra bits being falsely \nreported, but not 8.  \n\nNote that there's a long story about the stripped leading bits in DHE results.\nPKCS#3 requires that the DHE result have exactly the same length (in bit) as \nprime P.  Stripping it down by removing all leading zero bits, as done for \nSSL 3.{0,1,2}, was theoretically a mistake.  The specification for ECDH and \nECDHE explicitly requires that the result have the proper length without \nexcessive stripping of leading zeros.  During the production of the TLS 1.2\nRFC, there was discussion about requiring PKCS#3 compliance for integer finite field (not EC) DHE, but I don't recall if that suggested change made it into \nthe final RFC or not.", "is_private": false, "time": "2011-01-12T23:25:51Z", "creation_time": "2011-01-12T23:25:51Z", "count": 2, "author": "nelson@bolyard.me", "raw_text": "Brian, \nI don't understand your table in comment 0.  Is this frequency by key size?\n\nThere are numerous interfaces that pass key lengths in BYTES, so when we need\nkey lengths in bits, we multiply by 8, and do not subtract the number of \nleading 0 bits.   This should account for up to 7 extra bits being falsely \nreported, but not 8.  \n\nNote that there's a long story about the stripped leading bits in DHE results.\nPKCS#3 requires that the DHE result have exactly the same length (in bit) as \nprime P.  Stripping it down by removing all leading zero bits, as done for \nSSL 3.{0,1,2}, was theoretically a mistake.  The specification for ECDH and \nECDHE explicitly requires that the result have the proper length without \nexcessive stripping of leading zeros.  During the production of the TLS 1.2\nRFC, there was discussion about requiring PKCS#3 compliance for integer finite field (not EC) DHE, but I don't recall if that suggested change made it into \nthe final RFC or not.", "creator": "nelson@bolyard.me", "attachment_id": null}, {"time": "2011-02-08T02:42:21Z", "creation_time": "2011-02-08T02:42:21Z", "bug_id": 623658, "text": "(In reply to comment #2)\n> Brian, \n> I don't understand your table in comment 0.  Is this frequency by key size?\n\nThose are the frequencies of reported key sizes out of ~500,000 sites that negotiate DHE cipher suites.\n\n> Note that there's a long story about the stripped\n> leading bits in DHE results.\n\nI vaguely remember that. But, this isn't about leading zeros of the result; it is about leading zeros for P itself.", "attachment_id": null, "creator": "brian@briansmith.org", "raw_text": "(In reply to comment #2)\n> Brian, \n> I don't understand your table in comment 0.  Is this frequency by key size?\n\nThose are the frequencies of reported key sizes out of ~500,000 sites that negotiate DHE cipher suites.\n\n> Note that there's a long story about the stripped\n> leading bits in DHE results.\n\nI vaguely remember that. But, this isn't about leading zeros of the result; it is about leading zeros for P itself.", "is_private": false, "id": 5262124, "tags": [], "count": 3, "author": "brian@briansmith.org"}]}}, "comments": {}}