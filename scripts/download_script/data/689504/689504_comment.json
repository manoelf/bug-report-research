{"comments": {}, "bugs": {"689504": {"comments": [{"creator": "romaxa@gmail.com", "creation_time": "2011-09-27T09:24:34Z", "is_private": false, "attachment_id": null, "tags": [], "author": "romaxa@gmail.com", "count": 0, "text": "Checked optofile for morphing cubes and found that we repainting thebesLayer content on every cubes motion...:\n#16 0x3baacd48 in _cairo_image_surface_fill (abstract_surface=0x436da8d0, op=CAIRO_OPERATOR_OVER, source=0xaec0bf18, path=0x3c36100c, \n    fill_rule=CAIRO_FILL_RULE_WINDING, tolerance=-0.56250028610229497, antialias=CAIRO_ANTIALIAS_DEFAULT, clip=0xaec0be88)\n    at gfx/cairo/cairo/src/cairo-image-surface.c:3759\n#17 0x3bac1ac4 in _cairo_surface_fill (surface=0x436da8d0, op=CAIRO_OPERATOR_OVER, source=0xaec0bf18, path=0x3c36100c, fill_rule=CAIRO_FILL_RULE_WINDING, \n    tolerance=-0.56250028610229497, antialias=CAIRO_ANTIALIAS_DEFAULT, clip=0xaec0c020)\n    at gfx/cairo/cairo/src/cairo-surface.c:2348\n#18 0x3baa5e6c in _cairo_gstate_fill (gstate=0x3c360eb0, path=0x3c36100c)\n    at gfx/cairo/cairo/src/cairo-gstate.c:1290\n#19 0x3ba9adcc in _moz_cairo_fill_preserve (cr=0x3c360d38) at gfx/cairo/cairo/src/cairo.c:2459\n#20 0x3afd8ac8 in nsCSSRendering::PaintGradient (aPresContext=<value optimized out>, aRenderingContext=<value optimized out>, \n    aGradient=<value optimized out>, aDirtyRect=<value optimized out>, aOneCellArea=..., aFillArea=...)\n    at layout/base/nsCSSRendering.cpp:2223\n#21 0x3afd8c18 in ImageRenderer::Draw (this=0xaec0c598, aPresContext=0x419d7800, aRenderingContext=..., aDest=..., aFill=..., aAnchor=..., aDirty=...)\n---Type <return> to continue, or q <return> to quit---\n    at layout/base/nsCSSRendering.cpp:4173\n#22 0x3afd9e90 in nsCSSRendering::PaintBackgroundWithSC (aPresContext=0x419d7800, aRenderingContext=<value optimized out>, aForFrame=0x4363b048, \n    aDirtyRect=<value optimized out>, aBorderArea=..., aBackgroundSC=0x3afd9f94, aBorder=..., aFlags=1130607008, aBGClipRect=0x4363b0a0)\n    at layout/base/nsCSSRendering.cpp:2453\n#23 0x3afd9f94 in nsCSSRendering::PaintBackground (aPresContext=0x419d7800, aRenderingContext=..., aForFrame=0x4363b048, aDirtyRect=..., aBorderArea=..., \n    aFlags=4, aBGClipRect=0x0) at layout/base/nsCSSRendering.cpp:1490\n#24 0x3b01d564 in nsButtonFrameRenderer::PaintBorderAndBackground (this=0x4363b090, aPresContext=0x419d7800, aRenderingContext=..., aDirtyRect=..., \n    aRect=..., aBGFlags=4) at layout/forms/nsButtonFrameRenderer.cpp:270\n#25 0x3b01d608 in nsDisplayButtonBorderBackground::Paint (this=0x4394c650, aBuilder=0xaec0d6e0, aCtx=0x4313ca40)\n    at layout/forms/nsButtonFrameRenderer.cpp:185\n#26 0x3afbe6d4 in mozilla::FrameLayerBuilder::DrawThebesLayer (aLayer=<value optimized out>, aContext=0x419233e0, aRegionToDraw=<value optimized out>, \n    aRegionToInvalidate=<value optimized out>, aCallbackData=0xaec0d6e0)\n    at layout/base/FrameLayerBuilder.cpp:2143\n#27 0x3ba332fc in mozilla::layers::BasicThebesLayer::PaintBuffer (this=0x406bc360, aContext=0xffffff70, aRegionToDraw=<value optimized out>, \n    aExtendedRegionToDraw=..., aRegionToInvalidate=..., aDidSelfCopy=0, aCallback=0xffffffff, aCallbackData=0xaec0d6e0)\n    at gfx/layers/basic/BasicLayers.cpp:555\n---Type <return> to continue, or q <return> to quit---\n#28 0x3ba3b670 in mozilla::layers::BasicShadowableThebesLayer::PaintBuffer (this=0xffffff2c, aContext=0xffffff70, aRegionToDraw=..., \n    aExtendedRegionToDraw=..., aRegionToInvalidate=..., aDidSelfCopy=0, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0) at gfx/layers/basic/BasicLayers.cpp:2273\n#29 0x3ba39d20 in mozilla::layers::BasicThebesLayer::PaintThebes (this=0x406bc360, aContext=0x41923270, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0, aReadback=0x1) at gfx/layers/basic/BasicLayers.cpp:739\n#30 0x3ba3a2d8 in mozilla::layers::BasicLayerManager::PaintLayer (this=0x406cd400, aTarget=0x41923270, aLayer=0x406bc360, aCallback=<value optimized out>, \n    aCallbackData=0xaec0d6e0, aReadback=0xaec0d3a0) at gfx/layers/basic/BasicLayers.cpp:1891\n#31 0x3ba3a33c in mozilla::layers::BasicLayerManager::PaintLayer (this=0x406cd400, aTarget=0x41923270, aLayer=0x406b4220, aCallback=<value optimized out>, \n    aCallbackData=0xaec0d6e0, aReadback=0x0) at gfx/layers/basic/BasicLayers.cpp:1903\n#32 0x3ba3ade0 in mozilla::layers::BasicLayerManager::EndTransactionInternal (this=0x406cd400, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0, aFlags=<value optimized out>) at gfx/layers/basic/BasicLayers.cpp:1616\n#33 0x3ba3ae6c in mozilla::layers::BasicShadowLayerManager::EndTransaction (this=0xffffff2c, aCallback=0xffffff70, aCallbackData=0xaec0adb8, aFlags=514932)\n    at gfx/layers/basic/BasicLayers.cpp:3262\n---Type <return> to continue, or q <return> to quit---\n#34 0x3afe5918 in nsDisplayList::PaintForFrame (this=0xaec0dab0, aBuilder=0xaec0d6e0, aCtx=<value optimized out>, aForFrame=0x43150430, aFlags=2931873504)\n    at layout/base/nsDisplayList.cpp:627\n#35 0x3afe5998 in nsDisplayList::PaintRoot (this=<value optimized out>, aBuilder=0xffffff70, aCtx=<value optimized out>, aFlags=<value optimized out>)\n    at layout/base/nsDisplayList.cpp:538\n#36 0x3affcc54 in nsLayoutUtils::PaintFrame (aRenderingContext=<value optimized out>, aFrame=0x43150430, aDirtyRegion=<value optimized out>, \n    aBackstop=<value optimized out>, aFlags=260) at layout/base/nsLayoutUtils.cpp:1697\n#37 0x3b0147c0 in PresShell::Paint (this=0x406b4380, aViewToPaint=<value optimized out>, aWidgetToPaint=<value optimized out>, aDirtyRegion=..., \n    aIntDirtyRegion=..., aPaintDefaultBackground=993272380, aWillSendDidPaint=0)\n    at layout/base/nsPresShell.cpp:5382\n#38 0x3b34223c in nsViewManager::RenderViews (this=0x5, aView=<value optimized out>, aWidget=<value optimized out>, aRegion=<value optimized out>, \n    aIntRegion=..., aPaintDefaultBackground=0, aWillSendDidPaint=0) at view/src/nsViewManager.cpp:416\n#39 0x3b34232c in nsViewManager::Refresh (this=0x41939d40, aView=0x4060d970, aWidget=0x4064c5c0, aRegion=..., aUpdateFlags=1)\n    at view/src/nsViewManager.cpp:391\n#40 0x3b343410 in nsViewManager::DispatchEvent (this=0x41939d40, aEvent=0xaec0de18, aView=0x4060d970, aStatus=<value optimized out>)\n    at view/src/nsViewManager.cpp:894\n#41 0x3b33fc94 in HandleEvent (aEvent=0xaec0de18) at view/src/nsView.cpp:159\n---Type <return> to continue, or q <return> to quit---", "bug_id": 689504, "id": 5739555, "time": "2011-09-27T09:24:34Z", "raw_text": "Checked optofile for morphing cubes and found that we repainting thebesLayer content on every cubes motion...:\n#16 0x3baacd48 in _cairo_image_surface_fill (abstract_surface=0x436da8d0, op=CAIRO_OPERATOR_OVER, source=0xaec0bf18, path=0x3c36100c, \n    fill_rule=CAIRO_FILL_RULE_WINDING, tolerance=-0.56250028610229497, antialias=CAIRO_ANTIALIAS_DEFAULT, clip=0xaec0be88)\n    at gfx/cairo/cairo/src/cairo-image-surface.c:3759\n#17 0x3bac1ac4 in _cairo_surface_fill (surface=0x436da8d0, op=CAIRO_OPERATOR_OVER, source=0xaec0bf18, path=0x3c36100c, fill_rule=CAIRO_FILL_RULE_WINDING, \n    tolerance=-0.56250028610229497, antialias=CAIRO_ANTIALIAS_DEFAULT, clip=0xaec0c020)\n    at gfx/cairo/cairo/src/cairo-surface.c:2348\n#18 0x3baa5e6c in _cairo_gstate_fill (gstate=0x3c360eb0, path=0x3c36100c)\n    at gfx/cairo/cairo/src/cairo-gstate.c:1290\n#19 0x3ba9adcc in _moz_cairo_fill_preserve (cr=0x3c360d38) at gfx/cairo/cairo/src/cairo.c:2459\n#20 0x3afd8ac8 in nsCSSRendering::PaintGradient (aPresContext=<value optimized out>, aRenderingContext=<value optimized out>, \n    aGradient=<value optimized out>, aDirtyRect=<value optimized out>, aOneCellArea=..., aFillArea=...)\n    at layout/base/nsCSSRendering.cpp:2223\n#21 0x3afd8c18 in ImageRenderer::Draw (this=0xaec0c598, aPresContext=0x419d7800, aRenderingContext=..., aDest=..., aFill=..., aAnchor=..., aDirty=...)\n---Type <return> to continue, or q <return> to quit---\n    at layout/base/nsCSSRendering.cpp:4173\n#22 0x3afd9e90 in nsCSSRendering::PaintBackgroundWithSC (aPresContext=0x419d7800, aRenderingContext=<value optimized out>, aForFrame=0x4363b048, \n    aDirtyRect=<value optimized out>, aBorderArea=..., aBackgroundSC=0x3afd9f94, aBorder=..., aFlags=1130607008, aBGClipRect=0x4363b0a0)\n    at layout/base/nsCSSRendering.cpp:2453\n#23 0x3afd9f94 in nsCSSRendering::PaintBackground (aPresContext=0x419d7800, aRenderingContext=..., aForFrame=0x4363b048, aDirtyRect=..., aBorderArea=..., \n    aFlags=4, aBGClipRect=0x0) at layout/base/nsCSSRendering.cpp:1490\n#24 0x3b01d564 in nsButtonFrameRenderer::PaintBorderAndBackground (this=0x4363b090, aPresContext=0x419d7800, aRenderingContext=..., aDirtyRect=..., \n    aRect=..., aBGFlags=4) at layout/forms/nsButtonFrameRenderer.cpp:270\n#25 0x3b01d608 in nsDisplayButtonBorderBackground::Paint (this=0x4394c650, aBuilder=0xaec0d6e0, aCtx=0x4313ca40)\n    at layout/forms/nsButtonFrameRenderer.cpp:185\n#26 0x3afbe6d4 in mozilla::FrameLayerBuilder::DrawThebesLayer (aLayer=<value optimized out>, aContext=0x419233e0, aRegionToDraw=<value optimized out>, \n    aRegionToInvalidate=<value optimized out>, aCallbackData=0xaec0d6e0)\n    at layout/base/FrameLayerBuilder.cpp:2143\n#27 0x3ba332fc in mozilla::layers::BasicThebesLayer::PaintBuffer (this=0x406bc360, aContext=0xffffff70, aRegionToDraw=<value optimized out>, \n    aExtendedRegionToDraw=..., aRegionToInvalidate=..., aDidSelfCopy=0, aCallback=0xffffffff, aCallbackData=0xaec0d6e0)\n    at gfx/layers/basic/BasicLayers.cpp:555\n---Type <return> to continue, or q <return> to quit---\n#28 0x3ba3b670 in mozilla::layers::BasicShadowableThebesLayer::PaintBuffer (this=0xffffff2c, aContext=0xffffff70, aRegionToDraw=..., \n    aExtendedRegionToDraw=..., aRegionToInvalidate=..., aDidSelfCopy=0, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0) at gfx/layers/basic/BasicLayers.cpp:2273\n#29 0x3ba39d20 in mozilla::layers::BasicThebesLayer::PaintThebes (this=0x406bc360, aContext=0x41923270, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0, aReadback=0x1) at gfx/layers/basic/BasicLayers.cpp:739\n#30 0x3ba3a2d8 in mozilla::layers::BasicLayerManager::PaintLayer (this=0x406cd400, aTarget=0x41923270, aLayer=0x406bc360, aCallback=<value optimized out>, \n    aCallbackData=0xaec0d6e0, aReadback=0xaec0d3a0) at gfx/layers/basic/BasicLayers.cpp:1891\n#31 0x3ba3a33c in mozilla::layers::BasicLayerManager::PaintLayer (this=0x406cd400, aTarget=0x41923270, aLayer=0x406b4220, aCallback=<value optimized out>, \n    aCallbackData=0xaec0d6e0, aReadback=0x0) at gfx/layers/basic/BasicLayers.cpp:1903\n#32 0x3ba3ade0 in mozilla::layers::BasicLayerManager::EndTransactionInternal (this=0x406cd400, \n    aCallback=0x3afbe108 <mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*)>, aCallbackData=0xaec0d6e0, aFlags=<value optimized out>) at gfx/layers/basic/BasicLayers.cpp:1616\n#33 0x3ba3ae6c in mozilla::layers::BasicShadowLayerManager::EndTransaction (this=0xffffff2c, aCallback=0xffffff70, aCallbackData=0xaec0adb8, aFlags=514932)\n    at gfx/layers/basic/BasicLayers.cpp:3262\n---Type <return> to continue, or q <return> to quit---\n#34 0x3afe5918 in nsDisplayList::PaintForFrame (this=0xaec0dab0, aBuilder=0xaec0d6e0, aCtx=<value optimized out>, aForFrame=0x43150430, aFlags=2931873504)\n    at layout/base/nsDisplayList.cpp:627\n#35 0x3afe5998 in nsDisplayList::PaintRoot (this=<value optimized out>, aBuilder=0xffffff70, aCtx=<value optimized out>, aFlags=<value optimized out>)\n    at layout/base/nsDisplayList.cpp:538\n#36 0x3affcc54 in nsLayoutUtils::PaintFrame (aRenderingContext=<value optimized out>, aFrame=0x43150430, aDirtyRegion=<value optimized out>, \n    aBackstop=<value optimized out>, aFlags=260) at layout/base/nsLayoutUtils.cpp:1697\n#37 0x3b0147c0 in PresShell::Paint (this=0x406b4380, aViewToPaint=<value optimized out>, aWidgetToPaint=<value optimized out>, aDirtyRegion=..., \n    aIntDirtyRegion=..., aPaintDefaultBackground=993272380, aWillSendDidPaint=0)\n    at layout/base/nsPresShell.cpp:5382\n#38 0x3b34223c in nsViewManager::RenderViews (this=0x5, aView=<value optimized out>, aWidget=<value optimized out>, aRegion=<value optimized out>, \n    aIntRegion=..., aPaintDefaultBackground=0, aWillSendDidPaint=0) at view/src/nsViewManager.cpp:416\n#39 0x3b34232c in nsViewManager::Refresh (this=0x41939d40, aView=0x4060d970, aWidget=0x4064c5c0, aRegion=..., aUpdateFlags=1)\n    at view/src/nsViewManager.cpp:391\n#40 0x3b343410 in nsViewManager::DispatchEvent (this=0x41939d40, aEvent=0xaec0de18, aView=0x4060d970, aStatus=<value optimized out>)\n    at view/src/nsViewManager.cpp:894\n#41 0x3b33fc94 in HandleEvent (aEvent=0xaec0de18) at view/src/nsView.cpp:159\n---Type <return> to continue, or q <return> to quit---"}, {"author": "romaxa@gmail.com", "text": "Same problem I see on http://romaxa.bolshe.net/css3d/cube3d/cube.html", "count": 1, "creator": "romaxa@gmail.com", "is_private": false, "creation_time": "2011-09-27T14:59:53Z", "id": 5740167, "bug_id": 689504, "attachment_id": null, "raw_text": "Same problem I see on http://romaxa.bolshe.net/css3d/cube3d/cube.html", "time": "2011-09-27T14:59:53Z", "tags": []}, {"is_private": false, "creation_time": "2011-09-27T15:27:24Z", "id": 5740247, "bug_id": 689504, "author": "romaxa@gmail.com", "text": "Tested with patches from bug 524925, and it seems that those patches are fixing half of repaints for 3d transforms", "count": 2, "creator": "romaxa@gmail.com", "tags": [], "attachment_id": null, "raw_text": "Tested with patches from bug 524925, and it seems that those patches are fixing half of repaints for 3d transforms", "time": "2011-09-27T15:27:24Z"}, {"raw_text": "Here is one more paint backtrace which is happening on morphing-cubes even with patches from bug 524925 applied:\n10 0x3ba9b90c in _moz_cairo_fill_preserve (cr=0x3c361308) at gfx/cairo/cairo/src/cairo.c:2459\n#11 0x3afb2690 in nsRenderingContext::FillRect (this=0x4312f2c0, aRect=...)\n---Type <return> to continue, or q <return> to quit---\n    at gfx/src/nsRenderingContext.cpp:366\n#12 0x3b05e9d8 in nsDisplayCanvasBackground::Paint (this=0x44a0b810, aBuilder=0xaeafd6e0, aCtx=0x4312f2c0)\n    at layout/generic/nsCanvasFrame.cpp:261\n#13 0x3afbeb54 in mozilla::FrameLayerBuilder::DrawThebesLayer (aLayer=<value optimized out>, aContext=0x42b727c0, aRegionToDraw=<value optimized out>, \n    aRegionToInvalidate=<value optimized out>, aCallbackData=0xaeafd6e0)", "time": "2011-09-27T15:36:05Z", "bug_id": 689504, "id": 5740263, "author": "romaxa@gmail.com", "count": 3, "text": "Here is one more paint backtrace which is happening on morphing-cubes even with patches from bug 524925 applied:\n10 0x3ba9b90c in _moz_cairo_fill_preserve (cr=0x3c361308) at gfx/cairo/cairo/src/cairo.c:2459\n#11 0x3afb2690 in nsRenderingContext::FillRect (this=0x4312f2c0, aRect=...)\n---Type <return> to continue, or q <return> to quit---\n    at gfx/src/nsRenderingContext.cpp:366\n#12 0x3b05e9d8 in nsDisplayCanvasBackground::Paint (this=0x44a0b810, aBuilder=0xaeafd6e0, aCtx=0x4312f2c0)\n    at layout/generic/nsCanvasFrame.cpp:261\n#13 0x3afbeb54 in mozilla::FrameLayerBuilder::DrawThebesLayer (aLayer=<value optimized out>, aContext=0x42b727c0, aRegionToDraw=<value optimized out>, \n    aRegionToInvalidate=<value optimized out>, aCallbackData=0xaeafd6e0)", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-09-27T15:36:05Z", "creator": "romaxa@gmail.com"}, {"attachment_id": null, "tags": [], "creator": "romaxa@gmail.com", "is_private": false, "creation_time": "2011-09-27T15:47:04Z", "raw_text": "Not 100% sure, but it seems like some morphing cubes elements disappeared or not re-painted correctly with patches from bug 524925", "time": "2011-09-27T15:47:04Z", "text": "Not 100% sure, but it seems like some morphing cubes elements disappeared or not re-painted correctly with patches from bug 524925", "count": 4, "author": "romaxa@gmail.com", "id": 5740297, "bug_id": 689504}, {"tags": [], "attachment_id": null, "creation_time": "2012-02-09T07:07:01Z", "is_private": false, "creator": "romaxa@gmail.com", "time": "2012-02-09T07:07:01Z", "raw_text": "Still see lot of reflow for this test using latest m-c, also http://romaxa.info/css3d/poster/poster-circle.html - very very slow", "bug_id": 689504, "id": 6046406, "author": "romaxa@gmail.com", "count": 5, "text": "Still see lot of reflow for this test using latest m-c, also http://romaxa.info/css3d/poster/poster-circle.html - very very slow"}, {"attachment_id": 595689, "tags": [], "creator": "romaxa@gmail.com", "is_private": false, "creation_time": "2012-02-09T09:45:01Z", "raw_text": "I took latest m-c with patch from cjones (http://hg.mozilla.org/users/cjones_mozilla.com/mcmq/file/6d862bfdd1e7/invalid) + patches from 719177\nAnd still see each poster circle plane repainted on each frame", "time": "2012-02-09T09:45:01Z", "author": "romaxa@gmail.com", "count": 6, "text": "Created attachment 595689\ncallgraph oprofile\n\nI took latest m-c with patch from cjones (http://hg.mozilla.org/users/cjones_mozilla.com/mcmq/file/6d862bfdd1e7/invalid) + patches from 719177\nAnd still see each poster circle plane repainted on each frame", "bug_id": 689504, "id": 6046593}, {"tags": [], "time": "2012-02-09T10:16:31Z", "attachment_id": null, "raw_text": "Try to reduce the test case as much as you can. That helps roc and his team identifying the cause.", "id": 6046634, "bug_id": 689504, "is_private": false, "creation_time": "2012-02-09T10:16:31Z", "creator": "gal@uci.edu", "author": "gal@uci.edu", "text": "Try to reduce the test case as much as you can. That helps roc and his team identifying the cause.", "count": 7}, {"is_private": false, "creation_time": "2012-02-09T22:57:52Z", "creator": "romaxa@gmail.com", "tags": [], "attachment_id": null, "id": 6048627, "bug_id": 689504, "count": 8, "text": "http://romaxa.info/tests/Carousel1.html - minimized testcase.\n\nChange hint backtraces:\n#0  nsCSSFrameConstructor::ProcessRestyledFrames (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7990\n#1  0x3aff34a4 in nsCSSFrameConstructor::RestyleElement (this=0x4298ea00, aElement=<value optimized out>, aPrimaryFrame=0x43b28908, \n    aMinHint=0, aRestyleTracker=..., aRestyleDescendants=false)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:8091\n#2  0x3afe1d3c in mozilla::css::RestyleTracker::ProcessOneRestyle (this=0x4298eb40, aElement=0x4, aRestyleHint=<value optimized out>, \n    aChangeHint=0) at /home/rootfslayout/base/RestyleTracker.cpp:157\n#3  0x3afe23b0 in mozilla::css::RestyleTracker::DoProcessRestyles (this=0x4298eb40)\n    at /home/rootfslayout/base/RestyleTracker.cpp:242\n#4  0x3aff33f4 in nsCSSFrameConstructor::ProcessPendingRestyles (this=0x4298ea00)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:11664\n\n\n\n#0  DoApplyRenderingChangeToTree (aFrame=0x43b28908, aFrameManager=0x4298ea00, aChange=2560)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7691\n#1  0x3aff30b0 in ApplyRenderingChangeToTree (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7747\n#2  nsCSSFrameConstructor::ProcessRestyledFrames (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7990\n#3  0x3aff34a4 in nsCSSFrameConstructor::RestyleElement (this=0x4298ea00, aElement=<value optimized out>, aPrimaryFrame=0x43b28908, \n    aMinHint=0, aRestyleTracker=..., aRestyleDescendants=false)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:8091\n#4  0x3afe1d3c in mozilla::css::RestyleTracker::ProcessOneRestyle (this=0x4298eb40, aElement=0x4298ea00, aRestyleHint=<value optimized out>, \n    aChangeHint=0) at /home/rootfslayout/base/RestyleTracker.cpp:157\n#5  0x3afe23b0 in mozilla::css::RestyleTracker::DoProcessRestyles (this=0x4298eb40)", "author": "romaxa@gmail.com", "time": "2012-02-09T22:57:52Z", "raw_text": "http://romaxa.info/tests/Carousel1.html - minimized testcase.\n\nChange hint backtraces:\n#0  nsCSSFrameConstructor::ProcessRestyledFrames (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7990\n#1  0x3aff34a4 in nsCSSFrameConstructor::RestyleElement (this=0x4298ea00, aElement=<value optimized out>, aPrimaryFrame=0x43b28908, \n    aMinHint=0, aRestyleTracker=..., aRestyleDescendants=false)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:8091\n#2  0x3afe1d3c in mozilla::css::RestyleTracker::ProcessOneRestyle (this=0x4298eb40, aElement=0x4, aRestyleHint=<value optimized out>, \n    aChangeHint=0) at /home/rootfslayout/base/RestyleTracker.cpp:157\n#3  0x3afe23b0 in mozilla::css::RestyleTracker::DoProcessRestyles (this=0x4298eb40)\n    at /home/rootfslayout/base/RestyleTracker.cpp:242\n#4  0x3aff33f4 in nsCSSFrameConstructor::ProcessPendingRestyles (this=0x4298ea00)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:11664\n\n\n\n#0  DoApplyRenderingChangeToTree (aFrame=0x43b28908, aFrameManager=0x4298ea00, aChange=2560)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7691\n#1  0x3aff30b0 in ApplyRenderingChangeToTree (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7747\n#2  nsCSSFrameConstructor::ProcessRestyledFrames (this=0x4298ea00, aChangeList=...)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:7990\n#3  0x3aff34a4 in nsCSSFrameConstructor::RestyleElement (this=0x4298ea00, aElement=<value optimized out>, aPrimaryFrame=0x43b28908, \n    aMinHint=0, aRestyleTracker=..., aRestyleDescendants=false)\n    at /home/rootfslayout/base/nsCSSFrameConstructor.cpp:8091\n#4  0x3afe1d3c in mozilla::css::RestyleTracker::ProcessOneRestyle (this=0x4298eb40, aElement=0x4298ea00, aRestyleHint=<value optimized out>, \n    aChangeHint=0) at /home/rootfslayout/base/RestyleTracker.cpp:157\n#5  0x3afe23b0 in mozilla::css::RestyleTracker::DoProcessRestyles (this=0x4298eb40)"}, {"author": "romaxa@gmail.com", "text": "Ok I've found two problems which are causing perf problems with morphing cubes:\n1) when animation reach window edges we have thebes layers resizing problem and re-invalidation  - sounds like nsDisplayTransform::ShouldPrerenderTransformedContent does not work very well\n2) after attempts to fit animation into view and avoid problem 1), I got another problem that with certain layout resolution values like: 1.08506429 - we again have extra invalidations coming from somewhere else.", "count": 9, "creator": "romaxa@gmail.com", "creation_time": "2012-02-10T03:06:55Z", "is_private": false, "bug_id": 689504, "id": 6049179, "attachment_id": null, "raw_text": "Ok I've found two problems which are causing perf problems with morphing cubes:\n1) when animation reach window edges we have thebes layers resizing problem and re-invalidation  - sounds like nsDisplayTransform::ShouldPrerenderTransformedContent does not work very well\n2) after attempts to fit animation into view and avoid problem 1), I got another problem that with certain layout resolution values like: 1.08506429 - we again have extra invalidations coming from somewhere else.", "time": "2012-02-10T03:06:55Z", "tags": []}, {"tags": [], "time": "2012-02-10T03:07:20Z", "raw_text": "http://romaxa.info/tests/Carousel_TransformY3D.html here is test case", "attachment_id": null, "bug_id": 689504, "id": 6049180, "is_private": false, "creation_time": "2012-02-10T03:07:20Z", "creator": "romaxa@gmail.com", "text": "http://romaxa.info/tests/Carousel_TransformY3D.html here is test case", "count": 10, "author": "romaxa@gmail.com"}, {"is_private": false, "creation_time": "2012-02-10T04:26:43Z", "creator": "romaxa@gmail.com", "tags": [], "attachment_id": null, "id": 6049272, "bug_id": 689504, "text": "Hmm, somehow not able to reproduce problem with resolution, but problem with thebesLayer cropping easily visible on http://romaxa.info/tests/morphing-cubes1.html", "count": 11, "author": "romaxa@gmail.com", "raw_text": "Hmm, somehow not able to reproduce problem with resolution, but problem with thebesLayer cropping easily visible on http://romaxa.info/tests/morphing-cubes1.html", "time": "2012-02-10T04:26:43Z"}, {"id": 6049298, "bug_id": 689504, "author": "romaxa@gmail.com", "count": 12, "text": "On more observation:\nwith reduced poster-circle testcase I've found that while frame haz z value < 0 then it does not repaint thebes layer, when it is coming to the front (z > relative 0) it start invalidations", "raw_text": "On more observation:\nwith reduced poster-circle testcase I've found that while frame haz z value < 0 then it does not repaint thebes layer, when it is coming to the front (z > relative 0) it start invalidations", "time": "2012-02-10T04:50:11Z", "is_private": false, "creation_time": "2012-02-10T04:50:11Z", "creator": "romaxa@gmail.com", "tags": [], "attachment_id": null}, {"time": "2012-02-10T04:50:23Z", "raw_text": "http://romaxa.info/tests/poster-circle1.html", "id": 6049299, "bug_id": 689504, "author": "romaxa@gmail.com", "text": "http://romaxa.info/tests/poster-circle1.html", "count": 13, "tags": [], "attachment_id": null, "creation_time": "2012-02-10T04:50:23Z", "is_private": false, "creator": "romaxa@gmail.com"}, {"author": "romaxa@gmail.com", "text": "*** Bug 725927 has been marked as a duplicate of this bug. ***", "count": 14, "creator": "romaxa@gmail.com", "creation_time": "2012-02-10T06:19:58Z", "is_private": false, "id": 6049393, "bug_id": 689504, "attachment_id": null, "raw_text": "", "time": "2012-02-10T06:19:58Z", "tags": []}, {"tags": [], "time": "2012-02-10T06:23:19Z", "raw_text": "tracked down reflow calls, and found that main reason here is scrollFrame resizing nsGfxScrollFrameInner::UpdateOverflow ->nsGfxScrollFrame.cpp:3329", "attachment_id": null, "bug_id": 689504, "id": 6049396, "is_private": false, "creation_time": "2012-02-10T06:23:19Z", "creator": "romaxa@gmail.com", "text": "tracked down reflow calls, and found that main reason here is scrollFrame resizing nsGfxScrollFrameInner::UpdateOverflow ->nsGfxScrollFrame.cpp:3329", "count": 15, "author": "romaxa@gmail.com"}, {"raw_text": "Ok, so summary here is:\n1) nsGfxScrollFrameInner::UpdateOverflow - causing invalidate and thebesRepaint\n2) Complex transforms like poster circle make nsDisplayTransform::ShouldPrerenderTransformedContent not working\n3) With some certain conditions we churning ThebesLayers even if whole CSS3 animation scene inside visible view area.", "time": "2012-02-10T06:55:56Z", "bug_id": 689504, "id": 6049439, "author": "romaxa@gmail.com", "text": "Ok, so summary here is:\n1) nsGfxScrollFrameInner::UpdateOverflow - causing invalidate and thebesRepaint\n2) Complex transforms like poster circle make nsDisplayTransform::ShouldPrerenderTransformedContent not working\n3) With some certain conditions we churning ThebesLayers even if whole CSS3 animation scene inside visible view area.", "count": 16, "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2012-02-10T06:55:56Z", "creator": "romaxa@gmail.com"}]}}}