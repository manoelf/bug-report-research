{"bugs": {"676068": {"comments": [{"is_private": false, "count": 0, "tags": [], "id": 5628647, "bug_id": 676068, "creation_time": "2011-08-02T20:18:12Z", "raw_text": "Reporting this on behalf of the user on the support forums. Arabic text is not correctly joined. Need Martijn to follow up with screenshot, font startup list and if possible the specific fonts from the system folders.", "creator": "kbrosnan@mozilla.com", "text": "Reporting this on behalf of the user on the support forums. Arabic text is not correctly joined. Need Martijn to follow up with screenshot, font startup list and if possible the specific fonts from the system folders.", "attachment_id": null, "time": "2011-08-02T20:18:12Z", "author": "kbrosnan@mozilla.com"}, {"id": 5630484, "tags": [], "is_private": false, "count": 1, "bug_id": 676068, "raw_text": "This is a screenshot of trunk Fennec on the LG Optimus Black (Android 2.2) on the http://www.bbc.co.uk/arabic/ site.", "creation_time": "2011-08-03T15:18:09Z", "author": "martijn.martijn@gmail.com", "time": "2011-08-03T15:18:09Z", "attachment_id": 550395, "text": "Created attachment 550395\nScreenshot of http://www.bbc.co.uk/arabic/\n\nThis is a screenshot of trunk Fennec on the LG Optimus Black (Android 2.2) on the http://www.bbc.co.uk/arabic/ site.", "creator": "martijn.martijn@gmail.com"}, {"bug_id": 676068, "id": 5630531, "tags": [], "is_private": false, "count": 2, "author": "martijn.martijn@gmail.com", "time": "2011-08-03T15:39:56Z", "attachment_id": null, "text": "List of fonts installed on the LG Optimus Black: clockopia droid sans droid sans arabic droid sans fallback droid sans hebrew droid sans mono droid serif droidsansthai sjjunglego sjlover sjmyheart sjplayful tdballerina tddisplay\n\nI got this from the script at: http://www.kantjils.nl/moz/list_of_fonts.htm\n\nLet know if you need more info.\nI don't know how to get the font startup list or the specific fonts from the system folders.", "creator": "martijn.martijn@gmail.com", "raw_text": "List of fonts installed on the LG Optimus Black: clockopia droid sans droid sans arabic droid sans fallback droid sans hebrew droid sans mono droid serif droidsansthai sjjunglego sjlover sjmyheart sjplayful tdballerina tddisplay\n\nI got this from the script at: http://www.kantjils.nl/moz/list_of_fonts.htm\n\nLet know if you need more info.\nI don't know how to get the font startup list or the specific fonts from the system folders.", "creation_time": "2011-08-03T15:39:56Z"}, {"creator": "martijn.martijn@gmail.com", "author": "martijn.martijn@gmail.com", "text": "I'm also getting this on  http://www.islamway.com http://alwatan.kuwait.tt/ and http://kooora.com/\nI'm pretty sure I see it on all sites with arabic text.", "time": "2011-08-03T15:49:58Z", "attachment_id": null, "raw_text": "I'm also getting this on  http://www.islamway.com http://alwatan.kuwait.tt/ and http://kooora.com/\nI'm pretty sure I see it on all sites with arabic text.", "creation_time": "2011-08-03T15:49:58Z", "bug_id": 676068, "tags": [], "count": 3, "is_private": false, "id": 5630548}, {"tags": [], "count": 4, "is_private": false, "id": 5630670, "bug_id": 676068, "creation_time": "2011-08-03T16:33:51Z", "raw_text": "blassey on irc:\n<blassey>\tmw22: I'm assuming daggett is going to want the actual font file from your phone\nadb pull /system/font/<font name>.ttf", "text": "blassey on irc:\n<blassey>\tmw22: I'm assuming daggett is going to want the actual font file from your phone\nadb pull /system/font/<font name>.ttf", "time": "2011-08-03T16:33:51Z", "attachment_id": null, "creator": "martijn.martijn@gmail.com", "author": "martijn.martijn@gmail.com"}, {"attachment_id": null, "time": "2011-08-03T17:14:57Z", "text": "Ok, it turns out it is in system/fonts/.\nI tried adb pull DroidSansArabic.ttf , but I get permission denied, presumably because the phone I use is not rooted.", "creation_time": "2011-08-03T17:14:57Z", "raw_text": "Ok, it turns out it is in system/fonts/.\nI tried adb pull DroidSansArabic.ttf , but I get permission denied, presumably because the phone I use is not rooted.", "bug_id": 676068, "id": 5630750, "is_private": false, "count": 5, "tags": [], "author": "martijn.martijn@gmail.com", "creator": "martijn.martijn@gmail.com"}, {"creator": "martijn.martijn@gmail.com", "author": "martijn.martijn@gmail.com", "bug_id": 676068, "tags": [], "is_private": false, "count": 6, "id": 5630808, "text": "Created attachment 550421\nDroidSansArabic.ttf on my LG Optimus Black\n\nOk, here is DroidSansArabic.ttf on my LG Optimus Black phone. Let me know, if you need more fonts.\n\nIt turns out I had to adb pull /system/fonts/DroidSansArabic.ttf from a regular command shell, not from the msys command shell (which screwed things up for me).", "time": "2011-08-03T17:35:14Z", "attachment_id": 550421, "raw_text": "Ok, here is DroidSansArabic.ttf on my LG Optimus Black phone. Let me know, if you need more fonts.\n\nIt turns out I had to adb pull /system/fonts/DroidSansArabic.ttf from a regular command shell, not from the msys command shell (which screwed things up for me).", "creation_time": "2011-08-03T17:35:14Z"}, {"author": "jd.bugzilla@gmail.com", "creator": "jd.bugzilla@gmail.com", "raw_text": "The problem here is that LG Optimus ships with what looks like a\nnon-standard version of DroidSansArabic.ttf.  They've stripped the\nGSUB/GPOS OpenType layout tables which prevents HarfBuzz from shaping\nArabic correctly on these devices.  In place of these they've included\nglyphs for Arabic Presentation Forms, U+FB50-FDFF, U+FE70-FEFF:\n\nhttp://www.unicode.org/charts/PDF/UFB50.pdf\n\nThese are separate codepoints from the normal Arabic range\n(U+600-6FF), with a separate code point for each form of letters in\nthe Arabic alphabet (i.e. isolated, initial, medial, final).  Webkit\nhas code for doing presentational ligature formation (i.e.\ntransforming sequences of Arabic codepoints to the appropriate\npresentational forms) but we removed this code long ago (ask Stuart,\nhe removed it).\n\nI think the solution is to look for OpenType layout tables and ignore\nthe font for Arabic if it doesn't support them, with the assumption\nthat DroidSansFallback.ttf will have proper GSUB/GPOS tables and support for Arabic.  But to do this we'll need to confirm that the fallback font hasn't been hacked up similarly.\n\nDetails:\n\nSamsung Epic Froyo\nHTC Desire HD (2.3)\n\nDroidSansArabic.ttf (size: 35908 bytes)\nhas GSUB/GPOS tables\nno Arabic presentation forms\n\nLG Optimus\n\nDroidSansArabic.ttf (size: 233456 bytes)\nno GSUB/GPOS tables\nhas Arabic presentation forms", "creation_time": "2011-08-04T01:34:27Z", "attachment_id": null, "time": "2011-08-04T01:34:27Z", "text": "The problem here is that LG Optimus ships with what looks like a\nnon-standard version of DroidSansArabic.ttf.  They've stripped the\nGSUB/GPOS OpenType layout tables which prevents HarfBuzz from shaping\nArabic correctly on these devices.  In place of these they've included\nglyphs for Arabic Presentation Forms, U+FB50-FDFF, U+FE70-FEFF:\n\nhttp://www.unicode.org/charts/PDF/UFB50.pdf\n\nThese are separate codepoints from the normal Arabic range\n(U+600-6FF), with a separate code point for each form of letters in\nthe Arabic alphabet (i.e. isolated, initial, medial, final).  Webkit\nhas code for doing presentational ligature formation (i.e.\ntransforming sequences of Arabic codepoints to the appropriate\npresentational forms) but we removed this code long ago (ask Stuart,\nhe removed it).\n\nI think the solution is to look for OpenType layout tables and ignore\nthe font for Arabic if it doesn't support them, with the assumption\nthat DroidSansFallback.ttf will have proper GSUB/GPOS tables and support for Arabic.  But to do this we'll need to confirm that the fallback font hasn't been hacked up similarly.\n\nDetails:\n\nSamsung Epic Froyo\nHTC Desire HD (2.3)\n\nDroidSansArabic.ttf (size: 35908 bytes)\nhas GSUB/GPOS tables\nno Arabic presentation forms\n\nLG Optimus\n\nDroidSansArabic.ttf (size: 233456 bytes)\nno GSUB/GPOS tables\nhas Arabic presentation forms", "id": 5632131, "is_private": false, "count": 7, "tags": [], "bug_id": 676068}, {"bug_id": 676068, "count": 8, "is_private": false, "tags": [], "id": 5632629, "text": "John asked me for all the fonts on my LG Optimus Black.\nI posted them here: http://people.mozilla.org/~mwargers/fonts/LGOptimusBlackFonts/\nThe zip file is for quick downloading of all the files at once.", "creator": "martijn.martijn@gmail.com", "time": "2011-08-04T08:41:25Z", "attachment_id": null, "author": "martijn.martijn@gmail.com", "raw_text": "John asked me for all the fonts on my LG Optimus Black.\nI posted them here: http://people.mozilla.org/~mwargers/fonts/LGOptimusBlackFonts/\nThe zip file is for quick downloading of all the files at once.", "creation_time": "2011-08-04T08:41:25Z"}, {"raw_text": "Drat and double drat.  They've also neutered DroidFallback, it also lacks GSUB/GPOS tables.  Argh and double argh.  Maybe we should ship with a sensible fallback font for these situations (the real DroidArabic is 36K).  The Hebrew and Thai fonts still retain their GSUB/GPOS tables.", "creation_time": "2011-08-04T08:48:39Z", "creator": "jd.bugzilla@gmail.com", "text": "Drat and double drat.  They've also neutered DroidFallback, it also lacks GSUB/GPOS tables.  Argh and double argh.  Maybe we should ship with a sensible fallback font for these situations (the real DroidArabic is 36K).  The Hebrew and Thai fonts still retain their GSUB/GPOS tables.", "attachment_id": null, "time": "2011-08-04T08:48:39Z", "author": "jd.bugzilla@gmail.com", "is_private": false, "count": 9, "tags": [], "id": 5632636, "bug_id": 676068}, {"creator": "cww@mozilla.com", "author": "cww@mozilla.com", "raw_text": "Huh, so I'm in contact with bbc because that the bold text on page doesn't join properly, but it sounds like this is a different problem.", "creation_time": "2011-08-04T21:08:14Z", "text": "Huh, so I'm in contact with bbc because that the bold text on page doesn't join properly, but it sounds like this is a different problem.", "attachment_id": null, "time": "2011-08-04T21:08:14Z", "is_private": false, "count": 10, "tags": [], "id": 5634286, "bug_id": 676068}, {"id": 5638147, "tags": [], "count": 11, "is_private": false, "bug_id": 676068, "creation_time": "2011-08-07T08:41:09Z", "raw_text": "(In reply to [:Cww] from comment #10)\n> Huh, so I'm in contact with bbc because that the bold text on page doesn't\n> join properly, but it sounds like this is a different problem.\n\nYes. That's bug 674335, which relates to a specific webfont the BBC Arabic site is using. The bug here is an issue with the locally-installed fonts on the LG device.", "time": "2011-08-07T08:41:09Z", "attachment_id": null, "text": "(In reply to [:Cww] from comment #10)\n> Huh, so I'm in contact with bbc because that the bold text on page doesn't\n> join properly, but it sounds like this is a different problem.\n\nYes. That's bug 674335, which relates to a specific webfont the BBC Arabic site is using. The bug here is an issue with the locally-installed fonts on the LG device.", "author": "jfkthame@gmail.com", "creator": "jfkthame@gmail.com"}, {"creator": "ibrahimamon@yahoo.com", "author": "ibrahimamon@yahoo.com", "text": "Hi,\n\nThanks for looking into this. I am the original user that reported this problem.  What is going to be the resolution to this?  Is the decision going to be to ship a fallback font?\n\nThanks", "attachment_id": null, "time": "2011-08-17T15:58:51Z", "raw_text": "Hi,\n\nThanks for looking into this. I am the original user that reported this problem.  What is going to be the resolution to this?  Is the decision going to be to ship a fallback font?\n\nThanks", "creation_time": "2011-08-17T15:58:51Z", "bug_id": 676068, "count": 12, "is_private": false, "tags": [], "id": 5659775}, {"tags": [], "is_private": false, "count": 13, "id": 5693737, "bug_id": 676068, "raw_text": "Anyone there? :)", "creation_time": "2011-09-01T15:47:48Z", "text": "Anyone there? :)", "creator": "ibrahimamon@yahoo.com", "author": "ibrahimamon@yahoo.com", "attachment_id": null, "time": "2011-09-01T15:47:48Z"}, {"creator": "sneetsher@gmail.com", "author": "sneetsher@gmail.com", "text": "Hi,\n\nI have a Samsung S with Android 2.2\n\n- Build-in browser have same problem of broken Arabic script (No shaping & No bidi)\n- Firefox 9 works well \n\nMozilla/5.0 (Android; Linux armv7l; rv:9.0)\nGecko/20111216 Firefox/9.0 Fennec/9.0\n\nCould I help in this with testing or any file you need from my phone?", "time": "2011-12-31T19:31:53Z", "attachment_id": null, "creation_time": "2011-12-31T19:31:53Z", "raw_text": "Hi,\n\nI have a Samsung S with Android 2.2\n\n- Build-in browser have same problem of broken Arabic script (No shaping & No bidi)\n- Firefox 9 works well \n\nMozilla/5.0 (Android; Linux armv7l; rv:9.0)\nGecko/20111216 Firefox/9.0 Fennec/9.0\n\nCould I help in this with testing or any file you need from my phone?", "bug_id": 676068, "tags": [], "count": 14, "is_private": false, "id": 5948538}, {"raw_text": "I guess the suggestion in comment 9 from John Daggett is a solution. You might ping him on irc, once he's back from vacation. Or Jonathan Kew might have an answer.", "creation_time": "2011-12-31T19:52:54Z", "time": "2011-12-31T19:52:54Z", "attachment_id": null, "text": "I guess the suggestion in comment 9 from John Daggett is a solution. You might ping him on irc, once he's back from vacation. Or Jonathan Kew might have an answer.", "id": 5948549, "tags": [], "is_private": false, "count": 15, "bug_id": 676068, "author": "martijn.martijn@gmail.com", "creator": "martijn.martijn@gmail.com"}, {"is_private": false, "count": 16, "tags": [], "id": 5948555, "bug_id": 676068, "raw_text": "(In reply to John Daggett (:jtd) (Away 23 Dec - 4 Jan) from comment #9)\n> Drat and double drat.  They've also neutered DroidFallback, it also lacks\n> GSUB/GPOS tables.  Argh and double argh.  Maybe we should ship with a\n> sensible fallback font for these situations (the real DroidArabic is 36K). \n> The Hebrew and Thai fonts still retain their GSUB/GPOS tables.\n\nJohn, can we detect that and offer to download a non-broken font? This kinda sorta fits in with bug 619521.", "creation_time": "2011-12-31T20:05:50Z", "text": "(In reply to John Daggett (:jtd) (Away 23 Dec - 4 Jan) from comment #9)\n> Drat and double drat.  They've also neutered DroidFallback, it also lacks\n> GSUB/GPOS tables.  Argh and double argh.  Maybe we should ship with a\n> sensible fallback font for these situations (the real DroidArabic is 36K). \n> The Hebrew and Thai fonts still retain their GSUB/GPOS tables.\n\nJohn, can we detect that and offer to download a non-broken font? This kinda sorta fits in with bug 619521.", "attachment_id": null, "time": "2011-12-31T20:05:50Z", "creator": "lassey@chromium.org", "author": "lassey@chromium.org"}, {"author": "jfkthame@gmail.com", "creator": "jfkthame@gmail.com", "id": 5948572, "count": 17, "is_private": false, "tags": [], "bug_id": 676068, "raw_text": "Perhaps we should check for the presence of the OpenType tables needed to support Arabic (and Indic scripts, etc), and mask out the corresponding ranges from the cmap if the layout tables are missing. This would be analogous to the check we do for AAT tables on Mac OS X.\n\nThis would mean that in a case where the font has been emasculated by removal of the GSUB/GPOS tables, we'd detect this as a lack of adequate font support for the characters in question, and a download-on-demand mechanism (or whatever) could kick in. As things stand, the initial problem here is that the device *does* have a font that appears to \"support\" the Arabic characters, so we don't even try to look further.", "creation_time": "2011-12-31T20:37:47Z", "time": "2011-12-31T20:37:47Z", "attachment_id": null, "text": "Perhaps we should check for the presence of the OpenType tables needed to support Arabic (and Indic scripts, etc), and mask out the corresponding ranges from the cmap if the layout tables are missing. This would be analogous to the check we do for AAT tables on Mac OS X.\n\nThis would mean that in a case where the font has been emasculated by removal of the GSUB/GPOS tables, we'd detect this as a lack of adequate font support for the characters in question, and a download-on-demand mechanism (or whatever) could kick in. As things stand, the initial problem here is that the device *does* have a font that appears to \"support\" the Arabic characters, so we don't even try to look further."}, {"bug_id": 676068, "id": 6211681, "count": 18, "is_private": false, "tags": [], "time": "2012-04-10T20:29:31Z", "attachment_id": null, "text": "*** Bug 737422 has been marked as a duplicate of this bug. ***", "raw_text": "", "creation_time": "2012-04-10T20:29:31Z", "author": "nhirata.bugzilla@gmail.com", "creator": "nhirata.bugzilla@gmail.com"}, {"author": "jfkthame@gmail.com", "creator": "jfkthame@gmail.com", "id": 6226240, "tags": [], "count": 19, "is_private": false, "bug_id": 676068, "creation_time": "2012-04-16T17:06:10Z", "raw_text": "Bug 745780 should enable rendering Arabic on devices like this, by using the presentation-form codepoints supported in their Droid Sans Arabic font.", "attachment_id": null, "time": "2012-04-16T17:06:10Z", "text": "Bug 745780 should enable rendering Arabic on devices like this, by using the presentation-form codepoints supported in their Droid Sans Arabic font."}, {"author": "ehsan.akhgari@gmail.com", "creator": "ehsan.akhgari@gmail.com", "id": 6247447, "is_private": false, "count": 20, "tags": [], "bug_id": 676068, "raw_text": "Jonathan, are we planning to use the Arabic fallback shaping implemented on HarfBuzz trunk?", "creation_time": "2012-04-23T22:45:57Z", "attachment_id": null, "time": "2012-04-23T22:45:57Z", "text": "Jonathan, are we planning to use the Arabic fallback shaping implemented on HarfBuzz trunk?"}, {"creator": "jd.bugzilla@gmail.com", "author": "jd.bugzilla@gmail.com", "raw_text": "(In reply to Ehsan Akhgari [:ehsan] from comment #20)\n> Jonathan, are we planning to use the Arabic fallback shaping implemented on\n> HarfBuzz trunk?\n\nEr, see the previous comment?  Bug 745780 is the harfbuzz update which includes these changes.", "creation_time": "2012-04-23T23:36:38Z", "text": "(In reply to Ehsan Akhgari [:ehsan] from comment #20)\n> Jonathan, are we planning to use the Arabic fallback shaping implemented on\n> HarfBuzz trunk?\n\nEr, see the previous comment?  Bug 745780 is the harfbuzz update which includes these changes.", "time": "2012-04-23T23:36:38Z", "attachment_id": null, "count": 21, "is_private": false, "tags": [], "id": 6247613, "bug_id": 676068}, {"id": 6247647, "is_private": false, "count": 22, "tags": [], "bug_id": 676068, "creation_time": "2012-04-23T23:46:47Z", "raw_text": "(In reply to John Daggett (:jtd) from comment #21)\n> (In reply to Ehsan Akhgari [:ehsan] from comment #20)\n> > Jonathan, are we planning to use the Arabic fallback shaping implemented on\n> > HarfBuzz trunk?\n> \n> Er, see the previous comment?  Bug 745780 is the harfbuzz update which\n> includes these changes.\n\nRight, which is why I asked this question.  I'm not sure if there's going to be some work on our side to use the fallback shaping.  If there is not, we should call this fixed perhaps?", "attachment_id": null, "time": "2012-04-23T23:46:47Z", "text": "(In reply to John Daggett (:jtd) from comment #21)\n> (In reply to Ehsan Akhgari [:ehsan] from comment #20)\n> > Jonathan, are we planning to use the Arabic fallback shaping implemented on\n> > HarfBuzz trunk?\n> \n> Er, see the previous comment?  Bug 745780 is the harfbuzz update which\n> includes these changes.\n\nRight, which is why I asked this question.  I'm not sure if there's going to be some work on our side to use the fallback shaping.  If there is not, we should call this fixed perhaps?", "author": "ehsan.akhgari@gmail.com", "creator": "ehsan.akhgari@gmail.com"}, {"author": "jfkthame@gmail.com", "creator": "jfkthame@gmail.com", "creation_time": "2012-04-24T07:43:17Z", "raw_text": "I believe this is fixed for the case where Droid Sans Arabic has been stripped of OpenType tables, but would like to have that confirmed by someone with such a device.\n\nMartijn, could you try a current nightly build on your LG Optimus and let us know whether Arabic now shapes OK, particularly on sites that are *not* providing their own webfonts?\n\nEhsan, note that for devices where the Droid Sans Arabic font *does* have a GSUB table, but that table is incorrect, we'll need to do something more to make the fallback path take over. I believe you have such a device, as discussed in bug 706888 comment 14. I'll follow up there with a possible way forward.", "time": "2012-04-24T07:43:17Z", "attachment_id": null, "text": "I believe this is fixed for the case where Droid Sans Arabic has been stripped of OpenType tables, but would like to have that confirmed by someone with such a device.\n\nMartijn, could you try a current nightly build on your LG Optimus and let us know whether Arabic now shapes OK, particularly on sites that are *not* providing their own webfonts?\n\nEhsan, note that for devices where the Droid Sans Arabic font *does* have a GSUB table, but that table is incorrect, we'll need to do something more to make the fallback path take over. I believe you have such a device, as discussed in bug 706888 comment 14. I'll follow up there with a possible way forward.", "id": 6248314, "is_private": false, "count": 23, "tags": [], "bug_id": 676068}, {"author": "jd.bugzilla@gmail.com", "creator": "jd.bugzilla@gmail.com", "bug_id": 676068, "id": 6248320, "count": 24, "is_private": false, "tags": [], "attachment_id": null, "time": "2012-04-24T07:48:15Z", "text": "(In reply to Jonathan Kew (:jfkthame) from comment #23)\n\n> Ehsan, note that for devices where the Droid Sans Arabic font *does* have a\n> GSUB table, but that table is incorrect, we'll need to do something more to\n> make the fallback path take over. I believe you have such a device, as\n> discussed in bug 706888 comment 14. I'll follow up there with a possible way\n> forward.\n\nNot sure what you have in mind but I think this should be a mobile-only fix, I think we should avoid font-specific fixups like this wherever possible.", "creation_time": "2012-04-24T07:48:15Z", "raw_text": "(In reply to Jonathan Kew (:jfkthame) from comment #23)\n\n> Ehsan, note that for devices where the Droid Sans Arabic font *does* have a\n> GSUB table, but that table is incorrect, we'll need to do something more to\n> make the fallback path take over. I believe you have such a device, as\n> discussed in bug 706888 comment 14. I'll follow up there with a possible way\n> forward.\n\nNot sure what you have in mind but I think this should be a mobile-only fix, I think we should avoid font-specific fixups like this wherever possible."}, {"author": "martijn.martijn@gmail.com", "creator": "martijn.martijn@gmail.com", "id": 6248332, "is_private": false, "count": 25, "tags": [], "bug_id": 676068, "creation_time": "2012-04-24T08:00:10Z", "raw_text": "(In reply to Jonathan Kew (:jfkthame) from comment #23)\n> Martijn, could you try a current nightly build on your LG Optimus and let us\n> know whether Arabic now shapes OK, particularly on sites that are *not*\n> providing their own webfonts?\n\nThat phone went to the Mountain View office, Tony knows who has it now.", "attachment_id": null, "time": "2012-04-24T08:00:10Z", "text": "(In reply to Jonathan Kew (:jfkthame) from comment #23)\n> Martijn, could you try a current nightly build on your LG Optimus and let us\n> know whether Arabic now shapes OK, particularly on sites that are *not*\n> providing their own webfonts?\n\nThat phone went to the Mountain View office, Tony knows who has it now."}]}}, "comments": {}}