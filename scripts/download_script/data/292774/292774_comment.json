{"bugs": {"292774": {"comments": [{"bug_id": 292774, "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3\n\nThe context menu option \"View Image\" does not validate the src of the image. The\nimage source URL is directly opened without checking if this may result in\nchrome access. By using absolute positioning and the moz-opacity filter an\nattacker can easily fool the user to think he is going to view a valid image.\n\nWhile this isn't exploitable without being combined with other flaws, it can be\na significant stepstone for attacks. Beside cross site scripting exploits that\nuse the chrome page as the entry point for privilege elevation attacks, there\nmight be scripts in chrome that can be tricked into evaluating parts of the\ncalling url string. chrome://mozapps/content/extensions/extensions.xul is an\nexample for a page that uses location.search as part of their scripts - even\nthough i wasn't able to leverage this. \n\nReproducible: Always\n\nSteps to Reproduce:\n1. Open http://bugzilla:2Ke7Zis@www.mikx.de/fireimaging/\n2. Follow instructions", "id": 2492834, "time": "2005-05-03T19:24:03Z", "tags": [], "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3\n\nThe context menu option \"View Image\" does not validate the src of the image. The\nimage source URL is directly opened without checking if this may result in\nchrome access. By using absolute positioning and the moz-opacity filter an\nattacker can easily fool the user to think he is going to view a valid image.\n\nWhile this isn't exploitable without being combined with other flaws, it can be\na significant stepstone for attacks. Beside cross site scripting exploits that\nuse the chrome page as the entry point for privilege elevation attacks, there\nmight be scripts in chrome that can be tricked into evaluating parts of the\ncalling url string. chrome://mozapps/content/extensions/extensions.xul is an\nexample for a page that uses location.search as part of their scripts - even\nthough i wasn't able to leverage this. \n\nReproducible: Always\n\nSteps to Reproduce:\n1. Open http://bugzilla:2Ke7Zis@www.mikx.de/fireimaging/\n2. Follow instructions", "is_private": false, "creation_time": "2005-05-03T19:24:03Z", "author": "mikx@mikx.de", "count": 0, "attachment_id": null, "creator": "mikx@mikx.de"}, {"text": "It'd be an easy fix since the fix for bug 69070 explicitly allows <img> to\nreference chrome urls:\nhttp://lxr.mozilla.org/mozilla/source/content/base/src/nsContentUtils.cpp#1821\n\nWe might want to disable View-image for broken images. In any case the\nview-image code should do another checkLoadURI regardless of what we do with the\nbug 69070 fix. Paranoia can't hurt and in this case is justified.", "id": 2493060, "time": "2005-05-04T00:20:08Z", "tags": [], "bug_id": 292774, "count": 1, "attachment_id": null, "creator": "dveditz@mozilla.com", "raw_text": "It'd be an easy fix since the fix for bug 69070 explicitly allows <img> to\nreference chrome urls:\nhttp://lxr.mozilla.org/mozilla/source/content/base/src/nsContentUtils.cpp#1821\n\nWe might want to disable View-image for broken images. In any case the\nview-image code should do another checkLoadURI regardless of what we do with the\nbug 69070 fix. Paranoia can't hurt and in this case is justified.", "is_private": false, "creation_time": "2005-05-04T00:20:08Z", "author": "dveditz@mozilla.com"}, {"text": "Changing the 69070 fix won't help: even if the load is denied the user can \"View\nImage\" on the empty space. See with the blocked \"file\" image with the following\ndata url\n\ndata:text/html,<a%20href=\"chrome://browser/content/browser.xul\">link</a><img%20src=\"chrome://browser/skin/Throbber.gif\"><img%20src=\"file://c|/tmp/mozilla-16.png\"><img%20src=\"http:/www.biiid.com/c|/tmp/mozilla-16.png\">", "id": 2493073, "tags": [], "time": "2005-05-04T00:40:06Z", "bug_id": 292774, "creator": "dveditz@mozilla.com", "raw_text": "Changing the 69070 fix won't help: even if the load is denied the user can \"View\nImage\" on the empty space. See with the blocked \"file\" image with the following\ndata url\n\ndata:text/html,<a%20href=\"chrome://browser/content/browser.xul\">link</a><img%20src=\"chrome://browser/skin/Throbber.gif\"><img%20src=\"file://c|/tmp/mozilla-16.png\"><img%20src=\"http:/www.biiid.com/c|/tmp/mozilla-16.png\">", "attachment_id": null, "count": 2, "is_private": false, "author": "dveditz@mozilla.com", "creation_time": "2005-05-04T00:40:06Z"}, {"raw_text": "Changing the check in content utils would actually break various stuff (like\nbroken-image icons in webpages).\n\nI think doing a checkLoadURI in the \"view image\" code is the way to go.  Also do\nthe same in \"view only this frame\" and any similar options we have in the\ncontext menu.", "is_private": false, "creation_time": "2005-05-04T01:31:30Z", "author": "bzbarsky@mit.edu", "count": 3, "attachment_id": null, "creator": "bzbarsky@mit.edu", "bug_id": 292774, "id": 2493083, "text": "Changing the check in content utils would actually break various stuff (like\nbroken-image icons in webpages).\n\nI think doing a checkLoadURI in the \"view image\" code is the way to go.  Also do\nthe same in \"view only this frame\" and any similar options we have in the\ncontext menu.", "time": "2005-05-04T01:31:30Z", "tags": []}, {"bug_id": 292774, "text": "Created attachment 182566\nxpfe view [background] image patch (checked in)\n\nI don't (yet) think that \"view only this frame\" is similar - the frame and all\nof its scripts etc. will already have been loaded.", "id": 2493221, "tags": [], "time": "2005-05-04T08:37:18Z", "is_private": false, "raw_text": "I don't (yet) think that \"view only this frame\" is similar - the frame and all\nof its scripts etc. will already have been loaded.", "author": "neil@httl.net", "creation_time": "2005-05-04T08:37:18Z", "attachment_id": 182566, "count": 4, "creator": "neil@httl.net"}, {"creator": "mikx@mikx.de", "attachment_id": null, "count": 5, "author": "mikx@mikx.de", "creation_time": "2005-05-04T10:29:23Z", "is_private": false, "raw_text": "The demo page got updated to proof that this bug can actually be exploitet to\nrun arbitrary code in combination with popups and a cross site scripting bug.", "tags": [], "time": "2005-05-04T10:29:23Z", "id": 2493279, "text": "The demo page got updated to proof that this bug can actually be exploitet to\nrun arbitrary code in combination with popups and a cross site scripting bug.", "bug_id": 292774}, {"attachment_id": 182566, "count": 6, "creator": "bzbarsky@mit.edu", "is_private": false, "raw_text": "Hmm.. I guess if a frame load is blocked by security the target.ownerDocument\nwill be about:blank, so viewing the frame will show nothing...\n\nr=bzbarsky (note that this is seamonkey-only and should land on 1.7.8; Firefox\nalso needs a patch here...)", "author": "bzbarsky@mit.edu", "creation_time": "2005-05-04T16:37:37Z", "id": 2493483, "text": "Comment on attachment 182566\nxpfe view [background] image patch (checked in)\n\nHmm.. I guess if a frame load is blocked by security the target.ownerDocument\nwill be about:blank, so viewing the frame will show nothing...\n\nr=bzbarsky (note that this is seamonkey-only and should land on 1.7.8; Firefox\nalso needs a patch here...)", "tags": [], "time": "2005-05-04T16:37:37Z", "bug_id": 292774}, {"count": 7, "attachment_id": 186443, "creation_time": "2005-06-16T05:16:10Z", "author": "mconnor@mozilla.com", "is_private": false, "creator": "mconnor@mozilla.com", "raw_text": "should be sufficient, per bz's comment", "time": "2005-06-16T05:16:10Z", "tags": [], "id": 2528697, "text": "Created attachment 186443\nfirefox version of seamonkey patch (checked in)\n\nshould be sufficient, per bz's comment", "bug_id": 292774}, {"creator": "jstenback+bmo@gmail.com", "count": 8, "attachment_id": 186443, "creation_time": "2005-06-16T06:04:52Z", "author": "jstenback+bmo@gmail.com", "raw_text": "sr=jst", "is_private": false, "time": "2005-06-16T06:04:52Z", "tags": [], "text": "Comment on attachment 186443\nfirefox version of seamonkey patch (checked in)\n\nsr=jst", "id": 2528718, "bug_id": 292774}, {"raw_text": "sr=dveditz\na=dveditz for aviary1.0.1 and moz1.7 branches and trunk", "creator": "dveditz@mozilla.com", "bug_id": 292774, "time": "2005-06-16T08:23:08Z", "tags": [], "id": 2528773, "text": "Comment on attachment 182566\nxpfe view [background] image patch (checked in)\n\nsr=dveditz\na=dveditz for aviary1.0.1 and moz1.7 branches and trunk", "creation_time": "2005-06-16T08:23:08Z", "author": "dveditz@mozilla.com", "is_private": false, "count": 9, "attachment_id": 182566}, {"is_private": false, "raw_text": "r=dveditz\na=dveditz for branches and trunk", "author": "dveditz@mozilla.com", "creation_time": "2005-06-16T08:23:54Z", "attachment_id": 186443, "count": 10, "creator": "dveditz@mozilla.com", "bug_id": 292774, "id": 2528774, "text": "Comment on attachment 186443\nfirefox version of seamonkey patch (checked in)\n\nr=dveditz\na=dveditz for branches and trunk", "tags": [], "time": "2005-06-16T08:23:54Z"}, {"bug_id": 292774, "time": "2005-06-16T08:43:53Z", "tags": [], "text": "Comment on attachment 182566\nxpfe view [background] image patch (checked in)\n\nlanded on trunk and 1.7.9 branch", "id": 2528783, "raw_text": "landed on trunk and 1.7.9 branch", "creator": "mconnor@mozilla.com", "creation_time": "2005-06-16T08:43:53Z", "author": "mconnor@mozilla.com", "is_private": false, "count": 11, "attachment_id": 182566}, {"creator": "mconnor@mozilla.com", "attachment_id": 186443, "count": 12, "author": "mconnor@mozilla.com", "creation_time": "2005-06-16T08:44:38Z", "is_private": false, "raw_text": "landed on aviary 1.0.1 branch and trunk", "tags": [], "time": "2005-06-16T08:44:38Z", "id": 2528784, "text": "Comment on attachment 186443\nfirefox version of seamonkey patch (checked in)\n\nlanded on aviary 1.0.1 branch and trunk", "bug_id": 292774}, {"creation_time": "2005-06-18T00:14:43Z", "author": "neil@httl.net", "is_private": false, "count": 13, "attachment_id": null, "raw_text": "Damn, I forgot the trailing semicolons. How annoying :-[", "creator": "neil@httl.net", "bug_id": 292774, "time": "2005-06-18T00:14:43Z", "tags": [], "text": "Damn, I forgot the trailing semicolons. How annoying :-[", "id": 2530345}, {"bug_id": 292774, "time": "2005-07-07T00:23:12Z", "tags": [], "id": 2544827, "text": "v.fixed on aviary with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.9)\nGecko/20050706 Firefox/1.0.5 using the mikx testcase.  If I enable popups, I\nstill get a small window, but nothing bad happens.  With popups disabled,\neverything seems fine.", "creation_time": "2005-07-07T00:23:12Z", "author": "jaymoz@gmail.com", "raw_text": "v.fixed on aviary with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.9)\nGecko/20050706 Firefox/1.0.5 using the mikx testcase.  If I enable popups, I\nstill get a small window, but nothing bad happens.  With popups disabled,\neverything seems fine.", "is_private": false, "creator": "jaymoz@gmail.com", "count": 14, "attachment_id": null}, {"bug_id": 292774, "time": "2005-07-11T15:02:23Z", "tags": [], "id": 2548408, "text": "(In reply to comment #14)\n> v.fixed on aviary with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.9)\n> Gecko/20050706 Firefox/1.0.5 using the mikx testcase.  If I enable popups, I\n> still get a small window, but nothing bad happens.  With popups disabled,\n> everything seems fine.\n\nThis testcase relies on view-source:javascript:eval(). The eval() part was only\nuseful starting in 1.0.3, and the view-source:javascript part was disabled in\n1.0.4 by the fix for bug 290982.", "creation_time": "2005-07-11T15:02:23Z", "author": "dveditz@mozilla.com", "raw_text": "(In reply to comment #14)\n> v.fixed on aviary with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.9)\n> Gecko/20050706 Firefox/1.0.5 using the mikx testcase.  If I enable popups, I\n> still get a small window, but nothing bad happens.  With popups disabled,\n> everything seems fine.\n\nThis testcase relies on view-source:javascript:eval(). The eval() part was only\nuseful starting in 1.0.3, and the view-source:javascript part was disabled in\n1.0.4 by the fix for bug 290982.", "is_private": false, "creator": "dveditz@mozilla.com", "count": 15, "attachment_id": null}, {"creator": "dveditz@mozilla.com", "attachment_id": null, "count": 16, "author": "dveditz@mozilla.com", "creation_time": "2005-07-12T18:35:29Z", "is_private": false, "raw_text": "Adding distributors", "tags": [], "time": "2005-07-12T18:35:29Z", "id": 2549718, "text": "Adding distributors", "bug_id": 292774}, {"count": 17, "attachment_id": null, "creator": "dveditz@mozilla.com", "raw_text": "FF1.0.5 advisories published", "is_private": false, "creation_time": "2005-07-13T17:15:02Z", "author": "dveditz@mozilla.com", "id": 2550698, "text": "FF1.0.5 advisories published", "time": "2005-07-13T17:15:02Z", "tags": [], "bug_id": 292774}, {"count": 18, "attachment_id": null, "creator": "lloyd@mcomi.com", "raw_text": "Is this a particular MFSA ?", "is_private": false, "creation_time": "2005-07-28T21:16:54Z", "author": "lloyd@mcomi.com", "text": "Is this a particular MFSA ?", "id": 2565541, "time": "2005-07-28T21:16:54Z", "tags": [], "bug_id": 292774}, {"text": "(In reply to comment #18)\n> Is this a particular MFSA ?\n\nWe did not issue an advisory because the exploit was blocked by a fix in an\nearlier version (which did get an advisory). What was ultimately fixed here was\nthe potential stepping stone to an exploit should another XSS bug be found.\n", "id": 2565763, "time": "2005-07-29T01:02:16Z", "tags": [], "bug_id": 292774, "count": 19, "attachment_id": null, "creator": "dveditz@mozilla.com", "raw_text": "(In reply to comment #18)\n> Is this a particular MFSA ?\n\nWe did not issue an advisory because the exploit was blocked by a fix in an\nearlier version (which did get an advisory). What was ultimately fixed here was\nthe potential stepping stone to an exploit should another XSS bug be found.\n", "is_private": false, "creation_time": "2005-07-29T01:02:16Z", "author": "dveditz@mozilla.com"}]}}, "comments": {}}