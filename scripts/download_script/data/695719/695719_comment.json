{"bugs": {"695719": {"comments": [{"bug_id": 695719, "count": 0, "time": "2011-10-19T15:58:12Z", "tags": [], "text": "The pixman ARM assembly symbols all end up in the .text section even with -ffunction-sections, and have a size of 0, which makes them invisible to e.g. valgrind.", "author": "mh+mozilla@glandium.org", "creation_time": "2011-10-19T15:58:12Z", "creator": "mh+mozilla@glandium.org", "is_private": false, "id": 5792025, "raw_text": "The pixman ARM assembly symbols all end up in the .text section even with -ffunction-sections, and have a size of 0, which makes them invisible to e.g. valgrind.", "attachment_id": null}, {"time": "2011-10-19T16:01:16Z", "bug_id": 695719, "tags": [], "text": "Created attachment 568081\nPixman ARM assembly symbols tweaks\n\nIt would be better if the .section tweaks depended on -ffunction-sections being there, but there's no way to know :-/\n\nI'll need to check if that has some unwanted side effects when not building with -ffunction-sections.", "author": "mh+mozilla@glandium.org", "creation_time": "2011-10-19T16:01:16Z", "count": 1, "creator": "mh+mozilla@glandium.org", "is_private": false, "id": 5792036, "raw_text": "It would be better if the .section tweaks depended on -ffunction-sections being there, but there's no way to know :-/\n\nI'll need to check if that has some unwanted side effects when not building with -ffunction-sections.", "attachment_id": 568081}, {"text": "Is using -ffunction-sections option and putting each function into its own section really necessary? Based on my quick test (admittedly done in linux, not android), looks like just the part of your patch adding .size directives is enough to solve valgrind compatibility problems.\n\nCould you please also send your patch to the pixman mailing list or alternatively file a bug with the patch attached at https://bugs.freedesktop.org/ ?\n\nPS. to play nicer with various debugging tools, also adding unwind tables generation directives to the assembly code might be useful sooner or later.", "bug_id": 695719, "time": "2011-10-19T23:46:02Z", "tags": [], "creation_time": "2011-10-19T23:46:02Z", "author": "siarhei.siamashka@gmail.com", "count": 2, "is_private": false, "creator": "siarhei.siamashka@gmail.com", "id": 5793446, "raw_text": "Is using -ffunction-sections option and putting each function into its own section really necessary? Based on my quick test (admittedly done in linux, not android), looks like just the part of your patch adding .size directives is enough to solve valgrind compatibility problems.\n\nCould you please also send your patch to the pixman mailing list or alternatively file a bug with the patch attached at https://bugs.freedesktop.org/ ?\n\nPS. to play nicer with various debugging tools, also adding unwind tables generation directives to the assembly code might be useful sooner or later.", "attachment_id": null}, {"creation_time": "2011-10-20T06:24:53Z", "author": "mh+mozilla@glandium.org", "text": "(In reply to Siarhei Siamashka from comment #2)\n> Is using -ffunction-sections option and putting each function into its own\n> section really necessary?\n\nIt's useful for function/section reordering.\n\n> Could you please also send your patch to the pixman mailing list or\n> alternatively file a bug with the patch attached at\n> https://bugs.freedesktop.org/ ?\n\nI will, when i figure whether the function section blows things up without -ffunction-sections", "bug_id": 695719, "time": "2011-10-20T06:24:53Z", "tags": [], "is_private": false, "creator": "mh+mozilla@glandium.org", "count": 3, "id": 5793846, "attachment_id": null, "raw_text": "(In reply to Siarhei Siamashka from comment #2)\n> Is using -ffunction-sections option and putting each function into its own\n> section really necessary?\n\nIt's useful for function/section reordering.\n\n> Could you please also send your patch to the pixman mailing list or\n> alternatively file a bug with the patch attached at\n> https://bugs.freedesktop.org/ ?\n\nI will, when i figure whether the function section blows things up without -ffunction-sections"}]}}, "comments": {}}