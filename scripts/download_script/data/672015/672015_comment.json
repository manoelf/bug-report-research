{"comments": {}, "bugs": {"672015": {"comments": [{"time": "2011-07-16T03:26:34Z", "raw_text": "I recently removed the dom/src/threads directory and saw consistent timeouts in debug mochitest-2 runs. After much debugging I finally figured out that my patch wasn't the problem... It turns out that our mochitest chunking algorithm is simple and can be hazardous.\n\nThese are the directories for tests that ran in mochitest-2 before my change:\n\n0 INFO Running tests in tests/content/xml/document/test, tests/content/xslt/tests/mochitest, tests/content/xul/content/test, tests/docshell/test/navigation, tests/docshell/test, tests/dom/indexedDB/test, tests/dom/plugins/test, tests/dom/src/json/test, tests/dom/src/jsurl/test, tests/dom/src/threads/test, tests/dom/tests/mochitest/ajax, tests/dom/tests/mochitest/bugs, tests/dom/tests/mochitest/dom-level0, tests/dom/tests/mochitest/dom-level1-core, tests/dom/tests/mochitest/dom-level2-core\n\nAfter my change:\n\n0 INFO Running tests in tests/content/xml/document/test, tests/content/xslt/tests/mochitest, tests/content/xul/content/test, tests/docshell/test/navigation, tests/docshell/test, tests/dom/indexedDB/test, tests/dom/plugins/test, tests/dom/src/json/test, tests/dom/src/jsurl/test, tests/dom/tests/mochitest/ajax, tests/dom/tests/mochitest/bugs, tests/dom/tests/mochitest/dom-level0, tests/dom/tests/mochitest/dom-level1-core, tests/dom/tests/mochitest/dom-level2-core, tests/dom/tests/mochitest/dom-level2-html\n\nBefore we were luckily splitting dom-level2-core and dom-level2-html into mochitest-2 and mochitest-3, but after my change they both run in mochitest-2. Running all of these tests exceeds the 5400 seconds at which we currently cap each mochitest run.\n\nTo work around the problem I simply added a bogus test to dom/src/foo:\n\nhttp://hg.mozilla.org/integration/mozilla-inbound/rev/8bf078002768\n\nWe need some kind of real solution to this, however. The next time someone removes a test directory in mochitest-1 or mochitest-2 we will see these timeouts again and it is very difficult to figure out what's going wrong.", "attachment_id": null, "tags": [], "creator": "bent.mozilla@gmail.com", "count": 0, "text": "I recently removed the dom/src/threads directory and saw consistent timeouts in debug mochitest-2 runs. After much debugging I finally figured out that my patch wasn't the problem... It turns out that our mochitest chunking algorithm is simple and can be hazardous.\n\nThese are the directories for tests that ran in mochitest-2 before my change:\n\n0 INFO Running tests in tests/content/xml/document/test, tests/content/xslt/tests/mochitest, tests/content/xul/content/test, tests/docshell/test/navigation, tests/docshell/test, tests/dom/indexedDB/test, tests/dom/plugins/test, tests/dom/src/json/test, tests/dom/src/jsurl/test, tests/dom/src/threads/test, tests/dom/tests/mochitest/ajax, tests/dom/tests/mochitest/bugs, tests/dom/tests/mochitest/dom-level0, tests/dom/tests/mochitest/dom-level1-core, tests/dom/tests/mochitest/dom-level2-core\n\nAfter my change:\n\n0 INFO Running tests in tests/content/xml/document/test, tests/content/xslt/tests/mochitest, tests/content/xul/content/test, tests/docshell/test/navigation, tests/docshell/test, tests/dom/indexedDB/test, tests/dom/plugins/test, tests/dom/src/json/test, tests/dom/src/jsurl/test, tests/dom/tests/mochitest/ajax, tests/dom/tests/mochitest/bugs, tests/dom/tests/mochitest/dom-level0, tests/dom/tests/mochitest/dom-level1-core, tests/dom/tests/mochitest/dom-level2-core, tests/dom/tests/mochitest/dom-level2-html\n\nBefore we were luckily splitting dom-level2-core and dom-level2-html into mochitest-2 and mochitest-3, but after my change they both run in mochitest-2. Running all of these tests exceeds the 5400 seconds at which we currently cap each mochitest run.\n\nTo work around the problem I simply added a bogus test to dom/src/foo:\n\nhttp://hg.mozilla.org/integration/mozilla-inbound/rev/8bf078002768\n\nWe need some kind of real solution to this, however. The next time someone removes a test directory in mochitest-1 or mochitest-2 we will see these timeouts again and it is very difficult to figure out what's going wrong.", "author": "bent.mozilla@gmail.com", "id": 5594639, "bug_id": 672015, "is_private": false, "creation_time": "2011-07-16T03:26:34Z"}]}}}