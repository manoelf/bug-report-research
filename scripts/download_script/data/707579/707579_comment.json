{"comments": {}, "bugs": {"707579": {"comments": [{"raw_text": "xpt.py is trying to generate the destination file even if all inputs files are older (ie. unchanged). We should prevent that to win some time. This is currently not changing anything because the dest file is removed before calling this method but we might and up not removing (maybe only if an env variable is set).", "time": "2011-12-04T23:40:38Z", "author": "mounir@lamouri.fr", "text": "Created attachment 578948\nPatch v1\n\nxpt.py is trying to generate the destination file even if all inputs files are older (ie. unchanged). We should prevent that to win some time. This is currently not changing anything because the dest file is removed before calling this method but we might and up not removing (maybe only if an env variable is set).", "count": 0, "bug_id": 707579, "id": 5891802, "attachment_id": 578948, "tags": [], "creator": "mounir@lamouri.fr", "creation_time": "2011-12-04T23:40:38Z", "is_private": false}, {"time": "2011-12-07T20:36:00Z", "raw_text": "Review of attachment 578948:\n-----------------------------------------------------------------\n\nThis should be handled in the build system, not in xpt.py.", "bug_id": 707579, "id": 5898339, "author": "khuey@kylehuey.com", "count": 1, "text": "Comment on attachment 578948\nPatch v1\n\nReview of attachment 578948:\n-----------------------------------------------------------------\n\nThis should be handled in the build system, not in xpt.py.", "tags": [], "attachment_id": 578948, "creation_time": "2011-12-07T20:36:00Z", "is_private": false, "creator": "khuey@kylehuey.com"}, {"raw_text": "The file isn't called from a Makefile but from toolkit/mozapps/installer/xptlink.pl which is called by a Makefile. Adding a rule to the Makefile to handle that might not be trivial. AFAIUI, that would mean translating the perl script to some makefile rules. This said, can a makefile rule be dynamic? In the sense that components can be numerous and the files needed to build them vary too.\nFWIW, I think that would be quite too much of work compared to the goal we try to reach.", "attachment_id": null, "time": "2011-12-11T13:54:28Z", "tags": [], "count": 2, "text": "The file isn't called from a Makefile but from toolkit/mozapps/installer/xptlink.pl which is called by a Makefile. Adding a rule to the Makefile to handle that might not be trivial. AFAIUI, that would mean translating the perl script to some makefile rules. This said, can a makefile rule be dynamic? In the sense that components can be numerous and the files needed to build them vary too.\nFWIW, I think that would be quite too much of work compared to the goal we try to reach.", "author": "mounir@lamouri.fr", "creator": "mounir@lamouri.fr", "is_private": false, "creation_time": "2011-12-11T13:54:28Z", "id": 5907144, "bug_id": 707579}, {"creator": "khuey@kylehuey.com", "count": 3, "text": "Comment on attachment 578948\nPatch v1\n\nOk, since all this shit is awful adding this doesn't make it much worse.", "author": "khuey@kylehuey.com", "id": 5926675, "bug_id": 707579, "is_private": false, "creation_time": "2011-12-19T15:31:40Z", "time": "2011-12-19T15:31:40Z", "raw_text": "Ok, since all this shit is awful adding this doesn't make it much worse.", "attachment_id": 578948, "tags": []}, {"author": "nrthomas@gmail.com", "text": "http://hg.mozilla.org/integration/mozilla-inbound/rev/e00bbdb439ed", "count": 4, "creator": "nrthomas@gmail.com", "creation_time": "2012-04-30T07:07:18Z", "is_private": false, "bug_id": 707579, "id": 6264789, "attachment_id": null, "raw_text": "http://hg.mozilla.org/integration/mozilla-inbound/rev/e00bbdb439ed", "time": "2012-04-30T07:07:18Z", "tags": []}, {"time": "2012-04-30T08:24:07Z", "raw_text": "I must say I don't quite like this change, because it has an general effect on a tool that is used in more than our trees (it is part of the sdk)", "attachment_id": null, "tags": [], "creator": "mh+mozilla@glandium.org", "count": 5, "text": "I must say I don't quite like this change, because it has an general effect on a tool that is used in more than our trees (it is part of the sdk)", "author": "mh+mozilla@glandium.org", "bug_id": 707579, "id": 6264860, "is_private": false, "creation_time": "2012-04-30T08:24:07Z"}, {"bug_id": 707579, "id": 6265046, "count": 6, "text": "Backed out for win64 make check failures:\nhttps://tbpl.mozilla.org/?tree=Mozilla-Inbound&onlyunstarred=1&rev=5b2cef6c4c34\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=11319103&tree=Mozilla-Inbound\n\n{\nmake -C tools check\nmake[4]: Entering directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt/tools'\nc:/mozilla-build/python/python2.6.exe /e/builds/moz2_slave/m-in-w64/build/xpcom/typelib/xpt/tools/runtests.py\nc:\\users\\cltbld\\appdata\\local\\temp\\tmpzwsnlh\\tmpt5biin  is already up-to-date.\nmake[4]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt/tools'\nmake[3]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt'\nmake[2]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib'\nmake[1]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom'\n....................E\n======================================================================\nERROR: test_xpt_link (__main__.TestXPTLink)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"e:/builds/moz2_slave/m-in-w64/build/xpcom/typelib/xpt/tools/runtests.py\", line 780, in test_xpt_link\n    t3 = xpt.Typelib.read(f3)\n  File \"e:\\builds\\moz2_slave\\m-in-w64\\build\\xpcom\\typelib\\xpt\\tools\\xpt.py\", line 1063, in read\n    data = Typelib._header.unpack(map[:Typelib._header.size])\nerror: unpack requires a string argument of length 32\n\n----------------------------------------------------------------------\nRan 21 tests in 0.020s\n\nFAILED (errors=1)\nmake[4]: *** [check] Error 1\n}\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/043266d76bb3", "author": "emorley@mozilla.com", "time": "2012-04-30T10:59:30Z", "raw_text": "Backed out for win64 make check failures:\nhttps://tbpl.mozilla.org/?tree=Mozilla-Inbound&onlyunstarred=1&rev=5b2cef6c4c34\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=11319103&tree=Mozilla-Inbound\n\n{\nmake -C tools check\nmake[4]: Entering directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt/tools'\nc:/mozilla-build/python/python2.6.exe /e/builds/moz2_slave/m-in-w64/build/xpcom/typelib/xpt/tools/runtests.py\nc:\\users\\cltbld\\appdata\\local\\temp\\tmpzwsnlh\\tmpt5biin  is already up-to-date.\nmake[4]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt/tools'\nmake[3]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib/xpt'\nmake[2]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom/typelib'\nmake[1]: Leaving directory `/e/builds/moz2_slave/m-in-w64/build/obj-firefox/xpcom'\n....................E\n======================================================================\nERROR: test_xpt_link (__main__.TestXPTLink)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"e:/builds/moz2_slave/m-in-w64/build/xpcom/typelib/xpt/tools/runtests.py\", line 780, in test_xpt_link\n    t3 = xpt.Typelib.read(f3)\n  File \"e:\\builds\\moz2_slave\\m-in-w64\\build\\xpcom\\typelib\\xpt\\tools\\xpt.py\", line 1063, in read\n    data = Typelib._header.unpack(map[:Typelib._header.size])\nerror: unpack requires a string argument of length 32\n\n----------------------------------------------------------------------\nRan 21 tests in 0.020s\n\nFAILED (errors=1)\nmake[4]: *** [check] Error 1\n}\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/043266d76bb3", "creation_time": "2012-04-30T10:59:30Z", "is_private": false, "creator": "emorley@mozilla.com", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "ted@mielczarek.org", "creation_time": "2012-05-01T10:56:17Z", "is_private": false, "raw_text": "Oddly enough, this passed the Win64 build on try:\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=11316618&tree=Try", "time": "2012-05-01T10:56:17Z", "author": "ted@mielczarek.org", "count": 7, "text": "Oddly enough, this passed the Win64 build on try:\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=11316618&tree=Try", "id": 6268716, "bug_id": 707579}, {"time": "2012-05-01T11:22:53Z", "raw_text": "It's most probably an incremental build issue. I still don't think touching xpt.py is the right way to fix this.", "count": 8, "text": "It's most probably an incremental build issue. I still don't think touching xpt.py is the right way to fix this.", "author": "mh+mozilla@glandium.org", "bug_id": 707579, "id": 6268755, "attachment_id": null, "tags": [], "creator": "mh+mozilla@glandium.org", "creation_time": "2012-05-01T11:22:53Z", "is_private": false}, {"creator": "ted@mielczarek.org", "text": "I have a patch on bug 654448 that makes `xpt.py link` about 5x faster, so maybe we don't need this.", "count": 9, "author": "ted@mielczarek.org", "id": 6274119, "bug_id": 707579, "creation_time": "2012-05-02T20:53:54Z", "is_private": false, "time": "2012-05-02T20:53:54Z", "raw_text": "I have a patch on bug 654448 that makes `xpt.py link` about 5x faster, so maybe we don't need this.", "attachment_id": null, "tags": []}, {"creator": "mounir@lamouri.fr", "text": "(In reply to Ted Mielczarek [:ted] from comment #9)\n> I have a patch on bug 654448 that makes `xpt.py link` about 5x faster, so\n> maybe we don't need this.\n\nJust for information, does adding this change to your patch has a serious impact in the time time |make package| takes?", "count": 10, "author": "mounir@lamouri.fr", "bug_id": 707579, "id": 6275821, "creation_time": "2012-05-03T09:21:54Z", "is_private": false, "time": "2012-05-03T09:21:54Z", "raw_text": "(In reply to Ted Mielczarek [:ted] from comment #9)\n> I have a patch on bug 654448 that makes `xpt.py link` about 5x faster, so\n> maybe we don't need this.\n\nJust for information, does adding this change to your patch has a serious impact in the time time |make package| takes?", "attachment_id": null, "tags": []}, {"tags": [], "time": "2012-05-03T14:51:19Z", "attachment_id": null, "raw_text": "I don't know, I haven't tested this patch. My patch in the other bug took the xpt link step from 16.5s to 3.5s on my machine.", "bug_id": 707579, "id": 6276500, "creation_time": "2012-05-03T14:51:19Z", "is_private": false, "creator": "ted@mielczarek.org", "author": "ted@mielczarek.org", "count": 11, "text": "I don't know, I haven't tested this patch. My patch in the other bug took the xpt link step from 16.5s to 3.5s on my machine."}, {"bug_id": 707579, "id": 6301023, "creation_time": "2012-05-11T17:05:01Z", "is_private": false, "creator": "john+bugzilla@oduinn.com", "text": "mounir: \n\nWe've got enough speedup from (now closed) bug#707569 that I'm happy for phase1 cleanup, hence fixing dependencies. Plus blocking a fixed bug didnt make sense.\n\nNote: I didnt close this bug#707579, because I *think* this is still useful to do, so happy to help make that happen if you think its worth it. I dont have full context, hence asking: what do you want to do here?", "count": 12, "author": "john+bugzilla@oduinn.com", "tags": [], "time": "2012-05-11T17:05:01Z", "raw_text": "mounir: \n\nWe've got enough speedup from (now closed) bug#707569 that I'm happy for phase1 cleanup, hence fixing dependencies. Plus blocking a fixed bug didnt make sense.\n\nNote: I didnt close this bug#707579, because I *think* this is still useful to do, so happy to help make that happen if you think its worth it. I dont have full context, hence asking: what do you want to do here?", "attachment_id": null}, {"raw_text": "Given that Glandium was quite against that patch, I wouldn't mind marking it WONTFIX. Otherwise, we can keep it open if we want to reduce the |make package| time even more...", "time": "2012-05-15T07:41:48Z", "author": "mounir@lamouri.fr", "count": 13, "text": "Given that Glandium was quite against that patch, I wouldn't mind marking it WONTFIX. Otherwise, we can keep it open if we want to reduce the |make package| time even more...", "id": 6308077, "bug_id": 707579, "attachment_id": null, "tags": [], "creator": "mounir@lamouri.fr", "creation_time": "2012-05-15T07:41:48Z", "is_private": false}, {"creator": "mh+mozilla@glandium.org", "creation_time": "2012-05-15T07:49:40Z", "is_private": false, "attachment_id": null, "tags": [], "count": 14, "text": "Bug 707579 can still be fixed, but without altering xpt.py normal behaviour. (It might be possible to implement with \"simple\" Makefile dependencies)", "author": "mh+mozilla@glandium.org", "id": 6308083, "bug_id": 707579, "raw_text": "Bug 707579 can still be fixed, but without altering xpt.py normal behaviour. (It might be possible to implement with \"simple\" Makefile dependencies)", "time": "2012-05-15T07:49:40Z"}, {"count": 15, "text": "I'm not sure if this is an issue or not, but it is more of a build system issue than an XPCOM issue.", "author": "continuation@gmail.com", "creator": "continuation@gmail.com", "is_private": false, "creation_time": "2018-03-20T17:12:20Z", "bug_id": 707579, "id": 13143058, "raw_text": "I'm not sure if this is an issue or not, but it is more of a build system issue than an XPCOM issue.", "attachment_id": null, "time": "2018-03-20T17:12:20Z", "tags": []}]}}}