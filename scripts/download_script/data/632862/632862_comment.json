{"comments": {}, "bugs": {"632862": {"comments": [{"author": "pr38410@gmail.com", "is_private": false, "id": 5266593, "attachment_id": null, "creation_time": "2011-02-09T17:29:43Z", "tags": [], "bug_id": 632862, "count": 0, "time": "2011-02-09T17:29:43Z", "creator": "pr38410@gmail.com", "raw_text": "User-Agent:       Mozilla/5.0 (X11; U; SunOS sun4u; en-US; rv:1.7) Gecko/20070615\nBuild Identifier: nspr-4.8.7 and also in http://mxr.mozilla.org/nspr/source/nsprpub/pr/src/io/prprf.c#335\n\ncvt_f function use sprintf that may generates buffer overflow\n    ( trapped afterward by PR_ASSERT if nspr is compiled with debug flag.\n      plain stack overflow otherwise ... )\n\nMarked nspr issue as minor since the root problem was that our application was \n wrongly sending user data as format rather than as a %s format parameter \nbut the fact that PR_vsnprintf generated stack  overflow while the provided buffer and size are correct is a bit unexcpeted.\n \nmaybe cvt_f should use snprintf instead of sprintf ...  \n \n\nReproducible: Always\n\nSteps to Reproduce:\n1. create test program:\n#include \"nspr.h\"\n\nmain(int argc,char **argv)\n{\n        PR_fprintf(PR_STDOUT,\"%900g\",0.0);\n        return 0;\n}\n\n2. compile it and run it \n with non debug version I got a SIGSEGV at address 0x202020202020202020 \n  when returning from cvt_f \n with debug mode I get \nAssertion failure: strlen(fout) < sizeof(fout), at ../../../../pr/src/io/prprf.c:366\nAbort(coredump)\n\n3.\nActual Results:  \nwith non debug build of nspr I got a SIGSEGV at address 0x202020202020202020\n and a broken stack when returning from cvt_f \n with debug build I get \nAssertion failure: strlen(fout) < sizeof(fout), at ../../../../pr/src/io/prprf.c:366\n\nExpected Results:  \nideally the formatting function should fail and return some error \n but it should not crash. \nAnd if it crashs (like with the PR_ABORT case) make sure it crash before \n breaking the stack and making the debugging quite painfull ! -;)\n\nmaybe using snprintf instead of sprintf ?", "text": "User-Agent:       Mozilla/5.0 (X11; U; SunOS sun4u; en-US; rv:1.7) Gecko/20070615\nBuild Identifier: nspr-4.8.7 and also in http://mxr.mozilla.org/nspr/source/nsprpub/pr/src/io/prprf.c#335\n\ncvt_f function use sprintf that may generates buffer overflow\n    ( trapped afterward by PR_ASSERT if nspr is compiled with debug flag.\n      plain stack overflow otherwise ... )\n\nMarked nspr issue as minor since the root problem was that our application was \n wrongly sending user data as format rather than as a %s format parameter \nbut the fact that PR_vsnprintf generated stack  overflow while the provided buffer and size are correct is a bit unexcpeted.\n \nmaybe cvt_f should use snprintf instead of sprintf ...  \n \n\nReproducible: Always\n\nSteps to Reproduce:\n1. create test program:\n#include \"nspr.h\"\n\nmain(int argc,char **argv)\n{\n        PR_fprintf(PR_STDOUT,\"%900g\",0.0);\n        return 0;\n}\n\n2. compile it and run it \n with non debug version I got a SIGSEGV at address 0x202020202020202020 \n  when returning from cvt_f \n with debug mode I get \nAssertion failure: strlen(fout) < sizeof(fout), at ../../../../pr/src/io/prprf.c:366\nAbort(coredump)\n\n3.\nActual Results:  \nwith non debug build of nspr I got a SIGSEGV at address 0x202020202020202020\n and a broken stack when returning from cvt_f \n with debug build I get \nAssertion failure: strlen(fout) < sizeof(fout), at ../../../../pr/src/io/prprf.c:366\n\nExpected Results:  \nideally the formatting function should fail and return some error \n but it should not crash. \nAnd if it crashs (like with the PR_ABORT case) make sure it crash before \n breaking the stack and making the debugging quite painfull ! -;)\n\nmaybe using snprintf instead of sprintf ?"}]}}}