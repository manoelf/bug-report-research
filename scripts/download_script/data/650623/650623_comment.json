{"comments": {}, "bugs": {"650623": {"comments": [{"attachment_id": null, "creation_time": "2011-04-17T11:33:45Z", "tags": [], "creator": "public-mail@alekciy.ru", "raw_text": "User-Agent:       Opera/9.80 (Windows NT 5.1; U; ru) Presto/2.8.131 Version/11.10\nBuild Identifier: 3.1.9\n\nMozilla Thunderbird correct stored non latin IMAP folder, but breaks flags. Mozilla Thunderbird stored non system flag (http://tools.ietf.org/html/rfc2060#se...) in UTF-7, but conver character in lower case. Example: I set marker \"\u0422\u0435\u0441\u0442\" (like 'test' in russian language), in UTF-7 it's presented a string \"+BCIENQRBBEI\": \n\n echo '\u0422\u0435\u0441\u0442' | iconv -f UTF-8 -t UTF-7 \n +BCIENQRBBEI \n\n but Thunderbird convert it in &bcienqrbbei-. I see this in dovecot-keywords file, I see this in TCP traffic via Wireshark: \n\n DONE \n 10 OK Idle completed. \n 11 uid store 20 +FLAGS (&bcienqrbbei-) \n * 2 FETCH (UID 20 MODSEQ (96) FLAGS (\\Seen &bcienqrbbei-)) \n 11 OK Store completed. \n 12 IDLE \n + idling\n\nReproducible: Always\n\n\n\n\nBecause of this error I can not integrate with its own software. Via IMAP my software good read/write non system flags, but Mozilla Thunderbird don't see its and set broken flags.", "bug_id": 650623, "text": "User-Agent:       Opera/9.80 (Windows NT 5.1; U; ru) Presto/2.8.131 Version/11.10\nBuild Identifier: 3.1.9\n\nMozilla Thunderbird correct stored non latin IMAP folder, but breaks flags. Mozilla Thunderbird stored non system flag (http://tools.ietf.org/html/rfc2060#se...) in UTF-7, but conver character in lower case. Example: I set marker \"\u0422\u0435\u0441\u0442\" (like 'test' in russian language), in UTF-7 it's presented a string \"+BCIENQRBBEI\": \n\n echo '\u0422\u0435\u0441\u0442' | iconv -f UTF-8 -t UTF-7 \n +BCIENQRBBEI \n\n but Thunderbird convert it in &bcienqrbbei-. I see this in dovecot-keywords file, I see this in TCP traffic via Wireshark: \n\n DONE \n 10 OK Idle completed. \n 11 uid store 20 +FLAGS (&bcienqrbbei-) \n * 2 FETCH (UID 20 MODSEQ (96) FLAGS (\\Seen &bcienqrbbei-)) \n 11 OK Store completed. \n 12 IDLE \n + idling\n\nReproducible: Always\n\n\n\n\nBecause of this error I can not integrate with its own software. Via IMAP my software good read/write non system flags, but Mozilla Thunderbird don't see its and set broken flags.", "is_private": false, "count": 0, "time": "2011-04-17T11:33:45Z", "author": "public-mail@alekciy.ru", "id": 5414407}, {"creation_time": "2013-06-19T01:19:27Z", "tags": [], "attachment_id": null, "raw_text": "\u0421\u0443\u043d\u0434\u0443\u043a\u043e\u0432 will be running new tests", "creator": "vseerror@lehigh.edu", "bug_id": 650623, "text": "\u0421\u0443\u043d\u0434\u0443\u043a\u043e\u0432 will be running new tests", "is_private": false, "author": "vseerror@lehigh.edu", "time": "2013-06-19T01:19:27Z", "count": 1, "id": 7550240}, {"count": 2, "time": "2013-06-19T02:01:43Z", "author": "m-wada@usa.com", "is_private": false, "id": 7550345, "creator": "m-wada@usa.com", "raw_text": "&bcienqrbbei- is not utf-7. It's modified utf-7 of perhaps \"\u0422\u0435\u0441\u0442\" in Unicode or system charset or other charset.\n\nIn Tb, IMAP flag is \"Tag\", and is defined in prefs.js.\n  mailnews.tags.<used_tag=flag>.tag = <Typed_tag=flag>\n  <used_tag=flag name> : lower case of <Typed_tag=flag>,\n                         with removing prohibited special chars\n  In IMAP, <used_tag=flag> is used by \"store Flags\".\n  <Typed_tag=flag> is shown at Thread pane, Message Header pane.\nTb looks to use <used_tag=flag> = modified-utf-7 of lower case of <Typed_tag=flag_>, or lower case of modified-utf-7 of <Typed_tag=flag>.\n\nTo \u0421\u0443\u043d\u0434\u0443\u043a\u043e\u0432 \u0410\u043b\u0435\u043a\u0441\u0435\u0439(bug opener) :\nWhat is saved in Tb's prefs.js for \"\u0422\u0435\u0441\u0442\"?\n\nBy the way, \"Flag\" in IMAP is merely an \"8bits ascii string without some special characters\" and is case insensitive.\nWhat is reason to use non-ascii character for IMAP flag intentionally?\nDo you know RFC which refers to or defines \"non-ascii string use in IMAP Flag\"?\nNote:\n- For Mbox name, modified-utf-7 use is defined by IMAP.\n  Tb looks to apply same rule to typed tag name.\n- For authentication string in SASL, use of utf-8 is defined.", "attachment_id": null, "tags": [], "creation_time": "2013-06-19T02:01:43Z", "text": "&bcienqrbbei- is not utf-7. It's modified utf-7 of perhaps \"\u0422\u0435\u0441\u0442\" in Unicode or system charset or other charset.\n\nIn Tb, IMAP flag is \"Tag\", and is defined in prefs.js.\n  mailnews.tags.<used_tag=flag>.tag = <Typed_tag=flag>\n  <used_tag=flag name> : lower case of <Typed_tag=flag>,\n                         with removing prohibited special chars\n  In IMAP, <used_tag=flag> is used by \"store Flags\".\n  <Typed_tag=flag> is shown at Thread pane, Message Header pane.\nTb looks to use <used_tag=flag> = modified-utf-7 of lower case of <Typed_tag=flag_>, or lower case of modified-utf-7 of <Typed_tag=flag>.\n\nTo \u0421\u0443\u043d\u0434\u0443\u043a\u043e\u0432 \u0410\u043b\u0435\u043a\u0441\u0435\u0439(bug opener) :\nWhat is saved in Tb's prefs.js for \"\u0422\u0435\u0441\u0442\"?\n\nBy the way, \"Flag\" in IMAP is merely an \"8bits ascii string without some special characters\" and is case insensitive.\nWhat is reason to use non-ascii character for IMAP flag intentionally?\nDo you know RFC which refers to or defines \"non-ascii string use in IMAP Flag\"?\nNote:\n- For Mbox name, modified-utf-7 use is defined by IMAP.\n  Tb looks to apply same rule to typed tag name.\n- For authentication string in SASL, use of utf-8 is defined.", "bug_id": 650623}, {"text": "What is stored as Flag for the \"\u0422\u0435\u0441\u0442\" by other application or mail client?\nIs following a workaround?\n  mailnews.tags.<stored Flag string by other app>.tag = \u0422\u0435\u0441\u0442", "raw_text": "What is stored as Flag for the \"\u0422\u0435\u0441\u0442\" by other application or mail client?\nIs following a workaround?\n  mailnews.tags.<stored Flag string by other app>.tag = \u0422\u0435\u0441\u0442", "creator": "m-wada@usa.com", "time": "2013-06-19T02:07:40Z", "count": 3, "bug_id": 650623, "tags": [], "creation_time": "2013-06-19T02:07:40Z", "attachment_id": null, "id": 7550358, "is_private": false, "author": "m-wada@usa.com"}, {"tags": [], "creation_time": "2013-06-19T21:25:36Z", "attachment_id": null, "raw_text": "Please check http://sourceforge.net/p/davmail/feature-requests/72/ for additional details on IMAP flags support issue.\n\nDavMail needs to store IMAP flags as Outlook categories with non encoded values.\nHowever in Thunderbird keyword is RFC2060 encoded *before* toLowerCase\n=> the flag value is corrupted", "creator": "mguessan@free.fr", "bug_id": 650623, "text": "Please check http://sourceforge.net/p/davmail/feature-requests/72/ for additional details on IMAP flags support issue.\n\nDavMail needs to store IMAP flags as Outlook categories with non encoded values.\nHowever in Thunderbird keyword is RFC2060 encoded *before* toLowerCase\n=> the flag value is corrupted", "is_private": false, "time": "2013-06-19T21:25:36Z", "author": "mguessan@free.fr", "count": 4, "id": 7554393}, {"text": "(In reply to mguessan from comment #4)\n> Please check http://sourceforge.net/p/davmail/feature-requests/72/ for\n> additional details on IMAP flags support issue.\n>   user_pref(\"mailnews.tags.it.tag\", \"IT\");\n>   I tried modifying these setting to have an uppercase variable name,\n>   like mailnews.tags.IT.tag, but that doesn't seem to work.\n>     user_pref(\"mailnews.tags.IT.tag\", \"IT\");\n\nWhich is \"doesn't work as you expect\"?\n    user_pref(\"mailnews.tags.IT.tag\", \"IT\");\n(a) When Tag named \"IT\" is added by Tb,\n    Tb stores \"it\" instead of \"IT\". \"uid xx store +Flags (it)\" is used\n    because flag in IMAP is case insensitive.\n    Then other mail client fails to detect IMAP named \"it\".\n(b) Tb doesn't detect already stored flag of \"IT\" in IMAP mail.\n(c) Tb detects already stored flag of \"IT\" in IMAP mail, and shows it\n    as \"Tag labeled IT\" at Thread pane/Header pane,\n    but, when remove is requested in Tb, fails to remove flag of \"IT\".\n    - \"uid xxx store -Flags (it)\" is issued by Tb because flag in IMAP\n      is case insensitive,\n      then server doesn't remove flag named \"IT\".\n(d) other\n\nIIRC, problem is (a) and (b), and \"using same case when remove flag\" is already requested to avoid problem like (b), although I'm not sure.\n\nAnyway, rule on IMAP flag defined in IMAP4rev1 is;\n- Characters are 7-bit US-ASCII unless otherwise specified.\n- Usable character in IMAP flag = <any CHAR except atom-specials>\n- IMAP flag is also case insensitive.\nAnd, Tb's current implementation on Tag(flag when IMAP) is;\n- Definition in prefs.js\n  user_pref(\"mailnews.tags.<flag_name>.tag\", \"<Label_string_of_flag>\");\n- Detection of already stored flag is case insensitive.\n- When store flag, Tb uses lower case of <flag_name> as flag name.\n    \"uid xxx store +/-Flags ( lower case of <flag_name> )\n- Upon Tag definition, Tb generates <flag_name> string from string of\n  <Label_string_of_flag> which is typed by user at UI,\n  according to IMAP rule on IMAP flag, and rule on variable name in\n  JavaScript.\n\nPlease isolate issues:\n(i)  Unexpected <flag_name> string generation from string of\n     <Label_string_of_flag> which is typed by user at UI\n     when <Label_string_of_flag> contains non 7bits-ascii.\n     Note-1:\n     Tb looks to generate modified-utf-7 string.\n     Note-2:\n     This can be corrected by manual modification of <flag_name> part.\n(ii) Tb uses lower case of <flag_name> in \"uid store +/-Flags\" command.\n     It may be different from expectation of server and other client.", "bug_id": 650623, "raw_text": "(In reply to mguessan from comment #4)\n> Please check http://sourceforge.net/p/davmail/feature-requests/72/ for\n> additional details on IMAP flags support issue.\n>   user_pref(\"mailnews.tags.it.tag\", \"IT\");\n>   I tried modifying these setting to have an uppercase variable name,\n>   like mailnews.tags.IT.tag, but that doesn't seem to work.\n>     user_pref(\"mailnews.tags.IT.tag\", \"IT\");\n\nWhich is \"doesn't work as you expect\"?\n    user_pref(\"mailnews.tags.IT.tag\", \"IT\");\n(a) When Tag named \"IT\" is added by Tb,\n    Tb stores \"it\" instead of \"IT\". \"uid xx store +Flags (it)\" is used\n    because flag in IMAP is case insensitive.\n    Then other mail client fails to detect IMAP named \"it\".\n(b) Tb doesn't detect already stored flag of \"IT\" in IMAP mail.\n(c) Tb detects already stored flag of \"IT\" in IMAP mail, and shows it\n    as \"Tag labeled IT\" at Thread pane/Header pane,\n    but, when remove is requested in Tb, fails to remove flag of \"IT\".\n    - \"uid xxx store -Flags (it)\" is issued by Tb because flag in IMAP\n      is case insensitive,\n      then server doesn't remove flag named \"IT\".\n(d) other\n\nIIRC, problem is (a) and (b), and \"using same case when remove flag\" is already requested to avoid problem like (b), although I'm not sure.\n\nAnyway, rule on IMAP flag defined in IMAP4rev1 is;\n- Characters are 7-bit US-ASCII unless otherwise specified.\n- Usable character in IMAP flag = <any CHAR except atom-specials>\n- IMAP flag is also case insensitive.\nAnd, Tb's current implementation on Tag(flag when IMAP) is;\n- Definition in prefs.js\n  user_pref(\"mailnews.tags.<flag_name>.tag\", \"<Label_string_of_flag>\");\n- Detection of already stored flag is case insensitive.\n- When store flag, Tb uses lower case of <flag_name> as flag name.\n    \"uid xxx store +/-Flags ( lower case of <flag_name> )\n- Upon Tag definition, Tb generates <flag_name> string from string of\n  <Label_string_of_flag> which is typed by user at UI,\n  according to IMAP rule on IMAP flag, and rule on variable name in\n  JavaScript.\n\nPlease isolate issues:\n(i)  Unexpected <flag_name> string generation from string of\n     <Label_string_of_flag> which is typed by user at UI\n     when <Label_string_of_flag> contains non 7bits-ascii.\n     Note-1:\n     Tb looks to generate modified-utf-7 string.\n     Note-2:\n     This can be corrected by manual modification of <flag_name> part.\n(ii) Tb uses lower case of <flag_name> in \"uid store +/-Flags\" command.\n     It may be different from expectation of server and other client.", "creator": "m-wada@usa.com", "tags": [], "creation_time": "2013-06-20T00:06:41Z", "attachment_id": null, "id": 7555088, "time": "2013-06-20T00:06:41Z", "author": "m-wada@usa.com", "count": 5, "is_private": false}, {"raw_text": "I checked with Tag=\u65e5\u672c\u8a9e, IMAP Mbox name=\u65e5\u672c\u8a9e, with Tb 17 on Win-XP.\n(\u65e5\u672c\u8a9e==\"Japanese\" in Japanese)\n> prefs.js entry create by Tb for Tag=\u65e5\u672c\u8a9e\n>   user_pref(\"mailnews.tags.&zevnliqe-.tag\", \"\u65e5\u672c\u8a9e\");\n> File name for IMAP Mbox name=\u65e5\u672c\u8a9e\n>   &ZeVnLIqe-.msf\n> IMAP Server returns modified-utf-7 for non-ascii Mbox name.\n> Tb uses \"modified-utf-7\" + \".msf\" for .msf file.\n\nWhen non-ascii Tag name is requested,\n(1) Tb converts the non-ascii string to modified-utf-7 first,\n(2) Then changes to lower case for prefs.js entry name==IMAP flag name.\nBecause no rule is defined for \"IMAP flag of non 7bits-ascii\" which is RFC violation, IMAP server and IMAP clients can do anything on \"IMAP flag of non 7bits-ascii\" requested by user.\nSo, this is never RFC violation by Tb(Tb uses 7bits-ascii only always).\nHowever, converting to modified-utf-7, which is rule on Mbox name only in IMAP, is not good practice, at least when it's used as IMAP flag.\n\nConfirming.\n\nAnd, Tb converts \"Tag name part\" in prefs.js entry to lower case, when Tb issues \"uid xxx store +/-Flags (tagname)\".\nSo, even if user manually changed \"&zevnliqe-\" part in prefs.js to string of \"utf-8 binary consists of 7bits-ascii binary only\", Tb converts it to lower case if the utf-8 binary contains upper case 7bits-ascii binary.\nSo, IMAP server and/or IMAP client, who expects utf-8 or who expects upper case 7bits-ascii for IMAP flag, can't understand IMAP flag stored by Tb.\n\nIs change like \"use Tag name part of pres.js entry as-is, if the string consists of 7bits-ascii only\" needed?\nNote:\nThis kind of change in \"delete existent Flag of IMAP\" is needed at least for next case.\n- Old Tb/Sm used $LabelN(where N is digit) for standard Tag=Flag in\n  IMAP.\n- After a while, spec of Tb/Sm was changed, and $labelN is used always.\n- Thus, Tb/Sm can't remove old $LabelN stored in existent mail,\n  which was stored by Tb/Sm himself,\n  if IMAP server doesn't treat IMAP flag case-insensitive correctly.\n  Or, Tb/Sm doesn't issue \"uid xxx -Flags\". (I don't remember well.)", "creator": "m-wada@usa.com", "text": "I checked with Tag=\u65e5\u672c\u8a9e, IMAP Mbox name=\u65e5\u672c\u8a9e, with Tb 17 on Win-XP.\n(\u65e5\u672c\u8a9e==\"Japanese\" in Japanese)\n> prefs.js entry create by Tb for Tag=\u65e5\u672c\u8a9e\n>   user_pref(\"mailnews.tags.&zevnliqe-.tag\", \"\u65e5\u672c\u8a9e\");\n> File name for IMAP Mbox name=\u65e5\u672c\u8a9e\n>   &ZeVnLIqe-.msf\n> IMAP Server returns modified-utf-7 for non-ascii Mbox name.\n> Tb uses \"modified-utf-7\" + \".msf\" for .msf file.\n\nWhen non-ascii Tag name is requested,\n(1) Tb converts the non-ascii string to modified-utf-7 first,\n(2) Then changes to lower case for prefs.js entry name==IMAP flag name.\nBecause no rule is defined for \"IMAP flag of non 7bits-ascii\" which is RFC violation, IMAP server and IMAP clients can do anything on \"IMAP flag of non 7bits-ascii\" requested by user.\nSo, this is never RFC violation by Tb(Tb uses 7bits-ascii only always).\nHowever, converting to modified-utf-7, which is rule on Mbox name only in IMAP, is not good practice, at least when it's used as IMAP flag.\n\nConfirming.\n\nAnd, Tb converts \"Tag name part\" in prefs.js entry to lower case, when Tb issues \"uid xxx store +/-Flags (tagname)\".\nSo, even if user manually changed \"&zevnliqe-\" part in prefs.js to string of \"utf-8 binary consists of 7bits-ascii binary only\", Tb converts it to lower case if the utf-8 binary contains upper case 7bits-ascii binary.\nSo, IMAP server and/or IMAP client, who expects utf-8 or who expects upper case 7bits-ascii for IMAP flag, can't understand IMAP flag stored by Tb.\n\nIs change like \"use Tag name part of pres.js entry as-is, if the string consists of 7bits-ascii only\" needed?\nNote:\nThis kind of change in \"delete existent Flag of IMAP\" is needed at least for next case.\n- Old Tb/Sm used $LabelN(where N is digit) for standard Tag=Flag in\n  IMAP.\n- After a while, spec of Tb/Sm was changed, and $labelN is used always.\n- Thus, Tb/Sm can't remove old $LabelN stored in existent mail,\n  which was stored by Tb/Sm himself,\n  if IMAP server doesn't treat IMAP flag case-insensitive correctly.\n  Or, Tb/Sm doesn't issue \"uid xxx -Flags\". (I don't remember well.)", "time": "2013-06-20T07:42:37Z", "count": 6, "tags": [], "creation_time": "2013-06-20T07:42:37Z", "attachment_id": null, "bug_id": 650623, "is_private": false, "author": "m-wada@usa.com", "id": 7555960}, {"time": "2013-07-17T20:51:58Z", "count": 7, "text": "I can't test Tb. Dovecot log: \"TLS: SSL_read() failed: error:14094418:SSL routines:SSL3_READ_BYTES:tlsv1 alert unknown ca: SSL alert number 48\". But telnet work fine: \n\n$ telnet localhost 143\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE STARTTLS AUTH=LOGIN AUTH=PLAIN] Dovecot ready.\na login 13@ru-region.ru *******\na OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS MULTIAPPEND UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS] Logged in\nb select inbox\n* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema- $label1 $label2 $label3 $label4 $label5 test &beienqq6beeeqg- &0YLQtdGB0YI- &bcienqrbbei- &bbwenqrcbdoema- &0KHQu9C+0LLQvg-)\n* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema- $label1 $label2 $label3 $label4 $label5 test &beienqq6beeeqg- &0YLQtdGB0YI- &bcienqrbbei- &bbwenqrcbdoema- &0KHQu9C+0LLQvg- \\*)] Flags permitted.\n* 3 EXISTS\n* 0 RECENT\n* OK [UIDVALIDITY 1298927723] UIDs valid\n* OK [UIDNEXT 23] Predicted next UID\n* OK [HIGHESTMODSEQ 99] Highest\nb OK [READ-WRITE] Select completed.\ne logout\n* BYE Logging out\ne OK Logout completed.\nConnection closed by foreign host.\n\nPHP example set IMAG flag:\n<?php\n$mbox = imap_open('{ru-region.ru:993/imap/ssl/notls/novalidate-cert}INBOX', '13@ru-region.ru', '*******');\nimap_setflag_full( $mbox, '1,2', imap_utf7_encode('\u0421\u043b\u043e\u0432\u043e') );\nimap_close($mbox);\n?>\n\nUse this script http://stackoverflow.com/questions/3285690/how-to-get-imap-flags I can read flag:\n<?php\n\ninclude('ImapSocket.php');\n\n$imap = new ImapSocket(array(\n\t'server'   => 'ru-region.ru',\n\t'port'     => 993,\n\t'login'    => '13@ru-region.ru',\n\t'password' => '*******'\n), 'INBOX');\n\n$imap_flag_list = $imap->get_flags(1);\nforeach ($imap_flag_list as $flag) {\n\techo imap_utf7_decode($flag) . \"\\n\";\n}\n?>\n\nResult:\n$ php -f get_flag.php\n\\Answered\n\\Seen\n\u0442\u0435\u0441\u0442\n\u0421\u043b\u043e\u0432\u043e\n\nDovecot save my flag correct:\n$ cat /var/vmail/ru-region.ru/13/dovecot-keywords\n0 &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema-\n1 test\n2 $label1\n3 $label2\n4 $label3\n5 &beienqq6beeeqg-\n6 &0YLQtdGB0YI-\n7 $label4\n8 $label5\n9 &bcienqrbbei-\n10 &bbwenqrcbdoema-\n11 &0KHQu9C+0LLQvg-\n\nI want use IMAP flags in my php application and Tb.", "raw_text": "I can't test Tb. Dovecot log: \"TLS: SSL_read() failed: error:14094418:SSL routines:SSL3_READ_BYTES:tlsv1 alert unknown ca: SSL alert number 48\". But telnet work fine: \n\n$ telnet localhost 143\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE STARTTLS AUTH=LOGIN AUTH=PLAIN] Dovecot ready.\na login 13@ru-region.ru *******\na OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS MULTIAPPEND UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS] Logged in\nb select inbox\n* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema- $label1 $label2 $label3 $label4 $label5 test &beienqq6beeeqg- &0YLQtdGB0YI- &bcienqrbbei- &bbwenqrcbdoema- &0KHQu9C+0LLQvg-)\n* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema- $label1 $label2 $label3 $label4 $label5 test &beienqq6beeeqg- &0YLQtdGB0YI- &bcienqrbbei- &bbwenqrcbdoema- &0KHQu9C+0LLQvg- \\*)] Flags permitted.\n* 3 EXISTS\n* 0 RECENT\n* OK [UIDVALIDITY 1298927723] UIDs valid\n* OK [UIDNEXT 23] Predicted next UID\n* OK [HIGHESTMODSEQ 99] Highest\nb OK [READ-WRITE] Select completed.\ne logout\n* BYE Logging out\ne OK Logout completed.\nConnection closed by foreign host.\n\nPHP example set IMAG flag:\n<?php\n$mbox = imap_open('{ru-region.ru:993/imap/ssl/notls/novalidate-cert}INBOX', '13@ru-region.ru', '*******');\nimap_setflag_full( $mbox, '1,2', imap_utf7_encode('\u0421\u043b\u043e\u0432\u043e') );\nimap_close($mbox);\n?>\n\nUse this script http://stackoverflow.com/questions/3285690/how-to-get-imap-flags I can read flag:\n<?php\n\ninclude('ImapSocket.php');\n\n$imap = new ImapSocket(array(\n\t'server'   => 'ru-region.ru',\n\t'port'     => 993,\n\t'login'    => '13@ru-region.ru',\n\t'password' => '*******'\n), 'INBOX');\n\n$imap_flag_list = $imap->get_flags(1);\nforeach ($imap_flag_list as $flag) {\n\techo imap_utf7_decode($flag) . \"\\n\";\n}\n?>\n\nResult:\n$ php -f get_flag.php\n\\Answered\n\\Seen\n\u0442\u0435\u0441\u0442\n\u0421\u043b\u043e\u0432\u043e\n\nDovecot save my flag correct:\n$ cat /var/vmail/ru-region.ru/13/dovecot-keywords\n0 &bcienqrbbeiepgqybdaetw-_&bdwenqrcbdoema-\n1 test\n2 $label1\n3 $label2\n4 $label3\n5 &beienqq6beeeqg-\n6 &0YLQtdGB0YI-\n7 $label4\n8 $label5\n9 &bcienqrbbei-\n10 &bbwenqrcbdoema-\n11 &0KHQu9C+0LLQvg-\n\nI want use IMAP flags in my php application and Tb.", "creator": "public-mail@alekciy.ru", "id": 7647366, "author": "public-mail@alekciy.ru", "is_private": false, "bug_id": 650623, "creation_time": "2013-07-17T20:51:58Z", "tags": [], "attachment_id": null}, {"raw_text": "Same problem. Claws mail dispaly garbage instead of original flag (with national Latin accented characters). IMO TB/SM behavior is bad - it should either restrict users to using only lowercase ASCII letters, or allow full utf-8 and pass them correctly to IMAP server (not cripled to lowercase). Personaly I vote for second, as it will work with non-latin languages.", "creator": "franta@hanzlici.cz", "tags": [], "creation_time": "2015-05-17T16:22:56Z", "attachment_id": null, "text": "Same problem. Claws mail dispaly garbage instead of original flag (with national Latin accented characters). IMO TB/SM behavior is bad - it should either restrict users to using only lowercase ASCII letters, or allow full utf-8 and pass them correctly to IMAP server (not cripled to lowercase). Personaly I vote for second, as it will work with non-latin languages.", "bug_id": 650623, "author": "franta@hanzlici.cz", "time": "2015-05-17T16:22:56Z", "count": 8, "is_private": false, "id": 10277209}, {"creator": "gds@chartertn.net", "raw_text": "Note: I worked with another Russian to solve issues with his tags (in Russian) and there was no complaints that they appear as lower-case ASCII. But maybe this is a different issue, not sure.", "text": "Note: I worked with another Russian to solve issues with his tags (in Russian) and there was no complaints that they appear as lower-case ASCII. But maybe this is a different issue, not sure.", "count": 9, "time": "2019-07-21T18:34:47Z", "attachment_id": null, "tags": [], "creation_time": "2019-07-21T18:34:47Z", "bug_id": 650623, "is_private": false, "author": "gds@chartertn.net", "id": 14248887}]}}}