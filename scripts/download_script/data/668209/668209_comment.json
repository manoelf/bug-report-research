{"bugs": {"668209": {"comments": [{"creator": "hsivonen@mozilla.com", "creation_time": "2011-06-29T14:27:36Z", "is_private": false, "attachment_id": null, "tags": [], "count": 0, "text": "browser_459906_sample.html has this bit:\n      // inject a cross domain file ...\n      var documentInjected = false;\n      document.getElementsByTagName(\"iframe\")[0].onload =\n        function() { documentInjected = true; };\n      frames[0].location = \"browser_459906_empty.html\";\n      \n      // ... and ensure that it has time to load\n      for (var c = 0; !documentInjected && c < 20; c++) {\n        var r = new XMLHttpRequest();\n        r.open(\"GET\", location.href, false);\n        r.overrideMimeType(\"text/plain\");\n        r.send(null);\n      }\n\nThat spinning up a nested event loop up to 20 times to make the load event fire from a nested event loop is not cool.\n\nI'd expect a test like this to be structured to wait for the load event without any event loop tricks and to continue from there.", "author": "hsivonen@mozilla.com", "id": 5564454, "bug_id": 668209, "time": "2011-06-29T14:27:36Z", "raw_text": "browser_459906_sample.html has this bit:\n      // inject a cross domain file ...\n      var documentInjected = false;\n      document.getElementsByTagName(\"iframe\")[0].onload =\n        function() { documentInjected = true; };\n      frames[0].location = \"browser_459906_empty.html\";\n      \n      // ... and ensure that it has time to load\n      for (var c = 0; !documentInjected && c < 20; c++) {\n        var r = new XMLHttpRequest();\n        r.open(\"GET\", location.href, false);\n        r.overrideMimeType(\"text/plain\");\n        r.send(null);\n      }\n\nThat spinning up a nested event loop up to 20 times to make the load event fire from a nested event loop is not cool.\n\nI'd expect a test like this to be structured to wait for the load event without any event loop tricks and to continue from there."}]}}, "comments": {}}