{"bugs": {"655985": {"comments": [{"id": 5459317, "author": "ekerazha@gmail.com", "is_private": false, "bug_id": 655985, "attachment_id": null, "tags": [], "creation_time": "2011-05-10T11:42:45Z", "count": 0, "time": "2011-05-10T11:42:45Z", "text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\n\nIf you download a file and an antivirus real-time module detects something in the downloaded file, Firefox freezes with a 100% cpu usage. This only occurs when the \"browser.download.manager.scanWhenDone\" flag is enabled (and it is enabled by default). This *doesn't* happen with every file, i.e. it doesn't happen downloading the small EICAR file, however it always happens with other malware files. I suspect that the issue could be a combination of an antivirus fault and a Firefox fault. *Maybe* the antivirus doesn't correctly handle the situation where you call a scan on a file detected by the real-time module, but Firefox definitely shouldn't freeze with a 100% cpu usage (better use case handle?).\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Install COMODO Internet Security (http://personalfirewall.comodo.com), I didn't try other antivirus suites, I don't know if this is COMODO-specific. Default settings (so real-time antivirus module enabled).\n2. Install Firefox 4.0.1 (default settings, so \"scanWhenDone\" enabled).\n3. Download a malware, EICAR file doesn't trigger the issue (I don't know why). This file definitely triggers the issue:\n\n***** WARNING!!! MALWARE FILE SAMPLE *****\n***** WARNING!!! MALWARE FILE SAMPLE *****\nwww.5xse.com/av/ecececy.exe\n***** WARNING!!! MALWARE FILE SAMPLE *****\n***** WARNING!!! MALWARE FILE SAMPLE *****\n\nActual Results:  \nCOMODO antivirus real-time module detects the malware, Firefox freezes with 100% cpu usage when calling \"scanWhenDone\", I try to delete the file using the antivirus, resulting downloaded file is a 0-byte length file (instead of being deleted). It seems like there's some file handling conflict between Firefox and the antivirus.\n\nExpected Results:  \nFirefox shouldn't freeze.\n\nIf I set \"browser.download.manager.scanWhenDone\" to false, there isn't any issue.", "creator": "ekerazha@gmail.com", "raw_text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\n\nIf you download a file and an antivirus real-time module detects something in the downloaded file, Firefox freezes with a 100% cpu usage. This only occurs when the \"browser.download.manager.scanWhenDone\" flag is enabled (and it is enabled by default). This *doesn't* happen with every file, i.e. it doesn't happen downloading the small EICAR file, however it always happens with other malware files. I suspect that the issue could be a combination of an antivirus fault and a Firefox fault. *Maybe* the antivirus doesn't correctly handle the situation where you call a scan on a file detected by the real-time module, but Firefox definitely shouldn't freeze with a 100% cpu usage (better use case handle?).\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Install COMODO Internet Security (http://personalfirewall.comodo.com), I didn't try other antivirus suites, I don't know if this is COMODO-specific. Default settings (so real-time antivirus module enabled).\n2. Install Firefox 4.0.1 (default settings, so \"scanWhenDone\" enabled).\n3. Download a malware, EICAR file doesn't trigger the issue (I don't know why). This file definitely triggers the issue:\n\n***** WARNING!!! MALWARE FILE SAMPLE *****\n***** WARNING!!! MALWARE FILE SAMPLE *****\nwww.5xse.com/av/ecececy.exe\n***** WARNING!!! MALWARE FILE SAMPLE *****\n***** WARNING!!! MALWARE FILE SAMPLE *****\n\nActual Results:  \nCOMODO antivirus real-time module detects the malware, Firefox freezes with 100% cpu usage when calling \"scanWhenDone\", I try to delete the file using the antivirus, resulting downloaded file is a 0-byte length file (instead of being deleted). It seems like there's some file handling conflict between Firefox and the antivirus.\n\nExpected Results:  \nFirefox shouldn't freeze.\n\nIf I set \"browser.download.manager.scanWhenDone\" to false, there isn't any issue."}, {"id": 5461092, "is_private": false, "author": "xtc4uall@gmail.com", "bug_id": 655985, "attachment_id": null, "creation_time": "2011-05-10T22:55:33Z", "tags": [], "count": 1, "time": "2011-05-10T22:55:33Z", "text": "Does the Issue fit to some of those already filed?\nhttps://bugzilla.mozilla.org/buglist.cgi?quicksearch=browser.download.manager.scanWhenDone", "creator": "xtc4uall@gmail.com", "raw_text": "Does the Issue fit to some of those already filed?\nhttps://bugzilla.mozilla.org/buglist.cgi?quicksearch=browser.download.manager.scanWhenDone"}, {"bug_id": 655985, "text": "I don't think so. It looks vaguely similar to Bug 444467 but I'm not sure it's the same thing. Also, here we have a specific use case, while in Bug 444467 he says that it always hangs.", "tags": [], "creation_time": "2011-05-11T05:31:08Z", "attachment_id": null, "raw_text": "I don't think so. It looks vaguely similar to Bug 444467 but I'm not sure it's the same thing. Also, here we have a specific use case, while in Bug 444467 he says that it always hangs.", "creator": "ekerazha@gmail.com", "id": 5461869, "is_private": false, "author": "ekerazha@gmail.com", "time": "2011-05-11T05:31:08Z", "count": 2}]}}, "comments": {}}