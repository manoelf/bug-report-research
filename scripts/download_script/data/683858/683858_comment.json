{"bugs": {"683858": {"comments": [{"id": 5693191, "attachment_id": null, "raw_text": "Currently we only inline in methodjit the bump path of the object allocation in BaseAssembler::getNewObject. We should also consider inlining the free list case of FreeSpan::allocate.", "creation_time": "2011-09-01T10:11:37Z", "author": "igor@mir2.org", "text": "Currently we only inline in methodjit the bump path of the object allocation in BaseAssembler::getNewObject. We should also consider inlining the free list case of FreeSpan::allocate.", "time": "2011-09-01T10:11:37Z", "tags": [], "is_private": false, "creator": "igor@mir2.org", "bug_id": 683858, "count": 0}, {"id": 5693434, "attachment_id": null, "raw_text": "Yeah, I just did the bump case because a) I'm lazy, b) I didn't know how often the bump vs. free list case show up in practice, and c) the free list case needs a scratch register (I think).  It would be good to measure b).", "author": "bhackett1024@gmail.com", "creation_time": "2011-09-01T13:35:32Z", "time": "2011-09-01T13:35:32Z", "tags": [], "text": "Yeah, I just did the bump case because a) I'm lazy, b) I didn't know how often the bump vs. free list case show up in practice, and c) the free list case needs a scratch register (I think).  It would be good to measure b).", "creator": "bhackett1024@gmail.com", "is_private": false, "bug_id": 683858, "count": 1}, {"is_private": false, "creator": "igor@mir2.org", "text": "(In reply to Brian Hackett from comment #1)\n>  I didn't know how often the bump vs. free list case show up in practice\n\nI guess it would be nice to extend about:memory with that stat that shows the average length of free spans. \n\n> the free list case needs a scratch register (I think).\n\nHm, don't we have a support for 3-way jump, like <, != or > ?", "tags": [], "time": "2011-09-01T13:52:46Z", "creation_time": "2011-09-01T13:52:46Z", "author": "igor@mir2.org", "raw_text": "(In reply to Brian Hackett from comment #1)\n>  I didn't know how often the bump vs. free list case show up in practice\n\nI guess it would be nice to extend about:memory with that stat that shows the average length of free spans. \n\n> the free list case needs a scratch register (I think).\n\nHm, don't we have a support for 3-way jump, like <, != or > ?", "attachment_id": null, "id": 5693460, "count": 2, "bug_id": 683858}, {"creator": "bhackett1024@gmail.com", "is_private": false, "count": 3, "author": "bhackett1024@gmail.com", "creation_time": "2011-09-01T14:17:05Z", "time": "2011-09-01T14:17:05Z", "tags": [], "bug_id": 683858, "text": "(In reply to Igor Bukanov from comment #2)\n> (In reply to Brian Hackett from comment #1)\n> >  I didn't know how often the bump vs. free list case show up in practice\n> \n> I guess it would be nice to extend about:memory with that stat that shows\n> the average length of free spans. \n> \n> > the free list case needs a scratch register (I think).\n> \n> Hm, don't we have a support for 3-way jump, like <, != or > ?\n\nI think the extra register is needed to update the active span in the free list.  It should be fine to pass an extra register and emit a little more code in the assembler --- object allocation paths don't get crazy hot like arithmetic loops and an extra stack memory op needed in (unlikely) heavy register pressure won't matter.", "attachment_id": null, "raw_text": "(In reply to Igor Bukanov from comment #2)\n> (In reply to Brian Hackett from comment #1)\n> >  I didn't know how often the bump vs. free list case show up in practice\n> \n> I guess it would be nice to extend about:memory with that stat that shows\n> the average length of free spans. \n> \n> > the free list case needs a scratch register (I think).\n> \n> Hm, don't we have a support for 3-way jump, like <, != or > ?\n\nI think the extra register is needed to update the active span in the free list.  It should be fine to pass an extra register and emit a little more code in the assembler --- object allocation paths don't get crazy hot like arithmetic loops and an extra stack memory op needed in (unlikely) heavy register pressure won't matter.", "id": 5693496}, {"creator": "dmandelin@mozilla.com", "is_private": false, "count": 4, "author": "dmandelin@mozilla.com", "creation_time": "2011-09-01T17:42:59Z", "time": "2011-09-01T17:42:59Z", "bug_id": 683858, "tags": [], "text": "(In reply to Brian Hackett from comment #1)\n> Yeah, I just did the bump case because a) I'm lazy, b) I didn't know how\n> often the bump vs. free list case show up in practice, and c) the free list\n> case needs a scratch register (I think).  It would be good to measure b).\n\nYeah, I'd like an estimate of how much it buys us before going forward on that.", "attachment_id": null, "raw_text": "(In reply to Brian Hackett from comment #1)\n> Yeah, I just did the bump case because a) I'm lazy, b) I didn't know how\n> often the bump vs. free list case show up in practice, and c) the free list\n> case needs a scratch register (I think).  It would be good to measure b).\n\nYeah, I'd like an estimate of how much it buys us before going forward on that.", "id": 5694107}]}}, "comments": {}}