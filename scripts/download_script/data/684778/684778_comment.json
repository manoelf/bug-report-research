{"bugs": {"684778": {"comments": [{"tags": [], "raw_text": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.220 Safari/535.1\n\nSteps to reproduce:\n\nTry to enumerate zip entry names using the following code:\n\nvar zipReader = _CC[\"@mozilla.org/libjar/zip-reader;1\"].createInstance(_CI.nsIZipReader);\nzipReader.open(file);\nvar entries = zipReader.findEntries(null);\nwhile (entries.hasMore())\n\tdump(entries.getNext());\n\nnsIZipReader.findEntries(\"*\")\n\n\nActual results:\n\nThe order of the entries differs from the order the entries were added with.\n\n\nExpected results:\n\nThe entry names must be in the same order as the entries were added.", "attachment_id": 558366, "time": "2011-09-06T02:02:58Z", "creation_time": "2011-09-06T02:02:58Z", "is_private": false, "id": 5701240, "bug_id": 684778, "text": "Created attachment 558366\nArchive_20110906_1.zip - Test archive. __TOC.txt contains entries in the order they were added.\n\nUser Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.220 Safari/535.1\n\nSteps to reproduce:\n\nTry to enumerate zip entry names using the following code:\n\nvar zipReader = _CC[\"@mozilla.org/libjar/zip-reader;1\"].createInstance(_CI.nsIZipReader);\nzipReader.open(file);\nvar entries = zipReader.findEntries(null);\nwhile (entries.hasMore())\n\tdump(entries.getNext());\n\nnsIZipReader.findEntries(\"*\")\n\n\nActual results:\n\nThe order of the entries differs from the order the entries were added with.\n\n\nExpected results:\n\nThe entry names must be in the same order as the entries were added.", "count": 0, "author": "vadim.milichev@gmail.com", "creator": "vadim.milichev@gmail.com"}, {"attachment_id": null, "tags": [], "creator": "vadim.milichev@gmail.com", "creation_time": "2011-09-06T02:15:40Z", "is_private": false, "raw_text": "I need to enumerate zip entries to overcome zip file name charset restriction (https://bugzilla.mozilla.org/show_bug.cgi?id=445065, https://bugzilla.mozilla.org/show_bug.cgi?id=296795).", "time": "2011-09-06T02:15:40Z", "author": "vadim.milichev@gmail.com", "count": 1, "text": "I need to enumerate zip entries to overcome zip file name charset restriction (https://bugzilla.mozilla.org/show_bug.cgi?id=445065, https://bugzilla.mozilla.org/show_bug.cgi?id=296795).", "id": 5701249, "bug_id": 684778}, {"author": "daniel@glazman.org", "text": "Confirming. Badly needed for EPUB conformance checking.", "count": 2, "bug_id": 684778, "id": 6543165, "time": "2012-08-09T11:04:17Z", "raw_text": "Confirming. Badly needed for EPUB conformance checking.", "creator": "daniel@glazman.org", "is_private": false, "creation_time": "2012-08-09T11:04:17Z", "attachment_id": null, "tags": []}, {"creator": "daniel@glazman.org", "is_private": false, "creation_time": "2012-08-09T12:46:06Z", "attachment_id": 650517, "tags": [], "text": "Created attachment 650517\nWIP\n\nThe proposed fix adds a new openPreservingOrder()\nmethod to nsIZipReader to avoid disturbing the current clients of the\nunordered enumerations of entries in a zip file (in particular OmniJar.cpp).\nI have tested it successfully in BlueGriffon.\nNot sure if the way I did it is the cleanest but it's probably the\nleast intrusive into that code. Comments highly welcome.", "count": 3, "author": "daniel@glazman.org", "id": 6543329, "bug_id": 684778, "raw_text": "The proposed fix adds a new openPreservingOrder()\nmethod to nsIZipReader to avoid disturbing the current clients of the\nunordered enumerations of entries in a zip file (in particular OmniJar.cpp).\nI have tested it successfully in BlueGriffon.\nNot sure if the way I did it is the cleanest but it's probably the\nleast intrusive into that code. Comments highly welcome.", "time": "2012-08-09T12:46:06Z"}, {"text": "Created attachment 650518\nWIP #2\n\ncleaner patch", "count": 4, "author": "daniel@glazman.org", "bug_id": 684778, "id": 6543340, "time": "2012-08-09T12:50:01Z", "raw_text": "cleaner patch", "creator": "daniel@glazman.org", "is_private": false, "creation_time": "2012-08-09T12:50:01Z", "attachment_id": 650518, "tags": []}, {"tags": [], "time": "2012-08-09T13:28:18Z", "attachment_id": 650527, "raw_text": "cleaner again.", "bug_id": 684778, "id": 6543409, "creation_time": "2012-08-09T13:28:18Z", "is_private": false, "creator": "daniel@glazman.org", "author": "daniel@glazman.org", "count": 5, "text": "Created attachment 650527\nWIP #3\n\ncleaner again."}, {"author": "taras.mozilla@glek.net", "count": 6, "text": "Daniel, that's the wrong way to do this. \nWhy change the way you open files if all you need is a natural ordering for files?\nAdd a findEntriesSorted or an optional sort parameter.\n\nEvery zipentry has a central pointer in it. This pointer points directly into the archive. So you can do any number of things in findNaturallyOrderedEntries method\na) Walk the central dir again starting from first pointer(ie factor out code from BuildFileList)\nb) sort existing nsZipItems by their .central member.", "id": 6544099, "bug_id": 684778, "time": "2012-08-09T17:22:54Z", "raw_text": "Daniel, that's the wrong way to do this. \nWhy change the way you open files if all you need is a natural ordering for files?\nAdd a findEntriesSorted or an optional sort parameter.\n\nEvery zipentry has a central pointer in it. This pointer points directly into the archive. So you can do any number of things in findNaturallyOrderedEntries method\na) Walk the central dir again starting from first pointer(ie factor out code from BuildFileList)\nb) sort existing nsZipItems by their .central member.", "creator": "taras.mozilla@glek.net", "is_private": false, "creation_time": "2012-08-09T17:22:54Z", "attachment_id": null, "tags": []}]}}, "comments": {}}