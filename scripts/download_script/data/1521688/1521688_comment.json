{"comments": {}, "bugs": {"1521688": {"comments": [{"creator": "yuki@clear-code.com", "id": 13876371, "creation_time": "2019-01-22T06:46:49Z", "raw_text": "Steps to reproduce:\n\n1. Start Firefox on a Windows PC.\n2. Right-click on the toolbar and check \"Menu Bar\" to show it always.\n3. Hit Ctrl-Shift-K to open the Web Console.\n4. Input window.open('about:blank','_blank','toolbar') and hit Enter key.\n5. The popup is blocked by Firefox's popup blocker, thus click the \"allow to open\n   the requested window.\n\n\nActual result:\n\nA browser window is opened without window controls.\n(See the attached screenshot: missing-window-controls.png)\n\n\nExpected result:\n\nA browser window is opened with window controls.\n\n\nEnvrionment:\n\n* Confirmed versions of Firefox\n  * Firefox 65.0b12 (build ID: 20190117232427)\n  * Nightly 66.0a1 (build ID: 20190121175139)\n* Confirmed platform\n  * Windows 7\n  * Windows 10\n\n\nAdditional information:\n\n* If you uncheck the \"Menu Bar\" to show it on demand, the opened window has window controls. This problem appears only with always-shown menu bar.\n* On Firefox 64 or older versions, window controls become unclickable if you use the Classic theme of Windows 7, because the #tabbrowser-tab with z-index:2 [1] covers #titlebar-buttonbox with z-index:1 [2].\n\n[1]https://dxr.mozilla.org/mozilla-esr60/source/browser/themes/windows/browser.css#206\n[2]https://dxr.mozilla.org/mozilla-esr60/source/browser/themes/windows/browser.css#305", "attachment_id": 9038151, "text": "Created attachment 9038151\nmissing-window-controls.png\n\nSteps to reproduce:\n\n1. Start Firefox on a Windows PC.\n2. Right-click on the toolbar and check \"Menu Bar\" to show it always.\n3. Hit Ctrl-Shift-K to open the Web Console.\n4. Input window.open('about:blank','_blank','toolbar') and hit Enter key.\n5. The popup is blocked by Firefox's popup blocker, thus click the \"allow to open\n   the requested window.\n\n\nActual result:\n\nA browser window is opened without window controls.\n(See the attached screenshot: missing-window-controls.png)\n\n\nExpected result:\n\nA browser window is opened with window controls.\n\n\nEnvrionment:\n\n* Confirmed versions of Firefox\n  * Firefox 65.0b12 (build ID: 20190117232427)\n  * Nightly 66.0a1 (build ID: 20190121175139)\n* Confirmed platform\n  * Windows 7\n  * Windows 10\n\n\nAdditional information:\n\n* If you uncheck the \"Menu Bar\" to show it on demand, the opened window has window controls. This problem appears only with always-shown menu bar.\n* On Firefox 64 or older versions, window controls become unclickable if you use the Classic theme of Windows 7, because the #tabbrowser-tab with z-index:2 [1] covers #titlebar-buttonbox with z-index:1 [2].\n\n[1]https://dxr.mozilla.org/mozilla-esr60/source/browser/themes/windows/browser.css#206\n[2]https://dxr.mozilla.org/mozilla-esr60/source/browser/themes/windows/browser.css#305", "is_private": false, "author": "yuki@clear-code.com", "count": 0, "time": "2019-01-22T06:46:49Z", "bug_id": 1521688, "tags": []}, {"attachment_id": null, "raw_text": "I've filed the bug 1521692 for a similar probelm on currently released Firefox.", "creator": "yuki@clear-code.com", "id": 13876391, "creation_time": "2019-01-22T07:02:42Z", "tags": [], "count": 1, "time": "2019-01-22T07:02:42Z", "bug_id": 1521688, "text": "I've filed the bug 1521692 for a similar probelm on currently released Firefox.", "is_private": false, "author": "yuki@clear-code.com"}, {"is_private": false, "author": "yuki@clear-code.com", "text": "Created attachment 9038164\nPatch (WIP)\n\nInitial version patch, without automated test.\n\nI have a question: is there the suitable location to place automated test? I've found possible related tests under:\n\n* https://hg.mozilla.org/mozilla-central/file/tip/browser/base/content/test/\n* https://hg.mozilla.org/mozilla-central/file/tip/toolkit/components/windowwatcher/test/", "bug_id": 1521688, "time": "2019-01-22T08:31:42Z", "raw_text": "Initial version patch, without automated test.\n\nI have a question: is there the suitable location to place automated test? I've found possible related tests under:\n\n* https://hg.mozilla.org/mozilla-central/file/tip/browser/base/content/test/\n* https://hg.mozilla.org/mozilla-central/file/tip/toolkit/components/windowwatcher/test/", "creator": "yuki@clear-code.com", "attachment_id": 9038164, "tags": [], "count": 2, "id": 13876476, "creation_time": "2019-01-22T08:31:42Z"}, {"creator": "dao+bmo@mozilla.com", "id": 13876547, "creation_time": "2019-01-22T09:27:00Z", "raw_text": "(In reply to YUKI \"Piro\" Hiroshi from comment #2)\n\n> Created attachment 9038164\n> Patch (WIP)\n> \n> Initial version patch, without automated test.\n> \n> I have a question: is there the suitable location to place automated test?\n\nhttps://searchfox.org/mozilla-central/source/browser/base/content/test/popups/browser_popupUI.js", "attachment_id": null, "is_private": false, "author": "dao+bmo@mozilla.com", "text": "(In reply to YUKI \"Piro\" Hiroshi from comment #2)\n\n> Created attachment 9038164\n> Patch (WIP)\n> \n> Initial version patch, without automated test.\n> \n> I have a question: is there the suitable location to place automated test?\n\nhttps://searchfox.org/mozilla-central/source/browser/base/content/test/popups/browser_popupUI.js", "time": "2019-01-22T09:27:00Z", "bug_id": 1521688, "count": 3, "tags": []}, {"creator": "yuki@clear-code.com", "creation_time": "2019-01-23T03:43:38Z", "id": 13878860, "raw_text": "(In reply to D\u00e3o Gottwald [::dao] from comment #3)\n\n> (In reply to YUKI \"Piro\" Hiroshi from comment #2)\n> > I have a question: is there the suitable location to place automated test?\n> \n> https://searchfox.org/mozilla-central/source/browser/base/content/test/popups/browser_popupUI.js\n\nThanks!\n\nNow I'm trying to write tests. Here is a list of conditions thought as need to be tested:\n\n* `browser.tabs.drawInTitlebar` (on/off)\n* `window.open()` flags\n  * (no feature)\n  * toolbar\n  * menubar\n  * toolbar,menubar\n* `View` => `Toolbars` => `Menu Bar` (on/off)\n\nI think https://searchfox.org/mozilla-central/source/toolkit/components/windowwatcher/test/browser_new_content_window_chromeflags.js looks an example for testing with combinations of conditions.", "attachment_id": null, "author": "yuki@clear-code.com", "is_private": false, "text": "(In reply to D\u00e3o Gottwald [::dao] from comment #3)\n\n> (In reply to YUKI \"Piro\" Hiroshi from comment #2)\n> > I have a question: is there the suitable location to place automated test?\n> \n> https://searchfox.org/mozilla-central/source/browser/base/content/test/popups/browser_popupUI.js\n\nThanks!\n\nNow I'm trying to write tests. Here is a list of conditions thought as need to be tested:\n\n* `browser.tabs.drawInTitlebar` (on/off)\n* `window.open()` flags\n  * (no feature)\n  * toolbar\n  * menubar\n  * toolbar,menubar\n* `View` => `Toolbars` => `Menu Bar` (on/off)\n\nI think https://searchfox.org/mozilla-central/source/toolkit/components/windowwatcher/test/browser_new_content_window_chromeflags.js looks an example for testing with combinations of conditions.", "bug_id": 1521688, "time": "2019-01-23T03:43:38Z", "count": 4, "tags": []}, {"author": "yuki@clear-code.com", "is_private": false, "text": "Created attachment 9038450\nBug 1521688 - Show titlebar buttons when drawInTitlebar=true, window.open with features=\"toolbar\", View => Toolbars => Menu Bar=checked", "tags": [], "time": "2019-01-23T05:47:01Z", "bug_id": 1521688, "count": 5, "raw_text": "", "id": 13878922, "creation_time": "2019-01-23T05:47:01Z", "creator": "yuki@clear-code.com", "attachment_id": 9038450}, {"id": 13910224, "creation_time": "2019-02-07T18:18:41Z", "count": 6, "tags": [], "attachment_id": null, "creator": "pulsebot@bots.tld", "raw_text": "Pushed by ccoroiu@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/7d8248d94084\nShow titlebar buttons when drawInTitlebar=true, window.open with features=\"toolbar\", View => Toolbars => Menu Bar=checked r=dao", "bug_id": 1521688, "time": "2019-02-07T18:18:41Z", "text": "Pushed by ccoroiu@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/7d8248d94084\nShow titlebar buttons when drawInTitlebar=true, window.open with features=\"toolbar\", View => Toolbars => Menu Bar=checked r=dao", "author": "pulsebot@bots.tld", "is_private": false}, {"author": "rmaries@mozilla.com", "is_private": false, "text": "https://hg.mozilla.org/mozilla-central/rev/7d8248d94084", "bug_id": 1521688, "time": "2019-02-08T04:27:35Z", "count": 7, "tags": ["bugherder"], "creation_time": "2019-02-08T04:27:35Z", "creator": "rmaries@mozilla.com", "id": 13911464, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/7d8248d94084", "attachment_id": null}]}}}