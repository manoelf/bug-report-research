{"comments": {}, "bugs": {"713314": {"comments": [{"id": 5938181, "raw_text": "+++ This bug was initially created as a clone of Bug #713312 +++\n\nSome sites, in particular banking and e-commerce sites in China, are using ActiveX controls and/or NPAPI plugins that implement anti-keylogger techniques (of various levels of effectiveness). One of the anti-keylogger features is an ActiveX control that is basically a regular Win32 edit control that, AFAICT, checks for the the presence of keyloggers.\n\nThere are definitely limits to the detection and prevention of keyloggers. The main goal here is to satisfy the security requirements of various sites, especially sites in China, for keylogger protection. We should work with the sites to understand their requirements before getting too deep into this.\n\nOne of the things they do (AFAICT) is check for the presence of keyboard hooks [1][2][3]. I do not know if the control somehow disables the keyboard hooks for the input control (I suspect this is not possible), or whether it just disables the control and/or warns the user. We will have to test these plugins to see how they behave when keyboard hooks are installed on the system.\n\nThese edit controls may do other things to detect/prevent keylogging. We need to investigate this and get feedback from the sites using these controls.\n\nI believe we have a contact at Alipay, which is one site that uses such a control. Mozilla China may be able to get useful technical information from them about what exactly their plugin does to prevent keylogging, to help us with our own implementation. Mozilla China might also be able to get such information from other sites, including Chinese Banks, that use such controls.\n\nI am tempting to mark this Windows-only, because that is by far the most urgent platform to support this for, for the Chinese cases. Obviously it would be great to provide this support on all platforms; however, we shouldn't delay shipping the Windows implementation because of delays in implementing it for other platforms. I suggest we file other follow-up bugs for implementing it on other platforms after we've implemented it on Windows.\n\n[1] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx\n[2] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644984%28v=vs.85%29.aspx\n[3] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644985%28v=vs.85%29.aspx", "attachment_id": null, "time": "2011-12-24T01:59:13Z", "bug_id": 713314, "tags": [], "text": "+++ This bug was initially created as a clone of Bug #713312 +++\n\nSome sites, in particular banking and e-commerce sites in China, are using ActiveX controls and/or NPAPI plugins that implement anti-keylogger techniques (of various levels of effectiveness). One of the anti-keylogger features is an ActiveX control that is basically a regular Win32 edit control that, AFAICT, checks for the the presence of keyloggers.\n\nThere are definitely limits to the detection and prevention of keyloggers. The main goal here is to satisfy the security requirements of various sites, especially sites in China, for keylogger protection. We should work with the sites to understand their requirements before getting too deep into this.\n\nOne of the things they do (AFAICT) is check for the presence of keyboard hooks [1][2][3]. I do not know if the control somehow disables the keyboard hooks for the input control (I suspect this is not possible), or whether it just disables the control and/or warns the user. We will have to test these plugins to see how they behave when keyboard hooks are installed on the system.\n\nThese edit controls may do other things to detect/prevent keylogging. We need to investigate this and get feedback from the sites using these controls.\n\nI believe we have a contact at Alipay, which is one site that uses such a control. Mozilla China may be able to get useful technical information from them about what exactly their plugin does to prevent keylogging, to help us with our own implementation. Mozilla China might also be able to get such information from other sites, including Chinese Banks, that use such controls.\n\nI am tempting to mark this Windows-only, because that is by far the most urgent platform to support this for, for the Chinese cases. Obviously it would be great to provide this support on all platforms; however, we shouldn't delay shipping the Windows implementation because of delays in implementing it for other platforms. I suggest we file other follow-up bugs for implementing it on other platforms after we've implemented it on Windows.\n\n[1] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx\n[2] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644984%28v=vs.85%29.aspx\n[3] http://msdn.microsoft.com/en-us/library/windows/desktop/ms644985%28v=vs.85%29.aspx", "author": "brian@briansmith.org", "creation_time": "2011-12-24T01:59:13Z", "count": 0, "creator": "brian@briansmith.org", "is_private": false}, {"is_private": false, "creator": "dbaron@dbaron.org", "count": 1, "creation_time": "2011-12-24T02:39:34Z", "author": "dbaron@dbaron.org", "text": "How does this do more than address techniques *currently* used for keylogging?  That is, how does it prevent other keylogging techniques?  If a major browser shipped something like this, wouldn't people writing keyloggers just switch to a different technique?", "time": "2011-12-24T02:39:34Z", "tags": [], "bug_id": 713314, "attachment_id": null, "raw_text": "How does this do more than address techniques *currently* used for keylogging?  That is, how does it prevent other keylogging techniques?  If a major browser shipped something like this, wouldn't people writing keyloggers just switch to a different technique?", "id": 5938217}, {"bug_id": 713314, "count": 2, "id": 5938335, "attachment_id": null, "raw_text": "(In reply to David Baron [:dbaron] from comment #1)\n> How does this do more than address techniques *currently* used for\n> keylogging?  That is, how does it prevent other keylogging techniques?  If a\n> major browser shipped something like this, wouldn't people writing\n> keyloggers just switch to a different technique?\n\n\nWe should get clarification (probably through Mozilla China) from the websites that use these plugins, as to why they feel like protection against certain types of keyloggers is warranted even though there are ways to create keyloggers that we could not detect.\n\nI think the undetectable techniques may require admin rights (elevation) to install. So, maybe these websites are trying to block keylogging techniques that do NOT require elevation, and/or might only be possible on Windows XP, which doesn't have the UAC, UIPI, and other UI security stuff that modern Windows has. (In particular, it looks like the security properties of SetWindowHookEx have changed dramatically from Windows XP to Vista.)", "creation_time": "2011-12-24T05:05:32Z", "author": "brian@briansmith.org", "text": "(In reply to David Baron [:dbaron] from comment #1)\n> How does this do more than address techniques *currently* used for\n> keylogging?  That is, how does it prevent other keylogging techniques?  If a\n> major browser shipped something like this, wouldn't people writing\n> keyloggers just switch to a different technique?\n\n\nWe should get clarification (probably through Mozilla China) from the websites that use these plugins, as to why they feel like protection against certain types of keyloggers is warranted even though there are ways to create keyloggers that we could not detect.\n\nI think the undetectable techniques may require admin rights (elevation) to install. So, maybe these websites are trying to block keylogging techniques that do NOT require elevation, and/or might only be possible on Windows XP, which doesn't have the UAC, UIPI, and other UI security stuff that modern Windows has. (In particular, it looks like the security properties of SetWindowHookEx have changed dramatically from Windows XP to Vista.)", "tags": [], "time": "2011-12-24T05:05:32Z", "is_private": false, "creator": "brian@briansmith.org"}, {"time": "2012-02-22T22:23:43Z", "bug_id": 713314, "tags": [], "text": "sec triage, holding for more action", "author": "curtisk@mozilla.com", "creation_time": "2012-02-22T22:23:43Z", "count": 3, "creator": "curtisk@mozilla.com", "is_private": false, "id": 6084310, "raw_text": "sec triage, holding for more action", "attachment_id": null}, {"bug_id": 713314, "count": 4, "text": "still waiting", "time": "2012-03-21T21:40:03Z", "tags": [], "creation_time": "2012-03-21T21:40:03Z", "author": "curtisk@mozilla.com", "is_private": false, "creator": "curtisk@mozilla.com", "id": 6160364, "raw_text": "still waiting", "attachment_id": null}, {"id": 6412727, "attachment_id": null, "raw_text": "> We should get clarification (probably through Mozilla China) from the\n> websites that use these plugins, as to why they feel like protection against\n> certain types of keyloggers is warranted even though there are ways to\n> create keyloggers that we could not detect.\n\nI brought this up at the Security Engineering meeting today about the plugin at https://login.taobao.com/member/login.jhtml?f=top&redirectURL=http://www.taobao.com/index_global.php which has a name that is translated to mean that it is a security-related plugin.", "creation_time": "2012-06-22T00:11:54Z", "author": "nth10sd@gmail.com", "text": "> We should get clarification (probably through Mozilla China) from the\n> websites that use these plugins, as to why they feel like protection against\n> certain types of keyloggers is warranted even though there are ways to\n> create keyloggers that we could not detect.\n\nI brought this up at the Security Engineering meeting today about the plugin at https://login.taobao.com/member/login.jhtml?f=top&redirectURL=http://www.taobao.com/index_global.php which has a name that is translated to mean that it is a security-related plugin.", "tags": [], "time": "2012-06-22T00:11:54Z", "is_private": false, "creator": "nth10sd@gmail.com", "bug_id": 713314, "count": 5}]}}}