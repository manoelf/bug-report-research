{"comments": {}, "bugs": {"699291": {"comments": [{"raw_text": "On my latest m-c build under Linux, I experience numerous pauses in the chrome process lasting from ~0.5-1.0s when running the browser chrome mochitests. I /think/ this is a regression from the past month or so, where my mochitests used to all fly by with no unexpected pauses (I'm running a Core i7-2600K and nearly everything is fast all the time).\n\nThe pauses reliably occur every 3-10s. They are obvious on tests that have a lot of tab browser activity, such as toolkit/mozapps/extensions. It is very obvious when a pause occurs, as the new/old tab animation will often be paused, leaving the tab half drawn.\n\nThe .mozconfig producing the pauses is:\n\n  mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/obj-ff-debug\n  mk_add_options MOZ_MAKE_FLAGS=\"-j8\"\n  ac_add_options --enable-application=browser\n  ac_add_options --enable-tests\n  ac_add_options --with-ccache=/usr/bin/ccache\n  ac_add_options --enable-optimize=-O2\n\nInterestingly, on a similar build with:\n\n  ac_add_options --enable-optimize\n  ac_add_options --enable-debug\n\nI only saw one pause for the duration of the mochitest suite, and it was at the beginning. The test suite did execute slower, but I would expect that from a debug build. I am building the same tree with the offending flags now to see if it produces.\n\nI was able to trap a pause when running the mochitest suite under GDB. Nearly every thread was in pthread_cond_wait(). I can provide stack traces of all threads if requested.", "attachment_id": null, "id": 5822462, "count": 0, "creator": "gps@mozilla.com", "is_private": false, "tags": [], "time": "2011-11-02T23:51:24Z", "bug_id": 699291, "text": "On my latest m-c build under Linux, I experience numerous pauses in the chrome process lasting from ~0.5-1.0s when running the browser chrome mochitests. I /think/ this is a regression from the past month or so, where my mochitests used to all fly by with no unexpected pauses (I'm running a Core i7-2600K and nearly everything is fast all the time).\n\nThe pauses reliably occur every 3-10s. They are obvious on tests that have a lot of tab browser activity, such as toolkit/mozapps/extensions. It is very obvious when a pause occurs, as the new/old tab animation will often be paused, leaving the tab half drawn.\n\nThe .mozconfig producing the pauses is:\n\n  mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/obj-ff-debug\n  mk_add_options MOZ_MAKE_FLAGS=\"-j8\"\n  ac_add_options --enable-application=browser\n  ac_add_options --enable-tests\n  ac_add_options --with-ccache=/usr/bin/ccache\n  ac_add_options --enable-optimize=-O2\n\nInterestingly, on a similar build with:\n\n  ac_add_options --enable-optimize\n  ac_add_options --enable-debug\n\nI only saw one pause for the duration of the mochitest suite, and it was at the beginning. The test suite did execute slower, but I would expect that from a debug build. I am building the same tree with the offending flags now to see if it produces.\n\nI was able to trap a pause when running the mochitest suite under GDB. Nearly every thread was in pthread_cond_wait(). I can provide stack traces of all threads if requested.", "author": "gps@mozilla.com", "creation_time": "2011-11-02T23:51:24Z"}, {"time": "2011-11-03T00:33:05Z", "tags": [], "bug_id": 699291, "text": "I performed a clobber build on a commit from about a month ago and the issue persists. Maybe I was wrong about the regression. Maybe my toolchain changed and I'm producing something different now. Hmmm...", "author": "gps@mozilla.com", "creation_time": "2011-11-03T00:33:05Z", "count": 1, "creator": "gps@mozilla.com", "is_private": false, "id": 5822551, "raw_text": "I performed a clobber build on a commit from about a month ago and the issue persists. Maybe I was wrong about the regression. Maybe my toolchain changed and I'm producing something different now. Hmmm...", "attachment_id": null}, {"text": "Just checked a recent build on Windows and it does *not* exhibit the pauses in the tabbrowser during the same mochitest run.\n\nInterestingly, the same toolkit/mozapps/extensions mochitest-browser-chrome target executed much faster on Windows - 1:44 vs 2:32. Just by watching the test suites run, I feel the pauses on Linux account for much of the wall time difference.", "tags": [], "bug_id": 699291, "time": "2011-11-03T00:44:44Z", "creation_time": "2011-11-03T00:44:44Z", "author": "gps@mozilla.com", "count": 2, "is_private": false, "creator": "gps@mozilla.com", "id": 5822579, "raw_text": "Just checked a recent build on Windows and it does *not* exhibit the pauses in the tabbrowser during the same mochitest run.\n\nInterestingly, the same toolkit/mozapps/extensions mochitest-browser-chrome target executed much faster on Windows - 1:44 vs 2:32. Just by watching the test suites run, I feel the pauses on Linux account for much of the wall time difference.", "attachment_id": null}, {"attachment_id": null, "raw_text": "Important caveat: I am running Linux inside VMWare. I'm also forwarding X11 to an X server running on Windows. The VM is running with hardware virtualization and I've never noticed any kind of VM pauses. It is conceivable X11 is choking, but when the tests aren't paused, the window rendered over X seems just as responsive/fast as the native Windows build.\n\nI'm going to try a fresh VM and see if I can repro there.", "id": 5822680, "creator": "gps@mozilla.com", "is_private": false, "author": "gps@mozilla.com", "creation_time": "2011-11-03T01:40:52Z", "time": "2011-11-03T01:40:52Z", "tags": [], "text": "Important caveat: I am running Linux inside VMWare. I'm also forwarding X11 to an X server running on Windows. The VM is running with hardware virtualization and I've never noticed any kind of VM pauses. It is conceivable X11 is choking, but when the tests aren't paused, the window rendered over X seems just as responsive/fast as the native Windows build.\n\nI'm going to try a fresh VM and see if I can repro there.", "count": 3, "bug_id": 699291}, {"creation_time": "2011-11-03T23:51:45Z", "author": "gps@mozilla.com", "text": "I reproduced on a fresh Ubuntu 10.04 64 bit VM. Firefox built in x86 mode. Not sure what else I should do here.", "bug_id": 699291, "time": "2011-11-03T23:51:45Z", "tags": [], "is_private": false, "creator": "gps@mozilla.com", "count": 4, "id": 5825270, "attachment_id": null, "raw_text": "I reproduced on a fresh Ubuntu 10.04 64 bit VM. Firefox built in x86 mode. Not sure what else I should do here."}]}}}