{"bugs": {"655681": {"comments": [{"bug_id": 655681, "count": 0, "creator": "mh+mozilla@glandium.org", "tags": [], "raw_text": "When a js script is first stored in the startup cache, the path used to load it initially is stored as well. In the first implementation of part 7 bug 620931, I was loading the js scripts during packaging through jar:/full/path/to/omni.jar!/modules/*.js urls, and these were stored. The next iteration loads through resource:///modules/*.js, which is stored too.\n\nWhen loading from the startup cache, the js script object recovers that file name that was used when the startup cache was created, which doesn't necessarily match the path the script was called with.\n\nFor instance, in the above case, the jar:/full/path/to/omni.jar!/modules/*.js path obviously doesn't match the omni.jar path at run-time. But even in the next iteration, a script loaded through a resource://gre/ url will have the js script object say it's under resource:///.\n\nWe can surely imagine some corner cases where this would create problems (such as the one highlighted in bug 620931 comment 51, but in other places.\n\nI think we should fixup the js script object to point to the loaded url instead of the stored url.", "id": 5456674, "text": "When a js script is first stored in the startup cache, the path used to load it initially is stored as well. In the first implementation of part 7 bug 620931, I was loading the js scripts during packaging through jar:/full/path/to/omni.jar!/modules/*.js urls, and these were stored. The next iteration loads through resource:///modules/*.js, which is stored too.\n\nWhen loading from the startup cache, the js script object recovers that file name that was used when the startup cache was created, which doesn't necessarily match the path the script was called with.\n\nFor instance, in the above case, the jar:/full/path/to/omni.jar!/modules/*.js path obviously doesn't match the omni.jar path at run-time. But even in the next iteration, a script loaded through a resource://gre/ url will have the js script object say it's under resource:///.\n\nWe can surely imagine some corner cases where this would create problems (such as the one highlighted in bug 620931 comment 51, but in other places.\n\nI think we should fixup the js script object to point to the loaded url instead of the stored url.", "creation_time": "2011-05-09T10:26:41Z", "author": "mh+mozilla@glandium.org", "time": "2011-05-09T10:26:41Z", "is_private": false, "attachment_id": null}]}}, "comments": {}}