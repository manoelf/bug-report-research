{"bugs": {"688306": {"comments": [{"creator": "alexander.miller@sbcglobal.net", "author": "alexander.miller@sbcglobal.net", "text": "User Agent: Mozilla/5.0 (X11; Linux i686; rv:6.0.2) Gecko/20100101 Firefox/6.0.2\nBuild ID: 20110905174115\n\nSteps to reproduce:\n\nI read the source code?\n\nhttp://mxr.mozilla.org/mozilla-central/source/gfx/thebes/gfxBlur.cpp#200\n\n\nActual results:\n\nI found an unchecked, signed array index with arithmetic :\n\naOutput[aWidth * y + x] = (PRUint64(alphaSum)*reciprocal) >> 32;\n\nwhere aWidth, y, and x haven't gone through any validation, and is equal to aWidth, presumably.\n\n\nExpected results:\n\nThere should have been an overflow check. Also, the only place where BoxBlurHorizontal is called doesn't validate the parameters it's handing over in any way which would prevent an overflow during the arithmetic.", "attachment_id": null, "time": "2011-09-21T22:19:19Z", "creation_time": "2011-09-21T22:19:19Z", "raw_text": "User Agent: Mozilla/5.0 (X11; Linux i686; rv:6.0.2) Gecko/20100101 Firefox/6.0.2\nBuild ID: 20110905174115\n\nSteps to reproduce:\n\nI read the source code?\n\nhttp://mxr.mozilla.org/mozilla-central/source/gfx/thebes/gfxBlur.cpp#200\n\n\nActual results:\n\nI found an unchecked, signed array index with arithmetic :\n\naOutput[aWidth * y + x] = (PRUint64(alphaSum)*reciprocal) >> 32;\n\nwhere aWidth, y, and x haven't gone through any validation, and is equal to aWidth, presumably.\n\n\nExpected results:\n\nThere should have been an overflow check. Also, the only place where BoxBlurHorizontal is called doesn't validate the parameters it's handing over in any way which would prevent an overflow during the arithmetic.", "bug_id": 688306, "tags": [], "count": 0, "is_private": false, "id": 5729477}, {"author": "alexander.miller@sbcglobal.net", "creator": "alexander.miller@sbcglobal.net", "attachment_id": null, "time": "2011-09-21T22:20:09Z", "text": "s/and is equal/and x is equal/", "creation_time": "2011-09-21T22:20:09Z", "raw_text": "s/and is equal/and x is equal/", "bug_id": 688306, "id": 5729481, "tags": [], "is_private": false, "count": 1}, {"creator": "dbaron@dbaron.org", "author": "dbaron@dbaron.org", "bug_id": 688306, "is_private": false, "count": 2, "tags": [], "id": 5729542, "text": "This doesn't seem like a security bug to me.  I think integer overflows tend to cause security problems when there's an overflow at allocation time (resulting in too small an allocation) and code writes to indices in an array that aren't properly allocated.  What you're pointing out is a case where we're writing to a position in the array that might be too low.  (That said, we've hopefully already done an overflow check and failed to allocate the buffer such that we wouldn't even get here.  If we haven't, then *that* could be a security problem.)", "time": "2011-09-21T22:46:24Z", "attachment_id": null, "raw_text": "This doesn't seem like a security bug to me.  I think integer overflows tend to cause security problems when there's an overflow at allocation time (resulting in too small an allocation) and code writes to indices in an array that aren't properly allocated.  What you're pointing out is a case where we're writing to a position in the array that might be too low.  (That said, we've hopefully already done an overflow check and failed to allocate the buffer such that we wouldn't even get here.  If we haven't, then *that* could be a security problem.)", "creation_time": "2011-09-21T22:46:24Z"}, {"time": "2011-09-21T23:36:58Z", "attachment_id": null, "text": "Similar code in BoxBlurVertical, SpreadHorizontal, and SpreadVertical. I agree w/dbaron about overflow not being a security issue here, but if a potential attacker has that much control I'd be more worried about writing past the end of the buffer. Is there really no validation? Seems to be some at least.", "creation_time": "2011-09-21T23:36:58Z", "raw_text": "Similar code in BoxBlurVertical, SpreadHorizontal, and SpreadVertical. I agree w/dbaron about overflow not being a security issue here, but if a potential attacker has that much control I'd be more worried about writing past the end of the buffer. Is there really no validation? Seems to be some at least.", "bug_id": 688306, "id": 5729665, "tags": [], "is_private": false, "count": 3, "author": "dveditz@mozilla.com", "creator": "dveditz@mozilla.com"}, {"bug_id": 688306, "id": 5731306, "is_private": false, "count": 4, "tags": [], "time": "2011-09-22T17:45:17Z", "attachment_id": null, "author": "joe@drew.ca", "creator": "joe@drew.ca", "text": "Note that at least some of this may be fixed in bug 685767.", "raw_text": "Note that at least some of this may be fixed in bug 685767.", "creation_time": "2011-09-22T17:45:17Z"}]}}, "comments": {}}