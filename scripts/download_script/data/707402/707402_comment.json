{"comments": {}, "bugs": {"707402": {"comments": [{"id": 5890210, "count": 0, "is_private": false, "time": "2011-12-03T03:49:02Z", "creation_time": "2011-12-03T03:49:02Z", "creator": "jduell.mcbugs@gmail.com", "author": "jduell.mcbugs@gmail.com", "attachment_id": 578804, "raw_text": "Taras:  I cut this off at 1 Terabyte, assuming we don't care if we've got more space than that (at least as a proxy to measure disk fragmentation).\n\nMichal: this doesn't measure the case where a user has disabled smart-size cache (i.e. set a max cache size manually).  But this is the common case, and piggybacks off us getting the size anyway, so no additional I/O at startup.", "tags": [], "text": "Created attachment 578804\nv1\n\nTaras:  I cut this off at 1 Terabyte, assuming we don't care if we've got more space than that (at least as a proxy to measure disk fragmentation).\n\nMichal: this doesn't measure the case where a user has disabled smart-size cache (i.e. set a max cache size manually).  But this is the common case, and piggybacks off us getting the size anyway, so no additional I/O at startup.", "bug_id": 707402}, {"text": "Comment on attachment 578804\nv1\n\nI think it would be nicer to report percentage of disk free since a fill rate corresponds better to fs usage.", "bug_id": 707402, "tags": [], "attachment_id": 578804, "raw_text": "I think it would be nicer to report percentage of disk free since a fill rate corresponds better to fs usage.", "creator": "taras.mozilla@glek.net", "time": "2011-12-03T04:01:11Z", "creation_time": "2011-12-03T04:01:11Z", "author": "taras.mozilla@glek.net", "is_private": false, "id": 5890216, "count": 1}, {"creator": "jduell.mcbugs@gmail.com", "creation_time": "2011-12-03T04:34:22Z", "time": "2011-12-03T04:34:22Z", "author": "jduell.mcbugs@gmail.com", "is_private": false, "id": 5890247, "count": 2, "tags": [], "bug_id": 707402, "text": "Do we have a (portable) way to get disk space used on a device (or the total size of the device?  Either of those plus nsILocalFile.diskAvailableFreeSpace is enough to get the %, but I don't see an API for either.", "attachment_id": null, "raw_text": "Do we have a (portable) way to get disk space used on a device (or the total size of the device?  Either of those plus nsILocalFile.diskAvailableFreeSpace is enough to get the %, but I don't see an API for either."}, {"text": "Comment on attachment 578804\nv1\n\n(In reply to Taras Glek (:taras) from comment #1)\n> I think it would be nicer to report percentage of disk free since a fill\n> rate corresponds better to fs usage.\n\nWhy? We use absolute value to determine the cache size, so I think we should report that value.\n\n\n> +    Telemetry::Accumulate(Telemetry::NETWORK_DISK_CACHE_FREE_SPACE_MB,\n> +                          bytesAvailable / (1024*1024));\n> +\n>      return SmartCacheSize((bytesAvailable / 1024) + currentSize);\n\nIMO we should log currentSize as well, or maybe only a sum of both.", "bug_id": 707402, "tags": [], "raw_text": "(In reply to Taras Glek (:taras) from comment #1)\n> I think it would be nicer to report percentage of disk free since a fill\n> rate corresponds better to fs usage.\n\nWhy? We use absolute value to determine the cache size, so I think we should report that value.\n\n\n> +    Telemetry::Accumulate(Telemetry::NETWORK_DISK_CACHE_FREE_SPACE_MB,\n> +                          bytesAvailable / (1024*1024));\n> +\n>      return SmartCacheSize((bytesAvailable / 1024) + currentSize);\n\nIMO we should log currentSize as well, or maybe only a sum of both.", "attachment_id": 578804, "author": "michal.novotny@gmail.com", "creator": "michal.novotny@gmail.com", "time": "2011-12-03T18:02:59Z", "creation_time": "2011-12-03T18:02:59Z", "is_private": false, "count": 3, "id": 5890759}, {"attachment_id": null, "raw_text": "(In reply to Michal Novotny (:michal) from comment #3)\n> Comment on attachment 578804 [diff] [details] [review]\n> v1\n> \n> (In reply to Taras Glek (:taras) from comment #1)\n> > I think it would be nicer to report percentage of disk free since a fill\n> > rate corresponds better to fs usage.\n> \n> Why? We use absolute value to determine the cache size, so I think we should\n> report that value.\n\nThat value would be useful for cache tuning. However a percentage is more useful for determining fragmentation. Sounds like we should do both.", "tags": [], "bug_id": 707402, "text": "(In reply to Michal Novotny (:michal) from comment #3)\n> Comment on attachment 578804 [diff] [details] [review]\n> v1\n> \n> (In reply to Taras Glek (:taras) from comment #1)\n> > I think it would be nicer to report percentage of disk free since a fill\n> > rate corresponds better to fs usage.\n> \n> Why? We use absolute value to determine the cache size, so I think we should\n> report that value.\n\nThat value would be useful for cache tuning. However a percentage is more useful for determining fragmentation. Sounds like we should do both.", "count": 4, "id": 5893123, "is_private": false, "creation_time": "2011-12-05T17:43:31Z", "time": "2011-12-05T17:43:31Z", "creator": "taras.mozilla@glek.net", "author": "taras.mozilla@glek.net"}, {"attachment_id": null, "raw_text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "bug_id": 707402, "text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "tags": [], "is_private": false, "id": 12658705, "count": 5, "creator": "bug-husbandry-bot@mozilla.bugs", "time": "2017-09-13T18:38:58Z", "creation_time": "2017-09-13T18:38:58Z", "author": "bug-husbandry-bot@mozilla.bugs"}]}}}