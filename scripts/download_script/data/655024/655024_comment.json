{"comments": {}, "bugs": {"655024": {"comments": [{"attachment_id": null, "time": "2011-05-05T15:33:25Z", "is_private": false, "author": "mrwarper@yahoo.es", "creator": "mrwarper@yahoo.es", "tags": [], "count": 0, "bug_id": 655024, "creation_time": "2011-05-05T15:33:25Z", "text": "User-Agent:       Mozilla/5.0 (OS/2; U; Warp 4.5; es-ES; rv:1.8.1.19) Gecko/20081212 SeaMonkey/1.1.14 (PmW)\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\n\nWhen a tab containing a document is closed, any window.unload events registered are triggered, as it should.\n\nWhen the whole application is closed, these events are not fired, which will cause problems with any scripts that do things 'on exit'.\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Load the example URL in a tab; see the alert message: \"Window loaded!\"\n2. Close the tab; see the alert message: \"Unloading window!\"\n3. Load the example URL again, see the same alert message as in step #1\n4. Close or exit the application (Close button or File->Quit). No alert message like in step #2 will pop up.\n\nActual Results:  \nNo 'unloading window' message is shown upon application exit, but it is when a tab is closed.\n\n\nExpected Results:  \nThe same message 'unloading window' should be shown when a tab is closed as upon application exit.\n\nVerified on Windows and OS/2; FX versions: 4.0 and 4.0.1; SeaMonkey 2.1b3 exhibits the same behaviour on both platforms as well.", "id": 5451024, "raw_text": "User-Agent:       Mozilla/5.0 (OS/2; U; Warp 4.5; es-ES; rv:1.8.1.19) Gecko/20081212 SeaMonkey/1.1.14 (PmW)\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\n\nWhen a tab containing a document is closed, any window.unload events registered are triggered, as it should.\n\nWhen the whole application is closed, these events are not fired, which will cause problems with any scripts that do things 'on exit'.\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Load the example URL in a tab; see the alert message: \"Window loaded!\"\n2. Close the tab; see the alert message: \"Unloading window!\"\n3. Load the example URL again, see the same alert message as in step #1\n4. Close or exit the application (Close button or File->Quit). No alert message like in step #2 will pop up.\n\nActual Results:  \nNo 'unloading window' message is shown upon application exit, but it is when a tab is closed.\n\n\nExpected Results:  \nThe same message 'unloading window' should be shown when a tab is closed as upon application exit.\n\nVerified on Windows and OS/2; FX versions: 4.0 and 4.0.1; SeaMonkey 2.1b3 exhibits the same behaviour on both platforms as well."}, {"time": "2011-05-05T15:35:05Z", "is_private": false, "attachment_id": 530324, "count": 1, "tags": [], "creator": "mrwarper@yahoo.es", "bug_id": 655024, "creation_time": "2011-05-05T15:35:05Z", "text": "Created attachment 530324\nHTML container + JavaScript testcase", "id": 5451028, "raw_text": "", "author": "mrwarper@yahoo.es"}, {"attachment_id": null, "is_private": false, "time": "2011-05-05T15:39:33Z", "author": "bzbarsky@mit.edu", "id": 5451040, "raw_text": "> these events are not fired,\n\nThey're fired, and the JS runs.  You can verify this in various ways (e.g. by having that JS touch some state somewhere).\n\nAll you're seeing is that when a window is already closed an alert() that's supposed to have that window as a parent can't be shown... because its parent is gone.  \n\nSo as far as I can tell, this bug is invalid.", "creation_time": "2011-05-05T15:39:33Z", "text": "> these events are not fired,\n\nThey're fired, and the JS runs.  You can verify this in various ways (e.g. by having that JS touch some state somewhere).\n\nAll you're seeing is that when a window is already closed an alert() that's supposed to have that window as a parent can't be shown... because its parent is gone.  \n\nSo as far as I can tell, this bug is invalid.", "creator": "bzbarsky@mit.edu", "tags": [], "count": 2, "bug_id": 655024}, {"time": "2011-05-05T15:50:32Z", "is_private": false, "attachment_id": null, "bug_id": 655024, "tags": [], "count": 3, "creator": "mrwarper@yahoo.es", "text": "(In reply to comment #2)\n> > these events are not fired,\n> \n> They're fired, and the JS runs.  You can verify this in various ways (e.g. by\n> having that JS touch some state somewhere).\n\nNo need; if you say the JS runs, I'll believe you.\n \n> All you're seeing is that when a window is already closed an alert() that's\n> supposed to have that window as a parent can't be shown... because its parent\n> is gone.  \n\nOK, except that bits involving user input (\"confirm\" dialog boxes to save data, for example) are not shown either, which can still cause problems.", "creation_time": "2011-05-05T15:50:32Z", "raw_text": "(In reply to comment #2)\n> > these events are not fired,\n> \n> They're fired, and the JS runs.  You can verify this in various ways (e.g. by\n> having that JS touch some state somewhere).\n\nNo need; if you say the JS runs, I'll believe you.\n \n> All you're seeing is that when a window is already closed an alert() that's\n> supposed to have that window as a parent can't be shown... because its parent\n> is gone.  \n\nOK, except that bits involving user input (\"confirm\" dialog boxes to save data, for example) are not shown either, which can still cause problems.", "id": 5451062, "author": "mrwarper@yahoo.es"}, {"attachment_id": null, "time": "2011-05-05T15:53:46Z", "is_private": false, "author": "bzbarsky@mit.edu", "bug_id": 655024, "creator": "bzbarsky@mit.edu", "count": 4, "tags": [], "raw_text": "I think that if the user is quitting the app showing a confirm prompt would be totally broken....", "id": 5451071, "text": "I think that if the user is quitting the app showing a confirm prompt would be totally broken....", "creation_time": "2011-05-05T15:53:46Z"}, {"id": 5451073, "raw_text": "Of course it might also be that we're just showing them as tab-modal and then the whole window dies.", "creation_time": "2011-05-05T15:54:54Z", "is_private": false, "text": "Of course it might also be that we're just showing them as tab-modal and then the whole window dies.", "time": "2011-05-05T15:54:54Z", "creator": "bzbarsky@mit.edu", "tags": [], "count": 5, "bug_id": 655024, "attachment_id": null, "author": "bzbarsky@mit.edu"}, {"time": "2011-05-05T16:13:03Z", "creator": "mrwarper@yahoo.es", "tags": [], "count": 6, "bug_id": 655024, "is_private": false, "creation_time": "2011-05-05T16:13:03Z", "text": "I might coincide with that were it not the case that too many people are used to close applications, then get a confirm prompt to save their data when they haven't done it manually.\n\n[Which is why we have a checkbox to decide whether user confirmation is needed to close several tabs at once, etc.]\n\nIf a user doesn't bother to save his data and closes an application, I think the most sensible thing to do is try and warn him, or get a confirmation. Current behavior prevents this simple procedure that used to work in the past.", "id": 5451132, "raw_text": "I might coincide with that were it not the case that too many people are used to close applications, then get a confirm prompt to save their data when they haven't done it manually.\n\n[Which is why we have a checkbox to decide whether user confirmation is needed to close several tabs at once, etc.]\n\nIf a user doesn't bother to save his data and closes an application, I think the most sensible thing to do is try and warn him, or get a confirmation. Current behavior prevents this simple procedure that used to work in the past.", "attachment_id": null, "author": "mrwarper@yahoo.es"}, {"author": "bzbarsky@mit.edu", "tags": [], "creator": "bzbarsky@mit.edu", "count": 7, "bug_id": 655024, "id": 5451144, "raw_text": "When did it work?  I just tried Firefox 2, 3.5, 3.6, and 4 (on Mac) and none of them show the alert on the attached testcase when closing the browser window.\n\nFirefox 3 tries to show it and ends up in a state where the app can't quit.", "creation_time": "2011-05-05T16:18:06Z", "text": "When did it work?  I just tried Firefox 2, 3.5, 3.6, and 4 (on Mac) and none of them show the alert on the attached testcase when closing the browser window.\n\nFirefox 3 tries to show it and ends up in a state where the app can't quit.", "attachment_id": null, "time": "2011-05-05T16:18:06Z", "is_private": false}, {"author": "mrwarper@yahoo.es", "attachment_id": null, "bug_id": 655024, "count": 8, "tags": [], "creator": "mrwarper@yahoo.es", "time": "2011-05-05T16:59:17Z", "raw_text": "(In reply to comment #7)\n> When did it work?  I just tried Firefox 2, 3.5, 3.6, and 4 (on Mac)\n> and none of\n\nMy main browser is\n\nMozilla/5.0 (OS/2; U; Warp 4.5; es-ES; rv:1.8.1.19) Gecko/20081212 SeaMonkey/1.1.14 (PmW)\n\nand it works.\n\nI don't bother to check new versions thoroughly unless I'm planning to migrate, thus I don't know when it 'stopped' working.", "id": 5451291, "text": "(In reply to comment #7)\n> When did it work?  I just tried Firefox 2, 3.5, 3.6, and 4 (on Mac)\n> and none of\n\nMy main browser is\n\nMozilla/5.0 (OS/2; U; Warp 4.5; es-ES; rv:1.8.1.19) Gecko/20081212 SeaMonkey/1.1.14 (PmW)\n\nand it works.\n\nI don't bother to check new versions thoroughly unless I'm planning to migrate, thus I don't know when it 'stopped' working.", "is_private": false, "creation_time": "2011-05-05T16:59:17Z"}, {"author": "bzbarsky@mit.edu", "text": "It \"working\" may be OS-dependent...", "creation_time": "2011-05-05T17:08:40Z", "raw_text": "It \"working\" may be OS-dependent...", "id": 5451316, "bug_id": 655024, "creator": "bzbarsky@mit.edu", "tags": [], "count": 9, "attachment_id": null, "is_private": false, "time": "2011-05-05T17:08:40Z"}, {"raw_text": "I suspect this will end up WONTFIX anyway. There are existing bugs on disabling the ability to show modal prompts from certain events (like unload) because they're commonly used to abuse/annoy users. Better to use onbeforeunload to warn the user something is unsaved, and give them a chance to cancel closing the page.", "id": 5451697, "text": "I suspect this will end up WONTFIX anyway. There are existing bugs on disabling the ability to show modal prompts from certain events (like unload) because they're commonly used to abuse/annoy users. Better to use onbeforeunload to warn the user something is unsaved, and give them a chance to cancel closing the page.", "creation_time": "2011-05-05T19:12:16Z", "bug_id": 655024, "creator": "jdinbox@gmail.com", "count": 10, "tags": [], "author": "jdinbox@gmail.com", "is_private": false, "time": "2011-05-05T19:12:16Z", "attachment_id": null}, {"author": "mrwarper@yahoo.es", "text": "(In reply to comment #9)\n> It \"working\" may be OS-dependent...\n\nI kind of expected that reply... ;(\n\nMozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.19) Gecko/20081204\nSeaMonkey/1.1.14\n\ndisplays the dialogs upon application exit as well, and apparently exits without crashing :)", "creation_time": "2011-05-05T21:15:44Z", "raw_text": "(In reply to comment #9)\n> It \"working\" may be OS-dependent...\n\nI kind of expected that reply... ;(\n\nMozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.19) Gecko/20081204\nSeaMonkey/1.1.14\n\ndisplays the dialogs upon application exit as well, and apparently exits without crashing :)", "id": 5452076, "bug_id": 655024, "count": 11, "tags": [], "creator": "mrwarper@yahoo.es", "attachment_id": null, "is_private": false, "time": "2011-05-05T21:15:44Z"}, {"time": "2011-05-05T21:24:32Z", "is_private": false, "attachment_id": null, "count": 12, "creator": "mrwarper@yahoo.es", "tags": [], "bug_id": 655024, "creation_time": "2011-05-05T21:24:32Z", "text": "(In reply to comment #10)\n> I suspect this will end up WONTFIX. There are existing bugs on disabling\n> the ability to show modal prompts from certain events (like unload) because\n> they're commonly used to abuse/annoy users. Better to use onbeforeunload to\n\nIt can't be that hard to add some checkbox to the settings dialog saying 'let websites show modal dialogs blah blah', just like there is for the 'close multiple tabs'. Another MS-invented event as an alternative? Not ideal, I'd say...\n\nAbout the bug ending up WONTFIXed, I'm OK with that as long as I know what's going on and I have some place to direct irate users to :)", "id": 5452106, "raw_text": "(In reply to comment #10)\n> I suspect this will end up WONTFIX. There are existing bugs on disabling\n> the ability to show modal prompts from certain events (like unload) because\n> they're commonly used to abuse/annoy users. Better to use onbeforeunload to\n\nIt can't be that hard to add some checkbox to the settings dialog saying 'let websites show modal dialogs blah blah', just like there is for the 'close multiple tabs'. Another MS-invented event as an alternative? Not ideal, I'd say...\n\nAbout the bug ending up WONTFIXed, I'm OK with that as long as I know what's going on and I have some place to direct irate users to :)", "author": "mrwarper@yahoo.es"}, {"attachment_id": null, "is_private": false, "time": "2011-05-05T21:28:42Z", "author": "bzbarsky@mit.edu", "text": "beforeunload is implemented in all browsers and specified to fire before the page is going to go away.  It's there so you can ask for user confirmation and prevent the page unloading if the user says so.\n\nunload means the page is going away, period; you can't usefully \"save\" things from there nor prevent the page going away.  So if your use case is as described in comment 6, you want beforeunload.", "creation_time": "2011-05-05T21:28:42Z", "raw_text": "beforeunload is implemented in all browsers and specified to fire before the page is going to go away.  It's there so you can ask for user confirmation and prevent the page unloading if the user says so.\n\nunload means the page is going away, period; you can't usefully \"save\" things from there nor prevent the page going away.  So if your use case is as described in comment 6, you want beforeunload.", "id": 5452121, "bug_id": 655024, "tags": [], "creator": "bzbarsky@mit.edu", "count": 13}, {"is_private": false, "time": "2011-05-06T07:31:15Z", "attachment_id": null, "raw_text": "(In reply to comment #13)\n> beforeunload is implemented\n...\n> unload means the page is going away, period;\n...\n> So if your use case is as described in comment 6, you want beforeunload.\n\nI never needed to go as far as prevent the page from unloading, but it sounds you're right about onbeforeunload being a better place for that kind of stuff, and the switchover seems almost trivial. I doubt Opera likes this, but it always had problems with [un]load events.\n\nAnyway, couldn't onbeforeunload be abused exactly in the same ways people say unload is being abused?", "id": 5452952, "text": "(In reply to comment #13)\n> beforeunload is implemented\n...\n> unload means the page is going away, period;\n...\n> So if your use case is as described in comment 6, you want beforeunload.\n\nI never needed to go as far as prevent the page from unloading, but it sounds you're right about onbeforeunload being a better place for that kind of stuff, and the switchover seems almost trivial. I doubt Opera likes this, but it always had problems with [un]load events.\n\nAnyway, couldn't onbeforeunload be abused exactly in the same ways people say unload is being abused?", "creation_time": "2011-05-06T07:31:15Z", "bug_id": 655024, "tags": [], "creator": "mrwarper@yahoo.es", "count": 14, "author": "mrwarper@yahoo.es"}, {"time": "2011-05-06T13:21:47Z", "is_private": false, "attachment_id": null, "count": 15, "tags": [], "creator": "bzbarsky@mit.edu", "bug_id": 655024, "id": 5453287, "raw_text": "\"maybe\".  There are some subtle differences....", "creation_time": "2011-05-06T13:21:47Z", "text": "\"maybe\".  There are some subtle differences....", "author": "bzbarsky@mit.edu"}, {"raw_text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly.", "id": 13435562, "text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly.", "is_private": false, "creation_time": "2018-06-29T04:47:49Z", "bug_id": 655024, "count": 16, "time": "2018-06-29T04:47:49Z", "creator": "bug-husbandry-bot@mozilla.bugs", "tags": [], "author": "bug-husbandry-bot@mozilla.bugs", "attachment_id": null}, {"attachment_id": null, "author": "andrei.purice@softvision.com", "is_private": false, "creation_time": "2021-11-19T13:51:28Z", "text": "Hey Alfredo,\nCan you still reproduce this issue or should we close it?\nWhen I close the tab and window I no longer see the message \"Unloading window!\" - might be that the entire functionality has been changed during this time.", "id": 15663733, "raw_text": "Hey Alfredo,\nCan you still reproduce this issue or should we close it?\nWhen I close the tab and window I no longer see the message \"Unloading window!\" - might be that the entire functionality has been changed during this time.", "count": 17, "tags": [], "creator": "andrei.purice@softvision.com", "time": "2021-11-19T13:51:28Z", "bug_id": 655024}, {"attachment_id": null, "author": "mrwarper@yahoo.es", "time": "2021-12-01T15:42:13Z", "count": 18, "creator": "mrwarper@yahoo.es", "tags": [], "bug_id": 655024, "id": 15679327, "raw_text": "Hi,\nyes, apparently it's been long since closing a mere tab (as opposed to the last remaining tab or the application window) stopped triggering window.unload, so it no longer matters that it is not triggered when closing the application window either.", "creation_time": "2021-12-01T15:42:13Z", "is_private": false, "text": "Hi,\nyes, apparently it's been long since closing a mere tab (as opposed to the last remaining tab or the application window) stopped triggering window.unload, so it no longer matters that it is not triggered when closing the application window either."}]}}}