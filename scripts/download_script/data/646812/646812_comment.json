{"comments": {}, "bugs": {"646812": {"comments": [{"id": 5383053, "time": "2011-03-31T13:06:10Z", "is_private": false, "tags": [], "creation_time": "2011-03-31T13:06:10Z", "bug_id": 646812, "raw_text": "Ehsan says in bug 482909 comment 15:\n> (In reply to comment #14)\n> > In file included from ../../../dist/include/nsComponentManagerUtils.h:46,\n> >                  from ../../../dist/include/nsIComponentManager.h:164,\n> >                  from\n> > /opt/Projects/mozilla-html5/toolkit/components/feeds/nsScriptableUnescapeHTML.cpp:38:\n> > ../../../dist/include/nsCOMPtr.h: In destructor \u2018nsCOMPtr<T>::~nsCOMPtr() [with\n> > T = nsIPrincipal]\u2019:\n> > ../../../dist/include/nsTreeSanitizer.h:44:   instantiated from here\n> > ../../../dist/include/nsCOMPtr.h:531: error: invalid static_cast from type\n> > \u2018nsIPrincipal*\u2019 to type \u2018nsISupports*\u2019\n> > ../../../dist/include/nsCOMPtr.h:533: error: invalid use of incomplete type\n> > \u2018struct nsIPrincipal\u2019\n> > ../../../dist/include/nsNodeInfoManager.h:53: error: forward declaration of\n> > \u2018struct nsIPrincipal\u2019\n> > make[6]: *** [nsScriptableUnescapeHTML.o] Error 1\n> \n> Hmm, that's coming from\n> <http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsTraceRefcnt.h#80> I\n> bet.  I think that code should use NS_ISUPPORTS_CAST, which works around the\n> ambiguous possible cast path.  Can you please file a bug about that?", "author": "hsivonen@mozilla.com", "count": 0, "text": "Ehsan says in bug 482909 comment 15:\n> (In reply to comment #14)\n> > In file included from ../../../dist/include/nsComponentManagerUtils.h:46,\n> >                  from ../../../dist/include/nsIComponentManager.h:164,\n> >                  from\n> > /opt/Projects/mozilla-html5/toolkit/components/feeds/nsScriptableUnescapeHTML.cpp:38:\n> > ../../../dist/include/nsCOMPtr.h: In destructor \u2018nsCOMPtr<T>::~nsCOMPtr() [with\n> > T = nsIPrincipal]\u2019:\n> > ../../../dist/include/nsTreeSanitizer.h:44:   instantiated from here\n> > ../../../dist/include/nsCOMPtr.h:531: error: invalid static_cast from type\n> > \u2018nsIPrincipal*\u2019 to type \u2018nsISupports*\u2019\n> > ../../../dist/include/nsCOMPtr.h:533: error: invalid use of incomplete type\n> > \u2018struct nsIPrincipal\u2019\n> > ../../../dist/include/nsNodeInfoManager.h:53: error: forward declaration of\n> > \u2018struct nsIPrincipal\u2019\n> > make[6]: *** [nsScriptableUnescapeHTML.o] Error 1\n> \n> Hmm, that's coming from\n> <http://mxr.mozilla.org/mozilla-central/source/xpcom/glue/nsTraceRefcnt.h#80> I\n> bet.  I think that code should use NS_ISUPPORTS_CAST, which works around the\n> ambiguous possible cast path.  Can you please file a bug about that?", "attachment_id": null, "creator": "hsivonen@mozilla.com"}, {"count": 1, "text": "The error here is not an ambiguous cast, but a cast from an incomplete type. I don't think NS_ISUPPORTS_CAST would help at all. #including \"nsIPrincipal.h\" would, though.", "time": "2011-03-31T13:13:47Z", "author": "benjamin@smedbergs.us", "id": 5383066, "creation_time": "2011-03-31T13:13:47Z", "bug_id": 646812, "raw_text": "The error here is not an ambiguous cast, but a cast from an incomplete type. I don't think NS_ISUPPORTS_CAST would help at all. #including \"nsIPrincipal.h\" would, though.", "tags": [], "creator": "benjamin@smedbergs.us", "is_private": false, "attachment_id": null}, {"attachment_id": null, "creator": "ehsan.akhgari@gmail.com", "author": "ehsan.akhgari@gmail.com", "count": 2, "text": "(In reply to comment #1)\n> The error here is not an ambiguous cast, but a cast from an incomplete type. I\n> don't think NS_ISUPPORTS_CAST would help at all. #including \"nsIPrincipal.h\"\n> would, though.\n\nYes, but I think the static_cast that we use there right now can be a problem in the case of an ambiguous cast.  Do you think this is something that we should fix?", "is_private": false, "tags": [], "raw_text": "(In reply to comment #1)\n> The error here is not an ambiguous cast, but a cast from an incomplete type. I\n> don't think NS_ISUPPORTS_CAST would help at all. #including \"nsIPrincipal.h\"\n> would, though.\n\nYes, but I think the static_cast that we use there right now can be a problem in the case of an ambiguous cast.  Do you think this is something that we should fix?", "bug_id": 646812, "creation_time": "2011-03-31T23:48:03Z", "id": 5385074, "time": "2011-03-31T23:48:03Z"}]}}}