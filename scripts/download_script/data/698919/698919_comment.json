{"bugs": {"698919": {"comments": [{"creator": "continuation@gmail.com", "author": "continuation@gmail.com", "raw_text": "The cycle collector can cause unpleasant pause times, especially when things get leaky.  We should attempt to both reduce the length of those pauses (by improving cycle collector performance and investigating incremental approaches), and make them less annoying by being smarter about when and if we schedule the cycle collector to run.\n\nWe should also gather together bug reports where people report long CC pause times, but maybe it would make more sense to track that in a separate bug.\n\nFor reference, when I measured the cycle collector time (using shark and time logging), with a few tabs and some browsing around, cycle collector time was dominated by building the graph.  Most of the time graph building takes about 90% of the 40ms to 120ms ish cycle collector time.  Sometimes unlinking takes about a third of the cycle collector time, presumably when we close a tab and the CC has to free a bunch of things.  At the first shutdown CC, unlinking takes more time than building the graph, but I think that's unusual.  Of course, these \"normal\" CC times may not reflect the breakdown when things are getting slow, but they are a starting point.", "creation_time": "2011-11-01T22:23:03Z", "text": "The cycle collector can cause unpleasant pause times, especially when things get leaky.  We should attempt to both reduce the length of those pauses (by improving cycle collector performance and investigating incremental approaches), and make them less annoying by being smarter about when and if we schedule the cycle collector to run.\n\nWe should also gather together bug reports where people report long CC pause times, but maybe it would make more sense to track that in a separate bug.\n\nFor reference, when I measured the cycle collector time (using shark and time logging), with a few tabs and some browsing around, cycle collector time was dominated by building the graph.  Most of the time graph building takes about 90% of the 40ms to 120ms ish cycle collector time.  Sometimes unlinking takes about a third of the cycle collector time, presumably when we close a tab and the CC has to free a bunch of things.  At the first shutdown CC, unlinking takes more time than building the graph, but I think that's unusual.  Of course, these \"normal\" CC times may not reflect the breakdown when things are getting slow, but they are a starting point.", "time": "2011-11-01T22:23:03Z", "attachment_id": null, "count": 0, "is_private": false, "tags": [], "id": 5819381, "bug_id": 698919}, {"id": 5820331, "tags": [], "is_private": false, "count": 1, "bug_id": 698919, "raw_text": "There's also bug 646941 (which I haven't confirmed because I haven't seen these pauses since Firefox 3.6). Should this one be marked a dupe?", "creation_time": "2011-11-02T10:54:58Z", "attachment_id": null, "time": "2011-11-02T10:54:58Z", "text": "There's also bug 646941 (which I haven't confirmed because I haven't seen these pauses since Firefox 3.6). Should this one be marked a dupe?", "author": "ws.bugzilla@starkov.name", "creator": "ws.bugzilla@starkov.name"}, {"author": "continuation@gmail.com", "creator": "continuation@gmail.com", "attachment_id": null, "time": "2011-11-02T13:29:47Z", "text": "No, this is a meta bug for tracking various specific approaches for reducing the impact of cycle collector pause times.  It would probably be good to have a separate meta bug for tracking various instances of the CC/GC getting slower.  Unfortunately, those tend to be very hard to figure out.", "raw_text": "No, this is a meta bug for tracking various specific approaches for reducing the impact of cycle collector pause times.  It would probably be good to have a separate meta bug for tracking various instances of the CC/GC getting slower.  Unfortunately, those tend to be very hard to figure out.", "creation_time": "2011-11-02T13:29:47Z", "bug_id": 698919, "id": 5820494, "tags": [], "count": 2, "is_private": false}, {"is_private": false, "count": 3, "tags": [], "id": 5824111, "bug_id": 698919, "creation_time": "2011-11-03T18:10:54Z", "raw_text": "There's going to be a meeting tomorrow on improving/measuring browser responsiveness:  http://groups.google.com/group/mozilla.dev.planning/browse_thread/thread/d9d0d4e3675067e3\n\nI'll attend and take notes on cycle collector related things that are discussed.", "text": "There's going to be a meeting tomorrow on improving/measuring browser responsiveness:  http://groups.google.com/group/mozilla.dev.planning/browse_thread/thread/d9d0d4e3675067e3\n\nI'll attend and take notes on cycle collector related things that are discussed.", "attachment_id": null, "time": "2011-11-03T18:10:54Z", "creator": "continuation@gmail.com", "author": "continuation@gmail.com"}, {"raw_text": "Randell Jesup saw TraverseExpandoObjects() take up a huge amount of time in a long CC in bug 696761, and Peter thinks Bug 700668 will help reduce that.", "creation_time": "2011-11-08T16:17:56Z", "attachment_id": null, "time": "2011-11-08T16:17:56Z", "author": "continuation@gmail.com", "text": "Randell Jesup saw TraverseExpandoObjects() take up a huge amount of time in a long CC in bug 696761, and Peter thinks Bug 700668 will help reduce that.", "creator": "continuation@gmail.com", "id": 5834257, "count": 4, "is_private": false, "tags": [], "bug_id": 698919}, {"creator": "continuation@gmail.com", "author": "continuation@gmail.com", "text": "In terms of figuring out where we are spending time, Smaug says \"looks like in some cases unlinking takes more time than unroot, but not always. And rooting is quite cheap\".", "time": "2011-11-09T18:12:55Z", "attachment_id": null, "raw_text": "In terms of figuring out where we are spending time, Smaug says \"looks like in some cases unlinking takes more time than unroot, but not always. And rooting is quite cheap\".", "creation_time": "2011-11-09T18:12:55Z", "bug_id": 698919, "is_private": false, "count": 5, "tags": [], "id": 5837512}, {"id": 5886357, "tags": [], "count": 6, "is_private": false, "bug_id": 698919, "creation_time": "2011-12-01T21:16:34Z", "raw_text": "I guess I'll mark this as [Snappy:P1], as the cycle collector is a big source of pauses, but I'm not sure if a meta bug is appropriate for tracking like this or not.", "time": "2011-12-01T21:16:34Z", "attachment_id": null, "text": "I guess I'll mark this as [Snappy:P1], as the cycle collector is a big source of pauses, but I'm not sure if a meta bug is appropriate for tracking like this or not.", "author": "continuation@gmail.com", "creator": "continuation@gmail.com"}, {"creator": "continuation@gmail.com", "author": "continuation@gmail.com", "text": "Moved a bunch of these bugs into a sub-meta-bug.", "time": "2012-01-09T18:42:20Z", "attachment_id": null, "creation_time": "2012-01-09T18:42:20Z", "raw_text": "Moved a bunch of these bugs into a sub-meta-bug.", "bug_id": 698919, "tags": [], "is_private": false, "count": 7, "id": 5965895}, {"creator": "jean.claveau@c277.fr", "author": "jean.claveau@c277.fr", "raw_text": "I guess it's now effective on nightly because ffx  has massively improved its score on the spinning balls v8 bench (http://v8.googlecode.com/svn/branches/bleeding_edge/benchmarks/spinning-balls/index.html).\n\nA few weeks ago, I had around 800ms delays each 7 seconds (even after Incremental GC activation) and now the biggest one is around 400ms.\n\nYou made a wonderful work and without loosing this big part (1/3) of balls managed in less than 20ms.\n\nBravo and merci to make the web ( so mine :) ) better!", "creation_time": "2012-04-24T13:17:14Z", "text": "I guess it's now effective on nightly because ffx  has massively improved its score on the spinning balls v8 bench (http://v8.googlecode.com/svn/branches/bleeding_edge/benchmarks/spinning-balls/index.html).\n\nA few weeks ago, I had around 800ms delays each 7 seconds (even after Incremental GC activation) and now the biggest one is around 400ms.\n\nYou made a wonderful work and without loosing this big part (1/3) of balls managed in less than 20ms.\n\nBravo and merci to make the web ( so mine :) ) better!", "attachment_id": null, "time": "2012-04-24T13:17:14Z", "tags": [], "is_private": false, "count": 8, "id": 6248790, "bug_id": 698919}, {"creator": "continuation@gmail.com", "author": "continuation@gmail.com", "raw_text": "Thanks for the feedback!  Personally, at least when testing with nothing else open in my browser, it was always GC pauses that were happening, not CC.  billm has landed a number of GC improvements over the last few weeks to improve incremental GC, so that's probably more to blame for your improvement than any changes to the CC we have made.", "creation_time": "2012-04-24T15:20:24Z", "text": "Thanks for the feedback!  Personally, at least when testing with nothing else open in my browser, it was always GC pauses that were happening, not CC.  billm has landed a number of GC improvements over the last few weeks to improve incremental GC, so that's probably more to blame for your improvement than any changes to the CC we have made.", "attachment_id": null, "time": "2012-04-24T15:20:24Z", "count": 9, "is_private": false, "tags": [], "id": 6249166, "bug_id": 698919}, {"bug_id": 698919, "count": 10, "is_private": false, "tags": [], "id": 6249532, "text": "Ok thanks for the explanation and for your work, of you and billm, again.\nI just thought that a better cycles management meant less garbage to deal with for the CG (but I have not enough time to go deep in FFX's sources to be sure).\n\n\nAnyway, it's a pleasure to see the fast evolution of Mozilla.", "attachment_id": null, "time": "2012-04-24T16:51:48Z", "creation_time": "2012-04-24T16:51:48Z", "raw_text": "Ok thanks for the explanation and for your work, of you and billm, again.\nI just thought that a better cycles management meant less garbage to deal with for the CG (but I have not enough time to go deep in FFX's sources to be sure).\n\n\nAnyway, it's a pleasure to see the fast evolution of Mozilla.", "creator": "jean.claveau@c277.fr", "author": "jean.claveau@c277.fr"}, {"count": 11, "is_private": false, "tags": [], "id": 6256344, "bug_id": 698919, "raw_text": "Noming for Kilimanjaro blocking due to the requirement \"Content performance (gc+cc pauses and fps)\". Note that there may be a more specific subset of this work that we actually want to target.", "creation_time": "2012-04-26T14:05:40Z", "text": "Noming for Kilimanjaro blocking due to the requirement \"Content performance (gc+cc pauses and fps)\". Note that there may be a more specific subset of this work that we actually want to target.", "attachment_id": null, "time": "2012-04-26T14:05:40Z", "creator": "lmandel@mozilla.com", "author": "lmandel@mozilla.com"}, {"raw_text": "It is probably bug 741417, since when there are no cycles to collect, CC time should be\nreasonable low, almost low enough.", "creation_time": "2012-04-26T14:10:16Z", "attachment_id": null, "time": "2012-04-26T14:10:16Z", "text": "It is probably bug 741417, since when there are no cycles to collect, CC time should be\nreasonable low, almost low enough.", "id": 6256358, "tags": [], "count": 12, "is_private": false, "bug_id": 698919, "author": "bugs@pettay.fi", "creator": "bugs@pettay.fi"}, {"text": "Dropping Kilimanjaro nom from this bug in favour of bug 741417 and bug 728407 as suggested by Olli.", "creator": "lmandel@mozilla.com", "time": "2012-04-26T14:29:13Z", "attachment_id": null, "author": "lmandel@mozilla.com", "creation_time": "2012-04-26T14:29:13Z", "raw_text": "Dropping Kilimanjaro nom from this bug in favour of bug 741417 and bug 728407 as suggested by Olli.", "bug_id": 698919, "count": 13, "is_private": false, "tags": [], "id": 6256409}, {"creator": "continuation@gmail.com", "author": "continuation@gmail.com", "raw_text": "This is a meta bug, and CC performance is not so bad any more, so this doesn't really need an assignee or a Snappy tag.", "creation_time": "2012-09-14T18:26:23Z", "text": "This is a meta bug, and CC performance is not so bad any more, so this doesn't really need an assignee or a Snappy tag.", "time": "2012-09-14T18:26:23Z", "attachment_id": null, "is_private": false, "count": 14, "tags": [], "id": 6636031, "bug_id": 698919}]}}, "comments": {}}