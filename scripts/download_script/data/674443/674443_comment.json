{"bugs": {"674443": {"comments": [{"raw_text": "Basically, this patch tries to make the select element dropdown menu looks like any other menu in the UI. That's how it should look like on MacOS X, GTK and Windows Vista/7. I'm not sure Windows XP is expecting that but I do not have a Windows XP VM around.\n\nI marked this bug as blocking bug 402625 because it seems that MacOS X dropdown menus do not look native with this patch. I will use bug 402625 to fix that for MacOS X.\n\nI will need people to confirm that it looks correct on other GTK theme than mine and on Windows XP/Vista/7 (if you are in CC and you wonder why, that might be the reason ;))", "attachment_id": 548670, "id": 5615716, "creator": "mounir@lamouri.fr", "is_private": false, "time": "2011-07-27T02:51:54Z", "tags": [], "text": "Created attachment 548670\nPatch v1\n\nBasically, this patch tries to make the select element dropdown menu looks like any other menu in the UI. That's how it should look like on MacOS X, GTK and Windows Vista/7. I'm not sure Windows XP is expecting that but I do not have a Windows XP VM around.\n\nI marked this bug as blocking bug 402625 because it seems that MacOS X dropdown menus do not look native with this patch. I will use bug 402625 to fix that for MacOS X.\n\nI will need people to confirm that it looks correct on other GTK theme than mine and on Windows XP/Vista/7 (if you are in CC and you wonder why, that might be the reason ;))", "author": "mounir@lamouri.fr", "creation_time": "2011-07-27T02:51:54Z", "count": 0, "bug_id": 674443}, {"count": 1, "is_private": false, "creator": "mounir@lamouri.fr", "text": "Created attachment 548672\nPatch v1\n\nA part of another part came with the previously attached one...", "tags": [], "time": "2011-07-27T02:53:55Z", "bug_id": 674443, "creation_time": "2011-07-27T02:53:55Z", "author": "mounir@lamouri.fr", "raw_text": "A part of another part came with the previously attached one...", "attachment_id": 548672, "id": 5615718}, {"count": 2, "creator": "joe@drew.ca", "is_private": false, "time": "2011-07-27T03:01:29Z", "tags": [], "bug_id": 674443, "text": "Can you attach before/after screenshots?", "author": "joe@drew.ca", "creation_time": "2011-07-27T03:01:29Z", "raw_text": "Can you attach before/after screenshots?", "attachment_id": null, "id": 5615726}, {"raw_text": "(In reply to comment #2)\n> Can you attach before/after screenshots?\n\nI will but I've just seen an unexpected side effect on the select element height which gets even worse given that the text doesn't re-align.", "attachment_id": null, "id": 5615743, "count": 3, "is_private": false, "creator": "mounir@lamouri.fr", "text": "(In reply to comment #2)\n> Can you attach before/after screenshots?\n\nI will but I've just seen an unexpected side effect on the select element height which gets even worse given that the text doesn't re-align.", "tags": [], "bug_id": 674443, "time": "2011-07-27T03:14:51Z", "creation_time": "2011-07-27T03:14:51Z", "author": "mounir@lamouri.fr"}, {"bug_id": 674443, "count": 4, "author": "mounir@lamouri.fr", "creation_time": "2011-07-27T03:15:39Z", "tags": [], "time": "2011-07-27T03:15:39Z", "text": "CCing bz in case of he has an idea of what causes the behavior described in comment 3.", "creator": "mounir@lamouri.fr", "is_private": false, "id": 5615744, "attachment_id": null, "raw_text": "CCing bz in case of he has an idea of what causes the behavior described in comment 3."}, {"count": 5, "bug_id": 674443, "creator": "mounir@lamouri.fr", "is_private": false, "author": "mounir@lamouri.fr", "creation_time": "2011-07-27T03:19:44Z", "time": "2011-07-27T03:19:44Z", "tags": [], "text": "Created attachment 548673\nScreenshot: before", "attachment_id": 548673, "raw_text": "", "id": 5615750}, {"id": 5615753, "raw_text": "", "attachment_id": 548675, "text": "Created attachment 548675\nScreenshot: after", "tags": [], "time": "2011-07-27T03:20:23Z", "creation_time": "2011-07-27T03:20:23Z", "author": "mounir@lamouri.fr", "is_private": false, "creator": "mounir@lamouri.fr", "bug_id": 674443, "count": 6}, {"count": 7, "bug_id": 674443, "attachment_id": null, "raw_text": "Unfortunately, on Mac, instead of just not being native, the dropdown menu is quite broken :(\n\nHope stuff don't get worse on Windows :)", "id": 5615771, "is_private": false, "creator": "mounir@lamouri.fr", "creation_time": "2011-07-27T03:36:17Z", "author": "mounir@lamouri.fr", "text": "Unfortunately, on Mac, instead of just not being native, the dropdown menu is quite broken :(\n\nHope stuff don't get worse on Windows :)", "tags": [], "time": "2011-07-27T03:36:17Z"}, {"text": "You mean the height of the actual combobox increases?\n\nThat's quite purposeful.  See nsComboboxDisplayFrame::Reflow and the comment at the start of nsComboboxControlFrame::Reflow.  Basically, we want to be able to show any option in the display area without the options being cut off and without having to resize the combobox when the selected option changes.  So we size the display area to the size of the options.  Your patch is changing the size of the options, so changes the size of the display area....\n\nThat said, the current code is assuming that the height of options is due solely to the text in them.  With this change, I bet that's no longer true due to them ending up with nonzero padding or something.  So it would makes sense to account for that when computing the display area height.", "tags": [], "bug_id": 674443, "time": "2011-07-27T03:51:23Z", "creation_time": "2011-07-27T03:51:23Z", "author": "bzbarsky@mit.edu", "count": 8, "is_private": false, "creator": "bzbarsky@mit.edu", "id": 5615784, "raw_text": "You mean the height of the actual combobox increases?\n\nThat's quite purposeful.  See nsComboboxDisplayFrame::Reflow and the comment at the start of nsComboboxControlFrame::Reflow.  Basically, we want to be able to show any option in the display area without the options being cut off and without having to resize the combobox when the selected option changes.  So we size the display area to the size of the options.  Your patch is changing the size of the options, so changes the size of the display area....\n\nThat said, the current code is assuming that the height of options is due solely to the text in them.  With this change, I bet that's no longer true due to them ending up with nonzero padding or something.  So it would makes sense to account for that when computing the display area height.", "attachment_id": null}, {"count": 9, "is_private": false, "creator": "bzbarsky@mit.edu", "text": "One possible option is to stop worrying about the actual option text when computing the combobox height and just use the font-size of the combobox....", "bug_id": 674443, "time": "2011-07-27T03:54:19Z", "tags": [], "creation_time": "2011-07-27T03:54:19Z", "author": "bzbarsky@mit.edu", "raw_text": "One possible option is to stop worrying about the actual option text when computing the combobox height and just use the font-size of the combobox....", "attachment_id": null, "id": 5615787}, {"author": "henry.fai.hang.chan@gmail.com", "creation_time": "2012-10-08T12:08:09Z", "tags": [], "time": "2012-10-08T12:08:09Z", "bug_id": 674443, "text": "can this be fixed? this minor bug is extremely annoying compared to the whole design of firefox", "creator": "henry.fai.hang.chan@gmail.com", "is_private": false, "count": 10, "id": 6707399, "attachment_id": null, "raw_text": "can this be fixed? this minor bug is extremely annoying compared to the whole design of firefox"}, {"attachment_id": null, "raw_text": "(In reply to henry.fai.hang.chan from comment #10)\n> can this be fixed? this minor bug is extremely annoying compared to the\n> whole design of firefox\n\n+1", "id": 6707536, "is_private": false, "creator": "sierkb@gmx.de", "count": 11, "creation_time": "2012-10-08T13:23:43Z", "author": "sierkb@gmx.de", "text": "(In reply to henry.fai.hang.chan from comment #10)\n> can this be fixed? this minor bug is extremely annoying compared to the\n> whole design of firefox\n\n+1", "bug_id": 674443, "tags": [], "time": "2012-10-08T13:23:43Z"}, {"id": 7588659, "raw_text": "Any progress in this issue? :)", "attachment_id": null, "bug_id": 674443, "time": "2013-06-30T02:32:07Z", "tags": [], "text": "Any progress in this issue? :)", "author": "sierkb@gmx.de", "creation_time": "2013-06-30T02:32:07Z", "count": 12, "creator": "sierkb@gmx.de", "is_private": false}, {"attachment_id": 791334, "raw_text": "This patch makes the dropdown look native for GTK. I had to modify some widget code so I will likely have to modify other widgets to enable the feature on other platforms.", "id": 7756965, "is_private": false, "creator": "mounir@lamouri.fr", "count": 13, "creation_time": "2013-08-16T16:45:18Z", "author": "mounir@lamouri.fr", "text": "Created attachment 791334\nPatch with GTK support only\n\nThis patch makes the dropdown look native for GTK. I had to modify some widget code so I will likely have to modify other widgets to enable the feature on other platforms.", "tags": [], "bug_id": 674443, "time": "2013-08-16T16:45:18Z"}, {"attachment_id": 791358, "raw_text": "", "id": 7757126, "is_private": false, "creator": "mounir@lamouri.fr", "count": 14, "creation_time": "2013-08-16T17:27:22Z", "author": "mounir@lamouri.fr", "text": "Created attachment 791358\nPart 3 - Fix Cocoa backend", "bug_id": 674443, "time": "2013-08-16T17:27:22Z", "tags": []}, {"attachment_id": 791362, "raw_text": "", "id": 7757170, "is_private": false, "creator": "mounir@lamouri.fr", "count": 15, "creation_time": "2013-08-16T17:36:21Z", "author": "mounir@lamouri.fr", "text": "Created attachment 791362\nPart 1 - Update forms.css", "bug_id": 674443, "tags": [], "time": "2013-08-16T17:36:21Z"}, {"raw_text": "", "attachment_id": 791363, "id": 7757174, "creator": "mounir@lamouri.fr", "is_private": false, "tags": [], "time": "2013-08-16T17:36:54Z", "text": "Created attachment 791363\nPart 2 - Fix GTK backend", "author": "mounir@lamouri.fr", "creation_time": "2013-08-16T17:36:54Z", "count": 16, "bug_id": 674443}, {"count": 17, "bug_id": 674443, "creator": "mounir@lamouri.fr", "is_private": false, "time": "2013-08-16T17:44:01Z", "tags": [], "text": "Created attachment 791367\nPart 4 - Fix Windows backend", "author": "mounir@lamouri.fr", "creation_time": "2013-08-16T17:44:01Z", "raw_text": "", "attachment_id": 791367, "id": 7757200}, {"attachment_id": 791358, "raw_text": "You can move nsNativeThemeWin::IsMenuActive to xpwidgets/nsNativeTheme, make your changes there, and use that from the Cocoa backend instead.", "id": 7759811, "is_private": false, "creator": "mstange.moz@gmail.com", "count": 18, "creation_time": "2013-08-17T19:23:35Z", "author": "mstange.moz@gmail.com", "text": "Comment on attachment 791358\nPart 3 - Fix Cocoa backend\n\nYou can move nsNativeThemeWin::IsMenuActive to xpwidgets/nsNativeTheme, make your changes there, and use that from the Cocoa backend instead.", "time": "2013-08-17T19:23:35Z", "tags": [], "bug_id": 674443}, {"raw_text": ">+        // We want the item to look like hovered if it is checked too so the\n>+        // user can see the currently selected option easily.\n>+        aState->inHover |= GetContentState(aFrame, aWidgetType).\n>+                             HasState(NS_EVENT_STATE_CHECKED);\n\nIs there any time when NS_EVENT_STATE_HOVER will be set here but not NS_EVENT_STATE_CHECKED?\nHaving the highlight state set for both flags suggests there might be 2 options highlighted at one time.\nI assume that won't happen?\nWould replacing \"|=\" with \"=\" here behave as intended?\n\nI assume you only need my review of the widget/gtk2 changes.", "attachment_id": 791363, "id": 7761139, "creator": "karlt@mozbugz.karlt.net", "is_private": false, "time": "2013-08-19T02:51:35Z", "tags": [], "text": "Comment on attachment 791363\nPart 2 - Fix GTK backend\n\n>+        // We want the item to look like hovered if it is checked too so the\n>+        // user can see the currently selected option easily.\n>+        aState->inHover |= GetContentState(aFrame, aWidgetType).\n>+                             HasState(NS_EVENT_STATE_CHECKED);\n\nIs there any time when NS_EVENT_STATE_HOVER will be set here but not NS_EVENT_STATE_CHECKED?\nHaving the highlight state set for both flags suggests there might be 2 options highlighted at one time.\nI assume that won't happen?\nWould replacing \"|=\" with \"=\" here behave as intended?\n\nI assume you only need my review of the widget/gtk2 changes.", "author": "karlt@mozbugz.karlt.net", "creation_time": "2013-08-19T02:51:35Z", "count": 19, "bug_id": 674443}, {"bug_id": 674443, "count": 20, "tags": [], "time": "2013-08-26T11:52:08Z", "text": "Comment on attachment 791367\nPart 4 - Fix Windows backend\n\nReview of attachment 791367:\n-----------------------------------------------------------------\n\n::: widget/windows/nsNativeThemeWin.cpp\n@@ +1420,5 @@\n>  \n> +        if (isHover ||\n> +            (aFrame->GetContent()->IsHTML() &&\n> +             eventState.HasAtLeastOneOfStates(NS_EVENT_STATE_HOVER |\n> +                                              NS_EVENT_STATE_CHECKED))) {\n\nCan you break this out into a helper similar to IsMenuActive for html elements?", "author": "jmathies@mozilla.com", "creation_time": "2013-08-26T11:52:08Z", "creator": "jmathies@mozilla.com", "is_private": false, "id": 7788736, "raw_text": "Review of attachment 791367:\n-----------------------------------------------------------------\n\n::: widget/windows/nsNativeThemeWin.cpp\n@@ +1420,5 @@\n>  \n> +        if (isHover ||\n> +            (aFrame->GetContent()->IsHTML() &&\n> +             eventState.HasAtLeastOneOfStates(NS_EVENT_STATE_HOVER |\n> +                                              NS_EVENT_STATE_CHECKED))) {\n\nCan you break this out into a helper similar to IsMenuActive for html elements?", "attachment_id": 791367}, {"id": 11392448, "raw_text": "The last patch for this lies three years back. Mounir, do you still intend to fix this or should we unassign the bug for now?\n\nSebastian", "attachment_id": null, "text": "The last patch for this lies three years back. Mounir, do you still intend to fix this or should we unassign the bug for now?\n\nSebastian", "time": "2016-05-09T09:54:08Z", "bug_id": 674443, "tags": [], "creation_time": "2016-05-09T09:54:08Z", "author": "sebastianzartner@gmail.com", "count": 21, "is_private": false, "creator": "sebastianzartner@gmail.com"}, {"count": 22, "bug_id": 674443, "creator": "mounir@lamouri.fr", "is_private": false, "time": "2016-05-10T08:32:19Z", "tags": [], "text": "Fair to say I will not fix this :)", "author": "mounir@lamouri.fr", "creation_time": "2016-05-10T08:32:19Z", "raw_text": "Fair to say I will not fix this :)", "attachment_id": null, "id": 11395758}, {"count": 23, "bug_id": 674443, "is_private": false, "creator": "dbaron@dbaron.org", "text": "We probably did a bunch of this when we switched to e10s selects.", "time": "2017-10-16T22:39:24Z", "tags": [], "creation_time": "2017-10-16T22:39:24Z", "author": "dbaron@dbaron.org", "raw_text": "We probably did a bunch of this when we switched to e10s selects.", "attachment_id": null, "id": 12764377}]}}, "comments": {}}