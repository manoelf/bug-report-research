{"bugs": {"649802": {"comments": [{"time": "2011-04-13T21:15:38Z", "bug_id": 649802, "count": 0, "creator": "davidbourguignon.net@gmail.com", "author": "davidbourguignon.net@gmail.com", "tags": [], "is_private": false, "raw_text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0) Gecko/20100101 Firefox/4.0\n\nThe print function of Firefox 4.0 has sometimes a strange behavior. (I am in fact always printing to PDF files, using currently PDFCreator 1.2, latest.) It works quite well on most pages I have seen, but not very well on a very simple, valid XHTML test page... I have checked with Opera 11.0, latest, and it works perfectly, therefore the problem comes most probably from Firefox 4.0.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Go to http://www.davidbourguignon.net/texts/critique-du-film-home-de-yann-arthus-bertrand.html\n2. Click on the menu File > Print > Print to PDF (when PDFCreator 1.2 is installed as PDF printer)\n3. Look at the resulting PDF : page 1 is roughly OK, page 2 and over are completely wrong...\n4. Compare the output of the print to PDF man\u0153uver on Opera 11: it works perfectly.\nActual Results:  \nWrong PDF output. (See file pdfcreator1.2-firefox4.pdf in attachment.)\n\nExpected Results:  \nCorrect PDF output. (See file pdfcreator1.2-opera11.pdf in attachment.)\n\nIt seems that similar bugs have been reported in the past... (See bug 384841 for example.) I will try to attach the mentioned PDFs for clarity of the demonstration.", "text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0) Gecko/20100101 Firefox/4.0\nBuild Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0) Gecko/20100101 Firefox/4.0\n\nThe print function of Firefox 4.0 has sometimes a strange behavior. (I am in fact always printing to PDF files, using currently PDFCreator 1.2, latest.) It works quite well on most pages I have seen, but not very well on a very simple, valid XHTML test page... I have checked with Opera 11.0, latest, and it works perfectly, therefore the problem comes most probably from Firefox 4.0.\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Go to http://www.davidbourguignon.net/texts/critique-du-film-home-de-yann-arthus-bertrand.html\n2. Click on the menu File > Print > Print to PDF (when PDFCreator 1.2 is installed as PDF printer)\n3. Look at the resulting PDF : page 1 is roughly OK, page 2 and over are completely wrong...\n4. Compare the output of the print to PDF man\u0153uver on Opera 11: it works perfectly.\nActual Results:  \nWrong PDF output. (See file pdfcreator1.2-firefox4.pdf in attachment.)\n\nExpected Results:  \nCorrect PDF output. (See file pdfcreator1.2-opera11.pdf in attachment.)\n\nIt seems that similar bugs have been reported in the past... (See bug 384841 for example.) I will try to attach the mentioned PDFs for clarity of the demonstration.", "id": 5407740, "attachment_id": null, "creation_time": "2011-04-13T21:15:38Z"}, {"tags": [], "is_private": false, "raw_text": "", "text": "Created attachment 525804\nWrong PDF output", "id": 5407743, "attachment_id": 525804, "creation_time": "2011-04-13T21:16:31Z", "time": "2011-04-13T21:16:31Z", "bug_id": 649802, "count": 1, "creator": "davidbourguignon.net@gmail.com", "author": "davidbourguignon.net@gmail.com"}, {"creation_time": "2011-04-13T21:17:15Z", "author": "davidbourguignon.net@gmail.com", "text": "Created attachment 525806\nCorrect PDF output", "creator": "davidbourguignon.net@gmail.com", "id": 5407747, "attachment_id": 525806, "count": 2, "bug_id": 649802, "raw_text": "", "tags": [], "is_private": false, "time": "2011-04-13T21:17:15Z"}, {"id": 5408048, "attachment_id": null, "text": "Does the page appear correctly in print preview?", "creation_time": "2011-04-13T22:40:37Z", "is_private": false, "tags": [], "raw_text": "Does the page appear correctly in print preview?", "creator": "fmdevelopertim@gmail.com", "author": "fmdevelopertim@gmail.com", "time": "2011-04-13T22:40:37Z", "bug_id": 649802, "count": 3}, {"is_private": false, "tags": [], "time": "2011-04-13T22:54:38Z", "count": 4, "raw_text": "Thanks Tim for your quick reply. Nope, I just checked: the page looks exactly the same in the print preview as in the PDF...", "bug_id": 649802, "author": "davidbourguignon.net@gmail.com", "id": 5408086, "attachment_id": null, "creator": "davidbourguignon.net@gmail.com", "text": "Thanks Tim for your quick reply. Nope, I just checked: the page looks exactly the same in the print preview as in the PDF...", "creation_time": "2011-04-13T22:54:38Z"}, {"creation_time": "2011-04-14T03:32:15Z", "attachment_id": null, "id": 5408657, "text": "The same issue occurs in 3.6\n\nChanging the following css rule:\n\ndiv.texts-body {\n    font-family: \"Trebuchet MS\",Helvetica,sans-serif;\n    margin-left: 20%;\n    margin-right: 20%;\n    margin-top: 300px;\n    position: absolute;\n\nto\n\ndiv.texts-body {\n    font-family: \"Trebuchet MS\",Helvetica,sans-serif;\n    margin-top: 300px;\n    position: absolute;\n\nresolves the issue.", "raw_text": "The same issue occurs in 3.6\n\nChanging the following css rule:\n\ndiv.texts-body {\n    font-family: \"Trebuchet MS\",Helvetica,sans-serif;\n    margin-left: 20%;\n    margin-right: 20%;\n    margin-top: 300px;\n    position: absolute;\n\nto\n\ndiv.texts-body {\n    font-family: \"Trebuchet MS\",Helvetica,sans-serif;\n    margin-top: 300px;\n    position: absolute;\n\nresolves the issue.", "is_private": false, "tags": [], "author": "fmdevelopertim@gmail.com", "creator": "fmdevelopertim@gmail.com", "count": 5, "bug_id": 649802, "time": "2011-04-14T03:32:15Z"}, {"author": "davidbourguignon.net@gmail.com", "creator": "davidbourguignon.net@gmail.com", "text": "Alright Tim, but this is no longer my original layout! :-)\n\nThe CSS I'm using is fully valid according to W3C validator. Yes, the issue was also there in Firefox 3.6. It's part of the lingering printing problems that have never been addressed apparently. (There are many bug reports about that, I mentioned bug 384841 for example.)\n\nDoes this mean that Mozilla does not intend to implement fully the CSS specifications for printing HTML pages from Firefox?\n\nThanks in advance for your help!", "attachment_id": null, "id": 5408933, "creation_time": "2011-04-14T08:08:47Z", "tags": [], "is_private": false, "time": "2011-04-14T08:08:47Z", "count": 6, "bug_id": 649802, "raw_text": "Alright Tim, but this is no longer my original layout! :-)\n\nThe CSS I'm using is fully valid according to W3C validator. Yes, the issue was also there in Firefox 3.6. It's part of the lingering printing problems that have never been addressed apparently. (There are many bug reports about that, I mentioned bug 384841 for example.)\n\nDoes this mean that Mozilla does not intend to implement fully the CSS specifications for printing HTML pages from Firefox?\n\nThanks in advance for your help!"}, {"is_private": false, "tags": [], "raw_text": "(In reply to comment #6)\n> Alright Tim, but this is no longer my original layout! :-)\n> The CSS I'm using is fully valid according to W3C validator.\n[etc]\n\nI don't think Tim was suggesting \"Change your site to this and the problem will be fixed.\"  I think he was just offering some insight into what's going on, for the purpose of helping to get to the root of the problem in Firefox.\n\n> Does this mean that Mozilla does not intend to implement fully the CSS\n> specifications for printing HTML pages from Firefox?\n\nHopefully the above addresses this loaded question, too. :)", "attachment_id": null, "id": 5409727, "text": "(In reply to comment #6)\n> Alright Tim, but this is no longer my original layout! :-)\n> The CSS I'm using is fully valid according to W3C validator.\n[etc]\n\nI don't think Tim was suggesting \"Change your site to this and the problem will be fixed.\"  I think he was just offering some insight into what's going on, for the purpose of helping to get to the root of the problem in Firefox.\n\n> Does this mean that Mozilla does not intend to implement fully the CSS\n> specifications for printing HTML pages from Firefox?\n\nHopefully the above addresses this loaded question, too. :)", "creation_time": "2011-04-14T17:03:19Z", "time": "2011-04-14T17:03:19Z", "bug_id": 649802, "count": 7, "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com"}, {"count": 8, "bug_id": 649802, "raw_text": "Thanks Daniel for the explanation. I should have been more careful in replying to Tim's answer... Sorry for this mishap. Thanks in advance for your help guys!", "tags": [], "is_private": false, "time": "2011-04-14T17:56:28Z", "creation_time": "2011-04-14T17:56:28Z", "author": "davidbourguignon.net@gmail.com", "creator": "davidbourguignon.net@gmail.com", "text": "Thanks Daniel for the explanation. I should have been more careful in replying to Tim's answer... Sorry for this mishap. Thanks in advance for your help guys!", "attachment_id": null, "id": 5409908}, {"author": "fmdevelopertim@gmail.com", "attachment_id": null, "id": 5698877, "creator": "fmdevelopertim@gmail.com", "text": "Still an issue on Mozilla/5.0 (Windows NT 5.1; rv:9.0a1) Gecko/20110903 Firefox/9.0a1 ID:20110903030832", "creation_time": "2011-09-04T04:43:05Z", "is_private": false, "tags": [], "time": "2011-09-04T04:43:05Z", "count": 9, "raw_text": "Still an issue on Mozilla/5.0 (Windows NT 5.1; rv:9.0a1) Gecko/20110903 Firefox/9.0a1 ID:20110903030832", "bug_id": 649802}, {"time": "2011-09-04T05:59:42Z", "count": 10, "bug_id": 649802, "author": "dholbert@mozilla.com", "creator": "dholbert@mozilla.com", "tags": [], "is_private": false, "raw_text": "(clarifying bug summary)\n\nI believe I've seen another similar open bug, but I don't know the bug number offhand.  Flagging as possible-duplicate.", "text": "(clarifying bug summary)\n\nI believe I've seen another similar open bug, but I don't know the bug number offhand.  Flagging as possible-duplicate.", "id": 5698899, "attachment_id": null, "creation_time": "2011-09-04T05:59:42Z"}, {"creation_time": "2017-11-05T04:48:27Z", "author": "fantasai.bugs@inkedblade.net", "text": "Created attachment 8925320\ntestcase", "creator": "fantasai.bugs@inkedblade.net", "attachment_id": 8925320, "id": 12817867, "count": 11, "bug_id": 649802, "raw_text": "", "tags": [], "is_private": false, "time": "2017-11-05T04:48:27Z"}, {"time": "2017-11-05T05:15:02Z", "is_private": false, "tags": [], "raw_text": "Seems to me the affected cases (this bug, and bug 1033149) are all related to overflow containers.\nAnd I'm guessing the bug is here:\n\nhttps://dxr.mozilla.org/mozilla-central/rev/b5a3b8ef6902998507fc881b6d628b055457fe31/layout/generic/nsContainerFrame.cpp#1171\n      nsSize containerSize = aReflowInput.AvailableSize(wm).GetPhysicalSize(wm);\n      LogicalRect prevRect = prevInFlow->GetLogicalRect(wm, containerSize);\n\n      // Initialize reflow params\n      LogicalSize availSpace(wm, prevRect.ISize(wm),\n                             aReflowInput.AvailableSize(wm).BSize(wm));\n\nAfaict, we're passing in the frame's intended width as its available space; which works only if there's no margin. If there's a margin, it'll accumulate page by page exactly as we're seeing here. (What's *intended* to happen is that the frame gets the same width calculation as its prev-in-flow. I'm not 100% sure what would be the correct way to make that happen for all layout types, but this method obviously isn't it.)", "bug_id": 649802, "count": 12, "attachment_id": null, "id": 12817872, "text": "Seems to me the affected cases (this bug, and bug 1033149) are all related to overflow containers.\nAnd I'm guessing the bug is here:\n\nhttps://dxr.mozilla.org/mozilla-central/rev/b5a3b8ef6902998507fc881b6d628b055457fe31/layout/generic/nsContainerFrame.cpp#1171\n      nsSize containerSize = aReflowInput.AvailableSize(wm).GetPhysicalSize(wm);\n      LogicalRect prevRect = prevInFlow->GetLogicalRect(wm, containerSize);\n\n      // Initialize reflow params\n      LogicalSize availSpace(wm, prevRect.ISize(wm),\n                             aReflowInput.AvailableSize(wm).BSize(wm));\n\nAfaict, we're passing in the frame's intended width as its available space; which works only if there's no margin. If there's a margin, it'll accumulate page by page exactly as we're seeing here. (What's *intended* to happen is that the frame gets the same width calculation as its prev-in-flow. I'm not 100% sure what would be the correct way to make that happen for all layout types, but this method obviously isn't it.)", "creator": "fantasai.bugs@inkedblade.net", "author": "fantasai.bugs@inkedblade.net", "creation_time": "2017-11-05T05:15:02Z"}, {"bug_id": 649802, "count": 13, "time": "2020-04-07T20:19:42Z", "creator": "dholbert@mozilla.com", "author": "dholbert@mozilla.com", "raw_text": "", "tags": [], "is_private": false, "creation_time": "2020-04-07T20:19:42Z", "text": "*** Bug 1033149 has been marked as a duplicate of this bug. ***", "id": 14741452, "attachment_id": null}]}}, "comments": {}}