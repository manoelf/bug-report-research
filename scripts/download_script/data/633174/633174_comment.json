{"bugs": {"633174": {"comments": [{"creation_time": "2011-02-10T14:08:54Z", "text": "After bug 499292 has landed, the text is not displayed even after the timeout.", "id": 5269379, "raw_text": "After bug 499292 has landed, the text is not displayed even after the timeout.", "tags": [], "creator": "anthony@ricaud.me", "count": 0, "bug_id": 633174, "author": "anthony@ricaud.me", "is_private": false, "time": "2011-02-10T14:08:54Z", "attachment_id": null}, {"is_private": false, "time": "2011-02-10T14:21:01Z", "attachment_id": null, "text": "This looks like a blocker to me....", "creation_time": "2011-02-10T14:21:01Z", "raw_text": "This looks like a blocker to me....", "id": 5269405, "bug_id": 633174, "count": 1, "tags": [], "creator": "bzbarsky@mit.edu", "author": "bzbarsky@mit.edu"}, {"author": "anthony@ricaud.me", "attachment_id": null, "bug_id": 633174, "creator": "anthony@ricaud.me", "tags": [], "count": 2, "time": "2011-02-10T15:12:42Z", "text": "Looks like it is a problem with my local build. With a mozilla-central build[1], it's ok.\n\nAlso weird, other websites are displaying @font-face just fine with my local build.\n\n[1] http://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-macosx64/1297344448/", "creation_time": "2011-02-10T15:12:42Z", "is_private": false, "raw_text": "Looks like it is a problem with my local build. With a mozilla-central build[1], it's ok.\n\nAlso weird, other websites are displaying @font-face just fine with my local build.\n\n[1] http://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-macosx64/1297344448/", "id": 5269504}, {"author": "anthony@ricaud.me", "attachment_id": null, "bug_id": 633174, "creator": "anthony@ricaud.me", "time": "2011-02-10T18:40:29Z", "count": 3, "tags": [], "text": "I did a clean build after rm -rf objdir.\n\nSame problem. My mozconfig only contains\nmk_add_options MOZ_MAKE_FLAGS=\"-j5 -s\"\n\nI'm on OS X 10.6.6.", "is_private": false, "creation_time": "2011-02-10T18:40:29Z", "raw_text": "I did a clean build after rm -rf objdir.\n\nSame problem. My mozconfig only contains\nmk_add_options MOZ_MAKE_FLAGS=\"-j5 -s\"\n\nI'm on OS X 10.6.6.", "id": 5270087}, {"bug_id": 633174, "time": "2011-02-11T00:03:10Z", "creator": "jd.bugzilla@gmail.com", "tags": [], "count": 4, "raw_text": "(In reply to comment #3)\nAnthony, can you reproduce this with a m-c debug build (assuming your local build is a debug version)?  Also, did you try running with a a new profile?  Do you have any special settings in the profile where you see the problem?", "id": 5271223, "text": "(In reply to comment #3)\nAnthony, can you reproduce this with a m-c debug build (assuming your local build is a debug version)?  Also, did you try running with a a new profile?  Do you have any special settings in the profile where you see the problem?", "creation_time": "2011-02-11T00:03:10Z", "is_private": false, "author": "jd.bugzilla@gmail.com", "attachment_id": null}, {"author": "anthony@ricaud.me", "id": 5271249, "raw_text": "Sorry the bug does not contain every information since I discussed it with Jonathan on IRC.\n\n(In reply to comment #4)\n> (In reply to comment #3)\n> Anthony, can you reproduce this with a m-c debug build (assuming your local\n> build is a debug version)?\nMy local build is not a debug version. I'm currently building one. I've tried the build linked in comment #2, I don't know if this a debug build or not.\n\n> Also, did you try running with a a new profile?\nYes, no change with a new profile.\n\n> Do you have any special settings in the profile where you see the problem?\nI tried changing gfx.downloadable_fonts.fallback_delay to 0 but it had no effect.", "creation_time": "2011-02-11T00:12:23Z", "text": "Sorry the bug does not contain every information since I discussed it with Jonathan on IRC.\n\n(In reply to comment #4)\n> (In reply to comment #3)\n> Anthony, can you reproduce this with a m-c debug build (assuming your local\n> build is a debug version)?\nMy local build is not a debug version. I'm currently building one. I've tried the build linked in comment #2, I don't know if this a debug build or not.\n\n> Also, did you try running with a a new profile?\nYes, no change with a new profile.\n\n> Do you have any special settings in the profile where you see the problem?\nI tried changing gfx.downloadable_fonts.fallback_delay to 0 but it had no effect.", "count": 5, "creator": "anthony@ricaud.me", "tags": [], "bug_id": 633174, "attachment_id": null, "is_private": false, "time": "2011-02-11T00:12:23Z"}, {"author": "anthony@ricaud.me", "text": "With a debug build, when each font finish downloads, I get this\n\nWARNING: Unable to test style tree integrity -- no content node: file /Users/rik24d/Documents/Mozilla/mozilla-central/layout/base/nsCSSFrameConstructor.cpp, line 8061", "creation_time": "2011-02-11T01:27:29Z", "raw_text": "With a debug build, when each font finish downloads, I get this\n\nWARNING: Unable to test style tree integrity -- no content node: file /Users/rik24d/Documents/Mozilla/mozilla-central/layout/base/nsCSSFrameConstructor.cpp, line 8061", "id": 5271423, "bug_id": 633174, "tags": [], "creator": "anthony@ricaud.me", "count": 6, "attachment_id": null, "is_private": false, "time": "2011-02-11T01:27:29Z"}, {"id": 5272138, "raw_text": "(In reply to comment #6)\n> With a debug build, when each font finish downloads, I get this\n> \n> WARNING: Unable to test style tree integrity -- no content node: file\n> /Users/rik24d/Documents/Mozilla/mozilla-central/layout/base/nsCSSFrameConstructor.cpp,\n> line 8061\n\nI think that's a pretty common message, and unrelated to the problem here. I see it frequently when things are working fine.\n\nIf you set the environment variable NSPR_LOG_MODULES to \"userfonts:5,fontdownloader:5\" before running the debug build, it should print some additional logging messages to show what's happening with the font downloads; that might be a step towards understanding this.", "creation_time": "2011-02-11T11:51:50Z", "text": "(In reply to comment #6)\n> With a debug build, when each font finish downloads, I get this\n> \n> WARNING: Unable to test style tree integrity -- no content node: file\n> /Users/rik24d/Documents/Mozilla/mozilla-central/layout/base/nsCSSFrameConstructor.cpp,\n> line 8061\n\nI think that's a pretty common message, and unrelated to the problem here. I see it frequently when things are working fine.\n\nIf you set the environment variable NSPR_LOG_MODULES to \"userfonts:5,fontdownloader:5\" before running the debug build, it should print some additional logging messages to show what's happening with the font downloads; that might be a step towards understanding this.", "tags": [], "count": 7, "creator": "jfkthame@gmail.com", "bug_id": 633174, "author": "jfkthame@gmail.com", "is_private": false, "time": "2011-02-11T11:51:50Z", "attachment_id": null}, {"is_private": false, "creation_time": "2011-02-11T18:35:59Z", "text": "Here is the output when loading with the NSPR_LOG_MODULES http://pastebin.mozilla.org/1048344", "id": 5273209, "raw_text": "Here is the output when loading with the NSPR_LOG_MODULES http://pastebin.mozilla.org/1048344", "creator": "anthony@ricaud.me", "time": "2011-02-11T18:35:59Z", "count": 8, "tags": [], "bug_id": 633174, "attachment_id": null, "author": "anthony@ricaud.me"}, {"text": "Thanks for that. Note that I'm investigating a similar-looking issue in bug 633500; I don't quite understand your case yet (especially the difference between your local build and mozilla-central builds), but I think the root cause is related.", "creation_time": "2011-02-11T19:51:15Z", "is_private": false, "raw_text": "Thanks for that. Note that I'm investigating a similar-looking issue in bug 633500; I don't quite understand your case yet (especially the difference between your local build and mozilla-central builds), but I think the root cause is related.", "id": 5273493, "bug_id": 633174, "time": "2011-02-11T19:51:15Z", "count": 9, "creator": "jfkthame@gmail.com", "tags": [], "author": "jfkthame@gmail.com", "attachment_id": null}, {"attachment_id": null, "time": "2011-02-11T21:27:08Z", "is_private": false, "author": "jfkthame@gmail.com", "creator": "jfkthame@gmail.com", "count": 10, "tags": [], "bug_id": 633174, "id": 5273715, "raw_text": "I have just landed a patch for bug 633500, and I suspect this will also resolve the problem you've been seeing in your local build, though I have not been able to reproduce that exact issue for testing. Please re-try with a fresh build and let me know if the problem persists - thanks.", "creation_time": "2011-02-11T21:27:08Z", "text": "I have just landed a patch for bug 633500, and I suspect this will also resolve the problem you've been seeing in your local build, though I have not been able to reproduce that exact issue for testing. Please re-try with a fresh build and let me know if the problem persists - thanks."}, {"attachment_id": null, "author": "roc@ocallahan.org", "tags": [], "count": 11, "time": "2011-02-11T21:28:11Z", "creator": "roc@ocallahan.org", "bug_id": 633174, "id": 5273721, "raw_text": "If this isn't fixed by bug 633500, I think we should back out bug 499292 for FF4.", "creation_time": "2011-02-11T21:28:11Z", "is_private": false, "text": "If this isn't fixed by bug 633500, I think we should back out bug 499292 for FF4."}, {"attachment_id": null, "author": "anthony@ricaud.me", "is_private": false, "creation_time": "2011-02-12T18:19:12Z", "text": "I'm sad to say that the text is still not displayed after bug 633500.\n\nI've tried selecting the text before fallback is displayed. The pre-fallback and fallback text have the same size. The post-download non-displayed text has a smaller width, so it looks like the metrics of the downloaded font are \"understood\".\n\n(In reply to comment #11)\n> If this isn't fixed by bug 633500, I think we should back out bug 499292 for\n> FF4.\nI'm not sure that's necessary. I'm the only one to see that on my local builds. m-c builds and nightly builds are working just fine on the same machine. I may have a bad configuration for building, so unless someone else confirms that, why block. I have to add that I'm not fluent with makefiles, build options and all.", "id": 5275000, "raw_text": "I'm sad to say that the text is still not displayed after bug 633500.\n\nI've tried selecting the text before fallback is displayed. The pre-fallback and fallback text have the same size. The post-download non-displayed text has a smaller width, so it looks like the metrics of the downloaded font are \"understood\".\n\n(In reply to comment #11)\n> If this isn't fixed by bug 633500, I think we should back out bug 499292 for\n> FF4.\nI'm not sure that's necessary. I'm the only one to see that on my local builds. m-c builds and nightly builds are working just fine on the same machine. I may have a bad configuration for building, so unless someone else confirms that, why block. I have to add that I'm not fluent with makefiles, build options and all.", "time": "2011-02-12T18:19:12Z", "creator": "anthony@ricaud.me", "count": 12, "tags": [], "bug_id": 633174}, {"bug_id": 633174, "count": 13, "creator": "jfkthame@gmail.com", "time": "2011-02-12T19:39:38Z", "tags": [], "raw_text": "(In reply to comment #12)\n> I'm sad to say that the text is still not displayed after bug 633500.\n> \n> I've tried selecting the text before fallback is displayed. The pre-fallback\n> and fallback text have the same size. The post-download non-displayed text has\n> a smaller width, so it looks like the metrics of the downloaded font are\n> \"understood\".\n> \n> (In reply to comment #11)\n> > If this isn't fixed by bug 633500, I think we should back out bug 499292 for\n> > FF4.\n> I'm not sure that's necessary. I'm the only one to see that on my local builds.\n> m-c builds and nightly builds are working just fine on the same machine. I may\n> have a bad configuration for building, so unless someone else confirms that,\n> why block. I have to add that I'm not fluent with makefiles, build options and\n> all.\n\nCould you possibly send me your build, please? (Or better, put it somewhere online that I can download.) Debug build preferred. I'm curious to see if your build exhibits the problem on my system, or if it's somehow unique to the combination of your build and your machine. (Do you have access to other machines where you could test?)", "id": 5275082, "text": "(In reply to comment #12)\n> I'm sad to say that the text is still not displayed after bug 633500.\n> \n> I've tried selecting the text before fallback is displayed. The pre-fallback\n> and fallback text have the same size. The post-download non-displayed text has\n> a smaller width, so it looks like the metrics of the downloaded font are\n> \"understood\".\n> \n> (In reply to comment #11)\n> > If this isn't fixed by bug 633500, I think we should back out bug 499292 for\n> > FF4.\n> I'm not sure that's necessary. I'm the only one to see that on my local builds.\n> m-c builds and nightly builds are working just fine on the same machine. I may\n> have a bad configuration for building, so unless someone else confirms that,\n> why block. I have to add that I'm not fluent with makefiles, build options and\n> all.\n\nCould you possibly send me your build, please? (Or better, put it somewhere online that I can download.) Debug build preferred. I'm curious to see if your build exhibits the problem on my system, or if it's somehow unique to the combination of your build and your machine. (Do you have access to other machines where you could test?)", "creation_time": "2011-02-12T19:39:38Z", "is_private": false, "author": "jfkthame@gmail.com", "attachment_id": null}, {"author": "anthony@ricaud.me", "attachment_id": null, "text": "Ok that is weird, it's now working. I copied the .app directory to my Desktop to put it online and just before doing so, I open it to check if it's launching. Boom, the fonts are now working. So I launched the original in the objdir directory, working also. With a new profile, working.\n\nBetween Saturday and today, I don't think I've done anything special to my system. So closing this.", "creation_time": "2011-02-14T11:04:09Z", "is_private": false, "raw_text": "Ok that is weird, it's now working. I copied the .app directory to my Desktop to put it online and just before doing so, I open it to check if it's launching. Boom, the fonts are now working. So I launched the original in the objdir directory, working also. With a new profile, working.\n\nBetween Saturday and today, I don't think I've done anything special to my system. So closing this.", "id": 5276641, "bug_id": 633174, "count": 14, "tags": [], "time": "2011-02-14T11:04:09Z", "creator": "anthony@ricaud.me"}, {"bug_id": 633174, "tags": [], "count": 15, "time": "2011-02-14T11:46:04Z", "creator": "jfkthame@gmail.com", "raw_text": "Glad it's working, though I'm still curious to understand exactly what happened. The only reasonable explanation I can think of at the moment is that when you made and tested an updated build with the fix from bug 633500, you had inadvertently left your older build running - probably with no windows open, so it was easy to overlook - and so \"launching\" the new build didn't really do so, it just activated the already-running one. Does that seem even remotely possible?", "id": 5276678, "text": "Glad it's working, though I'm still curious to understand exactly what happened. The only reasonable explanation I can think of at the moment is that when you made and tested an updated build with the fix from bug 633500, you had inadvertently left your older build running - probably with no windows open, so it was easy to overlook - and so \"launching\" the new build didn't really do so, it just activated the already-running one. Does that seem even remotely possible?", "is_private": false, "creation_time": "2011-02-14T11:46:04Z", "author": "jfkthame@gmail.com", "attachment_id": null}, {"author": "hsivonen@mozilla.com", "bug_id": 633174, "creator": "hsivonen@mozilla.com", "tags": [], "count": 16, "text": "(In reply to comment #15)\n> The only reasonable explanation I can think of at the moment is that\n> when you made and tested an updated build with the fix from bug 633500, you had\n> inadvertently left your older build running - probably with no windows open, so\n> it was easy to overlook - and so \"launching\" the new build didn't really do so,\n> it just activated the already-running one.\n\nCan that happen on Mac?", "creation_time": "2011-02-14T12:21:22Z", "raw_text": "(In reply to comment #15)\n> The only reasonable explanation I can think of at the moment is that\n> when you made and tested an updated build with the fix from bug 633500, you had\n> inadvertently left your older build running - probably with no windows open, so\n> it was easy to overlook - and so \"launching\" the new build didn't really do so,\n> it just activated the already-running one.\n\nCan that happen on Mac?", "id": 5276716, "attachment_id": null, "time": "2011-02-14T12:21:22Z", "is_private": false}, {"author": "anthony@ricaud.me", "creation_time": "2011-02-14T13:02:12Z", "text": "OK, things are a bit clearer.\n\nIf I launch MinefieldDebug.app from the Finder, things work.\nIf I launch from the Terminal, things don't work.\n\nCommands I used in the Terminal:\nopen MinefieldDebug.app\n./MinefieldDebug.app/Contents/MacOS/firefox\n\nI thought \"open\" was the equivalent of launching through the Finder, apparently not.\n\n(In reply to comment #16)\n> Can that happen on Mac?\nYes. Only a small number of apps close when you close last window.", "id": 5276772, "raw_text": "OK, things are a bit clearer.\n\nIf I launch MinefieldDebug.app from the Finder, things work.\nIf I launch from the Terminal, things don't work.\n\nCommands I used in the Terminal:\nopen MinefieldDebug.app\n./MinefieldDebug.app/Contents/MacOS/firefox\n\nI thought \"open\" was the equivalent of launching through the Finder, apparently not.\n\n(In reply to comment #16)\n> Can that happen on Mac?\nYes. Only a small number of apps close when you close last window.", "creator": "anthony@ricaud.me", "count": 17, "tags": [], "bug_id": 633174, "attachment_id": null, "is_private": false, "time": "2011-02-14T13:02:12Z"}, {"author": "jfkthame@gmail.com", "bug_id": 633174, "creator": "jfkthame@gmail.com", "tags": [], "count": 18, "text": "(In reply to comment #16)\n> (In reply to comment #15)\n> > The only reasonable explanation I can think of at the moment is that\n> > when you made and tested an updated build with the fix from bug 633500, you had\n> > inadvertently left your older build running - probably with no windows open, so\n> > it was easy to overlook - and so \"launching\" the new build didn't really do so,\n> > it just activated the already-running one.\n> \n> Can that happen on Mac?\n\nYes, if you try to launch the new build from the Finder; that will automagically activate an already-running (potentially older) copy of the app. I don't think it can happen if you launch the new build from a command line, though. (So how plausible it is here might depend how Rik typically works.)", "creation_time": "2011-02-14T13:07:16Z", "raw_text": "(In reply to comment #16)\n> (In reply to comment #15)\n> > The only reasonable explanation I can think of at the moment is that\n> > when you made and tested an updated build with the fix from bug 633500, you had\n> > inadvertently left your older build running - probably with no windows open, so\n> > it was easy to overlook - and so \"launching\" the new build didn't really do so,\n> > it just activated the already-running one.\n> \n> Can that happen on Mac?\n\nYes, if you try to launch the new build from the Finder; that will automagically activate an already-running (potentially older) copy of the app. I don't think it can happen if you launch the new build from a command line, though. (So how plausible it is here might depend how Rik typically works.)", "id": 5276777, "attachment_id": null, "time": "2011-02-14T13:07:16Z", "is_private": false}, {"author": "jfkthame@gmail.com", "attachment_id": null, "text": "(In reply to comment #17)\n> OK, things are a bit clearer.\n> \n> If I launch MinefieldDebug.app from the Finder, things work.\n> If I launch from the Terminal, things don't work.\n\nHmm. So you can still reproduce the failure, if you launch your build from the Terminal? Strange indeed.\n\nHow about if you launch a mozilla-central nightly from the Terminal?\n\nIf this is limited to your local build, I'd still be interested to try it here. I have not been able to reproduce this behavior at all, regardless of how I launch Minefield. (I usually run it from a Terminal window.)", "is_private": false, "creation_time": "2011-02-14T13:11:12Z", "raw_text": "(In reply to comment #17)\n> OK, things are a bit clearer.\n> \n> If I launch MinefieldDebug.app from the Finder, things work.\n> If I launch from the Terminal, things don't work.\n\nHmm. So you can still reproduce the failure, if you launch your build from the Terminal? Strange indeed.\n\nHow about if you launch a mozilla-central nightly from the Terminal?\n\nIf this is limited to your local build, I'd still be interested to try it here. I have not been able to reproduce this behavior at all, regardless of how I launch Minefield. (I usually run it from a Terminal window.)", "id": 5276781, "bug_id": 633174, "creator": "jfkthame@gmail.com", "count": 19, "time": "2011-02-14T13:11:12Z", "tags": []}, {"count": 20, "creator": "anthony@ricaud.me", "tags": [], "bug_id": 633174, "creation_time": "2011-02-14T13:23:34Z", "text": "I can reproduce it with yesterday's nightly build.\nI've also started from a shell with an empty ~/.profile and I can reproduce.\n\nHowever, on 2 other Mac in the office, I can't reproduce.", "id": 5276794, "raw_text": "I can reproduce it with yesterday's nightly build.\nI've also started from a shell with an empty ~/.profile and I can reproduce.\n\nHowever, on 2 other Mac in the office, I can't reproduce.", "author": "anthony@ricaud.me", "time": "2011-02-14T13:23:34Z", "is_private": false, "attachment_id": null}, {"creation_time": "2011-02-14T17:16:49Z", "is_private": false, "text": "Evidence seems to point to this being a bad interaction with something on :rik's machine; we should work correctly on his machine, of course, but it shouldn't keep us from shipping FF4 to 429,999,999 other people. :-)", "id": 5277200, "raw_text": "Evidence seems to point to this being a bad interaction with something on :rik's machine; we should work correctly on his machine, of course, but it shouldn't keep us from shipping FF4 to 429,999,999 other people. :-)", "tags": [], "count": 21, "creator": "shaver@mozilla.org", "time": "2011-02-14T17:16:49Z", "bug_id": 633174, "attachment_id": null, "author": "shaver@mozilla.org"}]}}, "comments": {}}