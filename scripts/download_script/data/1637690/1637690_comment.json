{"bugs": {"1637690": {"comments": [{"creation_time": "2020-05-13T17:51:13Z", "raw_text": "Sending an openPGP PGP/MIME encrypted message using TB 68.8.0/Enigmail, and trying to decrypt that message with TB77 beta2.\n\nUpon opening the received message in TB77 the first time this error is shown:\n\"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\nA screenshot is attached.\n\nfrom the Error Console:\nSuccessfully loaded OpenPGP library librnp.so from /opt/thunderbird_beta/librnp.so RNPLib.jsm:46:13\npublic keys: 25, secret keys: 4 RNPLib.jsm:189:15\nError: \"Cannot load required GPGME library\"\n    loadExternalGPGMELib chrome://openpgp/content/modules/GPGMELib.jsm:55\n    init chrome://openpgp/content/modules/GPGMELib.jsm:61\n    once chrome://openpgp/content/modules/GPGME.jsm:20\n    init chrome://openpgp/content/modules/GPGME.jsm:36\n    init chrome://openpgp/content/BondOpenPGP.jsm:67\n    <anonymous> chrome://openpgp/content/BondOpenPGP.jsm:88\nGPGME.jsm:28:15\nSuccessfully loaded OTR library libotr.so.5 from /opt/thunderbird_beta/libotr.so.5 OTRLib.jsm:43:13\n\nUpon opening the received message in TB77 the second time it actually gets decrypted.\nA screenshot is attached.\n\nThe error console now shows:\nin RNPLib.password_cb, context: decrypt RNPLib.jsm:246:15\nmax_len: 256 RNPLib.jsm:249:15\nCryptoAPI.sync() starting interface.js:33:13\nCryptoAPI.sync() leaving interface.js:55:13\nDecrypted message\nGood signature\nSignature from public key **************** enigmailMsgHdrViewOverlay.js:189:15\n\nThe key id is redacted.\n\nThe message should decrypt right away upon first opening.", "time": "2020-05-13T17:51:13Z", "creator": "chriechers@netscape.net", "attachment_id": 9148097, "id": 14817381, "text": "Created attachment 9148097\nencrypted_message.png\n\nSending an openPGP PGP/MIME encrypted message using TB 68.8.0/Enigmail, and trying to decrypt that message with TB77 beta2.\n\nUpon opening the received message in TB77 the first time this error is shown:\n\"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\nA screenshot is attached.\n\nfrom the Error Console:\nSuccessfully loaded OpenPGP library librnp.so from /opt/thunderbird_beta/librnp.so RNPLib.jsm:46:13\npublic keys: 25, secret keys: 4 RNPLib.jsm:189:15\nError: \"Cannot load required GPGME library\"\n    loadExternalGPGMELib chrome://openpgp/content/modules/GPGMELib.jsm:55\n    init chrome://openpgp/content/modules/GPGMELib.jsm:61\n    once chrome://openpgp/content/modules/GPGME.jsm:20\n    init chrome://openpgp/content/modules/GPGME.jsm:36\n    init chrome://openpgp/content/BondOpenPGP.jsm:67\n    <anonymous> chrome://openpgp/content/BondOpenPGP.jsm:88\nGPGME.jsm:28:15\nSuccessfully loaded OTR library libotr.so.5 from /opt/thunderbird_beta/libotr.so.5 OTRLib.jsm:43:13\n\nUpon opening the received message in TB77 the second time it actually gets decrypted.\nA screenshot is attached.\n\nThe error console now shows:\nin RNPLib.password_cb, context: decrypt RNPLib.jsm:246:15\nmax_len: 256 RNPLib.jsm:249:15\nCryptoAPI.sync() starting interface.js:33:13\nCryptoAPI.sync() leaving interface.js:55:13\nDecrypted message\nGood signature\nSignature from public key **************** enigmailMsgHdrViewOverlay.js:189:15\n\nThe key id is redacted.\n\nThe message should decrypt right away upon first opening.", "author": "chriechers@netscape.net", "tags": [], "bug_id": 1637690, "is_private": false, "count": 0}, {"raw_text": "", "time": "2020-05-13T17:51:51Z", "author": "chriechers@netscape.net", "bug_id": 1637690, "tags": [], "count": 1, "is_private": false, "creation_time": "2020-05-13T17:51:51Z", "creator": "chriechers@netscape.net", "attachment_id": 9148098, "id": 14817382, "text": "Created attachment 9148098\nencrypted_message_2.png"}, {"time": "2020-05-13T19:02:28Z", "raw_text": "Christian, thanks for testing the beta version. Comments below.\n\n\n(In reply to Christian Riechers from comment #0)\n> \"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\n> A screenshot is attached.\n\nI've also seen that once. I haven't yet been able to reliably reproduce it.\n\nWas that message already selected when you started Thunderbird, and it was the first message shown?\nIt seems like we have an initialization race.\n\n\n> Error: \"Cannot load required GPGME library\"\n\nThis is a harmless debugging output. The GPGME library is optional. In bug 1636791 we will add a preference, that will disable the library by default, so that only advanced users who have the required optional software can enable it.\n\n\n> Upon opening the received message in TB77 the second time it actually gets decrypted.\n\nI'm glad to hear that it's working. Assuming the problem is really just a race on startup, it should continue to work for the remainder of your Thunderbird session.\n\n\n> The error console now shows:\n> in RNPLib.password_cb, context: decrypt RNPLib.jsm:246:15\n> max_len: 256 RNPLib.jsm:249:15\n> CryptoAPI.sync() starting interface.js:33:13\n> CryptoAPI.sync() leaving interface.js:55:13\n\nMore harmless debugging statements.\n\n\n> Decrypted message\n> Good signature\n> Signature from public key **************** enigmailMsgHdrViewOverlay.js:189:15", "is_private": false, "count": 2, "bug_id": 1637690, "tags": [], "author": "kaie@kuix.de", "attachment_id": null, "creator": "kaie@kuix.de", "creation_time": "2020-05-13T19:02:28Z", "text": "Christian, thanks for testing the beta version. Comments below.\n\n\n(In reply to Christian Riechers from comment #0)\n> \"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\n> A screenshot is attached.\n\nI've also seen that once. I haven't yet been able to reliably reproduce it.\n\nWas that message already selected when you started Thunderbird, and it was the first message shown?\nIt seems like we have an initialization race.\n\n\n> Error: \"Cannot load required GPGME library\"\n\nThis is a harmless debugging output. The GPGME library is optional. In bug 1636791 we will add a preference, that will disable the library by default, so that only advanced users who have the required optional software can enable it.\n\n\n> Upon opening the received message in TB77 the second time it actually gets decrypted.\n\nI'm glad to hear that it's working. Assuming the problem is really just a race on startup, it should continue to work for the remainder of your Thunderbird session.\n\n\n> The error console now shows:\n> in RNPLib.password_cb, context: decrypt RNPLib.jsm:246:15\n> max_len: 256 RNPLib.jsm:249:15\n> CryptoAPI.sync() starting interface.js:33:13\n> CryptoAPI.sync() leaving interface.js:55:13\n\nMore harmless debugging statements.\n\n\n> Decrypted message\n> Good signature\n> Signature from public key **************** enigmailMsgHdrViewOverlay.js:189:15", "id": 14817592}, {"author": "chriechers@netscape.net", "count": 3, "is_private": false, "bug_id": 1637690, "tags": [], "raw_text": "(In reply to Kai Engert (:KaiE:) from comment #2)\n> (In reply to Christian Riechers from comment #0)\n> > \"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\n> \n> I've also seen that once. I haven't yet been able to reliably reproduce it.\n\nI think I can consistently reproduce this here.\n \n> Was that message already selected when you started Thunderbird, and it was the first message shown?\n\nI'm not sure what you mean with 'already selected'. The message is the first and only one in Inbox. I click it once to select it, and then double click to open it. If this is the first time opening it after starting Thunderbird I get the error. \n \n> > Upon opening the received message in TB77 the second time it actually gets decrypted.\n> \n> I'm glad to hear that it's working. Assuming the problem is really just a race on startup, it should continue to work for the remainder of your \n> Thunderbird session.\n\nYes, it does.", "time": "2020-05-13T19:37:08Z", "id": 14817643, "text": "(In reply to Kai Engert (:KaiE:) from comment #2)\n> (In reply to Christian Riechers from comment #0)\n> > \"This is an encrypted OpenPGP message, but support for OpenPGP decryption is not available.\"\n> \n> I've also seen that once. I haven't yet been able to reliably reproduce it.\n\nI think I can consistently reproduce this here.\n \n> Was that message already selected when you started Thunderbird, and it was the first message shown?\n\nI'm not sure what you mean with 'already selected'. The message is the first and only one in Inbox. I click it once to select it, and then double click to open it. If this is the first time opening it after starting Thunderbird I get the error. \n \n> > Upon opening the received message in TB77 the second time it actually gets decrypted.\n> \n> I'm glad to hear that it's working. Assuming the problem is really just a race on startup, it should continue to work for the remainder of your \n> Thunderbird session.\n\nYes, it does.", "creation_time": "2020-05-13T19:37:08Z", "attachment_id": null, "creator": "chriechers@netscape.net"}, {"creation_time": "2020-05-14T19:16:35Z", "attachment_id": null, "creator": "kaie@kuix.de", "id": 14821043, "text": "(In reply to Christian Riechers from comment #3)\n> I'm not sure what you mean with 'already selected'. The message is the first and only one in Inbox. I click it once to select it, and then double click to open it. If this is the first time opening it after starting Thunderbird I get the error. \n\nMy question was \"is the message shown immediately after startup\" (somehow Thunderbird remembering that a message is automatically shown at startup), or, does this happen after you click a message.\n\nYou have confirmed it's the latter, you click a message after startup.\n\nThis surprises me, because it probably takes a moment for you to react, after the Thunderbird window appears. I would have assumed that our initialization could is executed more quickly than you are able to react and click the message.\n\nWould you say your computer is very fast, or rather slow?\n\nI have tried to reproduce it, by preparing my mouse exactly at the position where a message is about to appear, and use the keyboard and terminal to quit/start Thunderbird, so I can very quickly react after the window comes up, but I couldn't reproduce it yet.", "raw_text": "(In reply to Christian Riechers from comment #3)\n> I'm not sure what you mean with 'already selected'. The message is the first and only one in Inbox. I click it once to select it, and then double click to open it. If this is the first time opening it after starting Thunderbird I get the error. \n\nMy question was \"is the message shown immediately after startup\" (somehow Thunderbird remembering that a message is automatically shown at startup), or, does this happen after you click a message.\n\nYou have confirmed it's the latter, you click a message after startup.\n\nThis surprises me, because it probably takes a moment for you to react, after the Thunderbird window appears. I would have assumed that our initialization could is executed more quickly than you are able to react and click the message.\n\nWould you say your computer is very fast, or rather slow?\n\nI have tried to reproduce it, by preparing my mouse exactly at the position where a message is about to appear, and use the keyboard and terminal to quit/start Thunderbird, so I can very quickly react after the window comes up, but I couldn't reproduce it yet.", "time": "2020-05-14T19:16:35Z", "author": "kaie@kuix.de", "tags": [], "bug_id": 1637690, "count": 4, "is_private": false}, {"bug_id": 1637690, "tags": [], "count": 5, "is_private": false, "author": "kaie@kuix.de", "time": "2020-05-14T19:51:41Z", "raw_text": "Now I'm able to reproduce.\n\nI open an encrypted message in a tab. Then I quit, and start again. Thunderbird still has the tab open, and shows the described error.\nSwitching to the main tab, then switching back to the other tab causes the message to be decrypted.", "text": "Now I'm able to reproduce.\n\nI open an encrypted message in a tab. Then I quit, and start again. Thunderbird still has the tab open, and shows the described error.\nSwitching to the main tab, then switching back to the other tab causes the message to be decrypted.", "id": 14821118, "creator": "kaie@kuix.de", "attachment_id": null, "creation_time": "2020-05-14T19:51:41Z"}, {"id": 14821349, "text": "I'm not rushing to open the message. No message pane. Message opens in a new window.", "attachment_id": null, "creator": "chriechers@netscape.net", "creation_time": "2020-05-14T20:54:29Z", "bug_id": 1637690, "tags": [], "count": 6, "is_private": false, "author": "chriechers@netscape.net", "time": "2020-05-14T20:54:29Z", "raw_text": "I'm not rushing to open the message. No message pane. Message opens in a new window."}, {"author": "kaie@kuix.de", "is_private": false, "count": 7, "bug_id": 1637690, "tags": [], "raw_text": "Using the nightly build 2020-05-15, I can no longer reproduce this issue.\nPlease comment if you see the problem again with this or a newer version.\n\nI think the issue was fixed by bug 1636791.\nPreviously, we attempted to load the optional GPGME library, and if was missing, we raised an exception. That exception has probably interrupted the initial initialization code.\n\nWith the new logic, we no longer treat it as a failure if that optional library cannot be loaded, regardless of the setting of the pref.", "time": "2020-05-15T20:34:56Z", "text": "Using the nightly build 2020-05-15, I can no longer reproduce this issue.\nPlease comment if you see the problem again with this or a newer version.\n\nI think the issue was fixed by bug 1636791.\nPreviously, we attempted to load the optional GPGME library, and if was missing, we raised an exception. That exception has probably interrupted the initial initialization code.\n\nWith the new logic, we no longer treat it as a failure if that optional library cannot be loaded, regardless of the setting of the pref.\n\n*** This bug has been marked as a duplicate of bug 1636791 ***", "id": 14824598, "creation_time": "2020-05-15T20:34:56Z", "creator": "kaie@kuix.de", "attachment_id": null}, {"author": "kaie@kuix.de", "text": "*** Bug 1639182 has been marked as a duplicate of this bug. ***", "id": 14841975, "tags": [], "bug_id": 1637690, "count": 8, "is_private": false, "raw_text": "", "creation_time": "2020-05-25T13:38:25Z", "time": "2020-05-25T13:38:25Z", "creator": "kaie@kuix.de", "attachment_id": null}, {"author": "schaer@puzzle.ch", "bug_id": 1637690, "tags": [], "is_private": false, "count": 9, "raw_text": "Hi there. I know there are severl \"versions\" of this bug, but I am going to post my issue with it here.\nI may have an idea how to reproduce the bug, at least for the TB version 78.5.0 on MacOS. Encryption worked all fine, also since the first version 78, where integrated PGP inside TB and Enigmail wasn't necessary anymore. \n\nThen I installed the Add-On \ufeff\"p\u2261p\" for Thunderbird: https://pep.software/thunderbird/. After I deactivated it, PGP didn't work anymore. Then I removed the Add-On, which also didn't resolve my issue. After that I reinstalled the Add-On and my TB App is broken, Enycrption doesn't work anymore. I don't see the \"Manage PGP\" entry under Tools. The whole integration seems to be gone. \n\nReinstalling TB also didn't resolve the issue. \n\nI am kind of stuck. :( \n\nMaybe it has something to do with this bug? Maybe someone can try to reproduce by following the steps I describted above?", "time": "2020-11-23T15:36:07Z", "text": "Hi there. I know there are severl \"versions\" of this bug, but I am going to post my issue with it here.\nI may have an idea how to reproduce the bug, at least for the TB version 78.5.0 on MacOS. Encryption worked all fine, also since the first version 78, where integrated PGP inside TB and Enigmail wasn't necessary anymore. \n\nThen I installed the Add-On \ufeff\"p\u2261p\" for Thunderbird: https://pep.software/thunderbird/. After I deactivated it, PGP didn't work anymore. Then I removed the Add-On, which also didn't resolve my issue. After that I reinstalled the Add-On and my TB App is broken, Enycrption doesn't work anymore. I don't see the \"Manage PGP\" entry under Tools. The whole integration seems to be gone. \n\nReinstalling TB also didn't resolve the issue. \n\nI am kind of stuck. :( \n\nMaybe it has something to do with this bug? Maybe someone can try to reproduce by following the steps I describted above?", "id": 15145277, "creation_time": "2020-11-23T15:36:07Z", "attachment_id": null, "creator": "schaer@puzzle.ch"}, {"time": "2021-02-12T15:01:43Z", "raw_text": "Joshua, the original bug was resolved.\n\nI think you are reporting a different issue, and it's better to file fresh bugs, rather than reuse old unrelated bugs.\n\nIf Thunderbird no longer works for you after installing that Add-on, maybe it has corrupted files in your Thunderbird profile.\nYou could try to start with a fresh profile, start thunderbird with command line parameter -P, or find a guide that explains how to use multiple profiles with thunderbird.", "tags": [], "bug_id": 1637690, "is_private": false, "count": 10, "author": "kaie@kuix.de", "creator": "kaie@kuix.de", "attachment_id": null, "creation_time": "2021-02-12T15:01:43Z", "text": "Joshua, the original bug was resolved.\n\nI think you are reporting a different issue, and it's better to file fresh bugs, rather than reuse old unrelated bugs.\n\nIf Thunderbird no longer works for you after installing that Add-on, maybe it has corrupted files in your Thunderbird profile.\nYou could try to start with a fresh profile, start thunderbird with command line parameter -P, or find a guide that explains how to use multiple profiles with thunderbird.", "id": 15262314}, {"author": "schaer@puzzle.ch", "tags": [], "bug_id": 1637690, "count": 11, "is_private": false, "raw_text": "Hi there Kai and thanks for getting back to me. I found out, that after deactivating and/or deleting (?) the p\u2261p addon, I had to manually enable mail.openpgp.enable in the config editor. I will not file a new bug, but I think this should not happen when deactivating such an addon.", "time": "2021-02-22T14:17:15Z", "id": 15276693, "text": "Hi there Kai and thanks for getting back to me. I found out, that after deactivating and/or deleting (?) the p\u2261p addon, I had to manually enable mail.openpgp.enable in the config editor. I will not file a new bug, but I think this should not happen when deactivating such an addon.", "creation_time": "2021-02-22T14:17:15Z", "attachment_id": null, "creator": "schaer@puzzle.ch"}, {"creator": "kaie@kuix.de", "attachment_id": null, "creation_time": "2021-03-22T20:54:37Z", "text": "If an Add-on messes with Thunderbird's own preferences, there's nothing we can do. I think it's the responsibility of an Add-on to clean up.", "id": 15324083, "time": "2021-03-22T20:54:37Z", "raw_text": "If an Add-on messes with Thunderbird's own preferences, there's nothing we can do. I think it's the responsibility of an Add-on to clean up.", "tags": [], "bug_id": 1637690, "count": 12, "is_private": false, "author": "kaie@kuix.de"}]}}, "comments": {}}