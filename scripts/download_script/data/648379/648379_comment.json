{"comments": {}, "bugs": {"648379": {"comments": [{"count": 0, "time": "2011-04-07T22:21:06Z", "text": "Emscripten has 500+ automatic tests, that have uncovered various bugs in spidermonkey (in particular, recently in TI). It has been suggested to add some or all of those tests to the JS engine test suite, hence this bug.\n\nThe tests include both compiling LLVM to JS and running the generated JS. That includes some very large JS scripts (multiple megabytes), and running the entire suite takes 1-2 hours, so that is the downside to adding them all (but the large JS scripts have tended to find the most JS engine bugs).", "creator": "azakai@mozilla.com", "raw_text": "Emscripten has 500+ automatic tests, that have uncovered various bugs in spidermonkey (in particular, recently in TI). It has been suggested to add some or all of those tests to the JS engine test suite, hence this bug.\n\nThe tests include both compiling LLVM to JS and running the generated JS. That includes some very large JS scripts (multiple megabytes), and running the entire suite takes 1-2 hours, so that is the downside to adding them all (but the large JS scripts have tended to find the most JS engine bugs).", "id": 5395234, "is_private": false, "author": "azakai@mozilla.com", "bug_id": 648379, "attachment_id": null, "tags": [], "creation_time": "2011-04-07T22:21:06Z"}, {"tags": [], "creation_time": "2011-04-07T22:52:41Z", "attachment_id": null, "raw_text": "To move on this, the relevant people (I am not sure who that is) need to decide if we want this, and if so how many of the tests.", "creator": "azakai@mozilla.com", "bug_id": 648379, "text": "To move on this, the relevant people (I am not sure who that is) need to decide if we want this, and if so how many of the tests.", "is_private": false, "author": "azakai@mozilla.com", "time": "2011-04-07T22:52:41Z", "count": 1, "id": 5395312}, {"text": "The criteria we want to use is \"the tests which increase our test coverage\". Does this help or hinder?", "creator": "paul.biggar@gmail.com", "raw_text": "The criteria we want to use is \"the tests which increase our test coverage\". Does this help or hinder?", "count": 2, "time": "2011-04-07T23:04:25Z", "bug_id": 648379, "attachment_id": null, "tags": [], "creation_time": "2011-04-07T23:04:25Z", "id": 5395345, "author": "paul.biggar@gmail.com", "is_private": false}, {"id": 5395426, "count": 3, "time": "2011-04-07T23:34:47Z", "author": "azakai@mozilla.com", "is_private": false, "text": "We have found several bugs in TI using this, including recent regressions after they were fixed (the reduced testcases for them, that were added to the js tests, still passed, but not the original emscripten test they were reduced from). So I believe these tests do increase coverage.\n\nHowever, it might be the case that some of that can be achieved with fuzzing, which AFAIK is not yet done on jaegermonkey, so maybe once fuzzing is done these tests will not increase the coverage that much. I don't know the answer to that, but I did ask jesse about one specific case - a bug with >50 local variables - and he said his fuzzer would not have found that one.", "bug_id": 648379, "creator": "azakai@mozilla.com", "raw_text": "We have found several bugs in TI using this, including recent regressions after they were fixed (the reduced testcases for them, that were added to the js tests, still passed, but not the original emscripten test they were reduced from). So I believe these tests do increase coverage.\n\nHowever, it might be the case that some of that can be achieved with fuzzing, which AFAIK is not yet done on jaegermonkey, so maybe once fuzzing is done these tests will not increase the coverage that much. I don't know the answer to that, but I did ask jesse about one specific case - a bug with >50 local variables - and he said his fuzzer would not have found that one.", "attachment_id": null, "creation_time": "2011-04-07T23:34:47Z", "tags": []}, {"creation_time": "2011-04-08T01:51:08Z", "tags": [], "attachment_id": null, "raw_text": "Just to clarify, I wasnt trying to shoot down including the tests, but trying to provide the criteria so that you can find some subset which is useful.\n\nBut in fact, :decoder tells me that coverage is probably not a good metric for including tests, because we're doing pretty well on both line- and branch-coverage, and are finding bugs with fuzz-tests which \n\nHowever, I believe we can't add 2 hours of tests, no matter what the benefits. I could be wrong - it may be worth checking with RelEng and see what they say.\n\nAssuming for a moment that I'm right, then we need to find some subset of the tests that are useful to add to the testsuite. I don't know a way to identify that subset.", "creator": "paul.biggar@gmail.com", "bug_id": 648379, "text": "Just to clarify, I wasnt trying to shoot down including the tests, but trying to provide the criteria so that you can find some subset which is useful.\n\nBut in fact, :decoder tells me that coverage is probably not a good metric for including tests, because we're doing pretty well on both line- and branch-coverage, and are finding bugs with fuzz-tests which \n\nHowever, I believe we can't add 2 hours of tests, no matter what the benefits. I could be wrong - it may be worth checking with RelEng and see what they say.\n\nAssuming for a moment that I'm right, then we need to find some subset of the tests that are useful to add to the testsuite. I don't know a way to identify that subset.", "is_private": false, "time": "2011-04-08T01:51:08Z", "author": "paul.biggar@gmail.com", "count": 4, "id": 5395664}, {"id": 5395666, "time": "2011-04-08T01:52:07Z", "author": "paul.biggar@gmail.com", "count": 5, "is_private": false, "text": "(In reply to comment #4)\n \n> But in fact, :decoder tells me that coverage is probably not a good metric for\n> including tests, because we're doing pretty well on both line- and\n> branch-coverage, and are finding bugs with fuzz-tests which\n\n... are not improving coverage stats.", "bug_id": 648379, "raw_text": "(In reply to comment #4)\n \n> But in fact, :decoder tells me that coverage is probably not a good metric for\n> including tests, because we're doing pretty well on both line- and\n> branch-coverage, and are finding bugs with fuzz-tests which\n\n... are not improving coverage stats.", "creator": "paul.biggar@gmail.com", "tags": [], "creation_time": "2011-04-08T01:52:07Z", "attachment_id": null}, {"is_private": false, "author": "jruderman@gmail.com", "id": 5397957, "tags": [], "creation_time": "2011-04-09T01:54:01Z", "attachment_id": null, "bug_id": 648379, "time": "2011-04-09T01:54:01Z", "count": 6, "raw_text": "How about running it once per day on TM, instead of once per push?", "creator": "jruderman@gmail.com", "text": "How about running it once per day on TM, instead of once per push?"}, {"text": "I run the tests generally once a week, so I guess there is already some coverage in that sense, if we are happy with just that (and not preventing badness from even landing).\n\nThe risk is that I might miss a few weeks now and then. For example, I just found another bug on tracemonkey with this, bug 648769, which looks like a regression from almost two weeks ago.", "bug_id": 648379, "creator": "azakai@mozilla.com", "raw_text": "I run the tests generally once a week, so I guess there is already some coverage in that sense, if we are happy with just that (and not preventing badness from even landing).\n\nThe risk is that I might miss a few weeks now and then. For example, I just found another bug on tracemonkey with this, bug 648769, which looks like a regression from almost two weeks ago.", "attachment_id": null, "creation_time": "2011-04-09T18:23:27Z", "tags": [], "id": 5398497, "count": 7, "time": "2011-04-09T18:23:27Z", "author": "azakai@mozilla.com", "is_private": false}, {"time": "2011-04-09T18:55:37Z", "count": 8, "raw_text": "(In reply to comment #6)\n> How about running it once per day on TM, instead of once per push?\n\nIf we do this we can also use it for Kraken and other long running scripts. Bug 624792 is about adding Kraken to jit-tests but I had to tweak the tests to run faster. It would be good to check correctness of the full version too.", "creator": "jdemooij@mozilla.com", "text": "(In reply to comment #6)\n> How about running it once per day on TM, instead of once per push?\n\nIf we do this we can also use it for Kraken and other long running scripts. Bug 624792 is about adding Kraken to jit-tests but I had to tweak the tests to run faster. It would be good to check correctness of the full version too.", "author": "jdemooij@mozilla.com", "is_private": false, "id": 5398518, "tags": [], "creation_time": "2011-04-09T18:55:37Z", "attachment_id": null, "bug_id": 648379}, {"id": 5662436, "is_private": false, "author": "jdemooij@mozilla.com", "bug_id": 648379, "creation_time": "2011-08-18T14:39:38Z", "tags": [], "attachment_id": null, "time": "2011-08-18T14:39:38Z", "count": 9, "text": "(In reply to Alon Zakai (:azakai) from comment #7)\n> The risk is that I might miss a few weeks now and then. For example, I just\n> found another bug on tracemonkey with this, bug 648769, which looks like a\n> regression from almost two weeks ago.\n\nBug 679878 is another regression. From about a month ago, on the TI branch.\n\nWhat about Jesse's suggestion of running these tests once per day? Ideally on several branches (TI, MC, Ion). It doesn't have to be fancy, just an email to some people if there's a new failure.", "raw_text": "(In reply to Alon Zakai (:azakai) from comment #7)\n> The risk is that I might miss a few weeks now and then. For example, I just\n> found another bug on tracemonkey with this, bug 648769, which looks like a\n> regression from almost two weeks ago.\n\nBug 679878 is another regression. From about a month ago, on the TI branch.\n\nWhat about Jesse's suggestion of running these tests once per day? Ideally on several branches (TI, MC, Ion). It doesn't have to be fancy, just an email to some people if there's a new failure.", "creator": "jdemooij@mozilla.com"}]}}}