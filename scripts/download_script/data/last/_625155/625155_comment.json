{"comments": {}, "bugs": {"625155": {"comments": [{"is_private": false, "id": 5194513, "tags": [], "count": 0, "author": "wes@page.ca", "time": "2011-01-12T20:37:48Z", "creation_time": "2011-01-12T20:37:48Z", "bug_id": 625155, "text": "As we move further and further into long delays between runs of the cycle collector and JSAPI garbage collector, we run the risk of producing a browser which consumes more RAM than it needs to, as well as increasing our fragmenation.\n\nIf we kick off a run of the GC and CC when the browser loses focus, we can reclaim some memory when the user isn't needing interactive behaviour.\n\nGame system emulators, Flight of the Navigator, Defender of the Favicon, AJAX long poll apps, etc, can all generate plenty of churn objects when the browser is not focused, but we don't need to make the frame-rate/memory-usage trade-off when the browser isn't focused. So we could potentially restore some functionality (like calling JS_MaybeGC, or reducing the JSAPI GC threshold) when that is the case. That way the browser will be more likely to not need immediate GC when the user requires interaction again.\n\nSimilarly, if we have per-tab GC, we can be slightly more aggressive with GC at the expense of framerate for tabs that are not visible, etc.", "attachment_id": null, "raw_text": "As we move further and further into long delays between runs of the cycle collector and JSAPI garbage collector, we run the risk of producing a browser which consumes more RAM than it needs to, as well as increasing our fragmenation.\n\nIf we kick off a run of the GC and CC when the browser loses focus, we can reclaim some memory when the user isn't needing interactive behaviour.\n\nGame system emulators, Flight of the Navigator, Defender of the Favicon, AJAX long poll apps, etc, can all generate plenty of churn objects when the browser is not focused, but we don't need to make the frame-rate/memory-usage trade-off when the browser isn't focused. So we could potentially restore some functionality (like calling JS_MaybeGC, or reducing the JSAPI GC threshold) when that is the case. That way the browser will be more likely to not need immediate GC when the user requires interaction again.\n\nSimilarly, if we have per-tab GC, we can be slightly more aggressive with GC at the expense of framerate for tabs that are not visible, etc.", "creator": "wes@page.ca"}, {"count": 1, "author": "bugs@pettay.fi", "creator": "bugs@pettay.fi", "raw_text": "We could perhaps do something simple even for FF4.\nCall CC let's say 10 seconds after the FF was deactivated (no FF window focused).\n\nAnd perhaps we could increase the possibility for GC and CC when\nFF isn't focused.", "attachment_id": null, "id": 5194813, "bug_id": 625155, "tags": [], "text": "We could perhaps do something simple even for FF4.\nCall CC let's say 10 seconds after the FF was deactivated (no FF window focused).\n\nAnd perhaps we could increase the possibility for GC and CC when\nFF isn't focused.", "time": "2011-01-12T22:00:28Z", "is_private": false, "creation_time": "2011-01-12T22:00:28Z"}, {"attachment_id": 503292, "raw_text": "Applies over bug 624549.", "creator": "bugs@pettay.fi", "count": 2, "author": "bugs@pettay.fi", "is_private": false, "time": "2011-01-12T22:13:36Z", "creation_time": "2011-01-12T22:13:36Z", "bug_id": 625155, "id": 5194855, "text": "Created attachment 503292\nGC and CC after deactivation\n\nApplies over bug 624549.", "tags": []}, {"tags": [], "text": "Created attachment 506462\npatch\n\nOver a patch I'm going to attach to bug 624549.", "id": 5222574, "bug_id": 625155, "creation_time": "2011-01-24T19:27:02Z", "time": "2011-01-24T19:27:02Z", "is_private": false, "author": "bugs@pettay.fi", "count": 3, "raw_text": "Over a patch I'm going to attach to bug 624549.", "creator": "bugs@pettay.fi", "attachment_id": 506462}, {"tags": [], "id": 5223568, "is_private": false, "author": "jstenback+bmo@gmail.com", "count": 4, "text": "Comment on attachment 506462\npatch\n\n+    mAfterDeactivationTimer->InitWithFuncCallback(DeactivationTimerFired,\n+                                                  nsnull, 2500,\n+                                                  nsITimer::TYPE_ONE_SHOT);\n\nWhat made you change your mind from 10s to 2.5s?", "bug_id": 625155, "creation_time": "2011-01-24T23:39:36Z", "time": "2011-01-24T23:39:36Z", "attachment_id": 506462, "creator": "jstenback+bmo@gmail.com", "raw_text": "+    mAfterDeactivationTimer->InitWithFuncCallback(DeactivationTimerFired,\n+                                                  nsnull, 2500,\n+                                                  nsITimer::TYPE_ONE_SHOT);\n\nWhat made you change your mind from 10s to 2.5s?"}, {"text": "There is the user interactivity timer, which would fire \"inactive\" and that *might* cause CC (without GC). I think we just want to have a proper CC+GC when\nFF is deactivated. That is a bit hackish, and should be documented somewhere.", "bug_id": 625155, "creation_time": "2011-01-25T10:02:14Z", "time": "2011-01-25T10:02:14Z", "attachment_id": null, "raw_text": "There is the user interactivity timer, which would fire \"inactive\" and that *might* cause CC (without GC). I think we just want to have a proper CC+GC when\nFF is deactivated. That is a bit hackish, and should be documented somewhere.", "creator": "bugs@pettay.fi", "tags": [], "id": 5224728, "is_private": false, "author": "bugs@pettay.fi", "count": 5}, {"count": 6, "author": "bugs@pettay.fi", "creator": "bugs@pettay.fi", "raw_text": "I need to update this.\nI still think we want something like this.", "attachment_id": 506462, "id": 5373993, "bug_id": 625155, "tags": [], "text": "Comment on attachment 506462\npatch\n\nI need to update this.\nI still think we want something like this.", "time": "2011-03-28T12:40:12Z", "is_private": false, "creation_time": "2011-03-28T12:40:12Z"}]}}}