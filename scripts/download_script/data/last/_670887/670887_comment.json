{"bugs": {"670887": {"comments": [{"bug_id": 670887, "id": 5586271, "is_private": false, "creation_time": "2011-07-12T09:46:13Z", "creator": "rforbes@mozilla.com", "text": "issue:\n-------\nwhen a user attempts to create an account an email is sent.  This email is different depending on if the email address has been used or not.  If it has, the email says \"this email is already in use\".  This could give useful information to an attacker in order to brute for accounts.\n\nrecommended remediation\n-----------------------\nuse generic messages in email. \n\nExample: \"Instructions regarding registering an account have been sent to your email address.\"", "count": 0, "author": "rforbes@mozilla.com", "tags": [], "time": "2011-07-12T09:46:13Z", "raw_text": "issue:\n-------\nwhen a user attempts to create an account an email is sent.  This email is different depending on if the email address has been used or not.  If it has, the email says \"this email is already in use\".  This could give useful information to an attacker in order to brute for accounts.\n\nrecommended remediation\n-----------------------\nuse generic messages in email. \n\nExample: \"Instructions regarding registering an account have been sent to your email address.\"", "attachment_id": null}, {"creator": "rforbes@mozilla.com", "creation_time": "2011-07-12T09:49:54Z", "is_private": false, "attachment_id": null, "tags": [], "author": "rforbes@mozilla.com", "text": "This is also true for change password token.  \n\nThe following message is returned when an email that is not taken is submitted:\n\n\"A confirmation email has been sent containing a link to continue creating an account. The link will expire if an account is not created within 3 days.\"\n\nAn email that is taken responds the following message:\n\n\"There is already an account with the login name sentinel+a@whitehatsec.com.\"\n\nsolution is to utilize a generic message whether or not the email address is taken or not.\n\nExample: \"Instructions regarding registering an account have been sent to your email address.\"", "count": 1, "id": 5586276, "bug_id": 670887, "time": "2011-07-12T09:49:54Z", "raw_text": "This is also true for change password token.  \n\nThe following message is returned when an email that is not taken is submitted:\n\n\"A confirmation email has been sent containing a link to continue creating an account. The link will expire if an account is not created within 3 days.\"\n\nAn email that is taken responds the following message:\n\n\"There is already an account with the login name sentinel+a@whitehatsec.com.\"\n\nsolution is to utilize a generic message whether or not the email address is taken or not.\n\nExample: \"Instructions regarding registering an account have been sent to your email address.\""}, {"time": "2011-07-12T10:40:50Z", "raw_text": "This should probably go upstream.\n\nThe message should avoid lying. So:\n\n\"If there is not already an account for this email address, instructions on how to complete registration have been emailed to you. A reply must be received within 3 days.\n\nIf this address is already associated with an account, then no action has been taken.\"\n\nGerv", "bug_id": 670887, "id": 5586308, "author": "gerv@mozilla.org", "count": 2, "text": "This should probably go upstream.\n\nThe message should avoid lying. So:\n\n\"If there is not already an account for this email address, instructions on how to complete registration have been emailed to you. A reply must be received within 3 days.\n\nIf this address is already associated with an account, then no action has been taken.\"\n\nGerv", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-07-12T10:40:50Z", "creator": "gerv@mozilla.org"}, {"time": "2011-07-17T15:20:49Z", "raw_text": "This is not a security bug. When you register your email address, you have to know if it's already used in this Bugzilla installation or not. It doesn't make *any* sense to hide this information. The user doesn't need this \"trick\" to \"brute force\" user accounts. Using his own user account, he can already type random names in e.g. the CC list of bugs, and see lists being displayed there. No mystery here. And brute force won't work. The attacker will be locked at his 5th attempt.", "bug_id": 670887, "id": 5595496, "author": "LpSolit@gmail.com", "text": "This is not a security bug. When you register your email address, you have to know if it's already used in this Bugzilla installation or not. It doesn't make *any* sense to hide this information. The user doesn't need this \"trick\" to \"brute force\" user accounts. Using his own user account, he can already type random names in e.g. the CC list of bugs, and see lists being displayed there. No mystery here. And brute force won't work. The attacker will be locked at his 5th attempt.", "count": 3, "tags": [], "attachment_id": null, "creation_time": "2011-07-17T15:20:49Z", "is_private": false, "creator": "LpSolit@gmail.com"}, {"attachment_id": null, "tags": [], "creator": "reed@reedloden.com", "creation_time": "2011-07-17T19:56:34Z", "is_private": false, "raw_text": "It's not a \"security bug\", yes, but it is a common security enhancement.\n\nNote that another way that somebody can do this is to use the \"forgotten password\" functionality, which is very helpful at telling whether or not an account exists or not.\n\nExample:\n\nEnter \"blahblah@example.com\" in forgotten password.\nGet back \"There is no user named 'blahblah@example.com'. Either you mis-typed the name or that user has not yet registered for a Bugzilla account.\"\n\nWhile LpSolit is true that there are many other ways to enumerate Bugzilla's user database, I think this becomes more of a problem for private Bugzilla databases that don't allow just anybody to register. These \"tells\" can give an attacker very useful information about that Bugzilla instance that he/she may not be able to get via the other normal means.\n\nReopening this and converting it to an enhancement request. Leaving it open as non-security, however, as there's nothing sensitive here.", "time": "2011-07-17T19:56:34Z", "count": 4, "text": "It's not a \"security bug\", yes, but it is a common security enhancement.\n\nNote that another way that somebody can do this is to use the \"forgotten password\" functionality, which is very helpful at telling whether or not an account exists or not.\n\nExample:\n\nEnter \"blahblah@example.com\" in forgotten password.\nGet back \"There is no user named 'blahblah@example.com'. Either you mis-typed the name or that user has not yet registered for a Bugzilla account.\"\n\nWhile LpSolit is true that there are many other ways to enumerate Bugzilla's user database, I think this becomes more of a problem for private Bugzilla databases that don't allow just anybody to register. These \"tells\" can give an attacker very useful information about that Bugzilla instance that he/she may not be able to get via the other normal means.\n\nReopening this and converting it to an enhancement request. Leaving it open as non-security, however, as there's nothing sensitive here.", "author": "reed@reedloden.com", "bug_id": 670887, "id": 5595635}, {"raw_text": "If the user tries to sign up for an account with an email that already exists, we should treat it as a password reset request instead.  Don't show anything different in the UI, just the email they get would tell them they already have an account and here's a link to reset your password.\n\nThe ambiguous action here would be if the user has already requested a new account but hasn't responded to the token email yet.  We can't reset a password on an account that doesn't exist yet, and sending them additional email to say \"you already tried to sign up, here's your confirmation token again\" could possibly lead to a mailbombing if not done carefully.", "time": "2011-11-08T22:24:33Z", "id": 5835404, "bug_id": 670887, "author": "justdave@bugzilla.org", "count": 5, "text": "If the user tries to sign up for an account with an email that already exists, we should treat it as a password reset request instead.  Don't show anything different in the UI, just the email they get would tell them they already have an account and here's a link to reset your password.\n\nThe ambiguous action here would be if the user has already requested a new account but hasn't responded to the token email yet.  We can't reset a password on an account that doesn't exist yet, and sending them additional email to say \"you already tried to sign up, here's your confirmation token again\" could possibly lead to a mailbombing if not done carefully.", "tags": [], "attachment_id": null, "is_private": false, "creation_time": "2011-11-08T22:24:33Z", "creator": "justdave@bugzilla.org"}, {"author": "mkanat@bugzilla.org", "text": "(In reply to Dave Miller [:justdave] from comment #5)\n> If the user tries to sign up for an account with an email that already\n> exists, we should treat it as a password reset request instead.\n\n  No, I disagree, because the user's intention wasn't to do a password reset. It was to sign up for a new account. If the system isn't going to carry out their intention, it should tell them. I think this is even more relevant for Bugzilla instances that have non-email usernames in addition to their email usernames.", "count": 6, "creator": "mkanat@bugzilla.org", "is_private": false, "creation_time": "2011-11-15T08:54:19Z", "bug_id": 670887, "id": 5848942, "attachment_id": null, "raw_text": "(In reply to Dave Miller [:justdave] from comment #5)\n> If the user tries to sign up for an account with an email that already\n> exists, we should treat it as a password reset request instead.\n\n  No, I disagree, because the user's intention wasn't to do a password reset. It was to sign up for a new account. If the system isn't going to carry out their intention, it should tell them. I think this is even more relevant for Bugzilla instances that have non-email usernames in addition to their email usernames.", "time": "2011-11-15T08:54:19Z", "tags": []}, {"text": "(In reply to Max Kanat-Alexander from comment #6)\n> (In reply to Dave Miller [:justdave] from comment #5)\n> > If the user tries to sign up for an account with an email that already\n> > exists, we should treat it as a password reset request instead.\n> \n>   No, I disagree, because the user's intention wasn't to do a password\n> reset. It was to sign up for a new account. If the system isn't going to\n> carry out their intention, it should tell them. I think this is even more\n> relevant for Bugzilla instances that have non-email usernames in addition to\n> their email usernames.\n\nIn that case, we tell them they already have an account and instruct them to use the password reset facility if they don't remember the password.  But it would be more user-friendly to send them a reset link and say \"just don't use this if you remember the password\"", "count": 7, "author": "justdave@bugzilla.org", "bug_id": 670887, "id": 6278334, "raw_text": "(In reply to Max Kanat-Alexander from comment #6)\n> (In reply to Dave Miller [:justdave] from comment #5)\n> > If the user tries to sign up for an account with an email that already\n> > exists, we should treat it as a password reset request instead.\n> \n>   No, I disagree, because the user's intention wasn't to do a password\n> reset. It was to sign up for a new account. If the system isn't going to\n> carry out their intention, it should tell them. I think this is even more\n> relevant for Bugzilla instances that have non-email usernames in addition to\n> their email usernames.\n\nIn that case, we tell them they already have an account and instruct them to use the password reset facility if they don't remember the password.  But it would be more user-friendly to send them a reset link and say \"just don't use this if you remember the password\"", "time": "2012-05-03T22:00:01Z", "creator": "justdave@bugzilla.org", "is_private": false, "creation_time": "2012-05-03T22:00:01Z", "attachment_id": null, "tags": []}, {"creator": "LpSolit@gmail.com", "creation_time": "2012-05-03T22:06:34Z", "is_private": false, "attachment_id": null, "tags": [], "author": "LpSolit@gmail.com", "count": 8, "text": "(In reply to Dave Miller [:justdave] from comment #5)\n> If the user tries to sign up for an account with an email that already\n> exists, we should treat it as a password reset request instead.  Don't show\n> anything different in the UI, just the email they get would tell them they\n> already have an account and here's a link to reset your password.\n\nThis would be a great way to spam existing accounts, anonymously.", "bug_id": 670887, "id": 6278357, "raw_text": "(In reply to Dave Miller [:justdave] from comment #5)\n> If the user tries to sign up for an account with an email that already\n> exists, we should treat it as a password reset request instead.  Don't show\n> anything different in the UI, just the email they get would tell them they\n> already have an account and here's a link to reset your password.\n\nThis would be a great way to spam existing accounts, anonymously.", "time": "2012-05-03T22:06:34Z"}, {"attachment_id": null, "tags": [], "creator": "justdave@bugzilla.org", "creation_time": "2012-05-04T04:14:27Z", "is_private": false, "time": "2012-05-04T04:14:27Z", "raw_text": "(In reply to Fr\u00e9d\u00e9ric Buclin from comment #8)\n> This would be a great way to spam existing accounts, anonymously.\n\nSo is the existing method for resetting passwords, but we still do that.  How is this any different?", "author": "justdave@bugzilla.org", "count": 9, "text": "(In reply to Fr\u00e9d\u00e9ric Buclin from comment #8)\n> This would be a great way to spam existing accounts, anonymously.\n\nSo is the existing method for resetting passwords, but we still do that.  How is this any different?", "bug_id": 670887, "id": 6279211}, {"author": "matthewdf10@gmail.com", "count": 10, "text": "I am working on resolving a number of Whitehat bugs and this is the oldest one that is not yet resolved. Does anyone have an update on this?\n\nNote: changing all of our messages to generic ones will prevent 95% of these issues. For example in the reset password page, instead of saying \"email xx@mozilla.com does not exist\", the message should read \"A reset email has been sent to your email\" even if the email doesn't exist.", "creator": "matthewdf10@gmail.com", "creation_time": "2012-09-04T17:56:58Z", "is_private": false, "id": 6608013, "bug_id": 670887, "attachment_id": null, "raw_text": "I am working on resolving a number of Whitehat bugs and this is the oldest one that is not yet resolved. Does anyone have an update on this?\n\nNote: changing all of our messages to generic ones will prevent 95% of these issues. For example in the reset password page, instead of saying \"email xx@mozilla.com does not exist\", the message should read \"A reset email has been sent to your email\" even if the email doesn't exist.", "time": "2012-09-04T17:56:58Z", "tags": []}, {"author": "matthewdf10@gmail.com", "count": 11, "text": "Ping for an update here.", "creator": "matthewdf10@gmail.com", "is_private": false, "creation_time": "2012-10-10T23:12:28Z", "bug_id": 670887, "id": 6717495, "attachment_id": null, "raw_text": "Ping for an update here.", "time": "2012-10-10T23:12:28Z", "tags": []}, {"is_private": false, "creation_time": "2012-10-10T23:12:42Z", "creator": "matthewdf10@gmail.com", "tags": [], "attachment_id": null, "id": 6717497, "bug_id": 670887, "author": "matthewdf10@gmail.com", "text": "*** Bug 776273 has been marked as a duplicate of this bug. ***", "count": 12, "time": "2012-10-10T23:12:42Z", "raw_text": ""}, {"bug_id": 670887, "id": 10102039, "count": 13, "text": "*** Bug 1149452 has been marked as a duplicate of this bug. ***", "author": "LpSolit@gmail.com", "raw_text": "", "time": "2015-03-31T18:34:41Z", "creation_time": "2015-03-31T18:34:41Z", "is_private": false, "creator": "LpSolit@gmail.com", "tags": [], "attachment_id": null}, {"tags": [], "time": "2017-01-06T02:36:54Z", "attachment_id": null, "raw_text": "Hi Emma, I'm trying to determine if this bug is something we intend to fix, or if it can be closed wontfix. Are you the right person to ask for that determination? If not, can you help me find the right person? It's the only remaining open bug blocking the parent bug from several years ago being closed, which usually implies \"wontfix\". But just in case no one's looked at it in some time, needinfo requested.", "bug_id": 670887, "id": 11961213, "creation_time": "2017-01-06T02:36:54Z", "is_private": false, "creator": "atoll@mozilla.com", "author": "atoll@mozilla.com", "count": 14, "text": "Hi Emma, I'm trying to determine if this bug is something we intend to fix, or if it can be closed wontfix. Are you the right person to ask for that determination? If not, can you help me find the right person? It's the only remaining open bug blocking the parent bug from several years ago being closed, which usually implies \"wontfix\". But just in case no one's looked at it in some time, needinfo requested."}, {"text": "Note that this bug is filed in the Bugzilla product, meaning the generic software application used by orgs around the world.  If we want to implement this specifically for Mozilla's installation, bugzilla.mozilla.org, a separate bug should be filed under that product.", "count": 15, "author": "mcote@mozilla.bugs", "creator": "mcote@mozilla.bugs", "creation_time": "2017-01-06T13:26:24Z", "is_private": false, "bug_id": 670887, "id": 11962316, "raw_text": "Note that this bug is filed in the Bugzilla product, meaning the generic software application used by orgs around the world.  If we want to implement this specifically for Mozilla's installation, bugzilla.mozilla.org, a separate bug should be filed under that product.", "attachment_id": null, "time": "2017-01-06T13:26:24Z", "tags": []}, {"creation_time": "2017-01-06T17:59:11Z", "is_private": false, "bug_id": 670887, "id": 11963140, "author": "atoll@mozilla.com", "text": "I don't have any opinion on whether this should or should not be fixed for either upstream Bugzilla or only BMO, but if you can help ensure that it's evaluated for inclusion or rejection for upstream Bugzilla, I'm sure that would strongly guide any BMO decision.", "count": 16, "creator": "atoll@mozilla.com", "tags": [], "attachment_id": null, "raw_text": "I don't have any opinion on whether this should or should not be fixed for either upstream Bugzilla or only BMO, but if you can help ensure that it's evaluated for inclusion or rejection for upstream Bugzilla, I'm sure that would strongly guide any BMO decision.", "time": "2017-01-06T17:59:11Z"}, {"raw_text": "I'm going to move the bug into BMO for now, and get a couple of questions answered so I can prioritize it. If we decide to take it in BMO, then Bugzilla can take our fix.", "attachment_id": null, "time": "2017-01-06T18:33:38Z", "tags": [], "count": 17, "text": "I'm going to move the bug into BMO for now, and get a couple of questions answered so I can prioritize it. If we decide to take it in BMO, then Bugzilla can take our fix.", "author": "ech@emmah.net", "creator": "ech@emmah.net", "creation_time": "2017-01-06T18:33:38Z", "is_private": false, "bug_id": 670887, "id": 11963233}, {"raw_text": "Since it is blocking and dependent on other bugs, I'm going to have to clone into BMO instead.", "time": "2017-01-06T18:35:49Z", "id": 11963245, "bug_id": 670887, "author": "ech@emmah.net", "text": "Since it is blocking and dependent on other bugs, I'm going to have to clone into BMO instead.", "count": 18, "tags": [], "attachment_id": null, "creation_time": "2017-01-06T18:35:49Z", "is_private": false, "creator": "ech@emmah.net"}, {"creator": "atoll@mozilla.com", "count": 19, "text": "I closed the upstream meta-bug as this was the only one left attached to it. Since this isn't actionable until the BMO bug is evaluated, temporarily closing WONTFIX to clear out the dependency chain on this ancient security metabug. Anyone is welcome to reopen it when desired.", "author": "atoll@mozilla.com", "bug_id": 670887, "id": 11963274, "is_private": false, "creation_time": "2017-01-06T18:45:56Z", "time": "2017-01-06T18:45:56Z", "raw_text": "I closed the upstream meta-bug as this was the only one left attached to it. Since this isn't actionable until the BMO bug is evaluated, temporarily closing WONTFIX to clear out the dependency chain on this ancient security metabug. Anyone is welcome to reopen it when desired.", "attachment_id": null, "tags": []}]}}, "comments": {}}