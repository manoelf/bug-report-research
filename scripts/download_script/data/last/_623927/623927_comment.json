{"comments": {}, "bugs": {"623927": {"comments": [{"author": "jdiggs@igalia.com", "count": 0, "tags": [], "id": 5182754, "is_private": false, "attachment_id": null, "creator": "jdiggs@igalia.com", "raw_text": "Because applications can and do embed Gecko content, it is not always reliable for an assistive technology to use akt_util_get_toolkit_name(). That method only reports what the parent application toolkit happens to be.\n\nWe need toolkits to report themselves at the widget level. And the only way to do this, at the moment, seems to be as an attribute of the AtkObject associated with each widget, e.g. 'toolkit':'Gecko'.\n\nFWIW, WebKitGtk does this now ('toolkit':'WebKitGtk') and it's quite helpful in Orca's ability to present information from Yelp 3.0 and Epiphany.", "text": "Because applications can and do embed Gecko content, it is not always reliable for an assistive technology to use akt_util_get_toolkit_name(). That method only reports what the parent application toolkit happens to be.\n\nWe need toolkits to report themselves at the widget level. And the only way to do this, at the moment, seems to be as an attribute of the AtkObject associated with each widget, e.g. 'toolkit':'Gecko'.\n\nFWIW, WebKitGtk does this now ('toolkit':'WebKitGtk') and it's quite helpful in Orca's ability to present information from Yelp 3.0 and Epiphany.", "bug_id": 623927, "creation_time": "2011-01-07T16:42:21Z", "time": "2011-01-07T16:42:21Z"}, {"id": 5182785, "tags": [], "is_private": false, "count": 1, "author": "fherrera@onirica.com", "bug_id": 623927, "text": "Created attachment 502005\nPatch adding \"toolkit\" attibute to AtkObjects", "time": "2011-01-07T16:54:33Z", "creation_time": "2011-01-07T16:54:33Z", "raw_text": "", "creator": "fherrera@onirica.com", "attachment_id": 502005}, {"bug_id": 623927, "id": 5204349, "text": "MAI_NAME is defined in src/atk/nsApplicationAccessibleWrap.cpp\n\nIt should not be defined in 2 places.", "tags": [], "time": "2011-01-17T04:26:43Z", "is_private": false, "creation_time": "2011-01-17T04:26:43Z", "count": 2, "author": "ginnchen+exoracle@gmail.com", "attachment_id": null, "raw_text": "MAI_NAME is defined in src/atk/nsApplicationAccessibleWrap.cpp\n\nIt should not be defined in 2 places.", "creator": "ginnchen+exoracle@gmail.com"}, {"is_private": false, "tags": [], "id": 5204355, "author": "surkov.alexander@gmail.com", "count": 3, "creation_time": "2011-01-17T04:38:38Z", "time": "2011-01-17T04:38:38Z", "text": "(In reply to comment #2)\n> MAI_NAME is defined in src/atk/nsApplicationAccessibleWrap.cpp\n> \n> It should not be defined in 2 places.\n\nand nsApplicationAccessibleWrap should use nsApplicationAccessible.\n\nFernando, do you want to take a bug?", "bug_id": 623927, "creator": "surkov.alexander@gmail.com", "raw_text": "(In reply to comment #2)\n> MAI_NAME is defined in src/atk/nsApplicationAccessibleWrap.cpp\n> \n> It should not be defined in 2 places.\n\nand nsApplicationAccessibleWrap should use nsApplicationAccessible.\n\nFernando, do you want to take a bug?", "attachment_id": null}, {"is_private": false, "id": 5279307, "tags": [], "count": 4, "author": "surkov.alexander@gmail.com", "time": "2011-02-15T09:17:09Z", "creation_time": "2011-02-15T09:17:09Z", "bug_id": 623927, "text": "(In reply to comment #0)\n\n> We need toolkits to report themselves at the widget level. And the only way to\n> do this, at the moment, seems to be as an attribute of the AtkObject associated\n> with each widget, e.g. 'toolkit':'Gecko'.\n\nJoanie, why can't get_toolkit_name on AtkUtilClass be used instead an object attribute?\n\n> FWIW, WebKitGtk does this now ('toolkit':'WebKitGtk') and it's quite helpful in\n> Orca's ability to present information from Yelp 3.0 and Epiphany.\n\nIt's good point to be compatible with other applications and if you think it's worth to follow them then we can do this I think.", "creator": "surkov.alexander@gmail.com", "raw_text": "(In reply to comment #0)\n\n> We need toolkits to report themselves at the widget level. And the only way to\n> do this, at the moment, seems to be as an attribute of the AtkObject associated\n> with each widget, e.g. 'toolkit':'Gecko'.\n\nJoanie, why can't get_toolkit_name on AtkUtilClass be used instead an object attribute?\n\n> FWIW, WebKitGtk does this now ('toolkit':'WebKitGtk') and it's quite helpful in\n> Orca's ability to present information from Yelp 3.0 and Epiphany.\n\nIt's good point to be compatible with other applications and if you think it's worth to follow them then we can do this I think.", "attachment_id": null}, {"attachment_id": null, "creator": "fherrera@onirica.com", "raw_text": "(In reply to comment #4)\n> Joanie, why can't get_toolkit_name on AtkUtilClass be used instead an object\n> attribute?\n\nget_toolkit is not so useful when an application mixes two toolkits, like for example yelp using gtk for its chrome and gecko for html rendering.", "count": 5, "author": "fherrera@onirica.com", "time": "2011-02-15T13:28:52Z", "is_private": false, "creation_time": "2011-02-15T13:28:52Z", "bug_id": 623927, "id": 5279573, "text": "(In reply to comment #4)\n> Joanie, why can't get_toolkit_name on AtkUtilClass be used instead an object\n> attribute?\n\nget_toolkit is not so useful when an application mixes two toolkits, like for example yelp using gtk for its chrome and gecko for html rendering.", "tags": []}, {"attachment_id": null, "creator": "surkov.alexander@gmail.com", "raw_text": "(In reply to comment #5)\n> (In reply to comment #4)\n> > Joanie, why can't get_toolkit_name on AtkUtilClass be used instead an object\n> > attribute?\n> \n> get_toolkit is not so useful when an application mixes two toolkits, like for\n> example yelp using gtk for its chrome and gecko for html rendering.\n\nDoes gecko creates an application accessible in this case? It should.\n\nIs there a way to get AtkUtilClass for Gecko part?", "text": "(In reply to comment #5)\n> (In reply to comment #4)\n> > Joanie, why can't get_toolkit_name on AtkUtilClass be used instead an object\n> > attribute?\n> \n> get_toolkit is not so useful when an application mixes two toolkits, like for\n> example yelp using gtk for its chrome and gecko for html rendering.\n\nDoes gecko creates an application accessible in this case? It should.\n\nIs there a way to get AtkUtilClass for Gecko part?", "bug_id": 623927, "creation_time": "2011-02-15T13:40:40Z", "time": "2011-02-15T13:40:40Z", "author": "surkov.alexander@gmail.com", "count": 6, "tags": [], "id": 5279583, "is_private": false}, {"attachment_id": null, "raw_text": "Ping?", "creator": "surkov.alexander@gmail.com", "bug_id": 623927, "text": "Ping?", "time": "2011-03-10T15:38:05Z", "creation_time": "2011-03-10T15:38:05Z", "count": 7, "author": "surkov.alexander@gmail.com", "id": 5336188, "tags": [], "is_private": false}, {"attachment_id": null, "creator": "fherrera@onirica.com", "raw_text": "If we are going to add the toolking name attribute, it makes sense to add also the toolkit version.\n\nThe patch will be less hacky if we add the \"custom\" attributes inside ConvertToAtkAttributeSet function (because they are atk attributes and not genereci ns attributes).\n\nFinally, if I am correct we do not support embedding Gecko anymore, so the case where you have two diferent toolkits like Gtk embedding Gecko is not possible anymore.", "time": "2011-05-12T10:55:51Z", "creation_time": "2011-05-12T10:55:51Z", "bug_id": 623927, "text": "If we are going to add the toolking name attribute, it makes sense to add also the toolkit version.\n\nThe patch will be less hacky if we add the \"custom\" attributes inside ConvertToAtkAttributeSet function (because they are atk attributes and not genereci ns attributes).\n\nFinally, if I am correct we do not support embedding Gecko anymore, so the case where you have two diferent toolkits like Gtk embedding Gecko is not possible anymore.", "count": 8, "author": "fherrera@onirica.com", "is_private": false, "id": 5465134, "tags": []}, {"text": "Fernando, I have to ask you. When you do the comment providing some summary then please specify where it comes from. Otherwise it sounds that it's your personal observations and not a result of group discussion. Group decision is probably what we just should follow, personal observations are probably what should be discussed more.", "tags": [], "bug_id": 623927, "id": 5465155, "creation_time": "2011-05-12T11:18:04Z", "time": "2011-05-12T11:18:04Z", "is_private": false, "author": "surkov.alexander@gmail.com", "count": 9, "attachment_id": null, "raw_text": "Fernando, I have to ask you. When you do the comment providing some summary then please specify where it comes from. Otherwise it sounds that it's your personal observations and not a result of group discussion. Group decision is probably what we just should follow, personal observations are probably what should be discussed more.", "creator": "surkov.alexander@gmail.com"}, {"text": "Created attachment 531981\nUpdated patch\n\nYeah, sorry. We were discussing this during the Atk hackfest and we (Joanie, Alexander, API and me) that it would be nicer so have some kind of AtkToolkit interface, but that cannot be done until Atk 2.0. In the meantime we agreed that a temporary solution can be having it as an attribute.\n\nRegarding the old patch, I uploading a new version doing two things after Alexander comments:\n- Moving the custom Atk attributes adition into the ConvertToAtkAttributeSet function\n- Using nsApplicationAccessible::GetPlatformName to retrive our toolkit name (and GetPlatformVersion for toolkit version) instead of having those MAI_NAME and MAI_VERSION.\n\nHowever, I see two problems with this patch:\n- If we move the haspopup attribute adition into ConvertToAtkAttributeSet we need to modify the function prototype to pass also the accessible.\n- Using nsApplicationAccessible::GetPlatformName is much more lines of code (and calls) than using a compilation time define.", "bug_id": 623927, "creation_time": "2011-05-12T17:28:54Z", "time": "2011-05-12T17:28:54Z", "attachment_id": 531981, "raw_text": "Yeah, sorry. We were discussing this during the Atk hackfest and we (Joanie, Alexander, API and me) that it would be nicer so have some kind of AtkToolkit interface, but that cannot be done until Atk 2.0. In the meantime we agreed that a temporary solution can be having it as an attribute.\n\nRegarding the old patch, I uploading a new version doing two things after Alexander comments:\n- Moving the custom Atk attributes adition into the ConvertToAtkAttributeSet function\n- Using nsApplicationAccessible::GetPlatformName to retrive our toolkit name (and GetPlatformVersion for toolkit version) instead of having those MAI_NAME and MAI_VERSION.\n\nHowever, I see two problems with this patch:\n- If we move the haspopup attribute adition into ConvertToAtkAttributeSet we need to modify the function prototype to pass also the accessible.\n- Using nsApplicationAccessible::GetPlatformName is much more lines of code (and calls) than using a compilation time define.", "creator": "fherrera@onirica.com", "tags": [], "id": 5465934, "is_private": false, "author": "fherrera@onirica.com", "count": 10}, {"id": 5467745, "tags": [], "is_private": false, "count": 11, "author": "surkov.alexander@gmail.com", "bug_id": 623927, "text": "(In reply to comment #10)\n \n> Regarding the old patch, I uploading a new version doing two things after\n> Alexander comments:\n> - Moving the custom Atk attributes adition into the ConvertToAtkAttributeSet\n> function\n\n> However, I see two problems with this patch:\n> - If we move the haspopup attribute adition into ConvertToAtkAttributeSet we\n> need to modify the function prototype to pass also the accessible.\n\nI didn't mean that. What I said is add atk specific attributes directly to atkrelationset. ConvertToAtkAttributeSet should convert gecko attributes, nothing else.\n\n> - Using nsApplicationAccessible::GetPlatformName to retrive our toolkit name\n> (and GetPlatformVersion for toolkit version) instead of having those\n> MAI_NAME and MAI_VERSION.\n> \n\n> - Using nsApplicationAccessible::GetPlatformName is much more lines of code\n> (and calls) than using a compilation time define.\n\nYou can extend/change nsApplicationAccessible for that.", "time": "2011-05-13T09:59:45Z", "creation_time": "2011-05-13T09:59:45Z", "attachment_id": null, "creator": "surkov.alexander@gmail.com", "raw_text": "(In reply to comment #10)\n \n> Regarding the old patch, I uploading a new version doing two things after\n> Alexander comments:\n> - Moving the custom Atk attributes adition into the ConvertToAtkAttributeSet\n> function\n\n> However, I see two problems with this patch:\n> - If we move the haspopup attribute adition into ConvertToAtkAttributeSet we\n> need to modify the function prototype to pass also the accessible.\n\nI didn't mean that. What I said is add atk specific attributes directly to atkrelationset. ConvertToAtkAttributeSet should convert gecko attributes, nothing else.\n\n> - Using nsApplicationAccessible::GetPlatformName to retrive our toolkit name\n> (and GetPlatformVersion for toolkit version) instead of having those\n> MAI_NAME and MAI_VERSION.\n> \n\n> - Using nsApplicationAccessible::GetPlatformName is much more lines of code\n> (and calls) than using a compilation time define.\n\nYou can extend/change nsApplicationAccessible for that."}, {"count": 12, "author": "eitan@monotonous.org", "attachment_id": null, "creator": "eitan@monotonous.org", "raw_text": "Like fer said, you can't embed Gecko anymore. So this issue will never show up again :)", "bug_id": 623927, "id": 5818027, "text": "Like fer said, you can't embed Gecko anymore. So this issue will never show up again :)", "tags": [], "is_private": false, "time": "2011-11-01T15:41:49Z", "creation_time": "2011-11-01T15:41:49Z"}, {"time": "2011-11-01T21:41:08Z", "creation_time": "2011-11-01T21:41:08Z", "bug_id": 623927, "text": "(In reply to Eitan Isaacson [:eeejay] from comment #12)\n> Like fer said, you can't embed Gecko anymore. So this issue will never show\n> up again :)\n\nI don't recall a reason why it's still needed but I hope Joanie can give a hint. If occasionally we don't need to fix it then uploaded patch has some cleaningups and we should take them (file new bug for that or rename this one).\n\nreopen for now (to make sure we don't loose it by chance)", "creator": "surkov.alexander@gmail.com", "raw_text": "(In reply to Eitan Isaacson [:eeejay] from comment #12)\n> Like fer said, you can't embed Gecko anymore. So this issue will never show\n> up again :)\n\nI don't recall a reason why it's still needed but I hope Joanie can give a hint. If occasionally we don't need to fix it then uploaded patch has some cleaningups and we should take them (file new bug for that or rename this one).\n\nreopen for now (to make sure we don't loose it by chance)", "attachment_id": null, "is_private": false, "id": 5819192, "tags": [], "count": 13, "author": "surkov.alexander@gmail.com"}, {"attachment_id": null, "creator": "jdiggs@igalia.com", "raw_text": "If it will never, ever be the case where the reported toolkit of a Gecko application  can be something other than Gecko, I suppose it is no longer needed.", "time": "2011-11-07T10:58:12Z", "creation_time": "2011-11-07T10:58:12Z", "bug_id": 623927, "text": "If it will never, ever be the case where the reported toolkit of a Gecko application  can be something other than Gecko, I suppose it is no longer needed.", "count": 14, "author": "jdiggs@igalia.com", "is_private": false, "id": 5830329, "tags": []}, {"tags": [], "text": "Thanks, Joanie. So let's take cleaning up from uploaded patch and close the bug or if you like close this one and file new one for cleaning up.", "id": 5836307, "bug_id": 623927, "creation_time": "2011-11-09T06:19:00Z", "time": "2011-11-09T06:19:00Z", "is_private": false, "author": "surkov.alexander@gmail.com", "count": 15, "creator": "surkov.alexander@gmail.com", "raw_text": "Thanks, Joanie. So let's take cleaning up from uploaded patch and close the bug or if you like close this one and file new one for cleaning up.", "attachment_id": null}, {"attachment_id": null, "raw_text": "And also please do the same for your chrome (i.e. XUL or whatever). Thanks!", "creator": "jdiggs@igalia.com", "time": "2015-06-17T14:20:35Z", "creation_time": "2015-06-17T14:20:35Z", "bug_id": 623927, "text": "And also please do the same for your chrome (i.e. XUL or whatever). Thanks!", "count": 16, "author": "jdiggs@igalia.com", "is_private": false, "id": 10399567, "tags": []}, {"id": 10399848, "bug_id": 623927, "tags": [], "text": "Some summary of the discussion with Joanie. Orca has different processing of XUL and web content, and thus it needs to know where the user is. Historically Orca relies on toolkit object attribute for that. For example, epiphany browser exposes 'toolkit:gtk' for browser UI accessible objects, web content object exposes 'toolkit:webkitgtk'. To make Gecko compatible with ATK practices the suggestion is\n1) expose 'toolkit:gecko' for content\n2) expose 'toolkit:geckoxul' for browser UI", "is_private": false, "time": "2015-06-17T14:59:25Z", "creation_time": "2015-06-17T14:59:25Z", "count": 17, "author": "surkov.alexander@gmail.com", "raw_text": "Some summary of the discussion with Joanie. Orca has different processing of XUL and web content, and thus it needs to know where the user is. Historically Orca relies on toolkit object attribute for that. For example, epiphany browser exposes 'toolkit:gtk' for browser UI accessible objects, web content object exposes 'toolkit:webkitgtk'. To make Gecko compatible with ATK practices the suggestion is\n1) expose 'toolkit:gecko' for content\n2) expose 'toolkit:geckoxul' for browser UI", "creator": "surkov.alexander@gmail.com", "attachment_id": null}]}}}