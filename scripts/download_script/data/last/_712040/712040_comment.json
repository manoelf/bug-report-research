{"comments": {}, "bugs": {"712040": {"comments": [{"author": "dkl@mozilla.com", "time": "2011-12-19T17:47:13Z", "creation_time": "2011-12-19T17:47:13Z", "creator": "dkl@mozilla.com", "id": 5927064, "count": 0, "is_private": false, "bug_id": 712040, "text": "Created attachment 582861\nPatch to add lock icon to choose products to show product group restricted (v1)\n\n+++ This bug was initially created as a clone of Bug #705051 +++\n\nhttps://bugzilla.mozilla.org/enter_bug.cgi?full=1 lists the products available to the bug reporter.  However, sometimes the bug reporter can see products that others can't.  But this can lead to confusion when talking about how to file a bug.\n\nTo avoid confusion, enter_bug.cgi should have text (and probably also a different background color) next to a product that's only visible to some users saying who it's visible to.\n\nPatch based on Gerv's earlier work.\n\ndkl", "tags": [], "raw_text": "+++ This bug was initially created as a clone of Bug #705051 +++\n\nhttps://bugzilla.mozilla.org/enter_bug.cgi?full=1 lists the products available to the bug reporter.  However, sometimes the bug reporter can see products that others can't.  But this can lead to confusion when talking about how to file a bug.\n\nTo avoid confusion, enter_bug.cgi should have text (and probably also a different background color) next to a product that's only visible to some users saying who it's visible to.\n\nPatch based on Gerv's earlier work.\n\ndkl", "attachment_id": 582861}, {"creation_time": "2012-02-19T01:36:10Z", "time": "2012-02-19T01:36:10Z", "creator": "LpSolit@gmail.com", "author": "LpSolit@gmail.com", "id": 6074219, "count": 1, "is_private": false, "tags": [], "bug_id": 712040, "text": "Comment on attachment 582861\nPatch to add lock icon to choose products to show product group restricted (v1)\n\n>=== modified file 'skins/standard/global.css'\n\n>+.group_secure > th > a {\n\nWhy don't you reuse tr.bz_secure defined in buglist.css? What's the point to define another class name which does mostly the same thing?\n\n\n>=== modified file 'template/en/default/global/choose-product.html.tmpl'\n\n>   [% FOREACH p = c.products %]\n>+    [% class = \"\" %]\n>+    [% has_entry_groups = 0 %]\n>+    [% FOREACH gid = p.group_controls.keys %]\n>+      [% IF p.group_controls.$gid.entry %]\n>+        [% has_entry_groups = 1 %]\n>+        [% class = class _ \" group_$gid\" %]\n>+      [% END %]\n>+    [% END %]\n\nWhat's the performance penalty to call group_controls() on *all* products? Also, using group_$gid as classes is inconsistent with classes already used in bugs, which are of the form bz_group_$name. IMO, displaying the padlock only should be enough. I don't see the point to add more classes. This would fix the potential name/id leakage problem.\n\n\n>+    [%- IF has_entry_groups %] title=\"This product requires one or more\n>+ group memberships in order to enter [% terms.bugs %] in it. You have them, but be\n>+ aware not everyone else does.\"[% END %]>\n\nIMO, this warning is useless to 99.99% of users, which makes me wonder if this patch is really useful upstream. Some installations use group settings to only give you access to some very specific products, and so all products would be displayed with the padlock icon.", "attachment_id": 582861, "raw_text": ">=== modified file 'skins/standard/global.css'\n\n>+.group_secure > th > a {\n\nWhy don't you reuse tr.bz_secure defined in buglist.css? What's the point to define another class name which does mostly the same thing?\n\n\n>=== modified file 'template/en/default/global/choose-product.html.tmpl'\n\n>   [% FOREACH p = c.products %]\n>+    [% class = \"\" %]\n>+    [% has_entry_groups = 0 %]\n>+    [% FOREACH gid = p.group_controls.keys %]\n>+      [% IF p.group_controls.$gid.entry %]\n>+        [% has_entry_groups = 1 %]\n>+        [% class = class _ \" group_$gid\" %]\n>+      [% END %]\n>+    [% END %]\n\nWhat's the performance penalty to call group_controls() on *all* products? Also, using group_$gid as classes is inconsistent with classes already used in bugs, which are of the form bz_group_$name. IMO, displaying the padlock only should be enough. I don't see the point to add more classes. This would fix the potential name/id leakage problem.\n\n\n>+    [%- IF has_entry_groups %] title=\"This product requires one or more\n>+ group memberships in order to enter [% terms.bugs %] in it. You have them, but be\n>+ aware not everyone else does.\"[% END %]>\n\nIMO, this warning is useless to 99.99% of users, which makes me wonder if this patch is really useful upstream. Some installations use group settings to only give you access to some very specific products, and so all products would be displayed with the padlock icon."}, {"attachment_id": 604221, "raw_text": "New patch that uses bz_secure. Also no noticeably performance impact from adding this based on my benchmark tests. I admit when all products are product the usefulness decreases but BMO and Red Hat are pretty mixed with regard to private/public products so it would be useful for those at least.\n\ndkl", "tags": [], "bug_id": 712040, "text": "Created attachment 604221\nPatch to add lock icon to choose products to show product group restricted (v2)\n\nNew patch that uses bz_secure. Also no noticeably performance impact from adding this based on my benchmark tests. I admit when all products are product the usefulness decreases but BMO and Red Hat are pretty mixed with regard to private/public products so it would be useful for those at least.\n\ndkl", "is_private": false, "count": 2, "id": 6126043, "creator": "dkl@mozilla.com", "time": "2012-03-08T23:13:33Z", "creation_time": "2012-03-08T23:13:33Z", "author": "dkl@mozilla.com"}, {"time": "2012-04-11T00:31:35Z", "creation_time": "2012-04-11T00:31:35Z", "creator": "LpSolit@gmail.com", "text": "Comment on attachment 604221\nPatch to add lock icon to choose products to show product group restricted (v2)\n\n>+    [% FOREACH gid = p.group_controls.keys %]\n>+      [% IF p.group_controls.$gid.entry %]\n>+        [% has_entry_groups = 1 %]\n>+      [% END %]\n\nAs I suspect some performance issues when listing several tens or hundreds of products (or simply several tens or hundreds of useless calls to the DB), we should write a specific SQL query in enter_bug.cgi and describecomponents.cgi right before calling this template which returns products with the ENTRY bit set:\n\n  SELECT DISTINCT product_id FROM group_control_map WHERE entry != 0\n\nStore the result in a hash so that we can easily use it. Your code above could then totally be removed.\n\n\n>+    <tr class=\"[% \"bz_secure\" IF has_entry_groups %]\"\n\nThis class is not needed here. Please remove it.\n\n\n>+           class=\"[% \"bz_secure\" IF has_entry_groups +%]\">\n\nIMO, it would be better to write [% ' class=\"bz_secure\"' IF has_entry_groups %] to not create an empty class.\n\n\nI tested your patch, and the UI looks fine. So I'm fine with an updated patch with the comments above addressed.", "bug_id": 712040, "tags": [], "author": "LpSolit@gmail.com", "count": 3, "id": 6212574, "is_private": false, "attachment_id": 604221, "raw_text": ">+    [% FOREACH gid = p.group_controls.keys %]\n>+      [% IF p.group_controls.$gid.entry %]\n>+        [% has_entry_groups = 1 %]\n>+      [% END %]\n\nAs I suspect some performance issues when listing several tens or hundreds of products (or simply several tens or hundreds of useless calls to the DB), we should write a specific SQL query in enter_bug.cgi and describecomponents.cgi right before calling this template which returns products with the ENTRY bit set:\n\n  SELECT DISTINCT product_id FROM group_control_map WHERE entry != 0\n\nStore the result in a hash so that we can easily use it. Your code above could then totally be removed.\n\n\n>+    <tr class=\"[% \"bz_secure\" IF has_entry_groups %]\"\n\nThis class is not needed here. Please remove it.\n\n\n>+           class=\"[% \"bz_secure\" IF has_entry_groups +%]\">\n\nIMO, it would be better to write [% ' class=\"bz_secure\"' IF has_entry_groups %] to not create an empty class.\n\n\nI tested your patch, and the UI looks fine. So I'm fine with an updated patch with the comments above addressed."}, {"time": "2012-04-11T00:36:41Z", "creation_time": "2012-04-11T00:36:41Z", "creator": "LpSolit@gmail.com", "author": "LpSolit@gmail.com", "count": 4, "id": 6212590, "is_private": false, "text": "(In reply to Fr\u00e9d\u00e9ric Buclin from comment #3)\n> we should write a specific SQL query in enter_bug.cgi and\n> describecomponents.cgi right before calling this template\n\nI just realized that the bug summary only mentions enter_bug.cgi, not describecomponents.cgi. So the SQL query would only be needed in enter_bug.cgi. For describecomponents.cgi, if the template cannot find the hash I mentioned in my review, it simply won't display any padlock, which is fine.", "bug_id": 712040, "tags": [], "attachment_id": null, "raw_text": "(In reply to Fr\u00e9d\u00e9ric Buclin from comment #3)\n> we should write a specific SQL query in enter_bug.cgi and\n> describecomponents.cgi right before calling this template\n\nI just realized that the bug summary only mentions enter_bug.cgi, not describecomponents.cgi. So the SQL query would only be needed in enter_bug.cgi. For describecomponents.cgi, if the template cannot find the hash I mentioned in my review, it simply won't display any padlock, which is fine."}, {"is_private": false, "id": 7013278, "count": 5, "creator": "LpSolit@gmail.com", "time": "2013-01-17T19:06:54Z", "creation_time": "2013-01-17T19:06:54Z", "author": "LpSolit@gmail.com", "attachment_id": null, "raw_text": "Too late for 4.4. We already released rc1.", "tags": [], "bug_id": 712040, "text": "Too late for 4.4. We already released rc1."}]}}}