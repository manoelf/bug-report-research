{"bugs": {"703689": {"comments": [{"tags": [], "bug_id": 703689, "text": "In a nutshell, nowadays batteries take 20% of the time to charge 80% of the battery so 'chargingTime' might be very optimistic because the curve is going to be nearly vertical at the beginning and nearly flat at the end.\nWe could likely increase our precision by adding that parameter to our algorithm.", "attachment_id": null, "raw_text": "In a nutshell, nowadays batteries take 20% of the time to charge 80% of the battery so 'chargingTime' might be very optimistic because the curve is going to be nearly vertical at the beginning and nearly flat at the end.\nWe could likely increase our precision by adding that parameter to our algorithm.", "time": "2011-11-18T19:59:05Z", "creation_time": "2011-11-18T19:59:05Z", "creator": "mounir@lamouri.fr", "author": "mounir@lamouri.fr", "count": 0, "id": 5858962, "is_private": false}, {"bug_id": 703689, "text": "I grep 'chargingTime' and found some references under /mozilla-central/dom/battery component. Are there more information to assist in my understanding of how the battery charging/discharging is used, so I can try and address the issue properly?\n\nThanks!", "tags": [], "raw_text": "I grep 'chargingTime' and found some references under /mozilla-central/dom/battery component. Are there more information to assist in my understanding of how the battery charging/discharging is used, so I can try and address the issue properly?\n\nThanks!", "attachment_id": null, "author": "charles.wh.chan@gmail.com", "creation_time": "2012-02-26T04:56:06Z", "time": "2012-02-26T04:56:06Z", "creator": "charles.wh.chan@gmail.com", "count": 1, "id": 6093518, "is_private": false}, {"raw_text": "(In reply to Charles Chan from comment #1)\n> I grep 'chargingTime' and found some references under\n> /mozilla-central/dom/battery component. Are there more information to assist\n> in my understanding of how the battery charging/discharging is used, so I\n> can try and address the issue properly?\n\nWhat you found is correct but is for the DOM API.\nWhat you want to change is the Android backend which can be found here:\n/mozilla-central/mobile/android/base/GeckoBatteryManager.java", "attachment_id": null, "bug_id": 703689, "text": "(In reply to Charles Chan from comment #1)\n> I grep 'chargingTime' and found some references under\n> /mozilla-central/dom/battery component. Are there more information to assist\n> in my understanding of how the battery charging/discharging is used, so I\n> can try and address the issue properly?\n\nWhat you found is correct but is for the DOM API.\nWhat you want to change is the Android backend which can be found here:\n/mozilla-central/mobile/android/base/GeckoBatteryManager.java", "tags": [], "is_private": false, "count": 2, "id": 6094066, "author": "mounir@lamouri.fr", "creator": "mounir@lamouri.fr", "creation_time": "2012-02-26T19:52:49Z", "time": "2012-02-26T19:52:49Z"}, {"author": "charles.wh.chan@gmail.com", "time": "2012-02-27T06:56:27Z", "creation_time": "2012-02-27T06:56:27Z", "creator": "charles.wh.chan@gmail.com", "id": 6094646, "count": 3, "is_private": false, "tags": [], "bug_id": 703689, "text": "Thanks Mounir, I have a quick look at GeckoBatteryManager.java -- and this is definitely interesting. Will read up on the source and Android backend and battery tech in general before proposing something ...", "raw_text": "Thanks Mounir, I have a quick look at GeckoBatteryManager.java -- and this is definitely interesting. Will read up on the source and Android backend and battery tech in general before proposing something ...", "attachment_id": null}, {"raw_text": "Mounir, I think the change would be in the following block in /mozilla-central/mobile/android/base/GeckoBatteryManager.java:\n\n          if (sCharging) {\n            if (dLevel < 0) {\n              Log.w(LOGTAG, \"When charging, level should increase!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / dLevel * (1.0 - sLevel));\n            }\n          } else {\n            if (dLevel > 0) {\n              Log.w(LOGTAG, \"When discharging, level should decrease!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / -dLevel * sLevel);\n            }\n          }\n\nBased on the description, your expecting: \nTime\t        10.00%\t20.00%\t30.00%\t40.00%\t50.00%\t60.00%\t70.00%\t80.00%\t90.00%\t100.00%\nBattery Level\t50.00%\t80.00%\t82.50%\t85.00%\t87.50%\t90.00%\t92.50%\t95.00%\t97.50%\t100.00%\n\nAm I on the right track?\n\n---------\n\nI don't have an Android device for test, where does the charging time show up? Under Android OS settings? Or is it somewhere like 'about:config'?", "attachment_id": null, "tags": [], "bug_id": 703689, "text": "Mounir, I think the change would be in the following block in /mozilla-central/mobile/android/base/GeckoBatteryManager.java:\n\n          if (sCharging) {\n            if (dLevel < 0) {\n              Log.w(LOGTAG, \"When charging, level should increase!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / dLevel * (1.0 - sLevel));\n            }\n          } else {\n            if (dLevel > 0) {\n              Log.w(LOGTAG, \"When discharging, level should decrease!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / -dLevel * sLevel);\n            }\n          }\n\nBased on the description, your expecting: \nTime\t        10.00%\t20.00%\t30.00%\t40.00%\t50.00%\t60.00%\t70.00%\t80.00%\t90.00%\t100.00%\nBattery Level\t50.00%\t80.00%\t82.50%\t85.00%\t87.50%\t90.00%\t92.50%\t95.00%\t97.50%\t100.00%\n\nAm I on the right track?\n\n---------\n\nI don't have an Android device for test, where does the charging time show up? Under Android OS settings? Or is it somewhere like 'about:config'?", "is_private": false, "id": 6098101, "count": 4, "author": "charles.wh.chan@gmail.com", "creator": "charles.wh.chan@gmail.com", "creation_time": "2012-02-28T06:27:27Z", "time": "2012-02-28T06:27:27Z"}, {"creator": "mounir@lamouri.fr", "creation_time": "2012-02-28T11:25:49Z", "time": "2012-02-28T11:25:49Z", "author": "mounir@lamouri.fr", "is_private": false, "count": 5, "id": 6098491, "tags": [], "text": "So, my description was over-simplified. I don't know how long it takes usually to charge 50% of a battery. It very likely depends on the battery's type (chemicals inside) and the battery's age (but you could probably ignore that parameter).\n\nIf you have no Android device, I think you should try to find documentation about battery life depending on its type, write a patch and then someone could try it.\n\nTo show the charging time on an Android device, you have to use Nightly or Aurora (maybe Beta too) and load a webpage that shows |navigator.mozBattery.chargingTime|. Android doesn't provide that information.", "bug_id": 703689, "attachment_id": null, "raw_text": "So, my description was over-simplified. I don't know how long it takes usually to charge 50% of a battery. It very likely depends on the battery's type (chemicals inside) and the battery's age (but you could probably ignore that parameter).\n\nIf you have no Android device, I think you should try to find documentation about battery life depending on its type, write a patch and then someone could try it.\n\nTo show the charging time on an Android device, you have to use Nightly or Aurora (maybe Beta too) and load a webpage that shows |navigator.mozBattery.chargingTime|. Android doesn't provide that information."}, {"author": "rjain90@live.co.uk", "time": "2012-05-26T09:34:01Z", "creation_time": "2012-05-26T09:34:01Z", "creator": "rjain90@live.co.uk", "id": 6340488, "count": 6, "is_private": false, "tags": [], "bug_id": 703689, "text": "Can this work?\n\nif (sCharging) {\n            if (dLevel < 0) {\n              Log.w(LOGTAG, \"When charging, level should increase!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / dLevel * (1.0 - sLevel)* Math.round((8/10)*(max/sLevel));\n            }\n          }", "raw_text": "Can this work?\n\nif (sCharging) {\n            if (dLevel < 0) {\n              Log.w(LOGTAG, \"When charging, level should increase!\");\n              sRemainingTime = kUnknownRemainingTime;\n            } else {\n              sRemainingTime = Math.round(dt / dLevel * (1.0 - sLevel)* Math.round((8/10)*(max/sLevel));\n            }\n          }", "attachment_id": null}, {"tags": [], "text": "This is assuming that the curve is almost vertical till 80%", "bug_id": 703689, "raw_text": "This is assuming that the curve is almost vertical till 80%", "attachment_id": null, "author": "rjain90@live.co.uk", "creator": "rjain90@live.co.uk", "time": "2012-05-26T09:44:57Z", "creation_time": "2012-05-26T09:44:57Z", "is_private": false, "id": 6340496, "count": 7}, {"id": 6344148, "count": 8, "is_private": false, "time": "2012-05-29T09:49:17Z", "creation_time": "2012-05-29T09:49:17Z", "creator": "mounir@lamouri.fr", "author": "mounir@lamouri.fr", "attachment_id": null, "raw_text": "(In reply to Rishabh from comment #7)\n> This is assuming that the curve is almost vertical till 80%\n\nOn what do you base this approximation?", "tags": [], "text": "(In reply to Rishabh from comment #7)\n> This is assuming that the curve is almost vertical till 80%\n\nOn what do you base this approximation?", "bug_id": 703689}, {"author": "rjain90@live.co.uk", "creation_time": "2012-05-30T11:09:05Z", "time": "2012-05-30T11:09:05Z", "creator": "rjain90@live.co.uk", "id": 6348093, "count": 9, "is_private": false, "bug_id": 703689, "text": "8/10 * max = 80% battery charged\nthus, the value of the expression Math.round((8/10)*(max/sLevel)) decreases as the battery level increases. After 80% of the battery is charged this expression yields a value of 1 and therefore, ceases to affect the equation. \n\nThe remaining time is least accurate at lower battery levels and is significantly higher than obtained by the current calculations.", "tags": [], "raw_text": "8/10 * max = 80% battery charged\nthus, the value of the expression Math.round((8/10)*(max/sLevel)) decreases as the battery level increases. After 80% of the battery is charged this expression yields a value of 1 and therefore, ceases to affect the equation. \n\nThe remaining time is least accurate at lower battery levels and is significantly higher than obtained by the current calculations.", "attachment_id": null}, {"attachment_id": null, "raw_text": "I was just thinking that the amount of the battery getting charged would closer to the function -e^-t , where t is the time elapsed since it began to charge. If it is so then it can be implemented in the program and I would like to help in it.", "tags": [], "text": "I was just thinking that the amount of the battery getting charged would closer to the function -e^-t , where t is the time elapsed since it began to charge. If it is so then it can be implemented in the program and I would like to help in it.", "bug_id": 703689, "count": 10, "id": 6416612, "is_private": false, "time": "2012-06-23T07:03:28Z", "creation_time": "2012-06-23T07:03:28Z", "creator": "sankha93@gmail.com", "author": "sankha93@gmail.com"}, {"tags": [], "bug_id": 703689, "text": "Why -e^-t? Is there any paper/documentation explaining that this is the right approximation?", "attachment_id": null, "raw_text": "Why -e^-t? Is there any paper/documentation explaining that this is the right approximation?", "time": "2012-07-05T09:52:29Z", "creation_time": "2012-07-05T09:52:29Z", "creator": "mounir@lamouri.fr", "author": "mounir@lamouri.fr", "count": 11, "id": 6446222, "is_private": false}, {"time": "2012-07-05T15:23:23Z", "creation_time": "2012-07-05T15:23:23Z", "creator": "sankha93@gmail.com", "tags": [], "bug_id": 703689, "text": "(In reply to Mounir Lamouri (:mounir) from comment #11)\n> Why -e^-t? Is there any paper/documentation explaining that this is the\n> right approximation?\n\nYes, I found a few pages on the web that gives a graph between cell voltage and time:\nhttp://batteryuniversity.com/learn/article/charging_lithium_ion_batteries\nhttp://www.ibt-power.com/Battery_packs/Li_Ion/Lithium_ion_tech.html\n\nHere the curves are steep at first and then becomes almost flat, something similar to the -e^(-x) function here: http://www.wolframalpha.com/input/?i=-e^-x . This is not really an exact one and I didn't find any sources stating this to be the formula. This could be a rough estimate, that I thought so I just discussed it here.", "author": "sankha93@gmail.com", "id": 6446792, "count": 12, "is_private": false, "attachment_id": null, "raw_text": "(In reply to Mounir Lamouri (:mounir) from comment #11)\n> Why -e^-t? Is there any paper/documentation explaining that this is the\n> right approximation?\n\nYes, I found a few pages on the web that gives a graph between cell voltage and time:\nhttp://batteryuniversity.com/learn/article/charging_lithium_ion_batteries\nhttp://www.ibt-power.com/Battery_packs/Li_Ion/Lithium_ion_tech.html\n\nHere the curves are steep at first and then becomes almost flat, something similar to the -e^(-x) function here: http://www.wolframalpha.com/input/?i=-e^-x . This is not really an exact one and I didn't find any sources stating this to be the formula. This could be a rough estimate, that I thought so I just discussed it here."}, {"is_private": false, "count": 13, "id": 6450776, "author": "cjones.bugs@gmail.com", "creator": "cjones.bugs@gmail.com", "time": "2012-07-06T18:51:15Z", "creation_time": "2012-07-06T18:51:15Z", "raw_text": "IEEE 1725 includes information that we can use to make these estimates more precise.  We should reference that spec.", "attachment_id": null, "tags": [], "bug_id": 703689, "text": "IEEE 1725 includes information that we can use to make these estimates more precise.  We should reference that spec."}, {"is_private": false, "count": 14, "id": 6565218, "author": "jchilton@uw.edu", "creator": "jchilton@uw.edu", "time": "2012-08-18T22:41:27Z", "creation_time": "2012-08-18T22:41:27Z", "raw_text": "IEEE 1725: http://standards.ieee.org/findstds/standard/1725-2011.html\n\nI'm new but I'm going to look into this.", "attachment_id": null, "bug_id": 703689, "text": "IEEE 1725: http://standards.ieee.org/findstds/standard/1725-2011.html\n\nI'm new but I'm going to look into this.", "tags": []}, {"bug_id": 703689, "text": "Access costs over $100 even for IEEE members. I left them a voicemail about free access for this purpose. I'll follow up if/when I hear back from them.", "tags": [], "attachment_id": null, "raw_text": "Access costs over $100 even for IEEE members. I left them a voicemail about free access for this purpose. I'll follow up if/when I hear back from them.", "time": "2012-08-19T02:17:31Z", "creation_time": "2012-08-19T02:17:31Z", "creator": "jchilton@uw.edu", "author": "jchilton@uw.edu", "id": 6565402, "count": 15, "is_private": false}, {"text": "IEEE 1725 has no indication of battery charging curves.\n\nI understand that the charging curve can be modeled with a function of one variable that increases monotonically, passes through the points (0,0) and (0.2, 0.8), and has a horizontal asymptote at 1. I think at this point it is Mounir's decision what function to use. I found that Sankha's suggestion of y=-e^-bt+1 is appropriate because it satisfies all these constraints.\n\nI solved for the b that satisfies the points above, and found that y=-e^(-8.04719*x)+1 is a good model. Mounir, would you like me to implement this?", "bug_id": 703689, "tags": [], "raw_text": "IEEE 1725 has no indication of battery charging curves.\n\nI understand that the charging curve can be modeled with a function of one variable that increases monotonically, passes through the points (0,0) and (0.2, 0.8), and has a horizontal asymptote at 1. I think at this point it is Mounir's decision what function to use. I found that Sankha's suggestion of y=-e^-bt+1 is appropriate because it satisfies all these constraints.\n\nI solved for the b that satisfies the points above, and found that y=-e^(-8.04719*x)+1 is a good model. Mounir, would you like me to implement this?", "attachment_id": null, "author": "jchilton@uw.edu", "creator": "jchilton@uw.edu", "time": "2012-08-19T03:14:10Z", "creation_time": "2012-08-19T03:14:10Z", "is_private": false, "id": 6565426, "count": 16}, {"attachment_id": null, "raw_text": "John we are happy to cover the cost for accessing that document. Please email me at gal@mozilla.com", "text": "John we are happy to cover the cost for accessing that document. Please email me at gal@mozilla.com", "bug_id": 703689, "tags": [], "count": 17, "id": 6565508, "is_private": false, "creation_time": "2012-08-19T05:48:45Z", "time": "2012-08-19T05:48:45Z", "creator": "gal@uci.edu", "author": "gal@uci.edu"}, {"text": "Hi Andreas, I'm going to email you right after this comment. I have just verified in the IEEE document 1725-2011 that there is no mention of \"curve\" or \"model\", and the only 2 mentions of \"equation\" are irrelevant to this issue.", "bug_id": 703689, "tags": [], "raw_text": "Hi Andreas, I'm going to email you right after this comment. I have just verified in the IEEE document 1725-2011 that there is no mention of \"curve\" or \"model\", and the only 2 mentions of \"equation\" are irrelevant to this issue.", "attachment_id": null, "author": "jchilton@uw.edu", "creation_time": "2012-08-19T06:10:21Z", "time": "2012-08-19T06:10:21Z", "creator": "jchilton@uw.edu", "count": 18, "id": 6565528, "is_private": false}, {"creation_time": "2018-06-29T04:58:15Z", "time": "2018-06-29T04:58:15Z", "creator": "bug-husbandry-bot@mozilla.bugs", "tags": [], "bug_id": 703689, "text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly.", "author": "bug-husbandry-bot@mozilla.bugs", "id": 13436498, "count": 19, "attachment_id": null, "is_private": false, "raw_text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1472046\n\nMove all DOM bugs that haven\u2019t been updated in more than 3 years and has no one currently assigned to P5.\n\nIf you have questions, please contact :mdaly."}]}}, "comments": {}}