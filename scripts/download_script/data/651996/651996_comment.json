{"comments": {}, "bugs": {"651996": {"comments": [{"count": 0, "bug_id": 651996, "raw_text": "+++ This bug was initially created as a clone of Bug #651994 +++\n\nThis is very similar to to bug 650296 and 651994 and has a similar cause. When we resume a SSL session, we are relying on a trust decision that was made during the initial full handshake. But, we don't have a way, during the resumption, from extracting the actual validated certificate chain or usage trust information from the SSL session cache. We can't get that validated certificate chain from the SSL cache is because the libssl APIs do not provide a way for the certificate authentication callback to return the validated chain and/or to save application-specific data in the SSL session cache.", "tags": [], "is_private": false, "time": "2011-04-21T22:29:56Z", "creation_time": "2011-04-21T22:29:56Z", "author": "brian@briansmith.org", "text": "+++ This bug was initially created as a clone of Bug #651994 +++\n\nThis is very similar to to bug 650296 and 651994 and has a similar cause. When we resume a SSL session, we are relying on a trust decision that was made during the initial full handshake. But, we don't have a way, during the resumption, from extracting the actual validated certificate chain or usage trust information from the SSL session cache. We can't get that validated certificate chain from the SSL cache is because the libssl APIs do not provide a way for the certificate authentication callback to return the validated chain and/or to save application-specific data in the SSL session cache.", "creator": "brian@briansmith.org", "attachment_id": null, "id": 5425177}, {"bug_id": 651996, "count": 1, "time": "2011-04-23T00:10:59Z", "creator": "wtc@google.com", "author": "wtc@google.com", "raw_text": "Cache the peer's intermediate CA certificates in session ID, so that\nthey're available when we resume a session.\n\nThe certificates are the ones in the SSL Certificate message.", "is_private": false, "tags": [], "creation_time": "2011-04-23T00:10:59Z", "attachment_id": 527888, "id": 5427443, "text": "Created attachment 527888\nCache peer's certificate chain in session ID\n\nCache the peer's intermediate CA certificates in session ID, so that\nthey're available when we resume a session.\n\nThe certificates are the ones in the SSL Certificate message."}, {"is_private": false, "tags": [], "time": "2011-04-23T00:15:53Z", "count": 2, "raw_text": "The certificate authentication callback is given the SSL\nsocket 'fd'.  Pass 'fd' to SSL_PeerCertificateChain to get\nthe certificate chain in the peer's Certificate message.", "bug_id": 651996, "author": "wtc@google.com", "attachment_id": 527889, "id": 5427459, "text": "Created attachment 527889\nAdd the SSL_PeerCertificateChain function\n\nThe certificate authentication callback is given the SSL\nsocket 'fd'.  Pass 'fd' to SSL_PeerCertificateChain to get\nthe certificate chain in the peer's Certificate message.", "creator": "wtc@google.com", "creation_time": "2011-04-23T00:15:53Z"}]}}}