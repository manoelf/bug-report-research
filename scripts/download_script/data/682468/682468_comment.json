{"bugs": {"682468": {"comments": [{"attachment_id": null, "time": "2011-08-26T23:37:04Z", "author": "romaxa@gmail.com", "creator": "romaxa@gmail.com", "text": "Found it long time ago while investigating fennec scrolling performance issues.\nProblem is next:\nhitTest->BuildDisplayList - is not very cheap function\nWhen fennec content view scrolling started we detecting with hitTest scrollable frame.\nduring scrolling content view we continue perform hitTest\nhttp://hg.mozilla.org/mozilla-central/annotate/6eb75a6f3c1d/layout/base/nsPresShell.cpp#l6632\n\nbut ideally we can continue contentView scrolling without that hitTest and free some CPU.\n\nOprofile show this with hitTest:\n**********************************\n     7574 31.6864 libxul.so\n     7458 31.2011 vmlinux-2.6.32.39-dfl61-20113202\n     1103  4.6145 Xorg\n     1069  4.4722 libQtGui.so.4.7.4\n      878  3.6732 oprofiled\n      721  3.0164 libGLESv2_r125.so\n      669  2.7988 libc-2.10.1.so\n      574  2.4014 fennec\n~ 3.7% CPU idle\n**********************************\nWith cached frame trick:\n**********************************\n     7030 35.1940 vmlinux-2.6.32.39-dfl61-20113202\n     5810 29.0864 libxul.so\n      901  4.5106 libQtGui.so.4.7.4\n      881  4.4105 Xorg\n      636  3.1840 libGLESv2_r125.so\n      557  2.7885 libc-2.10.1.so\n      470  2.3529 fennec\n~ 8.7% CPU idle\n**********************************\n\nperf hit relatively not so big, but it sensitive for high 60FPS scrolling", "creation_time": "2011-08-26T23:37:04Z", "raw_text": "Found it long time ago while investigating fennec scrolling performance issues.\nProblem is next:\nhitTest->BuildDisplayList - is not very cheap function\nWhen fennec content view scrolling started we detecting with hitTest scrollable frame.\nduring scrolling content view we continue perform hitTest\nhttp://hg.mozilla.org/mozilla-central/annotate/6eb75a6f3c1d/layout/base/nsPresShell.cpp#l6632\n\nbut ideally we can continue contentView scrolling without that hitTest and free some CPU.\n\nOprofile show this with hitTest:\n**********************************\n     7574 31.6864 libxul.so\n     7458 31.2011 vmlinux-2.6.32.39-dfl61-20113202\n     1103  4.6145 Xorg\n     1069  4.4722 libQtGui.so.4.7.4\n      878  3.6732 oprofiled\n      721  3.0164 libGLESv2_r125.so\n      669  2.7988 libc-2.10.1.so\n      574  2.4014 fennec\n~ 3.7% CPU idle\n**********************************\nWith cached frame trick:\n**********************************\n     7030 35.1940 vmlinux-2.6.32.39-dfl61-20113202\n     5810 29.0864 libxul.so\n      901  4.5106 libQtGui.so.4.7.4\n      881  4.4105 Xorg\n      636  3.1840 libGLESv2_r125.so\n      557  2.7885 libc-2.10.1.so\n      470  2.3529 fennec\n~ 8.7% CPU idle\n**********************************\n\nperf hit relatively not so big, but it sensitive for high 60FPS scrolling", "bug_id": 682468, "id": 5681959, "count": 0, "is_private": false, "tags": []}, {"bug_id": 682468, "id": 5682099, "is_private": false, "count": 1, "tags": [], "attachment_id": null, "time": "2011-08-27T01:00:50Z", "text": "One more observation is: nsIFrame::BuildDisplayListForChild works 1.5-x slower when fennec TOOLBAR is visible.", "creation_time": "2011-08-27T01:00:50Z", "raw_text": "One more observation is: nsIFrame::BuildDisplayListForChild works 1.5-x slower when fennec TOOLBAR is visible.", "author": "romaxa@gmail.com", "creator": "romaxa@gmail.com"}]}}, "comments": {}}