{"comments": {}, "bugs": {"648383": {"comments": [{"attachment_id": null, "author": "boraas@mixpo.com", "count": 0, "tags": [], "time": "2011-04-07T22:36:27Z", "creator": "boraas@mixpo.com", "bug_id": 648383, "is_private": false, "creation_time": "2011-04-07T22:36:27Z", "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.16) Gecko/20110319 Firefox/3.6.16 MixpoPublisher/1.0.0.16336\nBuild Identifier: 3.6 and 4.0\n\nI have a specific page layout involving floating DIVs and nested DIVs. I want to adjust the height of one of the DIVs. When I increase the height, the page content below the DIV shifts down, as expected. When I decrease the height, the lower content does not move back up. The lower content seems to \"lock\" in its lowest position. So, any time I make the height of my resizing DIV larger than it has been before, the lower content notices and shifts down correctly. But changing the height of my resizing DIV to any smaller height has no effect on the lower content, even increasing and decreasing within that previous maximum.\n\nThe page layout can be fixed by resizing the browser window -- this causes the layout engine to move the lower content to where I expected it to be. So the layout engine knows where to put the lower content, it just didn't think it needed to move when I adjusted the height.\n\nReproducible: Always\n\nSteps to Reproduce:\nRender the following HTML in Firefox:\n\n<html>\n<body style=\"height:250px\">\n\t<div style=\"float:left\">First float</div>\n\t<div id=\"resizeMe\" style=\"float:left;width:100%\">Second float</div>\n\t<div>\n\t\t<div style=\"float:left;margin-top:1\">Third float</div>\n\t</div>\n<script>\nsetInterval(function(){\n\tvar resizeMe = document.getElementById(\"resizeMe\");\n\tif (!resizeMe.style.height || resizeMe.style.height == \"auto\") {\n\t\tresizeMe.style.height = \"100px\";\n\t} else {\n\t\tresizeMe.style.height = \"auto\";\n\t}\n}, 1000);\n</script>\n</body>\n</html> \n\nActual Results:  \nThe \"Third float\" moves down, but does not move up on its own. If I resize the browser window, the float does move to where it should be at that moment.\n\nExpected Results:  \nI expect to see the \"Third float\" move up and down on its own, every second. It does this is all versions of IE, Chrome, and Safari that I have tried. It does this is no version of Firefox that I have tried.\n\nI guess this is related to the incremental reflow engine, and I notice there are a few other bugs logged against it with the {inc} tag, so I have added that here too. Perhaps this is similar to 308733, which also involves floating DIVs. But the test cases appear somewhat different, so it seems good to have an additional test case, if the underlying bug is attempted to be fixed.\n\nUnfortunately, I cannot redesign my page layout to avoid this -- it is someone else's layout, and I just want to adjust the height of this 1 DIV and have the \"right thing\" happen around that. I am working around this problem by forcing the browser to reflow around my DIV by removing and reapplying its float style. I am using the following code for that, after every time I resize the DIV.\n\nvar oldFloat = resizeMe.style.cssFloat;\nresizeMe.style.cssFloat = \"none\";\n// looking up offsetLeft forces the reflow to happen... otherwise it gets optimized out\nvar test = resizeMe.offsetLeft;\nresizeMe.style.cssFloat = oldFloat;", "id": 5395266, "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.16) Gecko/20110319 Firefox/3.6.16 MixpoPublisher/1.0.0.16336\nBuild Identifier: 3.6 and 4.0\n\nI have a specific page layout involving floating DIVs and nested DIVs. I want to adjust the height of one of the DIVs. When I increase the height, the page content below the DIV shifts down, as expected. When I decrease the height, the lower content does not move back up. The lower content seems to \"lock\" in its lowest position. So, any time I make the height of my resizing DIV larger than it has been before, the lower content notices and shifts down correctly. But changing the height of my resizing DIV to any smaller height has no effect on the lower content, even increasing and decreasing within that previous maximum.\n\nThe page layout can be fixed by resizing the browser window -- this causes the layout engine to move the lower content to where I expected it to be. So the layout engine knows where to put the lower content, it just didn't think it needed to move when I adjusted the height.\n\nReproducible: Always\n\nSteps to Reproduce:\nRender the following HTML in Firefox:\n\n<html>\n<body style=\"height:250px\">\n\t<div style=\"float:left\">First float</div>\n\t<div id=\"resizeMe\" style=\"float:left;width:100%\">Second float</div>\n\t<div>\n\t\t<div style=\"float:left;margin-top:1\">Third float</div>\n\t</div>\n<script>\nsetInterval(function(){\n\tvar resizeMe = document.getElementById(\"resizeMe\");\n\tif (!resizeMe.style.height || resizeMe.style.height == \"auto\") {\n\t\tresizeMe.style.height = \"100px\";\n\t} else {\n\t\tresizeMe.style.height = \"auto\";\n\t}\n}, 1000);\n</script>\n</body>\n</html> \n\nActual Results:  \nThe \"Third float\" moves down, but does not move up on its own. If I resize the browser window, the float does move to where it should be at that moment.\n\nExpected Results:  \nI expect to see the \"Third float\" move up and down on its own, every second. It does this is all versions of IE, Chrome, and Safari that I have tried. It does this is no version of Firefox that I have tried.\n\nI guess this is related to the incremental reflow engine, and I notice there are a few other bugs logged against it with the {inc} tag, so I have added that here too. Perhaps this is similar to 308733, which also involves floating DIVs. But the test cases appear somewhat different, so it seems good to have an additional test case, if the underlying bug is attempted to be fixed.\n\nUnfortunately, I cannot redesign my page layout to avoid this -- it is someone else's layout, and I just want to adjust the height of this 1 DIV and have the \"right thing\" happen around that. I am working around this problem by forcing the browser to reflow around my DIV by removing and reapplying its float style. I am using the following code for that, after every time I resize the DIV.\n\nvar oldFloat = resizeMe.style.cssFloat;\nresizeMe.style.cssFloat = \"none\";\n// looking up offsetLeft forces the reflow to happen... otherwise it gets optimized out\nvar test = resizeMe.offsetLeft;\nresizeMe.style.cssFloat = oldFloat;"}, {"text": "Created attachment 524564\nThe testcase", "is_private": false, "creation_time": "2011-04-08T03:58:31Z", "raw_text": "", "id": 5395851, "bug_id": 648383, "tags": [], "time": "2011-04-08T03:58:31Z", "creator": "bzbarsky@mit.edu", "count": 1, "author": "bzbarsky@mit.edu", "attachment_id": 524564}, {"attachment_id": null, "time": "2011-04-08T04:00:23Z", "is_private": false, "author": "bzbarsky@mit.edu", "bug_id": 648383, "count": 2, "tags": [], "creator": "bzbarsky@mit.edu", "raw_text": "I lowered the interval to 100ms to make it slightly clearer.\n\nThis looks like a quirks-only problem; if I put the page in standards mode there is no issue.  Brian, I'm not sure whether that's an option for you; if it is, it would perform a lot better than the workaround you used.  And thank you very much for the testcase!", "id": 5395855, "text": "I lowered the interval to 100ms to make it slightly clearer.\n\nThis looks like a quirks-only problem; if I put the page in standards mode there is no issue.  Brian, I'm not sure whether that's an option for you; if it is, it would perform a lot better than the workaround you used.  And thank you very much for the testcase!", "creation_time": "2011-04-08T04:00:23Z"}, {"bug_id": 648383, "creator": "boraas@mixpo.com", "count": 3, "tags": [], "time": "2011-04-08T23:56:58Z", "raw_text": "Thanks for the quick investigation!\nYes, I see that when I add the following DOCTYPE:\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\nto my testcase, the problem goes away. However, I originally discovered the problem on a page using that DOCTYPE! I then deleted as much as possible from that page in order to create the smallest test case that still showed the problem. As part of that, I deleted the DOCTYPE, which seemed OK at the time, since it didn't change the behavior I was analyzing. Now I realize that was a mistake, since my final test case does have different behavior with and without that DOCTYPE. I should repeat that process, and keep the DOCTYPE this time!", "id": 5397862, "text": "Thanks for the quick investigation!\nYes, I see that when I add the following DOCTYPE:\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\nto my testcase, the problem goes away. However, I originally discovered the problem on a page using that DOCTYPE! I then deleted as much as possible from that page in order to create the smallest test case that still showed the problem. As part of that, I deleted the DOCTYPE, which seemed OK at the time, since it didn't change the behavior I was analyzing. Now I realize that was a mistake, since my final test case does have different behavior with and without that DOCTYPE. I should repeat that process, and keep the DOCTYPE this time!", "is_private": false, "creation_time": "2011-04-08T23:56:58Z", "author": "boraas@mixpo.com", "attachment_id": null}, {"attachment_id": null, "time": "2011-04-09T22:50:25Z", "is_private": false, "author": "bzbarsky@mit.edu", "bug_id": 648383, "count": 4, "tags": [], "creator": "bzbarsky@mit.edu", "text": "Brian, if you're willing to do that, it would be very helpful.  Thanks for minimizing the testcases!", "creation_time": "2011-04-09T22:50:25Z", "raw_text": "Brian, if you're willing to do that, it would be very helpful.  Thanks for minimizing the testcases!", "id": 5398678}, {"is_private": false, "time": "2016-04-30T21:42:31Z", "attachment_id": 8747479, "raw_text": "I think bz attached the wrong file.\n\nHere it is, but with the timeout change to 200.", "id": 11372178, "text": "Created attachment 8747479\nthe testcase\n\nI think bz attached the wrong file.\n\nHere it is, but with the timeout change to 200.", "creation_time": "2016-04-30T21:42:31Z", "bug_id": 648383, "count": 5, "tags": [], "creator": "dbaron@dbaron.org", "author": "dbaron@dbaron.org"}, {"time": "2016-04-30T21:46:31Z", "is_private": false, "attachment_id": 8747480, "creator": "dbaron@dbaron.org", "count": 6, "tags": [], "bug_id": 648383, "id": 11372181, "raw_text": "(and with a clearer description)", "creation_time": "2016-04-30T21:46:31Z", "text": "Created attachment 8747480\ntestcase in standards mode\n\n(and with a clearer description)", "author": "dbaron@dbaron.org"}]}}}