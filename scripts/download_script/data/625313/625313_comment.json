{"comments": {}, "bugs": {"625313": {"comments": [{"creator": "fake_healer@hotmail.com", "attachment_id": null, "id": 5196203, "text": "User-Agent:       Mozilla/5.0 (Windows NT 6.1; rv:2.0b8) Gecko/20100101 Firefox/4.0b8\nBuild Identifier: Mozilla/5.0 (Windows NT 6.1; rv:2.0b8) Gecko/20100101 Firefox/4.0b8\n\nThe event mousemove is not dispatch when mousedown has been triggered over an iframe, and the mouse is still down.\n\nThis works in Firefox 3.6 and earlier.\n\nIn a drag and drop emulation, an \"overlay\" div (which covers the whole window) is used to trigger on \"mousemove\". But when the \"dragstart\" event (represented by mousedown) starts over an iframe, the overlay div doesn't receive any event.\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Use this code:\n\n<html>\n  <head>\n    <style>\n    * {\n      -moz-user-select: none;\n    }\n    </style>\n    <script>\n      function showOverlay() {\n        var overlay = document.getElementById(\"overlay\");\n        overlay.style.display = \"block\";\n      }\n      function hideOverlay() {\n        var overlay = document.getElementById(\"overlay\");\n        overlay.style.display = \"none\";\n      }\n      \n      function Test() {\n        var oThis = this;\n        oThis.startMoving = function(evt) {\n          test_startMoving.apply(oThis, new Array(evt));\n        }\n        oThis.Moving = function(evt) {\n          test_Moving.apply(oThis, new Array(evt));\n        }\n        oThis.stopMoving = function(evt) {\n          test_stopMoving.apply(oThis, new Array(evt));\n        }\n      }\n      function test_startMoving(evt) {\n        var overlay = document.getElementById(\"overlay\");\n        showOverlay();\n        overlay.focus();\n        overlay.addEventListener(\"mousemove\", this.Moving, false);\n        overlay.addEventListener(\"mouseup\", this.stopMoving, false);\n        evt.preventDefault();\n        evt.stopPropagation();\n      }\n      function test_Moving(evt) {\n        var MoveObject = document.getElementById(\"MoveObject\");\n        MoveObject.style.left = evt.clientX - 50;\n        MoveObject.style.top = evt.clientY - 50;\n        MoveObject.style.display = \"block\";\n      }\n      function test_stopMoving(evt) {\n        var overlay = document.getElementById(\"overlay\");\n        hideOverlay();\n        overlay.removeEventListener(\"mousemove\", this.Moving, false);\n        overlay.removeEventListener(\"mouseup\", this.stopMoving, false);\n      }\n      \n    </script>\n  </head>\n  <body>\n    <div id=\"MoveObject\" style=\"position:absolute;width:100px;height:100px;left:50%;top:50%;background-color:yellow;z-index:0;\">\n      <div>Moving Object</div>\n    </div>\n    <div id=\"overlay\" style=\"width:100%;height:100%;position:absolute;top:0px;left:0px;background-color:#ffcccc;opacity:0.5;display:none;z-index:10;\"></div>\n    <iframe  id=\"win\" name=\"win\" style=\"position:absolute;width:400px;height:400px;\">\n    </iframe>\n    <script>\n      // FF3.5 b4 works FF3.6 works, FF4b6 fail\n      var content =\"<div STYLE='position:absolute;top:10;left:10;height:380px;width:380px;background-color:#00ff00;opacity:0.5'>Iframe Click here to drag 'Moving Object'</div>\";\n      var win = window[\"win\"];\n      var test = new Test();\n      var ifrm = document.getElementById('win');\n      ifrm = (ifrm.contentWindow) ? ifrm.contentWindow : (ifrm.contentDocument.document) ? ifrm.contentDocument.document : ifrm.contentDocument;\n      ifrm.document.open();\n      ifrm.document.write(content);\n      ifrm.document.close();\n      win.document.body.addEventListener(\"mousedown\", test.startMoving, false);\n    </script>\n  </body>\n</html>\n\n2. Mousedown on the green iframe and move the mouse around, without letting go of the button.\n3.\nActual Results:  \nThe yellow div doesn't move.\n\nExpected Results:  \nThe yellow div should move with the mouse.\n\nThis works in Firefox 3.6 and earlier versions.", "raw_text": "User-Agent:       Mozilla/5.0 (Windows NT 6.1; rv:2.0b8) Gecko/20100101 Firefox/4.0b8\nBuild Identifier: Mozilla/5.0 (Windows NT 6.1; rv:2.0b8) Gecko/20100101 Firefox/4.0b8\n\nThe event mousemove is not dispatch when mousedown has been triggered over an iframe, and the mouse is still down.\n\nThis works in Firefox 3.6 and earlier.\n\nIn a drag and drop emulation, an \"overlay\" div (which covers the whole window) is used to trigger on \"mousemove\". But when the \"dragstart\" event (represented by mousedown) starts over an iframe, the overlay div doesn't receive any event.\n\n\nReproducible: Always\n\nSteps to Reproduce:\n1. Use this code:\n\n<html>\n  <head>\n    <style>\n    * {\n      -moz-user-select: none;\n    }\n    </style>\n    <script>\n      function showOverlay() {\n        var overlay = document.getElementById(\"overlay\");\n        overlay.style.display = \"block\";\n      }\n      function hideOverlay() {\n        var overlay = document.getElementById(\"overlay\");\n        overlay.style.display = \"none\";\n      }\n      \n      function Test() {\n        var oThis = this;\n        oThis.startMoving = function(evt) {\n          test_startMoving.apply(oThis, new Array(evt));\n        }\n        oThis.Moving = function(evt) {\n          test_Moving.apply(oThis, new Array(evt));\n        }\n        oThis.stopMoving = function(evt) {\n          test_stopMoving.apply(oThis, new Array(evt));\n        }\n      }\n      function test_startMoving(evt) {\n        var overlay = document.getElementById(\"overlay\");\n        showOverlay();\n        overlay.focus();\n        overlay.addEventListener(\"mousemove\", this.Moving, false);\n        overlay.addEventListener(\"mouseup\", this.stopMoving, false);\n        evt.preventDefault();\n        evt.stopPropagation();\n      }\n      function test_Moving(evt) {\n        var MoveObject = document.getElementById(\"MoveObject\");\n        MoveObject.style.left = evt.clientX - 50;\n        MoveObject.style.top = evt.clientY - 50;\n        MoveObject.style.display = \"block\";\n      }\n      function test_stopMoving(evt) {\n        var overlay = document.getElementById(\"overlay\");\n        hideOverlay();\n        overlay.removeEventListener(\"mousemove\", this.Moving, false);\n        overlay.removeEventListener(\"mouseup\", this.stopMoving, false);\n      }\n      \n    </script>\n  </head>\n  <body>\n    <div id=\"MoveObject\" style=\"position:absolute;width:100px;height:100px;left:50%;top:50%;background-color:yellow;z-index:0;\">\n      <div>Moving Object</div>\n    </div>\n    <div id=\"overlay\" style=\"width:100%;height:100%;position:absolute;top:0px;left:0px;background-color:#ffcccc;opacity:0.5;display:none;z-index:10;\"></div>\n    <iframe  id=\"win\" name=\"win\" style=\"position:absolute;width:400px;height:400px;\">\n    </iframe>\n    <script>\n      // FF3.5 b4 works FF3.6 works, FF4b6 fail\n      var content =\"<div STYLE='position:absolute;top:10;left:10;height:380px;width:380px;background-color:#00ff00;opacity:0.5'>Iframe Click here to drag 'Moving Object'</div>\";\n      var win = window[\"win\"];\n      var test = new Test();\n      var ifrm = document.getElementById('win');\n      ifrm = (ifrm.contentWindow) ? ifrm.contentWindow : (ifrm.contentDocument.document) ? ifrm.contentDocument.document : ifrm.contentDocument;\n      ifrm.document.open();\n      ifrm.document.write(content);\n      ifrm.document.close();\n      win.document.body.addEventListener(\"mousedown\", test.startMoving, false);\n    </script>\n  </body>\n</html>\n\n2. Mousedown on the green iframe and move the mouse around, without letting go of the button.\n3.\nActual Results:  \nThe yellow div doesn't move.\n\nExpected Results:  \nThe yellow div should move with the mouse.\n\nThis works in Firefox 3.6 and earlier versions.", "bug_id": 625313, "is_private": false, "tags": [], "count": 0, "creation_time": "2011-01-13T09:29:39Z", "author": "fake_healer@hotmail.com", "time": "2011-01-13T09:29:39Z"}, {"author": "fake_healer@hotmail.com", "time": "2011-01-13T09:31:07Z", "count": 1, "creation_time": "2011-01-13T09:31:07Z", "tags": [], "raw_text": "", "is_private": false, "bug_id": 625313, "text": "Created attachment 503435\nSame testcase as in the link.", "attachment_id": 503435, "id": 5196205, "creator": "fake_healer@hotmail.com"}, {"tags": [], "creation_time": "2011-01-13T23:12:15Z", "count": 2, "time": "2011-01-13T23:12:15Z", "author": "xtc4uall@gmail.com", "creator": "xtc4uall@gmail.com", "id": 5198071, "attachment_id": null, "text": "Repro'd with Mozilla/5.0 (Windows NT 5.1; rv:2.0b10pre) Gecko/20110113 Firefox/4.0b10pre ID:20110113030355.", "is_private": false, "bug_id": 625313, "raw_text": "Repro'd with Mozilla/5.0 (Windows NT 5.1; rv:2.0b10pre) Gecko/20110113 Firefox/4.0b10pre ID:20110113030355."}, {"attachment_id": null, "creator": "bzbarsky@mit.edu", "text": "Isn't this just because of mouse capture?", "tags": [], "author": "bzbarsky@mit.edu", "creation_time": "2011-01-13T23:21:14Z", "id": 5198118, "raw_text": "Isn't this just because of mouse capture?", "bug_id": 625313, "is_private": false, "time": "2011-01-13T23:21:14Z", "count": 3}, {"attachment_id": null, "id": 5198203, "creator": "xtc4uall@gmail.com", "raw_text": "Last good nightly: 2010-10-28 First bad nightly: 2010-10-29\n\nPushlog: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=fe4898e97431&tochange=799a83ba5f86\n=> candidate: Bug 606192", "is_private": false, "bug_id": 625313, "text": "Last good nightly: 2010-10-28 First bad nightly: 2010-10-29\n\nPushlog: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=fe4898e97431&tochange=799a83ba5f86\n=> candidate: Bug 606192", "tags": [], "author": "xtc4uall@gmail.com", "time": "2011-01-13T23:41:30Z", "count": 4, "creation_time": "2011-01-13T23:41:30Z"}, {"tags": [], "creation_time": "2011-01-14T12:43:32Z", "count": 5, "time": "2011-01-14T12:43:32Z", "author": "bugs@pettay.fi", "creator": "bugs@pettay.fi", "id": 5199469, "attachment_id": null, "text": "Bah, it is tricky to get mouse event handling to work the same way it worked \nbefore bug 130078, partly because it isn't standardized at all.", "bug_id": 625313, "is_private": false, "raw_text": "Bah, it is tricky to get mouse event handling to work the same way it worked \nbefore bug 130078, partly because it isn't standardized at all."}, {"tags": [], "creation_time": "2011-04-07T07:27:54Z", "author": "fake_healer@hotmail.com", "creator": "fake_healer@hotmail.com", "attachment_id": null, "text": "This bug turned out to be a blocker for us now that Firefox 4 has been released.\n\nAny chance some poor soul would give it a try? :)", "count": 6, "time": "2011-04-07T07:27:54Z", "id": 5394065, "raw_text": "This bug turned out to be a blocker for us now that Firefox 4 has been released.\n\nAny chance some poor soul would give it a try? :)", "bug_id": 625313, "is_private": false}, {"tags": [], "time": "2012-01-25T22:15:55Z", "author": "cagster@hotmail.com", "creation_time": "2012-01-25T22:15:55Z", "count": 7, "id": 6009156, "attachment_id": null, "creator": "cagster@hotmail.com", "bug_id": 625313, "is_private": false, "raw_text": "How about a workaround?\n\nI have an odd one:\nWhile holding down the mouse button, I then alt-tab to another app and then alt-tab back (remember to keep holding mouse button down throughout) then the mousemove events start firing okay.\n\nIs there a way to force this? I can't ask users to alt-tab away and then back.\n\nAnother workaround is to remove \"preventDefault()\" which fixes mousemove, but the text selection is now messing up the look of the drag and drop. Is there a way to just turn off selection without using preventDefault?\n\nIt seems like preventDefault() became broken in FF4 build 7 ... and now through FF9.", "text": "How about a workaround?\n\nI have an odd one:\nWhile holding down the mouse button, I then alt-tab to another app and then alt-tab back (remember to keep holding mouse button down throughout) then the mousemove events start firing okay.\n\nIs there a way to force this? I can't ask users to alt-tab away and then back.\n\nAnother workaround is to remove \"preventDefault()\" which fixes mousemove, but the text selection is now messing up the look of the drag and drop. Is there a way to just turn off selection without using preventDefault?\n\nIt seems like preventDefault() became broken in FF4 build 7 ... and now through FF9."}, {"text": "I meant beta 7, not build 7.", "raw_text": "I meant beta 7, not build 7.", "is_private": false, "bug_id": 625313, "creator": "cagster@hotmail.com", "attachment_id": null, "id": 6009289, "count": 8, "creation_time": "2012-01-25T22:42:28Z", "author": "cagster@hotmail.com", "time": "2012-01-25T22:42:28Z", "tags": []}, {"is_private": false, "bug_id": 625313, "raw_text": "preventDefault() is broken in more than just the specific case of this bug? If so please file a new bug for that.", "text": "preventDefault() is broken in more than just the specific case of this bug? If so please file a new bug for that.", "id": 6009459, "attachment_id": null, "creator": "tnikkel@gmail.com", "time": "2012-01-25T23:28:27Z", "author": "tnikkel@gmail.com", "creation_time": "2012-01-25T23:28:27Z", "count": 9, "tags": []}, {"creation_time": "2012-01-26T00:00:16Z", "count": 10, "time": "2012-01-26T00:00:16Z", "author": "cagster@hotmail.com", "tags": [], "text": "This bug describes my problem very well. I am trying to figure out a workaround. \n\nDaniel wrote in his test code \"FF3.5 b4 works FF3.6 works, FF4b6 fail,\" but maybe he had a typo because the problem first appears in FF4b7.\n\nSince FF4b7, \"preventDefault\" appears to have this bad side-effect.", "is_private": false, "bug_id": 625313, "raw_text": "This bug describes my problem very well. I am trying to figure out a workaround. \n\nDaniel wrote in his test code \"FF3.5 b4 works FF3.6 works, FF4b6 fail,\" but maybe he had a typo because the problem first appears in FF4b7.\n\nSince FF4b7, \"preventDefault\" appears to have this bad side-effect.", "creator": "cagster@hotmail.com", "id": 6009575, "attachment_id": null}, {"attachment_id": null, "id": 6016191, "creator": "cagster@hotmail.com", "raw_text": "Hi, I need to retract my last comments on workarounds. Also, my comments about \"preventDefault\" should be ignored too. My issue seems to be different than Daniel's. But the same code changes to Firefox might have caused both our issues.\n\nFor my issue, the new methods in FF4 for setCapture caused my app to break because my custom methods setCapture methods were no longer called. The same thing happened to Jeff:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=503943#c51\nI have renamed my methods to something like setMyCapture and all seems to work fine now.\n\nFor Daniel, the same code to fix defect 503943 might cause his issue since that defect mentions beta 6 like Daniel wrote too.\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=503943#c46\nDaniel, check out 603550 which is derived from that comment # 46 in 503943:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=603550", "is_private": false, "bug_id": 625313, "text": "Hi, I need to retract my last comments on workarounds. Also, my comments about \"preventDefault\" should be ignored too. My issue seems to be different than Daniel's. But the same code changes to Firefox might have caused both our issues.\n\nFor my issue, the new methods in FF4 for setCapture caused my app to break because my custom methods setCapture methods were no longer called. The same thing happened to Jeff:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=503943#c51\nI have renamed my methods to something like setMyCapture and all seems to work fine now.\n\nFor Daniel, the same code to fix defect 503943 might cause his issue since that defect mentions beta 6 like Daniel wrote too.\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=503943#c46\nDaniel, check out 603550 which is derived from that comment # 46 in 503943:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=603550", "tags": [], "author": "cagster@hotmail.com", "time": "2012-01-28T03:04:00Z", "count": 11, "creation_time": "2012-01-28T03:04:00Z"}]}}}