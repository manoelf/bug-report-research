{"comments": {}, "bugs": {"685168": {"comments": [{"id": 5704921, "count": 0, "is_private": false, "time": "2011-09-07T15:24:31Z", "creation_time": "2011-09-07T15:24:31Z", "creator": "gfahrner@lexsi.com", "author": "gfahrner@lexsi.com", "attachment_id": 558819, "raw_text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:6.0) Gecko/20100101 Firefox/6.0\nBuild ID: 20110825133144\n\nSteps to reproduce:\n\nLoad a XML file containing an expansion attack with an XMLHttpRequest call. Same effect with nested entities infinite loop. \n\n\nActual results:\n\nLinux : Firefox crash, system is unusable (need to restart X)\nWindows XP / Seven : firefox crash, system is slow but usable\n\nAll tested version are affected : 3.6.14 / 6.0 / 6.0.1\n\nFirefox is unusable : immediate. Delay for crash is between 10 and 60 seconds.\n\n\n\n\nExpected results:\n\nProtection against XML expansion attack as if the XML file was loaded directly.", "text": "Created attachment 558819\nHTML_XML.txt\n\nUser Agent: Mozilla/5.0 (X11; Linux x86_64; rv:6.0) Gecko/20100101 Firefox/6.0\nBuild ID: 20110825133144\n\nSteps to reproduce:\n\nLoad a XML file containing an expansion attack with an XMLHttpRequest call. Same effect with nested entities infinite loop. \n\n\nActual results:\n\nLinux : Firefox crash, system is unusable (need to restart X)\nWindows XP / Seven : firefox crash, system is slow but usable\n\nAll tested version are affected : 3.6.14 / 6.0 / 6.0.1\n\nFirefox is unusable : immediate. Delay for crash is between 10 and 60 seconds.\n\n\n\n\nExpected results:\n\nProtection against XML expansion attack as if the XML file was loaded directly.", "bug_id": 685168, "tags": []}, {"author": "bob@bclary.com", "creation_time": "2011-09-07T15:47:21Z", "time": "2011-09-07T15:47:21Z", "creator": "bob@bclary.com", "id": 5704983, "count": 1, "is_private": false, "tags": [], "bug_id": 685168, "text": "Created attachment 558831\nexpansion_attack.xml", "raw_text": "", "attachment_id": 558831}, {"text": "Created attachment 558832\ntest.html", "bug_id": 685168, "tags": [], "raw_text": "", "attachment_id": 558832, "author": "bob@bclary.com", "time": "2011-09-07T15:48:54Z", "creation_time": "2011-09-07T15:48:54Z", "creator": "bob@bclary.com", "count": 2, "id": 5704989, "is_private": false}, {"count": 3, "id": 5705094, "is_private": false, "time": "2011-09-07T16:24:52Z", "creation_time": "2011-09-07T16:24:52Z", "creator": "bob@bclary.com", "author": "bob@bclary.com", "attachment_id": 558843, "raw_text": "now with proper domain.", "text": "Created attachment 558843\ntest.html\n\nnow with proper domain.", "bug_id": 685168, "tags": []}, {"author": "gfahrner@lexsi.com", "creator": "gfahrner@lexsi.com", "creation_time": "2011-09-07T18:20:39Z", "time": "2011-09-07T18:20:39Z", "is_private": false, "count": 4, "id": 5705452, "tags": [], "bug_id": 685168, "text": "Created attachment 558887\nRight XML file", "raw_text": "", "attachment_id": 558887}, {"time": "2011-09-07T18:35:54Z", "creation_time": "2011-09-07T18:35:54Z", "creator": "gfahrner@lexsi.com", "author": "gfahrner@lexsi.com", "count": 5, "id": 5705509, "is_private": false, "tags": [], "text": "Funny thing : first XML file provided (with the first entity define as empty) is not detected as a recursion when access directly (without javascript) and also lead to a (less violent) DOS.", "bug_id": 685168, "attachment_id": null, "raw_text": "Funny thing : first XML file provided (with the first entity define as empty) is not detected as a recursion when access directly (without javascript) and also lead to a (less violent) DOS."}, {"is_private": false, "count": 6, "id": 5705667, "author": "gfahrner@lexsi.com", "creator": "gfahrner@lexsi.com", "time": "2011-09-07T19:26:27Z", "creation_time": "2011-09-07T19:26:27Z", "raw_text": "New (good) test file.", "attachment_id": 558909, "tags": [], "text": "Created attachment 558909\nPOC\n\nNew (good) test file.", "bug_id": 685168}, {"is_private": false, "count": 7, "id": 5705675, "creator": "gfahrner@lexsi.com", "creation_time": "2011-09-07T19:32:00Z", "time": "2011-09-07T19:32:00Z", "author": "gfahrner@lexsi.com", "attachment_id": 558909, "raw_text": "Does not work on bugzilla...", "bug_id": 685168, "text": "Comment on attachment 558909\nPOC\n\nDoes not work on bugzilla...", "tags": []}, {"id": 5705710, "count": 8, "is_private": false, "author": "gfahrner@lexsi.com", "time": "2011-09-07T19:44:22Z", "creation_time": "2011-09-07T19:44:22Z", "creator": "gfahrner@lexsi.com", "raw_text": "Working POC : http://www.root-me.org/bug_id_685168/poc.html", "attachment_id": null, "text": "Working POC : http://www.root-me.org/bug_id_685168/poc.html", "bug_id": 685168, "tags": []}, {"attachment_id": null, "raw_text": "Definitely confirmed. Since it's sucking up so much memory I had to kill it before it crashed so I don't know if it's going to be stack exhaustion, OOM, or maybe something bad in expat. The stack I saw when I killed it was in DOM node insertion, but the ultimate crash might be later/elsewhere.\n\nPeter: please check whether this is a DoS or worse.", "text": "Definitely confirmed. Since it's sucking up so much memory I had to kill it before it crashed so I don't know if it's going to be stack exhaustion, OOM, or maybe something bad in expat. The stack I saw when I killed it was in DOM node insertion, but the ultimate crash might be later/elsewhere.\n\nPeter: please check whether this is a DoS or worse.", "bug_id": 685168, "tags": [], "is_private": false, "id": 5706557, "count": 9, "creator": "dveditz@mozilla.com", "time": "2011-09-08T01:01:56Z", "creation_time": "2011-09-08T01:01:56Z", "author": "dveditz@mozilla.com"}, {"raw_text": "It's a memory exhaustion DOS. Firefox will fail trying to allocate memory through mozalloc() call wich lead to INT3 / ERROR_NOT_ENOUGH_MEMORY and \"Access Violation when reading 0x00000000\".\n\nDoes not seems to be exploitable for remote exec (imho).", "attachment_id": null, "bug_id": 685168, "text": "It's a memory exhaustion DOS. Firefox will fail trying to allocate memory through mozalloc() call wich lead to INT3 / ERROR_NOT_ENOUGH_MEMORY and \"Access Violation when reading 0x00000000\".\n\nDoes not seems to be exploitable for remote exec (imho).", "tags": [], "is_private": false, "count": 10, "id": 5706981, "author": "gfahrner@lexsi.com", "creator": "gfahrner@lexsi.com", "creation_time": "2011-09-08T07:13:30Z", "time": "2011-09-08T07:13:30Z"}]}}}