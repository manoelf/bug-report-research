{"bugs": {"361624": {"comments": [{"text": "user style sheets may not imported from Safari\n\nthe problem is an inititialized variable, which could also hork bug #344284\n\nfrom my build:\n\n/Users/sspitzer/Desktop/trunk/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp:\nIn member function 'nsresult\nnsSafariProfileMigrator::ParseBookmarksFolder(const __CFArray*,\nnsIRDFResource*, nsIBookmarksService*, PRBool)':\n/Users/sspitzer/Desktop/trunk/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp:996:\nwarning: 'rv' may be used uninitialized in this function\n\nif I initialize rv to anything other than NS_OK (a.k.a. 0, see http://lxr.mozilla.org/seamonkey/source/xpcom/base/nsError.h#159), then CopyBookmarks() will fail, and we will never call CopyFormData() or CopyOtherData(), and CopyOtherData() is what migrates the user style sheets.\n\nelaborate steps to reproduce coming next!", "id": 3044461, "tags": [], "time": "2006-11-23T06:50:04Z", "bug_id": 361624, "attachment_id": null, "count": 0, "creator": "moco@sspitzer.org", "is_private": false, "raw_text": "user style sheets may not imported from Safari\n\nthe problem is an inititialized variable, which could also hork bug #344284\n\nfrom my build:\n\n/Users/sspitzer/Desktop/trunk/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp:\nIn member function 'nsresult\nnsSafariProfileMigrator::ParseBookmarksFolder(const __CFArray*,\nnsIRDFResource*, nsIBookmarksService*, PRBool)':\n/Users/sspitzer/Desktop/trunk/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp:996:\nwarning: 'rv' may be used uninitialized in this function\n\nif I initialize rv to anything other than NS_OK (a.k.a. 0, see http://lxr.mozilla.org/seamonkey/source/xpcom/base/nsError.h#159), then CopyBookmarks() will fail, and we will never call CopyFormData() or CopyOtherData(), and CopyOtherData() is what migrates the user style sheets.\n\nelaborate steps to reproduce coming next!", "author": "moco@sspitzer.org", "creation_time": "2006-11-23T06:50:04Z"}, {"count": 1, "attachment_id": null, "is_private": false, "creation_time": "2006-11-23T06:53:39Z", "author": "moco@sspitzer.org", "creator": "moco@sspitzer.org", "raw_text": "elaborate steps to reproduce:\n\n1) set up a userContent.css in safari (see attachment #1).  put it in ~/Library/Safari/userContent.css (the one I attached will disable the blink tag)\n2) verify that safari no longer blinks (see attachment #2 in safari)\n3) make sure that firefox blinks (see attachment #2 in firefox)\n4) import data from safari, including \"other data\" (see attachment #3)\n5) restart Firefox and make sure that we imported userContent.css and make sure that firefox no longer blinks\n\nwhen I forced import to fail, I got this on my console:\n\nJavaScript error: , line 0: uncaught exception: [Exception... \"Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIBrowserProfileMigrator.migrate]\"  nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"  location: \"JS frame :: chrome://browser/content/migration/migration.js :: anonymous :: line 390\"  data: no]\n\nI initialized rv to NS_ERROR_FAILURE.  the fix is to initialize to NS_OK.\n\nnote, I am not certain what rv is going to be initialized too, so reproducing this (to verify the fix) may not be easy.", "text": "elaborate steps to reproduce:\n\n1) set up a userContent.css in safari (see attachment #1).  put it in ~/Library/Safari/userContent.css (the one I attached will disable the blink tag)\n2) verify that safari no longer blinks (see attachment #2 in safari)\n3) make sure that firefox blinks (see attachment #2 in firefox)\n4) import data from safari, including \"other data\" (see attachment #3)\n5) restart Firefox and make sure that we imported userContent.css and make sure that firefox no longer blinks\n\nwhen I forced import to fail, I got this on my console:\n\nJavaScript error: , line 0: uncaught exception: [Exception... \"Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIBrowserProfileMigrator.migrate]\"  nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"  location: \"JS frame :: chrome://browser/content/migration/migration.js :: anonymous :: line 390\"  data: no]\n\nI initialized rv to NS_ERROR_FAILURE.  the fix is to initialize to NS_OK.\n\nnote, I am not certain what rv is going to be initialized too, so reproducing this (to verify the fix) may not be easy.", "id": 3044464, "time": "2006-11-23T06:53:39Z", "tags": [], "bug_id": 361624}, {"creation_time": "2006-11-23T06:55:59Z", "author": "moco@sspitzer.org", "raw_text": "", "is_private": false, "creator": "moco@sspitzer.org", "count": 2, "attachment_id": 246372, "bug_id": 361624, "time": "2006-11-23T06:55:59Z", "tags": [], "id": 3044466, "text": "Created attachment 246372\nattachment #1 (userContent.css)"}, {"attachment_id": 246373, "count": 3, "creator": "moco@sspitzer.org", "is_private": false, "raw_text": "", "author": "moco@sspitzer.org", "creation_time": "2006-11-23T06:56:41Z", "text": "Created attachment 246373\nattachment #2 (html with blink tag)", "id": 3044467, "tags": [], "time": "2006-11-23T06:56:41Z", "bug_id": 361624}, {"creation_time": "2006-11-23T06:57:48Z", "author": "moco@sspitzer.org", "raw_text": "", "is_private": false, "creator": "moco@sspitzer.org", "count": 4, "attachment_id": 246374, "bug_id": 361624, "time": "2006-11-23T06:57:48Z", "tags": [], "text": "Created attachment 246374\nattachment #3 (import from safari)", "id": 3044468}, {"attachment_id": 246375, "count": 5, "author": "moco@sspitzer.org", "creation_time": "2006-11-23T06:58:15Z", "is_private": false, "creator": "moco@sspitzer.org", "raw_text": "", "tags": [], "time": "2006-11-23T06:58:15Z", "id": 3044469, "text": "Created attachment 246375\nattachment #4 (setting up safari to use userContent.css)", "bug_id": 361624}, {"id": 3044470, "text": "Created attachment 246376\npatch to initialize rv (and fix another PLACES warning I created)\n\nthis has r=gavin over email", "tags": [], "time": "2006-11-23T06:58:55Z", "bug_id": 361624, "attachment_id": 246376, "count": 6, "creator": "moco@sspitzer.org", "is_private": false, "raw_text": "this has r=gavin over email", "author": "moco@sspitzer.org", "creation_time": "2006-11-23T06:58:55Z"}, {"text": "fixed on the trunk.\n\nChecking in nsOperaProfileMigrator.cpp;\n/cvsroot/mozilla/browser/components/migration/src/nsOperaProfileMigrator.cpp,v  <--  nsOperaProfileMigrator.cpp\nnew revision: 1.58; previous revision: 1.57\ndone\nChecking in nsSafariProfileMigrator.cpp;\n/cvsroot/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp,v  <--  nsSafariProfileMigrator.cpp\nnew revision: 1.33; previous revision: 1.32\ndone", "id": 3044475, "tags": [], "time": "2006-11-23T07:10:12Z", "bug_id": 361624, "attachment_id": null, "count": 7, "creator": "moco@sspitzer.org", "is_private": false, "raw_text": "fixed on the trunk.\n\nChecking in nsOperaProfileMigrator.cpp;\n/cvsroot/mozilla/browser/components/migration/src/nsOperaProfileMigrator.cpp,v  <--  nsOperaProfileMigrator.cpp\nnew revision: 1.58; previous revision: 1.57\ndone\nChecking in nsSafariProfileMigrator.cpp;\n/cvsroot/mozilla/browser/components/migration/src/nsSafariProfileMigrator.cpp,v  <--  nsSafariProfileMigrator.cpp\nnew revision: 1.33; previous revision: 1.32\ndone", "author": "moco@sspitzer.org", "creation_time": "2006-11-23T07:10:12Z"}]}}, "comments": {}}