{"bugs": {"670116": {"comments": [{"is_private": false, "id": 5580701, "count": 0, "author": "LpSolit@gmail.com", "creator": "LpSolit@gmail.com", "creation_time": "2011-07-08T12:09:02Z", "time": "2011-07-08T12:09:02Z", "raw_text": "The flagtypes.cc_list DB column is of type varchar(200), i.e. it accepts NULL values, but the code in Bugzilla always assumes cc_list to be defined, i.e. its value is expected to be \"\" when the CC list is empty (that's because the CC list field in editflagtypes.cgi passes an empty string when left empty).\n\nIn config/generate_test_data.pl (our QA script to generate data), we leave this field undefined, and so NULL is stored in the DB. This makes\n\n split(/[, ]+/, $cc_list)\n\nto throw \"Use of uninitialized value $cc_list in split at Bugzilla/Flag.pm line 955.\" every time it accesses this flagtype.\n\nSo we have two ways to fix the problem:\n1) Change the DB schema to \"varchar(200) NOTNULL\" for this column.\n2) Fix the code to a) store NULL instead of \"\" in the DB when the CC list is empty, and b) fix the code to correctly handle undefined CC lists.\n\nPersonally, I have no strong opinion. 1) would be easier as we wouldn't have to track all places in the code to make sure it doesn't fail when it gets \"undef\". mkanat, do you have a preference?\n\nIn the meantime, I will fix config/generate_test_data.pl to explicitly pass \"\" for the CC list, instead of undef.", "attachment_id": null, "tags": [], "text": "The flagtypes.cc_list DB column is of type varchar(200), i.e. it accepts NULL values, but the code in Bugzilla always assumes cc_list to be defined, i.e. its value is expected to be \"\" when the CC list is empty (that's because the CC list field in editflagtypes.cgi passes an empty string when left empty).\n\nIn config/generate_test_data.pl (our QA script to generate data), we leave this field undefined, and so NULL is stored in the DB. This makes\n\n split(/[, ]+/, $cc_list)\n\nto throw \"Use of uninitialized value $cc_list in split at Bugzilla/Flag.pm line 955.\" every time it accesses this flagtype.\n\nSo we have two ways to fix the problem:\n1) Change the DB schema to \"varchar(200) NOTNULL\" for this column.\n2) Fix the code to a) store NULL instead of \"\" in the DB when the CC list is empty, and b) fix the code to correctly handle undefined CC lists.\n\nPersonally, I have no strong opinion. 1) would be easier as we wouldn't have to track all places in the code to make sure it doesn't fail when it gets \"undef\". mkanat, do you have a preference?\n\nIn the meantime, I will fix config/generate_test_data.pl to explicitly pass \"\" for the CC list, instead of undef.", "bug_id": 670116}, {"attachment_id": null, "raw_text": "generate_test_data.pl has been patched:\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/4.0/\nmodified config/generate_test_data.pl\nCommitted revision 192.\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/3.6/\nmodified config/generate_test_data.pl\nCommitted revision 153.\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/3.4/\nmodified config/generate_test_data.pl\nCommitted revision 120.", "tags": [], "bug_id": 670116, "text": "generate_test_data.pl has been patched:\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/4.0/\nmodified config/generate_test_data.pl\nCommitted revision 192.\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/3.6/\nmodified config/generate_test_data.pl\nCommitted revision 153.\n\nCommitting to: bzr+ssh://lpsolit%40gmail.com@bzr.mozilla.org/bugzilla/qa/3.4/\nmodified config/generate_test_data.pl\nCommitted revision 120.", "is_private": false, "id": 5580717, "count": 1, "creator": "LpSolit@gmail.com", "creation_time": "2011-07-08T12:22:52Z", "time": "2011-07-08T12:22:52Z", "author": "LpSolit@gmail.com"}, {"id": 5600324, "count": 2, "is_private": false, "creation_time": "2011-07-19T22:12:45Z", "time": "2011-07-19T22:12:45Z", "creator": "mkanat@bugzilla.org", "author": "mkanat@bugzilla.org", "attachment_id": null, "raw_text": "I think NOT NULL DEFAULT '' sounds good to me. Keeps things simple.", "bug_id": 670116, "text": "I think NOT NULL DEFAULT '' sounds good to me. Keeps things simple.", "tags": []}]}}, "comments": {}}