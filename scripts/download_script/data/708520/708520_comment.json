{"bugs": {"708520": {"comments": [{"author": "stayopenmenu@gmail.com", "creator": "stayopenmenu@gmail.com", "bug_id": 708520, "id": 5899747, "tags": [], "count": 0, "is_private": false, "time": "2011-12-08T05:15:18Z", "attachment_id": 579959, "text": "Created attachment 579959\nAdd-on with simplified case demonstrating bug\n\nUser Agent: Mozilla/5.0 (Windows NT 6.1; rv:10.0a2) Gecko/20111207 Firefox/10.0a2\nBuild ID: 20111207042022\n\nSteps to reproduce:\n\nCreated an add-on that adds an autocomplete textbox with the enablehistoy attribute set to true.\n\n\nActual results:\n\nAutocomplete textbox appears and functions correctly *except* that clicking the dropdown arrow (which the enablehistory attribute adds) has no effect. IOW the dropdown (popup) does not appear.\n\n\nExpected results:\n\nThe dropdown showing possible selections should open when the arrow is clicked.", "raw_text": "User Agent: Mozilla/5.0 (Windows NT 6.1; rv:10.0a2) Gecko/20111207 Firefox/10.0a2\nBuild ID: 20111207042022\n\nSteps to reproduce:\n\nCreated an add-on that adds an autocomplete textbox with the enablehistoy attribute set to true.\n\n\nActual results:\n\nAutocomplete textbox appears and functions correctly *except* that clicking the dropdown arrow (which the enablehistory attribute adds) has no effect. IOW the dropdown (popup) does not appear.\n\n\nExpected results:\n\nThe dropdown showing possible selections should open when the arrow is clicked.", "creation_time": "2011-12-08T05:15:18Z"}, {"creator": "stayopenmenu@gmail.com", "author": "stayopenmenu@gmail.com", "is_private": false, "count": 1, "tags": [], "id": 5899780, "bug_id": 708520, "creation_time": "2011-12-08T05:36:54Z", "raw_text": "Seamonkey exhibits the same bug; Firefox does not. I added a workaround to my actual add-on (not the attached testcase add-on) that adds a click event handler to the dropdown arrow which calls myAutocompleteTextbox.showHistoryPopup(); making the dropdown/popup appear.", "text": "Seamonkey exhibits the same bug; Firefox does not. I added a workaround to my actual add-on (not the attached testcase add-on) that adds a click event handler to the dropdown arrow which calls myAutocompleteTextbox.showHistoryPopup(); making the dropdown/popup appear.", "time": "2011-12-08T05:36:54Z", "attachment_id": null}, {"text": "Maybe duplication of Bug 704521", "time": "2011-12-08T06:41:49Z", "attachment_id": null, "raw_text": "Maybe duplication of Bug 704521", "creation_time": "2011-12-08T06:41:49Z", "bug_id": 708520, "count": 2, "is_private": false, "tags": [], "id": 5899864, "creator": "alice0775@gmail.com", "author": "alice0775@gmail.com"}, {"is_private": false, "count": 3, "tags": [], "id": 5899869, "bug_id": 708520, "raw_text": "Sorry, please ignore comment #2", "creation_time": "2011-12-08T06:49:27Z", "text": "Sorry, please ignore comment #2", "attachment_id": null, "time": "2011-12-08T06:49:27Z", "creator": "alice0775@gmail.com", "author": "alice0775@gmail.com"}, {"id": 5899977, "tags": [], "is_private": false, "count": 4, "bug_id": 708520, "raw_text": "Confirmed on\nhttp://hg.mozilla.org/comm-central/rev/778c81627f48\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0a1) Gecko/20111207 Thunderbird/11.0a1 ID:20111207030021\nhttp://hg.mozilla.org/releases/comm-aurora/rev/494757cf43d9\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0a2) Gecko/20111207 Thunderbird/10.0a2 ID:20111207030021\nhttp://hg.mozilla.org/releases/comm-beta/rev/da477a14d2ce\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111130 Thunderbird/9.0 ID:20111130015651\nhttp://hg.mozilla.org/releases/comm-release/rev/3a77e857b5c1\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:8.0) Gecko/20111105 Thunderbird/8.0 ID:20111105021620", "creation_time": "2011-12-08T08:15:29Z", "attachment_id": null, "time": "2011-12-08T08:15:29Z", "text": "Confirmed on\nhttp://hg.mozilla.org/comm-central/rev/778c81627f48\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0a1) Gecko/20111207 Thunderbird/11.0a1 ID:20111207030021\nhttp://hg.mozilla.org/releases/comm-aurora/rev/494757cf43d9\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0a2) Gecko/20111207 Thunderbird/10.0a2 ID:20111207030021\nhttp://hg.mozilla.org/releases/comm-beta/rev/da477a14d2ce\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111130 Thunderbird/9.0 ID:20111130015651\nhttp://hg.mozilla.org/releases/comm-release/rev/3a77e857b5c1\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:8.0) Gecko/20111105 Thunderbird/8.0 ID:20111105021620", "author": "alice0775@gmail.com", "creator": "alice0775@gmail.com"}, {"author": "stayopenmenu@gmail.com", "creator": "stayopenmenu@gmail.com", "creation_time": "2011-12-08T17:01:02Z", "raw_text": "Upon further examination with DOMi, the bug shown in the first attached testcase may not be triggered by the same code as the bug I am encountering in my actual extension development, even though it exhibits the exact same symptom.  In the first attachment's testcase, clicking the arrow shows:\n\nError: textbox.showHistoryPopup is not a function\nSource File: chrome://global/content/bindings/autocomplete.xml\nLine: 1628\n\nin the error console.\n\n\nAttaching a second testcase which adds an autocomplete textbox to the Add-ons Manager (also simplified, but better illustrates what I encountered in my actual extension development). In the second testcase, the dropmarker/arrow appears (in DOMi) to have an xbl binding with a showPopup method consisting of the code:\n\nvar textbox = document.getBindingParent(this);\nvar kids = textbox.getElementsByClassName(\"autocomplete-history-popup\");\nif (kids.item(0) && textbox.getAttribute(\"open\") != \"true\") { // Open history popup\n  kids[0].showPopup(textbox, -1, -1, \"popup\", \"bottomleft\", \"topleft\");\n  textbox.setAttribute(\"open\", \"true\");\n}\n\nwhich appears to be the same code as found at:\nhttp://mxr.mozilla.org/comm-central/source/mozilla/xpfe/components/autocomplete/resources/content/autocomplete.xml#1749\n\n(...but I thought that modern versions of Thunderbird were using Toolkit code rather than xpfe.) There are no 'kids' with that classname and though showHistoryPopup does exist on the textbox when using testcase 2, it does not appear to get called (which is apparently what makes my workaround mentioned in Comment #1 work - and means that workaround should be effective if applied to testcase2, but not to testcase 1).\n\nI am not certain I am interpreting all of this correctly, but posting it in hopes it will help track down the bug's cause. If anything I've explained is unclear, just ask.", "time": "2011-12-08T17:01:02Z", "attachment_id": null, "text": "Upon further examination with DOMi, the bug shown in the first attached testcase may not be triggered by the same code as the bug I am encountering in my actual extension development, even though it exhibits the exact same symptom.  In the first attachment's testcase, clicking the arrow shows:\n\nError: textbox.showHistoryPopup is not a function\nSource File: chrome://global/content/bindings/autocomplete.xml\nLine: 1628\n\nin the error console.\n\n\nAttaching a second testcase which adds an autocomplete textbox to the Add-ons Manager (also simplified, but better illustrates what I encountered in my actual extension development). In the second testcase, the dropmarker/arrow appears (in DOMi) to have an xbl binding with a showPopup method consisting of the code:\n\nvar textbox = document.getBindingParent(this);\nvar kids = textbox.getElementsByClassName(\"autocomplete-history-popup\");\nif (kids.item(0) && textbox.getAttribute(\"open\") != \"true\") { // Open history popup\n  kids[0].showPopup(textbox, -1, -1, \"popup\", \"bottomleft\", \"topleft\");\n  textbox.setAttribute(\"open\", \"true\");\n}\n\nwhich appears to be the same code as found at:\nhttp://mxr.mozilla.org/comm-central/source/mozilla/xpfe/components/autocomplete/resources/content/autocomplete.xml#1749\n\n(...but I thought that modern versions of Thunderbird were using Toolkit code rather than xpfe.) There are no 'kids' with that classname and though showHistoryPopup does exist on the textbox when using testcase 2, it does not appear to get called (which is apparently what makes my workaround mentioned in Comment #1 work - and means that workaround should be effective if applied to testcase2, but not to testcase 1).\n\nI am not certain I am interpreting all of this correctly, but posting it in hopes it will help track down the bug's cause. If anything I've explained is unclear, just ask.", "id": 5900864, "is_private": false, "count": 5, "tags": [], "bug_id": 708520}, {"creator": "stayopenmenu@gmail.com", "author": "stayopenmenu@gmail.com", "raw_text": "", "creation_time": "2011-12-08T17:03:15Z", "text": "Created attachment 580065\nAdd-on containing testcase 2 - see comment 5", "attachment_id": 580065, "time": "2011-12-08T17:03:15Z", "count": 6, "is_private": false, "tags": [], "id": 5900872, "bug_id": 708520}, {"bug_id": 708520, "tags": [], "is_private": false, "count": 7, "id": 5908663, "text": "Adding tracking flags -> extension author needs it, testcase present start of analysis in comment #5.", "time": "2011-12-12T15:51:59Z", "attachment_id": null, "creation_time": "2011-12-12T15:51:59Z", "raw_text": "Adding tracking flags -> extension author needs it, testcase present start of analysis in comment #5.", "creator": "ludovic@hirlimann.net", "author": "ludovic@hirlimann.net"}, {"attachment_id": null, "time": "2012-01-05T21:20:51Z", "author": "standard8@mozilla.com", "creator": "standard8@mozilla.com", "text": "Is this actually a regression? Did it ever work in TB or SM?\n\nBoth TB and SM still use the xpfe autocomplete (although we do support some of the toolkit interfaces within it).", "creation_time": "2012-01-05T21:20:51Z", "raw_text": "Is this actually a regression? Did it ever work in TB or SM?\n\nBoth TB and SM still use the xpfe autocomplete (although we do support some of the toolkit interfaces within it).", "bug_id": 708520, "id": 5958464, "count": 8, "is_private": false, "tags": []}, {"id": 5958573, "is_private": false, "count": 9, "tags": [], "bug_id": 708520, "raw_text": "The first option is to adapt the CSS for toolkit autocomplete textboxes from Firefox's version of XUL.css into your extension (I think Thunderbird does this for gloda somewhere). Note that you would need to be more careful if you were overlaying a window that already used an autocomplete textbox, but it can be done (SeaMonkey does this for its search bar).\n\nThe second option is to write your autocomplete using the XPFE style of history popup. This involves adding a menupopup with the autocomplete-history-popup class and a popupshowing handler that populates it (unlike the toolkit popup which invokes a search with an empty string to populate its history popup).\n\nThe third option is to help either with fixing LDAP autocomplete to use toolkit interfaces or switching the message compose window over from XPFE to toolkit autocomplete. Then toolkit will become the default autocomplete, and only a few select widgets in SeaMonkey will still use XPFE autocomplete.", "creation_time": "2012-01-05T21:40:08Z", "attachment_id": null, "time": "2012-01-05T21:40:08Z", "text": "The first option is to adapt the CSS for toolkit autocomplete textboxes from Firefox's version of XUL.css into your extension (I think Thunderbird does this for gloda somewhere). Note that you would need to be more careful if you were overlaying a window that already used an autocomplete textbox, but it can be done (SeaMonkey does this for its search bar).\n\nThe second option is to write your autocomplete using the XPFE style of history popup. This involves adding a menupopup with the autocomplete-history-popup class and a popupshowing handler that populates it (unlike the toolkit popup which invokes a search with an empty string to populate its history popup).\n\nThe third option is to help either with fixing LDAP autocomplete to use toolkit interfaces or switching the message compose window over from XPFE to toolkit autocomplete. Then toolkit will become the default autocomplete, and only a few select widgets in SeaMonkey will still use XPFE autocomplete.", "author": "neil@httl.net", "creator": "neil@httl.net"}, {"bug_id": 708520, "id": 5982502, "tags": [], "is_private": false, "count": 10, "attachment_id": null, "time": "2012-01-16T11:47:26Z", "text": "Given the steps that Neil mentioned, the work around for now is to implement the extension to support the xpfe autocomplete. The work for switching to toolkit autocomplete is being done in bug 360648 and bug 452232 so I'm marking this as dependent on bug 360648 (as it isn't a direct duplicate).", "raw_text": "Given the steps that Neil mentioned, the work around for now is to implement the extension to support the xpfe autocomplete. The work for switching to toolkit autocomplete is being done in bug 360648 and bug 452232 so I'm marking this as dependent on bug 360648 (as it isn't a direct duplicate).", "creation_time": "2012-01-16T11:47:26Z", "author": "standard8@mozilla.com", "creator": "standard8@mozilla.com"}]}}, "comments": {}}