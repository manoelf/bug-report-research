{"bugs": {"636561": {"comments": [{"time": "2011-02-24T20:54:58Z", "tags": [], "is_private": false, "bug_id": 636561, "raw_text": "After bug 634155, there are 67 Foreground deallocation sites in SpiderMonkey. We should reduce these to as close to zero as possible.", "count": 0, "creator": "paul.biggar@gmail.com", "text": "After bug 634155, there are 67 Foreground deallocation sites in SpiderMonkey. We should reduce these to as close to zero as possible.", "id": 5302431, "attachment_id": null, "author": "paul.biggar@gmail.com", "creation_time": "2011-02-24T20:54:58Z"}, {"bug_id": 636561, "raw_text": "Are those sites in performance critical paths?", "count": 1, "time": "2011-02-24T21:14:57Z", "tags": [], "is_private": false, "creation_time": "2011-02-24T21:14:57Z", "creator": "gal@uci.edu", "text": "Are those sites in performance critical paths?", "id": 5302483, "attachment_id": null, "author": "gal@uci.edu"}, {"author": "paul.biggar@gmail.com", "creator": "paul.biggar@gmail.com", "count": 2, "bug_id": 636561, "time": "2011-02-24T21:30:21Z", "creation_time": "2011-02-24T21:30:21Z", "text": "(In reply to comment #1)\n> Are those sites in performance critical paths?\n\nI'm not sure. In general, this happen in sections of code that don't have a context passed to them (in general the same ones with OfftheBooks allocations), for example arenas.", "id": 5302546, "attachment_id": null, "raw_text": "(In reply to comment #1)\n> Are those sites in performance critical paths?\n\nI'm not sure. In general, this happen in sections of code that don't have a context passed to them (in general the same ones with OfftheBooks allocations), for example arenas.", "tags": [], "is_private": false}, {"raw_text": "If its in a slow path immediate deallocation seems desirable. I would suggest we work on this from a profile perspective. Fix anything that is causing us to be slow.", "tags": [], "is_private": false, "creation_time": "2011-02-24T21:35:50Z", "text": "If its in a slow path immediate deallocation seems desirable. I would suggest we work on this from a profile perspective. Fix anything that is causing us to be slow.", "attachment_id": null, "id": 5302561, "count": 3, "bug_id": 636561, "time": "2011-02-24T21:35:50Z", "author": "gal@uci.edu", "creator": "gal@uci.edu"}, {"creation_time": "2011-02-24T21:57:29Z", "id": 5302659, "attachment_id": null, "creator": "paul.biggar@gmail.com", "text": "(In reply to comment #3)\n> If its in a slow path immediate deallocation seems desirable.\n\nDo you mean that we _prefer_ Foreground deallocation on the slow path, or that there's no need to change code to allow Foreground deallocation on the slow path?", "author": "paul.biggar@gmail.com", "raw_text": "(In reply to comment #3)\n> If its in a slow path immediate deallocation seems desirable.\n\nDo you mean that we _prefer_ Foreground deallocation on the slow path, or that there's no need to change code to allow Foreground deallocation on the slow path?", "bug_id": 636561, "count": 4, "time": "2011-02-24T21:57:29Z", "is_private": false, "tags": []}, {"creation_time": "2011-02-25T18:43:26Z", "attachment_id": null, "id": 5304525, "text": "Shipping a pointer to the deallocation thread is not free, and we have (AFAICT) not resolved the thread contention issues with some mallocs that may make the whole thing bite back, not in latency to \"free\" but in throughput.\n\nSo yeah, there are reasons to prefer foreground free.\n\nWe shouldn't do much of any performance tuning without profile data.\n\n/be", "creator": "brendan@mozilla.org", "author": "brendan@mozilla.org", "raw_text": "Shipping a pointer to the deallocation thread is not free, and we have (AFAICT) not resolved the thread contention issues with some mallocs that may make the whole thing bite back, not in latency to \"free\" but in throughput.\n\nSo yeah, there are reasons to prefer foreground free.\n\nWe shouldn't do much of any performance tuning without profile data.\n\n/be", "bug_id": 636561, "count": 5, "time": "2011-02-25T18:43:26Z", "is_private": false, "tags": []}, {"creator": "paul.biggar@gmail.com", "text": "I've changed the title to reflect the discussion so far. Basically, UnwantedForeground allocations are allocations that have not yet been audited. If ew determine that they belong in the Foreground, we can leave them there by renaming them to Foreground::allocfunc(). Otherwise, we can move them to the background by finding a context to run the allocation through.", "attachment_id": null, "id": 5340438, "author": "paul.biggar@gmail.com", "creation_time": "2011-03-11T23:52:43Z", "time": "2011-03-11T23:52:43Z", "tags": [], "is_private": false, "bug_id": 636561, "raw_text": "I've changed the title to reflect the discussion so far. Basically, UnwantedForeground allocations are allocations that have not yet been audited. If ew determine that they belong in the Foreground, we can leave them there by renaming them to Foreground::allocfunc(). Otherwise, we can move them to the background by finding a context to run the allocation through.", "count": 6}, {"creation_time": "2011-03-11T23:53:09Z", "attachment_id": null, "id": 5340443, "text": "(In reply to comment #6)\n\ns/allocations/deallocations/g above", "creator": "paul.biggar@gmail.com", "author": "paul.biggar@gmail.com", "raw_text": "(In reply to comment #6)\n\ns/allocations/deallocations/g above", "bug_id": 636561, "count": 7, "time": "2011-03-11T23:53:09Z", "is_private": false, "tags": []}]}}, "comments": {}}