{"comments": {}, "bugs": {"687868": {"comments": [{"author": "b56girard@gmail.com", "creator": "b56girard@gmail.com", "time": "2011-09-20T15:54:13Z", "creation_time": "2011-09-20T15:54:13Z", "is_private": false, "count": 0, "id": 5725715, "tags": [], "bug_id": 687868, "text": "Currently we call CGLQueryRendererInfo in GfxInfo::Init() which puts us in Discrete mode. We need to get renderer info without having it put Firefox in Discrete.", "raw_text": "Currently we call CGLQueryRendererInfo in GfxInfo::Init() which puts us in Discrete mode. We need to get renderer info without having it put Firefox in Discrete.", "attachment_id": null}, {"creator": "jmuizelaar@mozilla.com", "time": "2011-09-21T22:59:18Z", "creation_time": "2011-09-21T22:59:18Z", "author": "jmuizelaar@mozilla.com", "is_private": false, "id": 5729571, "count": 1, "text": "Created attachment 561603\nRedo blacklisting to use device ids instead of render info\n\nThis removes the work from 611292. We explicitly ask for a hardware renderer (http://mxr.mozilla.org/mozilla-central/source/gfx/thebes/GLContextProviderCGL.mm#88) so it shouldn't be needed.", "bug_id": 687868, "tags": [], "attachment_id": 561603, "raw_text": "This removes the work from 611292. We explicitly ask for a hardware renderer (http://mxr.mozilla.org/mozilla-central/source/gfx/thebes/GLContextProviderCGL.mm#88) so it shouldn't be needed."}, {"tags": [], "text": "Created attachment 561605\nRedo blacklisting to use device ids instead of render info v2\n\nAdd some more comment", "bug_id": 687868, "raw_text": "Add some more comment", "attachment_id": 561605, "author": "jmuizelaar@mozilla.com", "creation_time": "2011-09-21T23:01:58Z", "time": "2011-09-21T23:01:58Z", "creator": "jmuizelaar@mozilla.com", "id": 5729582, "count": 2, "is_private": false}, {"creator": "b56girard@gmail.com", "creation_time": "2011-09-23T20:29:01Z", "time": "2011-09-23T20:29:01Z", "author": "b56girard@gmail.com", "is_private": false, "count": 3, "id": 5734373, "text": "This fix is no longer required to fix bug 687864. Apple looks at our bundle ID and make it such that CGLQueryRendererInfo does not put us into Discrete for builds with the bundle id 'org.mozilla.firefox'", "bug_id": 687868, "tags": [], "attachment_id": null, "raw_text": "This fix is no longer required to fix bug 687864. Apple looks at our bundle ID and make it such that CGLQueryRendererInfo does not put us into Discrete for builds with the bundle id 'org.mozilla.firefox'"}, {"bug_id": 687868, "text": "It does prevent us from testing it though, so I'd like to keep the dependency around.", "tags": [], "raw_text": "It does prevent us from testing it though, so I'd like to keep the dependency around.", "attachment_id": null, "author": "jmuizelaar@mozilla.com", "time": "2011-09-23T20:43:27Z", "creation_time": "2011-09-23T20:43:27Z", "creator": "jmuizelaar@mozilla.com", "count": 4, "id": 5734405, "is_private": false}, {"text": "Comment on attachment 561605\nRedo blacklisting to use device ids instead of render info v2\n\nReview of attachment 561605:\n-----------------------------------------------------------------\n\nr+ with following comments (changes needed):\n\n::: widget/src/cocoa/GfxInfo.mm\n@@ +106,5 @@\n> +IsATIRadeonX1000(PRUint32 aVendorID, PRUint32 aDeviceID)\n> +{\n> +  if (aVendorID == 0x1002) {\n> +    // this list is from the ATIRadeonX1000.kext Info.plist\n> +    PRUint32 devices[] = {0x7187, 0x72101, 0x71DE, 0x7146, 0x7142, 0x7109, 0x71C5, 0x71C0, 0x7240, 0x7249 0x7291};\n\nthe 0x72101 here is bogus; i'm ok to r+ the rest if you're confident in this list\n\n@@ +111,5 @@\n> +    for (size_t i; i<NS_ARRAY_LENGTH(devices); i++) {\n> +      if (aDeviceID == devices[i])\n> +        return true;\n> +    }\n> +  }\n\nreturn missing\n\n@@ +358,5 @@\n> +    if (!IsATIRadeonX1000(mAdapterVendorID, mAdapterDeviceId)) {\n> +      foundGoodDevice = PR_TRUE;\n> +    }\n> +\n> +#if 0\n\nOK. if the slowness in bug 611292 was caused by software fallbacks then we might take a performance regression from this so it's worth replying to bug 611292 to ask people to test, and let this bake in channels. However Jeff points out that we're already requiring NSOpenGLPFAAccelerated so in principle this shouldn't happen.", "bug_id": 687868, "tags": [], "attachment_id": 561605, "raw_text": "Review of attachment 561605:\n-----------------------------------------------------------------\n\nr+ with following comments (changes needed):\n\n::: widget/src/cocoa/GfxInfo.mm\n@@ +106,5 @@\n> +IsATIRadeonX1000(PRUint32 aVendorID, PRUint32 aDeviceID)\n> +{\n> +  if (aVendorID == 0x1002) {\n> +    // this list is from the ATIRadeonX1000.kext Info.plist\n> +    PRUint32 devices[] = {0x7187, 0x72101, 0x71DE, 0x7146, 0x7142, 0x7109, 0x71C5, 0x71C0, 0x7240, 0x7249 0x7291};\n\nthe 0x72101 here is bogus; i'm ok to r+ the rest if you're confident in this list\n\n@@ +111,5 @@\n> +    for (size_t i; i<NS_ARRAY_LENGTH(devices); i++) {\n> +      if (aDeviceID == devices[i])\n> +        return true;\n> +    }\n> +  }\n\nreturn missing\n\n@@ +358,5 @@\n> +    if (!IsATIRadeonX1000(mAdapterVendorID, mAdapterDeviceId)) {\n> +      foundGoodDevice = PR_TRUE;\n> +    }\n> +\n> +#if 0\n\nOK. if the slowness in bug 611292 was caused by software fallbacks then we might take a performance regression from this so it's worth replying to bug 611292 to ask people to test, and let this bake in channels. However Jeff points out that we're already requiring NSOpenGLPFAAccelerated so in principle this shouldn't happen.", "creator": "jacob.benoit.1@gmail.com", "time": "2011-09-26T21:00:22Z", "creation_time": "2011-09-26T21:00:22Z", "author": "jacob.benoit.1@gmail.com", "is_private": false, "count": 5, "id": 5738032}, {"text": "https://hg.mozilla.org/mozilla-central/rev/9ba53832faf2", "bug_id": 687868, "tags": [], "attachment_id": null, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/9ba53832faf2", "time": "2011-09-28T09:00:15Z", "creation_time": "2011-09-28T09:00:15Z", "creator": "mak@mozilla.com", "author": "mak@mozilla.com", "id": 5742584, "count": 6, "is_private": false}, {"raw_text": "GfxInfo::Init() still triggers discrete graphics mode for me, on\n\n  Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7.2; rv:10.0a1) Gecko/20111028 Firefox/10.0a1 ID:20111028031044\n\nTo reproduce, simply open about:support.", "attachment_id": null, "text": "GfxInfo::Init() still triggers discrete graphics mode for me, on\n\n  Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7.2; rv:10.0a1) Gecko/20111028 Firefox/10.0a1 ID:20111028031044\n\nTo reproduce, simply open about:support.", "bug_id": 687868, "tags": [], "id": 5813043, "count": 7, "is_private": false, "author": "reuben.morais@gmail.com", "time": "2011-10-29T04:26:50Z", "creation_time": "2011-10-29T04:26:50Z", "creator": "reuben.morais@gmail.com"}, {"bug_id": 687868, "text": "Confirmed, it still happens and I get a nasty black flash on 10.6.", "tags": [], "attachment_id": null, "raw_text": "Confirmed, it still happens and I get a nasty black flash on 10.6.", "creation_time": "2011-10-29T04:45:27Z", "time": "2011-10-29T04:45:27Z", "creator": "b56girard@gmail.com", "author": "b56girard@gmail.com", "count": 8, "id": 5813049, "is_private": false}, {"raw_text": "After changing the build identifier to org.mozilla.firefox, we go back to integrated graphics right after causing the switch.", "attachment_id": null, "tags": [], "bug_id": 687868, "text": "After changing the build identifier to org.mozilla.firefox, we go back to integrated graphics right after causing the switch.", "count": 9, "id": 5813052, "is_private": false, "author": "reuben.morais@gmail.com", "creation_time": "2011-10-29T04:48:25Z", "time": "2011-10-29T04:48:25Z", "creator": "reuben.morais@gmail.com"}]}}}