{"bugs": {"1630120": {"comments": [{"attachment_id": null, "raw_text": "When running \"docker-compose up frontend\", the frontend comes up, does something, then exits with a 0 exit code. It should instead run the dev server that compiles static assets.\n\nThis covers fixing that.", "author": "willkg@mozilla.com", "id": 14755815, "creation_time": "2020-04-15T01:09:49Z", "count": 0, "text": "When running \"docker-compose up frontend\", the frontend comes up, does something, then exits with a 0 exit code. It should instead run the dev server that compiles static assets.\n\nThis covers fixing that.", "tags": [], "bug_id": 1630120, "is_private": false, "time": "2020-04-15T01:09:49Z", "creator": "willkg@mozilla.com"}, {"count": 1, "creation_time": "2020-04-15T01:14:21Z", "raw_text": "So this works:\n\n```\n$ docker-compose run --service-ports frontend start\n```\n\nBut this doesn't:\n\n```\n$ docker-compose up frontend\n```\n\nIt's completely mystifying and there are no error messages or indication of something gone awry.\n\nJohn thinks it's related to the round of JS updates I just did and that it works fine with 4448aca.\n\nWhen I did the JS updates, one of them changed the `yarn.lock` file. I thought about wiping that file and rebuilding it, but then decided to push that off for another day. I think that's probably the right thing to do here to see if that fixes it.\n\nAnother thing that might be problematic is that something in the frontend keeps saving stuff in `/app/frontend/node_modules/`. There's a `.cache` directory. I don't know what's building that. All node module stuff should be in `/node_modules/` in the container, otherwise it pollutes the user's repository directory with \"weird state\".\n\nStage, prod, and CI all work, but this breaks the local dev environment, so I'm making it a P1. I'll look into it tomorrow.", "creator": "willkg@mozilla.com", "time": "2020-04-15T01:14:21Z", "tags": [], "text": "So this works:\n\n```\n$ docker-compose run --service-ports frontend start\n```\n\nBut this doesn't:\n\n```\n$ docker-compose up frontend\n```\n\nIt's completely mystifying and there are no error messages or indication of something gone awry.\n\nJohn thinks it's related to the round of JS updates I just did and that it works fine with 4448aca.\n\nWhen I did the JS updates, one of them changed the `yarn.lock` file. I thought about wiping that file and rebuilding it, but then decided to push that off for another day. I think that's probably the right thing to do here to see if that fixes it.\n\nAnother thing that might be problematic is that something in the frontend keeps saving stuff in `/app/frontend/node_modules/`. There's a `.cache` directory. I don't know what's building that. All node module stuff should be in `/node_modules/` in the container, otherwise it pollutes the user's repository directory with \"weird state\".\n\nStage, prod, and CI all work, but this breaks the local dev environment, so I'm making it a P1. I'll look into it tomorrow.", "author": "willkg@mozilla.com", "id": 14755824, "attachment_id": null, "is_private": false, "bug_id": 1630120}, {"text": "Created attachment 9140756\npr 2027: bug 1630120: fix frontend in local dev environment", "attachment_id": 9140756, "id": 14756797, "author": "willkg@mozilla.com", "is_private": false, "bug_id": 1630120, "creation_time": "2020-04-15T13:56:03Z", "count": 2, "raw_text": "", "creator": "willkg@mozilla.com", "time": "2020-04-15T13:56:03Z", "tags": []}, {"tags": [], "is_private": false, "bug_id": 1630120, "time": "2020-04-15T15:05:03Z", "creator": "willkg@mozilla.com", "raw_text": "[willkg](https://github.com/willkg) merged [PR #2027: \"bug 1630120: fix frontend in local dev environment\"](https://github.com/mozilla-services/tecken/pull/2027) in [8285dca](https://github.com/mozilla-services/tecken/commit/8285dca1844f58c2a10414d89a7af0cbdce86792).", "attachment_id": null, "author": "willkg@mozilla.com", "id": 14756979, "creation_time": "2020-04-15T15:05:03Z", "count": 3, "text": "[willkg](https://github.com/willkg) merged [PR #2027: \"bug 1630120: fix frontend in local dev environment\"](https://github.com/mozilla-services/tecken/pull/2027) in [8285dca](https://github.com/mozilla-services/tecken/commit/8285dca1844f58c2a10414d89a7af0cbdce86792)."}, {"creator": "willkg@mozilla.com", "time": "2020-04-16T15:09:17Z", "tags": [], "count": 4, "creation_time": "2020-04-16T15:09:17Z", "raw_text": "This only affects the local dev environment, so I'm marking this as FIXED.", "bug_id": 1630120, "is_private": false, "text": "This only affects the local dev environment, so I'm marking this as FIXED.", "author": "willkg@mozilla.com", "id": 14759244, "attachment_id": null}]}}, "comments": {}}