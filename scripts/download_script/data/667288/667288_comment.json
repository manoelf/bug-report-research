{"comments": {}, "bugs": {"667288": {"comments": [{"raw_text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.2.18) Gecko/20110616 Thunderbird/3.1.11 ThunderBrowse/3.3.5\n\n- At top of the email content, there is only 'From' in the first line.\n- My webmailer doesn't show the real From address.\n(see attachments)\n\nReproducible: Always\n\nSteps to Reproduce:\nI had to rescue my emails from a IMAP box, because of new mailbox setup from provider's side.\n1. I copied all content to temporary folders under \"Locale folders\".\n2. The old account went offline.\n3. The new account with same email address, but different login, password etc. came online.\n4. After some time, I copied the old emails back to their folders.", "creation_time": "2011-06-26T14:26:30Z", "text": "User-Agent:       Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1\nBuild Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.2.18) Gecko/20110616 Thunderbird/3.1.11 ThunderBrowse/3.3.5\n\n- At top of the email content, there is only 'From' in the first line.\n- My webmailer doesn't show the real From address.\n(see attachments)\n\nReproducible: Always\n\nSteps to Reproduce:\nI had to rescue my emails from a IMAP box, because of new mailbox setup from provider's side.\n1. I copied all content to temporary folders under \"Locale folders\".\n2. The old account went offline.\n3. The new account with same email address, but different login, password etc. came online.\n4. After some time, I copied the old emails back to their folders.", "time": "2011-06-26T14:26:30Z", "attachment_id": null, "tags": [], "count": 0, "is_private": false, "id": 5557066, "bug_id": 667288, "creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de"}, {"creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de", "count": 1, "is_private": false, "tags": [], "id": 5557079, "bug_id": 667288, "raw_text": "Created via AddOn \"ViewSourceWith\"", "creation_time": "2011-06-26T14:33:07Z", "text": "Created attachment 542018\ncorrupted email source\n\nCreated via AddOn \"ViewSourceWith\"", "attachment_id": 542018, "time": "2011-06-26T14:33:07Z"}, {"id": 5557089, "tags": [], "is_private": false, "count": 2, "bug_id": 667288, "raw_text": "The sender email addresses of those emails are no more visible. Instead only 'From' appears.", "creation_time": "2011-06-26T14:39:45Z", "attachment_id": 542020, "time": "2011-06-26T14:39:45Z", "text": "Created attachment 542020\nWeb Mailer view\n\nThe sender email addresses of those emails are no more visible. Instead only 'From' appears.", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"creation_time": "2011-06-26T15:25:42Z", "raw_text": "Can you please post a workaround in the meantime?\nThis is critical because of: https://bugzilla.mozilla.org/show_bug.cgi?id=667294\nHow can I remove the wrong 'From' line from my emails?", "attachment_id": null, "time": "2011-06-26T15:25:42Z", "text": "Can you please post a workaround in the meantime?\nThis is critical because of: https://bugzilla.mozilla.org/show_bug.cgi?id=667294\nHow can I remove the wrong 'From' line from my emails?", "id": 5557139, "tags": [], "is_private": false, "count": 3, "bug_id": 667288, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"bug_id": 667288, "id": 5558620, "is_private": false, "count": 4, "tags": [], "time": "2011-06-27T14:33:05Z", "attachment_id": null, "text": "Did you try rebuilding the folder's index ?", "raw_text": "Did you try rebuilding the folder's index ?", "creation_time": "2011-06-27T14:33:05Z", "author": "ludovic@hirlimann.net", "creator": "ludovic@hirlimann.net"}, {"raw_text": "I tried, but it didn't help.\nThinking about, why shout it help? The emails content is corrupted on both sides.\nIt seems, that the download frequency is little higher, if the IMAP inbox folder is selected for view.", "creation_time": "2011-06-27T16:01:00Z", "time": "2011-06-27T16:01:00Z", "attachment_id": null, "text": "I tried, but it didn't help.\nThinking about, why shout it help? The emails content is corrupted on both sides.\nIt seems, that the download frequency is little higher, if the IMAP inbox folder is selected for view.", "id": 5558796, "tags": [], "is_private": false, "count": 5, "bug_id": 667288, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"author": "rsx11m.pub@gmail.com", "creator": "rsx11m.pub@gmail.com", "attachment_id": null, "time": "2011-06-30T16:50:02Z", "text": "That's either Database or IMAP, moving to the latter first for investigation.", "raw_text": "That's either Database or IMAP, moving to the latter first for investigation.", "creation_time": "2011-06-30T16:50:02Z", "bug_id": 667288, "id": 5567433, "tags": [], "is_private": false, "count": 6}, {"author": "ludovic@hirlimann.net", "creator": "ludovic@hirlimann.net", "bug_id": 667288, "id": 5569182, "tags": [], "is_private": false, "count": 7, "time": "2011-07-01T09:54:33Z", "attachment_id": null, "text": "(In reply to comment #5)\n> I tried, but it didn't help.\n> Thinking about, why shout it help? The emails content is corrupted on both\n> sides.\n> It seems, that the download frequency is little higher, if the IMAP inbox\n> folder is selected for view.\n\nCause I failed to noticed it was corrupt server side. This bugs sounds like something got corrupted on your server. Are you thinking it was corrupted by Thunderbird ? Do you have access to your server to investigate it's log files ?", "creation_time": "2011-07-01T09:54:33Z", "raw_text": "(In reply to comment #5)\n> I tried, but it didn't help.\n> Thinking about, why shout it help? The emails content is corrupted on both\n> sides.\n> It seems, that the download frequency is little higher, if the IMAP inbox\n> folder is selected for view.\n\nCause I failed to noticed it was corrupt server side. This bugs sounds like something got corrupted on your server. Are you thinking it was corrupted by Thunderbird ? Do you have access to your server to investigate it's log files ?"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "attachment_id": null, "time": "2011-07-01T11:38:07Z", "text": "I think, Thunderbird caused the corruption, but also possible, there was an error in the interaction with the server.\nPleas see also Bug 668482.\nI don't have direct access to the logs, but I have investigated to get the from the provider. They sayed, maybe monday, I can get them.", "raw_text": "I think, Thunderbird caused the corruption, but also possible, there was an error in the interaction with the server.\nPleas see also Bug 668482.\nI don't have direct access to the logs, but I have investigated to get the from the provider. They sayed, maybe monday, I can get them.", "creation_time": "2011-07-01T11:38:07Z", "bug_id": 667288, "id": 5569257, "tags": [], "count": 8, "is_private": false}, {"author": "vseerror@lehigh.edu", "creator": "vseerror@lehigh.edu", "raw_text": "Ulf,\n\nDo you also see this problem (and your other two problems) if you update to version 5?  If yes, then we still need your server logs.\n\nDid you also post a topic in getsatisfaction?", "creation_time": "2011-07-25T04:06:11Z", "time": "2011-07-25T04:06:11Z", "attachment_id": null, "text": "Ulf,\n\nDo you also see this problem (and your other two problems) if you update to version 5?  If yes, then we still need your server logs.\n\nDid you also post a topic in getsatisfaction?", "id": 5610278, "count": 9, "is_private": false, "tags": [], "bug_id": 667288}, {"raw_text": "RESOLVED INCOMPLETE due to lack of response to previous question. If you feel this change was made in error, please respond to this bug with your reasons why.", "creation_time": "2011-09-02T14:30:11Z", "text": "RESOLVED INCOMPLETE due to lack of response to previous question. If you feel this change was made in error, please respond to this bug with your reasons why.", "creator": "Pidgeot18@gmail.com", "author": "Pidgeot18@gmail.com", "attachment_id": null, "time": "2011-09-02T14:30:11Z", "tags": [], "is_private": false, "count": 10, "id": 5696199, "bug_id": 667288}, {"bug_id": 667288, "tags": [], "count": 11, "is_private": false, "id": 5714484, "text": "(In reply to Wayne Mery (:wsmwk) from comment #9)\n> Ulf,\n> \n> Do you also see this problem (and your other two problems) if you update to\n> version 5?  If yes, then we still need your server logs.\nI can't reproduce the error anymore\n\n> Did you also post a topic in getsatisfaction?\nNo.", "attachment_id": null, "time": "2011-09-12T19:56:57Z", "creation_time": "2011-09-12T19:56:57Z", "raw_text": "(In reply to Wayne Mery (:wsmwk) from comment #9)\n> Ulf,\n> \n> Do you also see this problem (and your other two problems) if you update to\n> version 5?  If yes, then we still need your server logs.\nI can't reproduce the error anymore\n\n> Did you also post a topic in getsatisfaction?\nNo.", "creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "time": "2011-11-24T14:16:29Z", "attachment_id": null, "text": "It seems, one has found the cause for the problem:\nThunderbird adds a X-Account-Key: tag to the MBox. I can imagine, that if the id of the new account is different of the old one, back-copying the MBox files causes such problems, and/or the providers IMAP server software was irritated about this uncommon tag.\nSee bug 704613.\n\nIs there a best practice tutorial for rescuing emails from the old IMAP server while changing the provider?", "creation_time": "2011-11-24T14:16:29Z", "raw_text": "It seems, one has found the cause for the problem:\nThunderbird adds a X-Account-Key: tag to the MBox. I can imagine, that if the id of the new account is different of the old one, back-copying the MBox files causes such problems, and/or the providers IMAP server software was irritated about this uncommon tag.\nSee bug 704613.\n\nIs there a best practice tutorial for rescuing emails from the old IMAP server while changing the provider?", "bug_id": 667288, "id": 5870694, "is_private": false, "count": 12, "tags": []}, {"is_private": false, "count": 13, "tags": [], "id": 5881989, "bug_id": 667288, "creation_time": "2011-11-30T14:41:00Z", "raw_text": "See also bug 426651.", "text": "See also bug 426651.", "time": "2011-11-30T14:41:00Z", "attachment_id": null, "creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de"}, {"id": 5884742, "count": 14, "is_private": false, "tags": [], "bug_id": 667288, "raw_text": "Was changed to resolved by error.\nAnyway, after closer look to bug 697635, I estimate, compacting the folders before back-copying to the IMAP server could have been the source of the error.", "creation_time": "2011-12-01T10:48:56Z", "attachment_id": null, "time": "2011-12-01T10:48:56Z", "text": "Was changed to resolved by error.\nAnyway, after closer look to bug 697635, I estimate, compacting the folders before back-copying to the IMAP server could have been the source of the error.", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "id": 5908357, "tags": [], "is_private": false, "count": 15, "bug_id": 667288, "creation_time": "2011-12-12T12:50:34Z", "raw_text": "(In reply to Ulf Zibis from comment #0)\n> Steps to Reproduce:\nI now have managed to reproduce the phenomenon with Thunderbird 7.0:\n\n1. Create folder 'Test-Inbox' in IMAP account, offline-use=On.\n2. Copy some emails from Inbox to 'Test-Inbox'.\n3. Compact 'Test-Inbox'.\n4. Close TB.\n5. Via web-mailer delete all content of 'Test-Inbox.\n   (to simulate a fresh IMAP server setup)\n6. Copy files 'Test-Inbox' + 'Test-Inbox.msf' to '..\\Mail\\Local Folders\\'.\n7. Open TB.\n8. Select Local Folders -> 'Test-Inbox'.\n9. Ctrl-A + Copy to IMAP -> 'Test-Inbox'.\n10. Open web-mailer and see the corrupted 'From' fields.", "attachment_id": null, "time": "2011-12-12T12:50:34Z", "text": "(In reply to Ulf Zibis from comment #0)\n> Steps to Reproduce:\nI now have managed to reproduce the phenomenon with Thunderbird 7.0:\n\n1. Create folder 'Test-Inbox' in IMAP account, offline-use=On.\n2. Copy some emails from Inbox to 'Test-Inbox'.\n3. Compact 'Test-Inbox'.\n4. Close TB.\n5. Via web-mailer delete all content of 'Test-Inbox.\n   (to simulate a fresh IMAP server setup)\n6. Copy files 'Test-Inbox' + 'Test-Inbox.msf' to '..\\Mail\\Local Folders\\'.\n7. Open TB.\n8. Select Local Folders -> 'Test-Inbox'.\n9. Ctrl-A + Copy to IMAP -> 'Test-Inbox'.\n10. Open web-mailer and see the corrupted 'From' fields."}, {"tags": [], "count": 16, "is_private": false, "id": 5913912, "bug_id": 667288, "creation_time": "2011-12-13T23:34:09Z", "raw_text": "(In reply to Ulf Zibis from comment #2)\n> Web Mailer view\n> The sender email addresses of those emails are no more visible.\n> Instead only 'From' appears.\n\nIt can be called \"a bug of the Web Mailer\". Perhaps (a) interprets first \"From \" line as \"From\" header, even though it's not followed by \":\", (b) use this first \"From\" header as \"From\" header of the mail for which only one header is permitted.", "text": "(In reply to Ulf Zibis from comment #2)\n> Web Mailer view\n> The sender email addresses of those emails are no more visible.\n> Instead only 'From' appears.\n\nIt can be called \"a bug of the Web Mailer\". Perhaps (a) interprets first \"From \" line as \"From\" header, even though it's not followed by \":\", (b) use this first \"From\" header as \"From\" header of the mail for which only one header is permitted.", "attachment_id": null, "time": "2011-12-13T23:34:09Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"author": "m-wada@usa.com", "creator": "m-wada@usa.com", "bug_id": 667288, "id": 5914138, "count": 17, "is_private": false, "tags": [], "attachment_id": null, "time": "2011-12-14T00:30:02Z", "text": "Workaround:\n(1) Download the mails of \"From line at top of mail data\" in IMAP folder to Tb's local mail folder using Tb.\n=> \"From ...\" lines are escaped by \">\" and is changed to \">From ...\" in local mail folder file of Tb because Unix Mbox format is used.\n(2) If Gmail IMAP, move the mails in IMAP folder(Gmail Label) to [Gmail]/Trash.\n(3) Copy(upload) the mail in local mail folder of Tb to the IMAP folder using Tb.\n=> \">From ...\" lines at top part of message header is not sent to IMAP server by Tb, as X-Mozilla-Status:, X-Mozilla-Status2: is not sent to IMAP server(possibly removal of corupted headr line by Tb). So excess \"From ...\" lines at top part of mail is removed.\n=> Because Tb doesn't send X-Mozilla-Status:, X-Mozilla-Status2: to IMAP server, excess X-Mozilla-Status:, X-Mozilla-Status2: is also removed.\n=> \">From ...\" lines in message body is sent as-is. So \"From ...\" line in orinal message body is changed to \">From ...\".\n(4) If Gmail IMAP, erase mail data in [Gmail]/Trash by \"Empty Trash\".\n\nIt's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP server if uploaded mail is held in Tb's local mail folder or uploaded(copied) .eml file is saved by Tb's \"Save As to .eml\".\nWho did generate row \"From ...\" line at top of the mail data? Tb? I believe NEVER.\n\nClosing as INVALID.", "raw_text": "Workaround:\n(1) Download the mails of \"From line at top of mail data\" in IMAP folder to Tb's local mail folder using Tb.\n=> \"From ...\" lines are escaped by \">\" and is changed to \">From ...\" in local mail folder file of Tb because Unix Mbox format is used.\n(2) If Gmail IMAP, move the mails in IMAP folder(Gmail Label) to [Gmail]/Trash.\n(3) Copy(upload) the mail in local mail folder of Tb to the IMAP folder using Tb.\n=> \">From ...\" lines at top part of message header is not sent to IMAP server by Tb, as X-Mozilla-Status:, X-Mozilla-Status2: is not sent to IMAP server(possibly removal of corupted headr line by Tb). So excess \"From ...\" lines at top part of mail is removed.\n=> Because Tb doesn't send X-Mozilla-Status:, X-Mozilla-Status2: to IMAP server, excess X-Mozilla-Status:, X-Mozilla-Status2: is also removed.\n=> \">From ...\" lines in message body is sent as-is. So \"From ...\" line in orinal message body is changed to \">From ...\".\n(4) If Gmail IMAP, erase mail data in [Gmail]/Trash by \"Empty Trash\".\n\nIt's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP server if uploaded mail is held in Tb's local mail folder or uploaded(copied) .eml file is saved by Tb's \"Save As to .eml\".\nWho did generate row \"From ...\" line at top of the mail data? Tb? I believe NEVER.\n\nClosing as INVALID.", "creation_time": "2011-12-14T00:30:02Z"}, {"id": 5917497, "tags": [], "count": 18, "is_private": false, "bug_id": 667288, "creation_time": "2011-12-15T00:04:46Z", "raw_text": "(In reply to WADA from comment #16)\n> It can be called \"a bug of the Web Mailer\". Perhaps (a) interprets first\n> \"From \" line as \"From\" header, even though it's not followed by \":\", (b) use\n> this first \"From\" header as \"From\" header of the mail for which only one\n> header is permitted.\nI would say ...\nBug of the web-mailer:\n- using \"From \" line instead \"From:...\" as indicator for the senders email address\n- displaying \"From\" as senders email address\n- should better reject the wrong formatted email data with error message\nBug of Tb:\n- uploading wrong formatted email data", "attachment_id": null, "time": "2011-12-15T00:04:46Z", "text": "(In reply to WADA from comment #16)\n> It can be called \"a bug of the Web Mailer\". Perhaps (a) interprets first\n> \"From \" line as \"From\" header, even though it's not followed by \":\", (b) use\n> this first \"From\" header as \"From\" header of the mail for which only one\n> header is permitted.\nI would say ...\nBug of the web-mailer:\n- using \"From \" line instead \"From:...\" as indicator for the senders email address\n- displaying \"From\" as senders email address\n- should better reject the wrong formatted email data with error message\nBug of Tb:\n- uploading wrong formatted email data", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"raw_text": "Correction:\nBug of the IMAP server:\n- using \"From \" line instead \"From:...\" as indicator for the senders email address\n- should better reject the wrong formatted email data on upload with error message\nBug of the web-mailer:\n- displaying \"From\" as senders email address", "creation_time": "2011-12-15T00:10:40Z", "time": "2011-12-15T00:10:40Z", "attachment_id": null, "text": "Correction:\nBug of the IMAP server:\n- using \"From \" line instead \"From:...\" as indicator for the senders email address\n- should better reject the wrong formatted email data on upload with error message\nBug of the web-mailer:\n- displaying \"From\" as senders email address", "id": 5917519, "tags": [], "is_private": false, "count": 19, "bug_id": 667288, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"raw_text": "(In reply to WADA from comment #17)\nI'm not sure, if we are talking about the same:\nI don't had \"From ...\" lines, but one \"From \" line at top of each mail in local folder mbox file after step 6 in comment #15\n\n> It's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP\n> server if uploaded mail is held in Tb's local mail folder.\nIn step 9 of comment #15, uploaded mail, held in Tb's local mail folder, was starting with \"From \" line.\n\n> Who did generate row \"From ...\" line at top of the mail data? Tb? I believe\n> NEVER.\nIt was generated by Compact of Tb in step 3 of comment #15, \nand if later in step 9 Tb doesn't send that \"From \" line to IMAP server, where should it come from, as (a) the later downloaded mail again contained the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder, then the mail is correctly displayed in web-mailer and additionally correctly uploaded to the client later, without containing \"From \" line in the mbox file.\n\nAdditionally note another maybe \"From \" related problem: bug 709504 comment #7.\nAfter this, the web-mailer showed 'From' for the 1st mail, but correct email address for the 2nd mail.", "creation_time": "2011-12-15T01:16:25Z", "text": "(In reply to WADA from comment #17)\nI'm not sure, if we are talking about the same:\nI don't had \"From ...\" lines, but one \"From \" line at top of each mail in local folder mbox file after step 6 in comment #15\n\n> It's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP\n> server if uploaded mail is held in Tb's local mail folder.\nIn step 9 of comment #15, uploaded mail, held in Tb's local mail folder, was starting with \"From \" line.\n\n> Who did generate row \"From ...\" line at top of the mail data? Tb? I believe\n> NEVER.\nIt was generated by Compact of Tb in step 3 of comment #15, \nand if later in step 9 Tb doesn't send that \"From \" line to IMAP server, where should it come from, as (a) the later downloaded mail again contained the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder, then the mail is correctly displayed in web-mailer and additionally correctly uploaded to the client later, without containing \"From \" line in the mbox file.\n\nAdditionally note another maybe \"From \" related problem: bug 709504 comment #7.\nAfter this, the web-mailer showed 'From' for the 1st mail, but correct email address for the 2nd mail.", "attachment_id": null, "time": "2011-12-15T01:16:25Z", "tags": [], "count": 20, "is_private": false, "id": 5917698, "bug_id": 667288, "creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de"}, {"raw_text": "And thanks for your workaround, but I have had managed the \"repair\" long time ago, just after posting this bug, by manually editing the local folders temporary mbox file before back-copying to the IMAP Inbox.", "creation_time": "2011-12-15T01:23:33Z", "text": "And thanks for your workaround, but I have had managed the \"repair\" long time ago, just after posting this bug, by manually editing the local folders temporary mbox file before back-copying to the IMAP Inbox.", "creator": "Ulf.Zibis@gmx.de", "attachment_id": null, "time": "2011-12-15T01:23:33Z", "author": "Ulf.Zibis@gmx.de", "count": 21, "is_private": false, "tags": [], "id": 5917719, "bug_id": 667288}, {"author": "m-wada@usa.com", "creator": "m-wada@usa.com", "creation_time": "2011-12-15T02:46:20Z", "raw_text": "(In reply to Ulf Zibis from comment #20)\n> > It's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP\n> > server if uploaded mail is held in Tb's local mail folder.\n> In step 9 of comment #15, uploaded mail, held in Tb's local mail folder, was\n> starting with \"From \" line.\n\nAre you talking about file of '..\\Mail\\Local Folders\\Test-Inbox' created by YOU, never by Tb?\n> 6. Copy files 'Test-Inbox' + 'Test-Inbox.msf' to '..\\Mail\\Local Folders\\' \n\nBecause local mail folder, \"From ...\" line is Unix Mbox separator, Tb splits mails at the row \"From ...\" line upon rebuild-index. Because .msf file is not copatible etween IMAP folder and local mail folder, rebuild-index is invoked internally upon first click(open) of Test-Inbox under 'Local Folders'. If no valid mail data under the \"From ...\" line, Tb doesn't look to show it as null mail.\n\nDo you see row \"From ...\" line by View/Message Source of mail in 'Test-Inbox' under 'Local Folders'?\n\nDo next.\n- Create Test-Inbox-2 under 'Local Folders'\n- Copy all mails in Test-Inbox under 'Local Folders' Test-Inbox-2 under 'Local Folders'\nDo you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-2'?\n\nDo next too.\n- Copy '..\\Mail\\Local Folders\\Test-Inbox-2' to '..\\Mail\\Local Folders\\Test-Inbox-3'\n- Restart Tb, click(open) Test-Inbox-3 under 'Local Folders'\n- Compact Test-Inbox-3 under 'Local Folders'\nDo you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-3'", "attachment_id": null, "time": "2011-12-15T02:46:20Z", "text": "(In reply to Ulf Zibis from comment #20)\n> > It's never Tb's fault, and Tb won't send row \"From ...\" line of mail to IMAP\n> > server if uploaded mail is held in Tb's local mail folder.\n> In step 9 of comment #15, uploaded mail, held in Tb's local mail folder, was\n> starting with \"From \" line.\n\nAre you talking about file of '..\\Mail\\Local Folders\\Test-Inbox' created by YOU, never by Tb?\n> 6. Copy files 'Test-Inbox' + 'Test-Inbox.msf' to '..\\Mail\\Local Folders\\' \n\nBecause local mail folder, \"From ...\" line is Unix Mbox separator, Tb splits mails at the row \"From ...\" line upon rebuild-index. Because .msf file is not copatible etween IMAP folder and local mail folder, rebuild-index is invoked internally upon first click(open) of Test-Inbox under 'Local Folders'. If no valid mail data under the \"From ...\" line, Tb doesn't look to show it as null mail.\n\nDo you see row \"From ...\" line by View/Message Source of mail in 'Test-Inbox' under 'Local Folders'?\n\nDo next.\n- Create Test-Inbox-2 under 'Local Folders'\n- Copy all mails in Test-Inbox under 'Local Folders' Test-Inbox-2 under 'Local Folders'\nDo you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-2'?\n\nDo next too.\n- Copy '..\\Mail\\Local Folders\\Test-Inbox-2' to '..\\Mail\\Local Folders\\Test-Inbox-3'\n- Restart Tb, click(open) Test-Inbox-3 under 'Local Folders'\n- Compact Test-Inbox-3 under 'Local Folders'\nDo you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-3'", "id": 5917844, "tags": [], "is_private": false, "count": 22, "bug_id": 667288}, {"bug_id": 667288, "id": 5917867, "count": 23, "is_private": false, "tags": [], "attachment_id": null, "time": "2011-12-15T03:12:03Z", "text": "(In reply to Ulf Zibis from comment #20)\n> > Who did generate row \"From ...\" line at top of the mail data? Tb? I believe\n> > NEVER.\n> It was generated by Compact of Tb in step 3 of comment #15, \n\nAs you already know in your bug 66848, Tb eats first \"From \" line of mail data in offline-store file when Compact of IMAP offline-use=on folder is executed.\nAt which step in your comment#15 can Tb sends row \"From \" line to server?\n\nIf row \"From \" line(not Unix Mbox separator of local mail folder of Tb) was held in '..\\Mail\\Local Folders\\Test-Inbox', it means that multiple row \"From \" lines existed at server, because you did Compact of IMAP offline-use=on folder named Test-Inbox only once in steps of comment #15.  \n\n> and if later in step 9 Tb doesn't send that \"From \" line to IMAP server,\n> where should it come from, as (a) the later downloaded mail again contained\n> the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without\n> \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder,\n> then the mail is correctly displayed in web-mailer and additionally\n> correctly uploaded to the client later, without containing \"From \" line in\n> the mbox file.\n\nAs I wrote in previous comment, \"From \" line is Unix Mbox mail separator, and Tb never interpret it as mail data upon rebuild-index of local mail folder.\n\nEven if row \"From \" line is contained in '..\\Mail\\Local Folders\\Test-Inbox', I can't think there is possibility of \"Tb sends row From line to server\" in steps of comment #15.\nCan you show step by step data of local mail folder file content and View/Message Source?", "creation_time": "2011-12-15T03:12:03Z", "raw_text": "(In reply to Ulf Zibis from comment #20)\n> > Who did generate row \"From ...\" line at top of the mail data? Tb? I believe\n> > NEVER.\n> It was generated by Compact of Tb in step 3 of comment #15, \n\nAs you already know in your bug 66848, Tb eats first \"From \" line of mail data in offline-store file when Compact of IMAP offline-use=on folder is executed.\nAt which step in your comment#15 can Tb sends row \"From \" line to server?\n\nIf row \"From \" line(not Unix Mbox separator of local mail folder of Tb) was held in '..\\Mail\\Local Folders\\Test-Inbox', it means that multiple row \"From \" lines existed at server, because you did Compact of IMAP offline-use=on folder named Test-Inbox only once in steps of comment #15.  \n\n> and if later in step 9 Tb doesn't send that \"From \" line to IMAP server,\n> where should it come from, as (a) the later downloaded mail again contained\n> the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without\n> \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder,\n> then the mail is correctly displayed in web-mailer and additionally\n> correctly uploaded to the client later, without containing \"From \" line in\n> the mbox file.\n\nAs I wrote in previous comment, \"From \" line is Unix Mbox mail separator, and Tb never interpret it as mail data upon rebuild-index of local mail folder.\n\nEven if row \"From \" line is contained in '..\\Mail\\Local Folders\\Test-Inbox', I can't think there is possibility of \"Tb sends row From line to server\" in steps of comment #15.\nCan you show step by step data of local mail folder file content and View/Message Source?", "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"attachment_id": null, "time": "2011-12-15T03:46:23Z", "text": "(In reply to Ulf Zibis from comment #20)\n> After this, the web-mailer showed 'From' for the 1st mail, but correct email\n> address for the 2nd mail.\n\nAt any IMAP folder? Or specific IMAP folder only?\n\nEven after you did recovery operation like next?\n- Remove row \"From \" line in mail data from '..\\Mail\\Local Folders\\Test-Inbox'\n  by manual editing of the file.\n- Rebuild-Index if required\n  (as file size is changed, it's invoked automatically upon first open by click)\n- Upload to IMAP server\n\nIf you still believe that the \"From \" line was uploaded by Tb from local mail folder of Tb, get IMAP log for uploading of mail by Tb, and show us evidence, please.\nI can't imagine other than next cases if uploaded by Tb.\n(i) Copy mails which contains row \"From \" lines in mail data,\n    from IMAP folder to IMAP folder of other IMAP account.\n(ii) Import of .eml file which contains row \"From \" lines into IMAP folder,\n     via Drag&Drop of .eml file to IIMAP folder or thread pane of IMAP folder.\n(iii) Addition of row \"From \" line(s) to Tb's file for local mail folder was\n      done while Tb is running. Because .msf file is already opened, internal\n      rebuild-index is not invoked automatically, but rebuild-index was not\n      requested by user.\n      So, added row \"From \" line is read as mail data by Tb upon mail copy\n      from local mail folder to IMAP mail folder, then sent as-is to server.", "creation_time": "2011-12-15T03:46:23Z", "raw_text": "(In reply to Ulf Zibis from comment #20)\n> After this, the web-mailer showed 'From' for the 1st mail, but correct email\n> address for the 2nd mail.\n\nAt any IMAP folder? Or specific IMAP folder only?\n\nEven after you did recovery operation like next?\n- Remove row \"From \" line in mail data from '..\\Mail\\Local Folders\\Test-Inbox'\n  by manual editing of the file.\n- Rebuild-Index if required\n  (as file size is changed, it's invoked automatically upon first open by click)\n- Upload to IMAP server\n\nIf you still believe that the \"From \" line was uploaded by Tb from local mail folder of Tb, get IMAP log for uploading of mail by Tb, and show us evidence, please.\nI can't imagine other than next cases if uploaded by Tb.\n(i) Copy mails which contains row \"From \" lines in mail data,\n    from IMAP folder to IMAP folder of other IMAP account.\n(ii) Import of .eml file which contains row \"From \" lines into IMAP folder,\n     via Drag&Drop of .eml file to IIMAP folder or thread pane of IMAP folder.\n(iii) Addition of row \"From \" line(s) to Tb's file for local mail folder was\n      done while Tb is running. Because .msf file is already opened, internal\n      rebuild-index is not invoked automatically, but rebuild-index was not\n      requested by user.\n      So, added row \"From \" line is read as mail data by Tb upon mail copy\n      from local mail folder to IMAP mail folder, then sent as-is to server.", "bug_id": 667288, "id": 5917909, "tags": [], "count": 24, "is_private": false, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"bug_id": 667288, "tags": [], "count": 25, "is_private": false, "id": 5924830, "text": "(In reply to WADA from comment #22)\n> (In reply to Ulf Zibis from comment #20)\n> Are you talking about file of '..\\Mail\\Local Folders\\Test-Inbox' created by\n> YOU, never by Tb?\nYes, but '...\\ImapMail\\xxx\\Test-Inbox' was created by Tb, compacted and, after closing Tb, externally copied to '..\\Mail\\Local Folders\\Test-Inbox'\n\n> Because local mail folder, \"From ...\" line is Unix Mbox separator, Tb splits\n> mails at the row \"From ...\" line upon rebuild-index.\nIn my case there was only \"From \" line, as copied from IMAP mbox file, but splitting the mails under Local Folders by \"From \" even worked without problems.\n\n> Because .msf file is\n> not copatible etween IMAP folder and local mail folder, rebuild-index is\n> invoked internally upon first click(open) of Test-Inbox under 'Local\n> Folders'. If no valid mail data under the \"From ...\" line, Tb doesn't look\n> to show it as null mail.\nThere are no \"From ...\" lines, but shouldn't Tb convert the the \"From \" lines while rebuilding index?\n\n> Do you see row \"From ...\" line by View/Message Source of mail in\n> 'Test-Inbox' under 'Local Folders'?\nI see neither \"From ...\" nor \"From \" lines by View/Message Source.\n\n> Do next.\nWill do later.\nBut I did:\n1. Create folder 'Test-Inbox' in IMAP account, offline-use=On.\n2. Copy 1 mail from Inbox to 'Test-Inbox'.\n3. Compact 'Test-Inbox'.\n4. Copy same mail again from Inbox to 'Test-Inbox'.\n5. Close TB.\n6. Via web-mailer delete all content of 'Test-Inbox.\n   (to simulate a fresh IMAP server setup)\n7. Copy file 'Test-Inbox' to '..\\Mail\\Local Folders\\'.\n8. Open TB.\n9. Select Local Folders -> 'Test-Inbox'.\n10. Ctrl-A + Copy to IMAP -> 'Test-Inbox'.\n11. Open web-mailer and see 1 corrupted and 1 correct 'From' field.", "attachment_id": null, "time": "2011-12-17T22:10:47Z", "creation_time": "2011-12-17T22:10:47Z", "raw_text": "(In reply to WADA from comment #22)\n> (In reply to Ulf Zibis from comment #20)\n> Are you talking about file of '..\\Mail\\Local Folders\\Test-Inbox' created by\n> YOU, never by Tb?\nYes, but '...\\ImapMail\\xxx\\Test-Inbox' was created by Tb, compacted and, after closing Tb, externally copied to '..\\Mail\\Local Folders\\Test-Inbox'\n\n> Because local mail folder, \"From ...\" line is Unix Mbox separator, Tb splits\n> mails at the row \"From ...\" line upon rebuild-index.\nIn my case there was only \"From \" line, as copied from IMAP mbox file, but splitting the mails under Local Folders by \"From \" even worked without problems.\n\n> Because .msf file is\n> not copatible etween IMAP folder and local mail folder, rebuild-index is\n> invoked internally upon first click(open) of Test-Inbox under 'Local\n> Folders'. If no valid mail data under the \"From ...\" line, Tb doesn't look\n> to show it as null mail.\nThere are no \"From ...\" lines, but shouldn't Tb convert the the \"From \" lines while rebuilding index?\n\n> Do you see row \"From ...\" line by View/Message Source of mail in\n> 'Test-Inbox' under 'Local Folders'?\nI see neither \"From ...\" nor \"From \" lines by View/Message Source.\n\n> Do next.\nWill do later.\nBut I did:\n1. Create folder 'Test-Inbox' in IMAP account, offline-use=On.\n2. Copy 1 mail from Inbox to 'Test-Inbox'.\n3. Compact 'Test-Inbox'.\n4. Copy same mail again from Inbox to 'Test-Inbox'.\n5. Close TB.\n6. Via web-mailer delete all content of 'Test-Inbox.\n   (to simulate a fresh IMAP server setup)\n7. Copy file 'Test-Inbox' to '..\\Mail\\Local Folders\\'.\n8. Open TB.\n9. Select Local Folders -> 'Test-Inbox'.\n10. Ctrl-A + Copy to IMAP -> 'Test-Inbox'.\n11. Open web-mailer and see 1 corrupted and 1 correct 'From' field.", "creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "bug_id": 667288, "id": 5924832, "tags": [], "is_private": false, "count": 26, "time": "2011-12-17T22:15:43Z", "attachment_id": 582594, "text": "Created attachment 582594\nScreen shot, 1 correct + 1 corrupted From field", "creation_time": "2011-12-17T22:15:43Z", "raw_text": ""}, {"bug_id": 667288, "tags": [], "is_private": false, "count": 27, "id": 5924874, "creator": "Ulf.Zibis@gmx.de", "text": "..\\Mail\\Local Folders\\Test-Inbox:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Mon Dec 12 12:38:43 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n\n\n..\\ImapMail\\xxx\\Test-Inbox:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Mon Dec 12 12:38:43 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])", "author": "Ulf.Zibis@gmx.de", "time": "2011-12-17T23:18:01Z", "attachment_id": null, "creation_time": "2011-12-17T23:18:01Z", "raw_text": "..\\Mail\\Local Folders\\Test-Inbox:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Mon Dec 12 12:38:43 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n\n\n..\\ImapMail\\xxx\\Test-Inbox:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Mon Dec 12 12:38:43 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])"}, {"bug_id": 667288, "id": 5934065, "is_private": false, "count": 28, "tags": [], "time": "2011-12-22T00:07:21Z", "attachment_id": null, "text": "If I delete IMAP file 'Test-Inbox', I get after new download from the IMAP server:\n..\\ImapMail\\xxx\\Test-Inbox:\nFrom - Thu Dec 22 00:47:50 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Thu Dec 22 00:48:13 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\n\nAs you can see, there is again a \"From \" line in the 2nd mail data.\nIf not before uploaded by Tb on step 4 at comment #25, how should it got to there otherwise?\nAdditionally I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines. Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload to the IMAP server?", "raw_text": "If I delete IMAP file 'Test-Inbox', I get after new download from the IMAP server:\n..\\ImapMail\\xxx\\Test-Inbox:\nFrom - Thu Dec 22 00:47:50 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\nFrom - Thu Dec 22 00:48:13 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...\n\nAs you can see, there is again a \"From \" line in the 2nd mail data.\nIf not before uploaded by Tb on step 4 at comment #25, how should it got to there otherwise?\nAdditionally I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines. Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload to the IMAP server?", "creation_time": "2011-12-22T00:07:21Z", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"time": "2011-12-22T00:29:44Z", "attachment_id": null, "text": "(In reply to WADA from comment #22)\n> Do next.\n> - Create Test-Inbox-2 under 'Local Folders'\n> - Copy all mails in Test-Inbox under 'Local Folders' Test-Inbox-2 under\n> 'Local Folders'\n> Do you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-2'?\nYes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.\n\n> Do next too.\n> - Copy '..\\Mail\\Local Folders\\Test-Inbox-2' to '..\\Mail\\Local\n> Folders\\Test-Inbox-3'\n> - Restart Tb, click(open) Test-Inbox-3 under 'Local Folders'\n> - Compact Test-Inbox-3 under 'Local Folders'\n> Do you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-3'\nYes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.", "creation_time": "2011-12-22T00:29:44Z", "raw_text": "(In reply to WADA from comment #22)\n> Do next.\n> - Create Test-Inbox-2 under 'Local Folders'\n> - Copy all mails in Test-Inbox under 'Local Folders' Test-Inbox-2 under\n> 'Local Folders'\n> Do you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-2'?\nYes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.\n\n> Do next too.\n> - Copy '..\\Mail\\Local Folders\\Test-Inbox-2' to '..\\Mail\\Local\n> Folders\\Test-Inbox-3'\n> - Restart Tb, click(open) Test-Inbox-3 under 'Local Folders'\n> - Compact Test-Inbox-3 under 'Local Folders'\n> Do you see row \"From \" line in file of '..\\Mail\\Local Folders\\Test-Inbox-3'\nYes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.", "bug_id": 667288, "id": 5934153, "tags": [], "is_private": false, "count": 29, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"tags": [], "count": 30, "is_private": false, "id": 5934170, "bug_id": 667288, "raw_text": "(In reply to Ulf Zibis from comment #28)\n> I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines.\n> Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload\n> to the IMAP server?\n\nYou already posted comment in Bug 426651, didn't you?", "creation_time": "2011-12-22T00:36:42Z", "text": "(In reply to Ulf Zibis from comment #28)\n> I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines.\n> Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload\n> to the IMAP server?\n\nYou already posted comment in Bug 426651, didn't you?", "attachment_id": null, "time": "2011-12-22T00:36:42Z", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de", "text": "(In reply to WADA from comment #23)\n> As you already know in your bug 66848,\nAre you sure, you reference the correct bug no. here?\n\n> Tb eats first \"From \" line of mail\n> data in offline-store file when Compact of IMAP offline-use=on folder is\n> executed.\n> At which step in your comment#15 can Tb sends row \"From \" line to server?\nStep 9.\n\n> If row \"From \" line(not Unix Mbox separator of local mail folder of Tb) was\n> held in '..\\Mail\\Local Folders\\Test-Inbox', it means that multiple row \"From\n> \" lines existed at server, because you did Compact of IMAP offline-use=on\n> folder named Test-Inbox only once in steps of comment #15.\nI'm not sure, if I understand right here. Multiple \"From \" lines existed in IMAP offline-use=on folder named Test-Inbox after compact (step 3 of comment 15), but they did not exist at server at that time, but they existed in '..\\Mail\\Local Folders\\Test-Inbox after step 6 and in at server + IMAP folder after step 9.\n\n> > and if later in step 9 Tb doesn't send that \"From \" line to IMAP server,\n> > where should it come from, as (a) the later downloaded mail again contained\n> > the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without\n> > \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder,\n> > then the mail is correctly displayed in web-mailer and additionally\n> > correctly uploaded to the client later, without containing \"From \" line in\n> > the mbox file.\n> \n> As I wrote in previous comment, \"From \" line is Unix Mbox mail separator,\n> and Tb never interpret it as mail data upon rebuild-index of local mail\n> folder.\n... but seems to while copying the mails to IMAP folder.\n\n> Even if row \"From \" line is contained in '..\\Mail\\Local Folders\\Test-Inbox',\n> I can't think there is possibility of \"Tb sends row From line to server\" in\n> steps of comment #15.\n> Can you show step by step data of local mail folder file content and\n> View/Message Source?\nSee comment 27.\n+ View/Message Source:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...", "attachment_id": null, "time": "2011-12-22T01:32:18Z", "raw_text": "(In reply to WADA from comment #23)\n> As you already know in your bug 66848,\nAre you sure, you reference the correct bug no. here?\n\n> Tb eats first \"From \" line of mail\n> data in offline-store file when Compact of IMAP offline-use=on folder is\n> executed.\n> At which step in your comment#15 can Tb sends row \"From \" line to server?\nStep 9.\n\n> If row \"From \" line(not Unix Mbox separator of local mail folder of Tb) was\n> held in '..\\Mail\\Local Folders\\Test-Inbox', it means that multiple row \"From\n> \" lines existed at server, because you did Compact of IMAP offline-use=on\n> folder named Test-Inbox only once in steps of comment #15.\nI'm not sure, if I understand right here. Multiple \"From \" lines existed in IMAP offline-use=on folder named Test-Inbox after compact (step 3 of comment 15), but they did not exist at server at that time, but they existed in '..\\Mail\\Local Folders\\Test-Inbox after step 6 and in at server + IMAP folder after step 9.\n\n> > and if later in step 9 Tb doesn't send that \"From \" line to IMAP server,\n> > where should it come from, as (a) the later downloaded mail again contained\n> > the \"From \" line in the mbox file and (b) if I copy \"correct\" mail without\n> > \"From \" line, but \"From - timestamp\" line from local folder to IMAP folder,\n> > then the mail is correctly displayed in web-mailer and additionally\n> > correctly uploaded to the client later, without containing \"From \" line in\n> > the mbox file.\n> \n> As I wrote in previous comment, \"From \" line is Unix Mbox mail separator,\n> and Tb never interpret it as mail data upon rebuild-index of local mail\n> folder.\n... but seems to while copying the mails to IMAP folder.\n\n> Even if row \"From \" line is contained in '..\\Mail\\Local Folders\\Test-Inbox',\n> I can't think there is possibility of \"Tb sends row From line to server\" in\n> steps of comment #15.\n> Can you show step by step data of local mail folder file content and\n> View/Message Source?\nSee comment 27.\n+ View/Message Source:\nFrom \nX-Mozilla-Keys: nonjunk                                                                         \nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n...", "creation_time": "2011-12-22T01:32:18Z", "bug_id": 667288, "tags": [], "count": 31, "is_private": false, "id": 5934283}, {"bug_id": 667288, "is_private": false, "count": 32, "tags": [], "id": 5934294, "text": "Woops, wrong bug. it was Bug 426651.", "attachment_id": null, "time": "2011-12-22T01:40:28Z", "creation_time": "2011-12-22T01:40:28Z", "raw_text": "Woops, wrong bug. it was Bug 426651.", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de", "raw_text": "(In reply to WADA from comment #30)\n> (In reply to Ulf Zibis from comment #28)\n> > I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines.\n> > Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload\n> > to the IMAP server?\n> \n> You already posted comment in Bug 426651, didn't you?\nI didn't mention \"X-Mozilla-Xxx: \" lines there, that was only in _your_ comment 1.", "creation_time": "2011-12-22T01:42:58Z", "text": "(In reply to WADA from comment #30)\n> (In reply to Ulf Zibis from comment #28)\n> > I'm wondering about the \"X-Mozilla-Keys: nonjunk  \" lines.\n> > Shouldn't all \"X-Mozilla-Xxx: \" lines have been filtered out before upload\n> > to the IMAP server?\n> \n> You already posted comment in Bug 426651, didn't you?\nI didn't mention \"X-Mozilla-Xxx: \" lines there, that was only in _your_ comment 1.", "attachment_id": null, "time": "2011-12-22T01:42:58Z", "tags": [], "count": 33, "is_private": false, "id": 5934299, "bug_id": 667288}, {"creator": "m-wada@usa.com", "text": "(In reply to Ulf Zibis from comment #31)\n> + View/Message Source:\n> From \n> X-Mozilla-Keys: nonjunk\n> Return-Path: <www-data@www.goatrance.de>\n> Delivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\n> Received: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n> ...\n\nConfusing but View/Message Source of Tb is different between local mail folder and IMAP folder.\nIf local mail folder, Tb's View/Message Source shows all lines from Unix Mbox mail separator.\nIn contrast to it, Unix Mbox mail separator doesn't exist if IMAP offline-use=off folder, so it's never shown. \"From ...\" line(... = 0 to N characters), which may be followed by X-Mozilla-Status:/X-Mozilla-Status2: if atter first download before Compact, is merely \"place holder of a mail\" in offline-store file of IMAP offline-use=on folder, and it's also not shown.\n\n(In reply to Ulf Zibis from comment #29)\n> Yes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.\n\nI meant next by row \"From \" line.\n  \"From \" line, or line starts with \"From \"\n   which is NOT unix mbox mail separator used by Tb\n   in Tb's file for local mail folder.\ni.e.\n\"From \" line, or line starts with \"From \", which is shown as message header or message body text by View/Message Source of Tb, instead of first line of message source display of mail in local mail folder(usually before X-Accout-Key:, before X-UIDL:, before X-Mozilla-Status:/X-Mozilla-Status2:, before X-Mozilla-Keys:).\n\nI believe you already saw;\nTb escapes \"From \" line by \">\" in Tb's local mail folder file when row \"From \" line is sent from IMAP server upon mail copy from IMAP folder to local mail folder.\n\nAnd I believe you already saw;\nEven if row \"From \" line was generated by manual copy of offline-store file of IMAP folder to local mail folder file, the row \"From \" line is treated as Unix Mbox mail separator by Tb.\ni.e.\nIf following data of IMAP offline-store file is copied to local mail folder file by manual file copy by YOU(never by Tb), these are two different mails for Tb because of local mail folder file.\n  (a) mail data of X-Mozilla-Status:/X-Mozilla-Status2: only.\n      no message headers such as From:, To:, Subject:, Received:,\n      no message body data.\n  (b) mail data without X-Mozilla-Status:/X-Mozilla-Status2:.\n      starts from X-Mozilla-Keys: header.\n  Tb doesn't look to show mail (a) at thread pane.\n\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk\nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n\nNote:\nAfter successful first Compact execution of local mail folder, X-Mozilla-Status:/X-Mozilla-Status2: is added, if X-Mozilla-Status:/X-Mozilla-Status2: doesn't exist.\nAnd, affter second successful Compact execution of local mail folder, X-Mozilla-Keys: is added, if X-Mozilla-Keys: doesn't exist.\nThis is current implementation.(In reply to Ulf Zibis from comment #33)\n\n> (In reply to WADA from comment #30)\n> I didn't mention \"X-Mozilla-Xxx: \" lines there, that was only in _your_  comment 1.\n\nI believe \"posting comment to a bug at B.M.O\" means \"comment poster already read the bug at B.M.O\".", "attachment_id": null, "time": "2011-12-22T02:09:16Z", "author": "m-wada@usa.com", "creation_time": "2011-12-22T02:09:16Z", "raw_text": "(In reply to Ulf Zibis from comment #31)\n> + View/Message Source:\n> From \n> X-Mozilla-Keys: nonjunk\n> Return-Path: <www-data@www.goatrance.de>\n> Delivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\n> Received: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n> ...\n\nConfusing but View/Message Source of Tb is different between local mail folder and IMAP folder.\nIf local mail folder, Tb's View/Message Source shows all lines from Unix Mbox mail separator.\nIn contrast to it, Unix Mbox mail separator doesn't exist if IMAP offline-use=off folder, so it's never shown. \"From ...\" line(... = 0 to N characters), which may be followed by X-Mozilla-Status:/X-Mozilla-Status2: if atter first download before Compact, is merely \"place holder of a mail\" in offline-store file of IMAP offline-use=on folder, and it's also not shown.\n\n(In reply to Ulf Zibis from comment #29)\n> Yes, there are \"From \" lines for each mail without \"X-Mozilla-Status|2: ...\" lines.\n\nI meant next by row \"From \" line.\n  \"From \" line, or line starts with \"From \"\n   which is NOT unix mbox mail separator used by Tb\n   in Tb's file for local mail folder.\ni.e.\n\"From \" line, or line starts with \"From \", which is shown as message header or message body text by View/Message Source of Tb, instead of first line of message source display of mail in local mail folder(usually before X-Accout-Key:, before X-UIDL:, before X-Mozilla-Status:/X-Mozilla-Status2:, before X-Mozilla-Keys:).\n\nI believe you already saw;\nTb escapes \"From \" line by \">\" in Tb's local mail folder file when row \"From \" line is sent from IMAP server upon mail copy from IMAP folder to local mail folder.\n\nAnd I believe you already saw;\nEven if row \"From \" line was generated by manual copy of offline-store file of IMAP folder to local mail folder file, the row \"From \" line is treated as Unix Mbox mail separator by Tb.\ni.e.\nIf following data of IMAP offline-store file is copied to local mail folder file by manual file copy by YOU(never by Tb), these are two different mails for Tb because of local mail folder file.\n  (a) mail data of X-Mozilla-Status:/X-Mozilla-Status2: only.\n      no message headers such as From:, To:, Subject:, Received:,\n      no message body data.\n  (b) mail data without X-Mozilla-Status:/X-Mozilla-Status2:.\n      starts from X-Mozilla-Keys: header.\n  Tb doesn't look to show mail (a) at thread pane.\n\nFrom - Sat Dec 17 23:07:49 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nX-Mozilla-Keys: nonjunk\nReturn-Path: <www-data@www.goatrance.de>\nDelivery-Date: Wed, 20 Jan 2010 20:41:40 +0100\nReceived: from www.goatrance.de (www.goatrance.de [81.88.37.27])\n\nNote:\nAfter successful first Compact execution of local mail folder, X-Mozilla-Status:/X-Mozilla-Status2: is added, if X-Mozilla-Status:/X-Mozilla-Status2: doesn't exist.\nAnd, affter second successful Compact execution of local mail folder, X-Mozilla-Keys: is added, if X-Mozilla-Keys: doesn't exist.\nThis is current implementation.(In reply to Ulf Zibis from comment #33)\n\n> (In reply to WADA from comment #30)\n> I didn't mention \"X-Mozilla-Xxx: \" lines there, that was only in _your_  comment 1.\n\nI believe \"posting comment to a bug at B.M.O\" means \"comment poster already read the bug at B.M.O\".", "bug_id": 667288, "is_private": false, "count": 34, "tags": [], "id": 5934351}, {"raw_text": "(In reply to WADA from comment #32)\n> Woops, wrong bug. it was Bug 426651.\nMaybe you meant bug 697635 or bug 708941?", "creation_time": "2011-12-22T02:41:59Z", "creator": "Ulf.Zibis@gmx.de", "text": "(In reply to WADA from comment #32)\n> Woops, wrong bug. it was Bug 426651.\nMaybe you meant bug 697635 or bug 708941?", "author": "Ulf.Zibis@gmx.de", "time": "2011-12-22T02:41:59Z", "attachment_id": null, "tags": [], "count": 35, "is_private": false, "id": 5934411, "bug_id": 667288}, {"raw_text": "> > As you already know in your bug 66848,\n> Maybe you meant bug 697635 or bug 708941?\nIt was your bug 668482 (last 2 was cut upon copy&paste. sorry for misoperation.)", "creation_time": "2011-12-22T03:01:28Z", "text": "> > As you already know in your bug 66848,\n> Maybe you meant bug 697635 or bug 708941?\nIt was your bug 668482 (last 2 was cut upon copy&paste. sorry for misoperation.)", "attachment_id": null, "time": "2011-12-22T03:01:28Z", "tags": [], "is_private": false, "count": 36, "id": 5934438, "bug_id": 667288, "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"author": "m-wada@usa.com", "creator": "m-wada@usa.com", "creation_time": "2011-12-22T03:04:04Z", "raw_text": "Read \"row\" as \"raw\" in my previous comments, please. Sorry for many typo's.", "attachment_id": null, "time": "2011-12-22T03:04:04Z", "text": "Read \"row\" as \"raw\" in my previous comments, please. Sorry for many typo's.", "id": 5934445, "tags": [], "count": 37, "is_private": false, "bug_id": 667288}, {"creation_time": "2011-12-22T03:41:22Z", "raw_text": "(In reply to WADA from comment #24)\n> (In reply to Ulf Zibis from comment #20)\n> > After this, the web-mailer showed 'From' for the 1st mail, but correct email\n> > address for the 2nd mail.\n> \n> At any IMAP folder? Or specific IMAP folder only?\nAt specific 'Test-Inbox' folder on 1st try of scenario from comment 25.\n\n> Even after you did recovery operation like next?\n> - Remove row \"From \" line in mail data from '..\\Mail\\Local\n> Folders\\Test-Inbox'\n>   by manual editing of the file.\nIf I would remove all \"From \" lines, there wouldn't remain any Unix Mbox mail separators, as there are no \"From ...\" lines, so multiple mails would be interpreted as _one_ mail. So does that make sense?", "author": "Ulf.Zibis@gmx.de", "time": "2011-12-22T03:41:22Z", "attachment_id": null, "creator": "Ulf.Zibis@gmx.de", "text": "(In reply to WADA from comment #24)\n> (In reply to Ulf Zibis from comment #20)\n> > After this, the web-mailer showed 'From' for the 1st mail, but correct email\n> > address for the 2nd mail.\n> \n> At any IMAP folder? Or specific IMAP folder only?\nAt specific 'Test-Inbox' folder on 1st try of scenario from comment 25.\n\n> Even after you did recovery operation like next?\n> - Remove row \"From \" line in mail data from '..\\Mail\\Local\n> Folders\\Test-Inbox'\n>   by manual editing of the file.\nIf I would remove all \"From \" lines, there wouldn't remain any Unix Mbox mail separators, as there are no \"From ...\" lines, so multiple mails would be interpreted as _one_ mail. So does that make sense?", "id": 5934499, "tags": [], "is_private": false, "count": 38, "bug_id": 667288}, {"bug_id": 667288, "id": 5934508, "count": 39, "is_private": false, "tags": [], "attachment_id": 583712, "time": "2011-12-22T03:51:46Z", "text": "Created attachment 583712\nIMAP logs\n\n(In reply to WADA from comment #24)\n> If you still believe that the \"From \" line was uploaded by Tb from local\n> mail folder of Tb, get IMAP log for uploading of mail by Tb, and show us\n> evidence, please.", "raw_text": "(In reply to WADA from comment #24)\n> If you still believe that the \"From \" line was uploaded by Tb from local\n> mail folder of Tb, get IMAP log for uploading of mail by Tb, and show us\n> evidence, please.", "creation_time": "2011-12-22T03:51:46Z", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"id": 5934525, "count": 40, "is_private": false, "tags": [], "bug_id": 667288, "creation_time": "2011-12-22T04:16:08Z", "raw_text": "(In reply to Ulf Zibis from comment #38)\n> > Even after you did recovery operation like next?\n> > - Remove row \"From \" line in mail data from '..\\Mail\\Local\n> > Folders\\Test-Inbox'\n> >   by manual editing of the file.\n> If I would remove all \"From \" lines, there wouldn't remain any Unix Mbox\n> mail separators, as there are no \"From ...\" lines, so multiple mails would\n> be interpreted as _one_ mail. So does that make sense?\n\nYou are correct.\nRemove \"Raw\" \"From ...\" line(...=0 to N chars) which is not valid Unix Mbox mail separator, if you copied offline-store file as file for local mail folder of Tb.\ni.e.\nRemove \"From \" line in following data\n  in file for local mail folder of Tb,\n  which was copied from offline-store file of IMAP folder of offline-use=on. \n\nFrom - Sat Dec 17 23:07:49 2011 <= Used as Unix Mbox mail separator by Tb\nX-Mozilla-Status: 0001          <= Used as correct X-Mozilla-Status:\nX-Mozilla-Status2: 00000000     <= Used as correct X-Mozilla-Status2:\nFrom                            <= '\"Raw\" \"From \" line' I called\nX-Mozilla-Keys: nonjunk         <= Used as correct X-Mozilla-Keys:\nReturn-Path: <www-data@www.goatrance.de>\n\nThis is to ensure that Tb never sends(upload, append) \"From \" line to IMAP server if mail copy from local mail folder to IMAP folder. \n\nSo, above can be replaced by next, because \"From \" only line is used as Unix Mbox mail seprator by Tb if local mail folder.\n\nDo following before upload mails to IMAP server(copy from local mail folder to IMAP folder) to make it sure.\n  1. \"Repair Folder\" of the local mail folder\n  2. Copy a mail to the local mail folder, and delete the copied mail.\n     Compact (first Compact).\n  3. Copy a mail to the local mail folder, and delete the copied mail.\n     Compact (second Compact).", "time": "2011-12-22T04:16:08Z", "attachment_id": null, "text": "(In reply to Ulf Zibis from comment #38)\n> > Even after you did recovery operation like next?\n> > - Remove row \"From \" line in mail data from '..\\Mail\\Local\n> > Folders\\Test-Inbox'\n> >   by manual editing of the file.\n> If I would remove all \"From \" lines, there wouldn't remain any Unix Mbox\n> mail separators, as there are no \"From ...\" lines, so multiple mails would\n> be interpreted as _one_ mail. So does that make sense?\n\nYou are correct.\nRemove \"Raw\" \"From ...\" line(...=0 to N chars) which is not valid Unix Mbox mail separator, if you copied offline-store file as file for local mail folder of Tb.\ni.e.\nRemove \"From \" line in following data\n  in file for local mail folder of Tb,\n  which was copied from offline-store file of IMAP folder of offline-use=on. \n\nFrom - Sat Dec 17 23:07:49 2011 <= Used as Unix Mbox mail separator by Tb\nX-Mozilla-Status: 0001          <= Used as correct X-Mozilla-Status:\nX-Mozilla-Status2: 00000000     <= Used as correct X-Mozilla-Status2:\nFrom                            <= '\"Raw\" \"From \" line' I called\nX-Mozilla-Keys: nonjunk         <= Used as correct X-Mozilla-Keys:\nReturn-Path: <www-data@www.goatrance.de>\n\nThis is to ensure that Tb never sends(upload, append) \"From \" line to IMAP server if mail copy from local mail folder to IMAP folder. \n\nSo, above can be replaced by next, because \"From \" only line is used as Unix Mbox mail seprator by Tb if local mail folder.\n\nDo following before upload mails to IMAP server(copy from local mail folder to IMAP folder) to make it sure.\n  1. \"Repair Folder\" of the local mail folder\n  2. Copy a mail to the local mail folder, and delete the copied mail.\n     Compact (first Compact).\n  3. Copy a mail to the local mail folder, and delete the copied mail.\n     Compact (second Compact).", "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"attachment_id": null, "time": "2011-12-22T04:18:27Z", "text": "(In reply to Ulf Zibis from comment #39)\n> IMAP logs\n\nWhich line of which log file is evidence that Tb sended \"From \" only line to IMAP server?", "creation_time": "2011-12-22T04:18:27Z", "raw_text": "(In reply to Ulf Zibis from comment #39)\n> IMAP logs\n\nWhich line of which log file is evidence that Tb sended \"From \" only line to IMAP server?", "bug_id": 667288, "id": 5934528, "tags": [], "is_private": false, "count": 41, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"bug_id": 667288, "tags": [], "is_private": false, "count": 42, "id": 5934543, "text": "I coul see it at Line 21592 in imap_2.log.\n> 16196[a35e40]: 1dcf000:imap.1und1.de:S-Test-Inbox-4:SendData: 10 append \"Test-Inbox-4\" \"20-Jan-2010 20:41:42 +0100\" {36248+}[CR]\n> [CRLF]\n> 16196[a35e40]: 1dcf000:imap.1und1.de:S-Test-Inbox-4:SendData: From [CR]\n> [CRLF]                                                                        \n> X-Mozilla-Keys: nonjunk    (consecutive spaces)    [CR]\n> [CRLF]                                                                        \n\nIs this copy from local mail folder to IMAP mail folder of /Test-Inbox-4 ?\nIf copy of mail from IMAP folder to IMAP older of other IMAP server, or if import of .eml file which contains \"From \" line by Drag&Drop of .eml(a way to reproduce raw From line at IMAP folder), this is normal flow.\n\nDid you explicitely execute \"Repair Folder\" at local mail folder after copy of imap offline-store file to local mail folder file?", "creator": "m-wada@usa.com", "author": "m-wada@usa.com", "time": "2011-12-22T04:39:10Z", "attachment_id": null, "creation_time": "2011-12-22T04:39:10Z", "raw_text": "I coul see it at Line 21592 in imap_2.log.\n> 16196[a35e40]: 1dcf000:imap.1und1.de:S-Test-Inbox-4:SendData: 10 append \"Test-Inbox-4\" \"20-Jan-2010 20:41:42 +0100\" {36248+}[CR]\n> [CRLF]\n> 16196[a35e40]: 1dcf000:imap.1und1.de:S-Test-Inbox-4:SendData: From [CR]\n> [CRLF]                                                                        \n> X-Mozilla-Keys: nonjunk    (consecutive spaces)    [CR]\n> [CRLF]                                                                        \n\nIs this copy from local mail folder to IMAP mail folder of /Test-Inbox-4 ?\nIf copy of mail from IMAP folder to IMAP older of other IMAP server, or if import of .eml file which contains \"From \" line by Drag&Drop of .eml(a way to reproduce raw From line at IMAP folder), this is normal flow.\n\nDid you explicitely execute \"Repair Folder\" at local mail folder after copy of imap offline-store file to local mail folder file?"}, {"bug_id": 667288, "is_private": false, "count": 43, "tags": [], "id": 5934550, "text": "It may be \"new line\" character relevant.\nCan you attach IMAP offline-store file which contains mail of \"Raw\" \"From \" only line as first/top mail and several mails additionally.\n\nDid you copy .msf file for offline-store file directory for local mail folder too?\nIf so, it may be \"internal rebuild-index is not automatically executed on copy of offline-store file & .msf file\".", "time": "2011-12-22T04:47:04Z", "attachment_id": null, "creation_time": "2011-12-22T04:47:04Z", "raw_text": "It may be \"new line\" character relevant.\nCan you attach IMAP offline-store file which contains mail of \"Raw\" \"From \" only line as first/top mail and several mails additionally.\n\nDid you copy .msf file for offline-store file directory for local mail folder too?\nIf so, it may be \"internal rebuild-index is not automatically executed on copy of offline-store file & .msf file\".", "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"creator": "m-wada@usa.com", "author": "m-wada@usa.com", "text": "Is the uploaded(append'ed) \"From \" line escaped in local mail folder file as \">From \"(escaped by >) or \" From \"(escaped by space)?", "time": "2011-12-22T04:52:34Z", "attachment_id": null, "raw_text": "Is the uploaded(append'ed) \"From \" line escaped in local mail folder file as \">From \"(escaped by >) or \" From \"(escaped by space)?", "creation_time": "2011-12-22T04:52:34Z", "bug_id": 667288, "tags": [], "is_private": false, "count": 44, "id": 5934553}, {"attachment_id": null, "time": "2011-12-22T06:56:21Z", "text": "FYI.\n\nQuick check result around From line with Gmail IMAP and Yahoo! IMAP.\n(A) Escaped \"From \" line at messeage header part of mail in local mail folder.\n    \">From \"(escaped by >), \" From \"(escaped by space)\n    Tb 8 sends this line as-is to IMAP server.\n(A-1) Gmail IMAP  : Rejects it, because syntax error of message header\n(A-2) Yahoo! IMAP : Accepts it, and ignores it.\n(B) Raw \"From \" line at messeage header part of mail in .eml file.\n    \"From \" only line.\n    Tb 8 sends this line as-is to IMAP server upon Drag&Drop of .eml file.\n(B-1) Gmail IMAP  : Accepts it, and sends it as mail data line to IMAP client.\n(B-2) Yahoo! IMAP : Accepts it, and ignores it.\nSo, phenomenon you are looking is IMAP server dependent.\n\n(C) If local mail folder file(call F1) content is as follows, \n\n++ F1 content \nFrom - Mon Dec 01 16:09:04 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nDate: Sat, 17 Dec 2011 16:08:56 +0900\nFrom: Boyacky at RocketMail <boyacky@rocketmail.com>\n(snip)\n\nlocal mail folder file(call F2) content become as follows, after \"Repair Folder\" of local folder named F1, copy mail in F1 to newly created local mail folder named F2.\n\n++ F2 content \nFrom \nDate: Sat, 17 Dec 2011 16:08:56 +0900\nFrom: Boyacky at RocketMail <boyacky@rocketmail.com>\n(snip)\n\n\"From - Mon ...\", \"X-Mozilla-Status: ...\", \"X-Mozilla-Status2: ...\" is removed. \"From \" line in F2 is Unix Mbox mail separater of Tb's local mail folder file. Tb doesn't look to add X-Mozilla-... header when local mail copy.\n\nAbove (A)/(B)/(C) is reason why I said \"Tb won't send raw From line if mail copy from local mail folder to IMAP folder\".\n\nHowever, if [CR] is sent by IMAP server, data in offline-store file can be one like next.\n...[CRLF]\n...[CR]From [CR]X-Account-Key: ...[CR]...\n[CRLF]\nIf this offline-store file is copied by user as local mail folder file, these are perhaps sent to IMAP server as-is upon mail copy from local mail folder to IMAP folder, because \"new line\" of local mail folder file of Tb is [CRLF] instead of [CR].\nThis is reason why I asked you to attach small offline-store file in your environment.", "raw_text": "FYI.\n\nQuick check result around From line with Gmail IMAP and Yahoo! IMAP.\n(A) Escaped \"From \" line at messeage header part of mail in local mail folder.\n    \">From \"(escaped by >), \" From \"(escaped by space)\n    Tb 8 sends this line as-is to IMAP server.\n(A-1) Gmail IMAP  : Rejects it, because syntax error of message header\n(A-2) Yahoo! IMAP : Accepts it, and ignores it.\n(B) Raw \"From \" line at messeage header part of mail in .eml file.\n    \"From \" only line.\n    Tb 8 sends this line as-is to IMAP server upon Drag&Drop of .eml file.\n(B-1) Gmail IMAP  : Accepts it, and sends it as mail data line to IMAP client.\n(B-2) Yahoo! IMAP : Accepts it, and ignores it.\nSo, phenomenon you are looking is IMAP server dependent.\n\n(C) If local mail folder file(call F1) content is as follows, \n\n++ F1 content \nFrom - Mon Dec 01 16:09:04 2011\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nFrom \nDate: Sat, 17 Dec 2011 16:08:56 +0900\nFrom: Boyacky at RocketMail <boyacky@rocketmail.com>\n(snip)\n\nlocal mail folder file(call F2) content become as follows, after \"Repair Folder\" of local folder named F1, copy mail in F1 to newly created local mail folder named F2.\n\n++ F2 content \nFrom \nDate: Sat, 17 Dec 2011 16:08:56 +0900\nFrom: Boyacky at RocketMail <boyacky@rocketmail.com>\n(snip)\n\n\"From - Mon ...\", \"X-Mozilla-Status: ...\", \"X-Mozilla-Status2: ...\" is removed. \"From \" line in F2 is Unix Mbox mail separater of Tb's local mail folder file. Tb doesn't look to add X-Mozilla-... header when local mail copy.\n\nAbove (A)/(B)/(C) is reason why I said \"Tb won't send raw From line if mail copy from local mail folder to IMAP folder\".\n\nHowever, if [CR] is sent by IMAP server, data in offline-store file can be one like next.\n...[CRLF]\n...[CR]From [CR]X-Account-Key: ...[CR]...\n[CRLF]\nIf this offline-store file is copied by user as local mail folder file, these are perhaps sent to IMAP server as-is upon mail copy from local mail folder to IMAP folder, because \"new line\" of local mail folder file of Tb is [CRLF] instead of [CR].\nThis is reason why I asked you to attach small offline-store file in your environment.", "creation_time": "2011-12-22T06:56:21Z", "bug_id": 667288, "id": 5934635, "tags": [], "is_private": false, "count": 45, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"creator": "m-wada@usa.com", "author": "m-wada@usa.com", "creation_time": "2011-12-22T09:31:10Z", "raw_text": "FYI.\n[CR] in local mail folder file, which was originally IMAP offline-store file, may cause some problems.\n\n(1) ++ Local mail folder F1 content\nFrom 1[CR]\nSubject: mail2[CR]\n[CR] <= null line, separator of header and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR] <= null line, separator of header and payload\ndata2[CR](End of file)\n\n(2) After Compact of F1, these mails are accessed normally.\n    Tb is basically torelant with mixture of [CRLF], [CR], [LF]\n    in mail data held in local mail folder file. \n\n(3) Copy these two mails in F1 to local mail folder of F2.\n++ Local mail folder F2 content\n(mail data lines for existent mails)\nFrom 1[CR]\nSubject: mail1[CR]\n[CR] <= null line, separator of mheader and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR](End of file) <= null line, separator of header and payload\n\n(3-1) data2[CR] of mail2 at bottom of F1 is lost by local mail copy.\n      So, nothing is shown as message body of mail2\n\n(4) Copy other two mails which are similar to mail data in F1(mail4 is at bottom of file) to local mail folder of F2.\n\n++ Local mail folder F2 content\n(mail data lines for existent mails)\nFrom 1[CR]\nSubject: mail1[CR]\n[CR] <= null line, separator of header and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR]\nFrom 3[CR]\nSubject: mail3[CR]\n[CR] <= null line, separator of header and payload\ndata3[CR]\nFrom 4[CR]\nSubject: mail4[CR]\n[CR](End of file) <= null line, separator of mheader and payload\n\n(4-1) \"From 3\" for mail3 is shown as message body of mail2.\n\n(4-2) data4[CR] of mail4 at bottom of F1 is lost by local mail copy.\n      So, nothing is shown as message body of mail4\n\nYou may be looking phenomenon like (4-1).", "text": "FYI.\n[CR] in local mail folder file, which was originally IMAP offline-store file, may cause some problems.\n\n(1) ++ Local mail folder F1 content\nFrom 1[CR]\nSubject: mail2[CR]\n[CR] <= null line, separator of header and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR] <= null line, separator of header and payload\ndata2[CR](End of file)\n\n(2) After Compact of F1, these mails are accessed normally.\n    Tb is basically torelant with mixture of [CRLF], [CR], [LF]\n    in mail data held in local mail folder file. \n\n(3) Copy these two mails in F1 to local mail folder of F2.\n++ Local mail folder F2 content\n(mail data lines for existent mails)\nFrom 1[CR]\nSubject: mail1[CR]\n[CR] <= null line, separator of mheader and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR](End of file) <= null line, separator of header and payload\n\n(3-1) data2[CR] of mail2 at bottom of F1 is lost by local mail copy.\n      So, nothing is shown as message body of mail2\n\n(4) Copy other two mails which are similar to mail data in F1(mail4 is at bottom of file) to local mail folder of F2.\n\n++ Local mail folder F2 content\n(mail data lines for existent mails)\nFrom 1[CR]\nSubject: mail1[CR]\n[CR] <= null line, separator of header and payload\ndata1[CR]\nFrom 2[CR]\nSubject: mail2[CR]\n[CR]\nFrom 3[CR]\nSubject: mail3[CR]\n[CR] <= null line, separator of header and payload\ndata3[CR]\nFrom 4[CR]\nSubject: mail4[CR]\n[CR](End of file) <= null line, separator of mheader and payload\n\n(4-1) \"From 3\" for mail3 is shown as message body of mail2.\n\n(4-2) data4[CR] of mail4 at bottom of F1 is lost by local mail copy.\n      So, nothing is shown as message body of mail4\n\nYou may be looking phenomenon like (4-1).", "time": "2011-12-22T09:31:10Z", "attachment_id": null, "count": 46, "is_private": false, "tags": [], "id": 5934749, "bug_id": 667288}, {"creator": "m-wada@usa.com", "author": "m-wada@usa.com", "text": "Correction of previous comment. sorry for spam.\nWrong:\n  (2) After Compact of F1, these mails are accessed normally.\nCorrect:\n  (2) After Repair Folder of F1, these mails are accessed normally.", "time": "2011-12-22T10:38:23Z", "attachment_id": null, "raw_text": "Correction of previous comment. sorry for spam.\nWrong:\n  (2) After Compact of F1, these mails are accessed normally.\nCorrect:\n  (2) After Repair Folder of F1, these mails are accessed normally.", "creation_time": "2011-12-22T10:38:23Z", "bug_id": 667288, "is_private": false, "count": 47, "tags": [], "id": 5934805}, {"bug_id": 667288, "id": 5934871, "tags": [], "is_private": false, "count": 48, "attachment_id": 583754, "time": "2011-12-22T11:32:55Z", "text": "Created attachment 583754\nMail to see problem due to CR\n\nMail folder file consists of one mail.\n  Subject: mail with CR[CR]\n  1-st message body line :\n       ABCDEFGHIJKLMNOPQRSTUVWXYZ[CR]\n  2-nd(last) message body line, bottom of mail folder file :\n      (string of 400 bytes)[CR]\n  Any mail data line is terminated by [CR].\n\n(1) Create local mail folder(call F1), or delete all mails of F1/Compact.\n(2-1) Copy test mail of \"mail with CR\" to F1.\n      ABCDEFGHIJKLMNOPQRSTUVWXYZ only is shown as message body,\n      because (string of 400 bytes) is not copied to file for F1.\n(2-2) Copy any mail in any mail folder to F1.\n      Message body display of \"mail with CR\" :\n        ABCDEFGHIJKLMNOPQRSTUVWXYZ is shown as first line.\n        400 bytes from \"From ...\" line for this copied mail is shown as body,\n        because mail data length of \"mail with CR\" is same as original.\n(3) Repeat step (2) multiple times.\n      \nBecause mail data line of (string of 400 bytes) is not copied to file for F1, ABCDEFGHIJKLMNOPQRSTUVWXYZ line only is shown after Repair Folder(rebuild-index) of F1.", "raw_text": "Mail folder file consists of one mail.\n  Subject: mail with CR[CR]\n  1-st message body line :\n       ABCDEFGHIJKLMNOPQRSTUVWXYZ[CR]\n  2-nd(last) message body line, bottom of mail folder file :\n      (string of 400 bytes)[CR]\n  Any mail data line is terminated by [CR].\n\n(1) Create local mail folder(call F1), or delete all mails of F1/Compact.\n(2-1) Copy test mail of \"mail with CR\" to F1.\n      ABCDEFGHIJKLMNOPQRSTUVWXYZ only is shown as message body,\n      because (string of 400 bytes) is not copied to file for F1.\n(2-2) Copy any mail in any mail folder to F1.\n      Message body display of \"mail with CR\" :\n        ABCDEFGHIJKLMNOPQRSTUVWXYZ is shown as first line.\n        400 bytes from \"From ...\" line for this copied mail is shown as body,\n        because mail data length of \"mail with CR\" is same as original.\n(3) Repeat step (2) multiple times.\n      \nBecause mail data line of (string of 400 bytes) is not copied to file for F1, ABCDEFGHIJKLMNOPQRSTUVWXYZ line only is shown after Repair Folder(rebuild-index) of F1.", "creation_time": "2011-12-22T11:32:55Z", "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "id": 5934931, "tags": [], "count": 49, "is_private": false, "bug_id": 667288, "raw_text": "Hi WADA,\nsorry for being at sleep here in Europe while you are twisting your brain about possible \"new line\" character relevant phenomenons.\nIn my files, _all_ lines end by [CR][LF], so there should not be any worry about that.\nBut have you recognized the 73 spaces (mark text by mouse in comment 27):\nX-Mozilla-Keys: nonjunk<--73 spaces-->[CR][LF]", "creation_time": "2011-12-22T12:06:33Z", "attachment_id": null, "time": "2011-12-22T12:06:33Z", "text": "Hi WADA,\nsorry for being at sleep here in Europe while you are twisting your brain about possible \"new line\" character relevant phenomenons.\nIn my files, _all_ lines end by [CR][LF], so there should not be any worry about that.\nBut have you recognized the 73 spaces (mark text by mouse in comment 27):\nX-Mozilla-Keys: nonjunk<--73 spaces-->[CR][LF]"}, {"creation_time": "2011-12-22T12:49:08Z", "raw_text": "(In reply to WADA from comment #45)\n> FYI.\n> So, phenomenon you are looking is IMAP server dependent.\nThat's what I wanted to say by comment 18, comment 19.", "attachment_id": null, "time": "2011-12-22T12:49:08Z", "text": "(In reply to WADA from comment #45)\n> FYI.\n> So, phenomenon you are looking is IMAP server dependent.\nThat's what I wanted to say by comment 18, comment 19.", "id": 5934970, "count": 50, "is_private": false, "tags": [], "bug_id": 667288, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "attachment_id": null, "time": "2011-12-22T13:26:42Z", "text": "(In reply to WADA from comment #34)\n> I believe you already saw;\n> Tb escapes \"From \" line by \">\" in Tb's local mail folder file when row \"From\n> \" line is sent from IMAP server upon mail copy from IMAP folder to local\n> mail folder.\nYes.\n\n> And I believe you already saw;\n> Even if row \"From \" line was generated by manual copy of offline-store file\n> of IMAP folder to local mail folder file, the row \"From \" line is treated as\n> Unix Mbox mail separator by Tb.\nYes!\n \n> I believe \"posting comment to a bug at B.M.O\" means \"comment poster already\n> read the bug at B.M.O\".\nAh, now understood and agreed. Sorry for the spam, I had forgotten about that bug.\n\n(In reply to WADA from comment #40)\n> Do following before upload mails to IMAP server(copy from local mail folder\n> to IMAP folder) to make it sure.\n>   1. \"Repair Folder\" of the local mail folder\n>   2. Copy a mail to the local mail folder, and delete the copied mail.\n>      Compact (first Compact).\n>   3. Copy a mail to the local mail folder, and delete the copied mail.\n>      Compact (second Compact).\nThanks for the alternative work around.\n\n(In reply to WADA from comment #42)\n> Is this copy from local mail folder to IMAP mail folder of /Test-Inbox-4 ?\nYes.\n\n> If copy of mail from IMAP folder to IMAP older of other IMAP server, or if\n> import of .eml file which contains \"From \" line by Drag&Drop of .eml(a way\n> to reproduce raw From line at IMAP folder), this is normal flow.\nBut incorrect as well, as IMHO, Tb should reject/repair corrupted mail data or at least only continue with a warning instead _silently_ forwarding the erroneous data to any other party e.g. IMAP server, local .eml file.\n\n> Did you explicitely execute \"Repair Folder\" at local mail folder after copy\n> of imap offline-store file to local mail folder file?\nNo, I strictly followed steps of comment 15 except copying .msf file, as irrelevant.", "raw_text": "(In reply to WADA from comment #34)\n> I believe you already saw;\n> Tb escapes \"From \" line by \">\" in Tb's local mail folder file when row \"From\n> \" line is sent from IMAP server upon mail copy from IMAP folder to local\n> mail folder.\nYes.\n\n> And I believe you already saw;\n> Even if row \"From \" line was generated by manual copy of offline-store file\n> of IMAP folder to local mail folder file, the row \"From \" line is treated as\n> Unix Mbox mail separator by Tb.\nYes!\n \n> I believe \"posting comment to a bug at B.M.O\" means \"comment poster already\n> read the bug at B.M.O\".\nAh, now understood and agreed. Sorry for the spam, I had forgotten about that bug.\n\n(In reply to WADA from comment #40)\n> Do following before upload mails to IMAP server(copy from local mail folder\n> to IMAP folder) to make it sure.\n>   1. \"Repair Folder\" of the local mail folder\n>   2. Copy a mail to the local mail folder, and delete the copied mail.\n>      Compact (first Compact).\n>   3. Copy a mail to the local mail folder, and delete the copied mail.\n>      Compact (second Compact).\nThanks for the alternative work around.\n\n(In reply to WADA from comment #42)\n> Is this copy from local mail folder to IMAP mail folder of /Test-Inbox-4 ?\nYes.\n\n> If copy of mail from IMAP folder to IMAP older of other IMAP server, or if\n> import of .eml file which contains \"From \" line by Drag&Drop of .eml(a way\n> to reproduce raw From line at IMAP folder), this is normal flow.\nBut incorrect as well, as IMHO, Tb should reject/repair corrupted mail data or at least only continue with a warning instead _silently_ forwarding the erroneous data to any other party e.g. IMAP server, local .eml file.\n\n> Did you explicitely execute \"Repair Folder\" at local mail folder after copy\n> of imap offline-store file to local mail folder file?\nNo, I strictly followed steps of comment 15 except copying .msf file, as irrelevant.", "creation_time": "2011-12-22T13:26:42Z", "bug_id": 667288, "id": 5934990, "tags": [], "is_private": false, "count": 51}, {"bug_id": 667288, "id": 5934994, "tags": [], "count": 52, "is_private": false, "attachment_id": null, "time": "2011-12-22T13:30:26Z", "text": "(In reply to WADA from comment #44)\n> Is the uploaded(append'ed) \"From \" line escaped in local mail folder file as\n> \">From \"(escaped by >) or \" From \"(escaped by space)?\n\nNo!", "raw_text": "(In reply to WADA from comment #44)\n> Is the uploaded(append'ed) \"From \" line escaped in local mail folder file as\n> \">From \"(escaped by >) or \" From \"(escaped by space)?\n\nNo!", "creation_time": "2011-12-22T13:30:26Z", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"id": 5935002, "is_private": false, "count": 53, "tags": [], "bug_id": 667288, "raw_text": "Internal rebuild-index was surely invoked on the copied offline-store file, because you didn't copy .msf file.\nIt looks Tb sends \"From \" line, even though only \"From ...\" line as Unix Mbox mail separator exists in mail folder file(even if excess \"From \" line is contained, this line and following excess lines till next \"From ...\" line is discarded by rebuild-index), and even though there is no escaped \"From ...\" line(\">From ...\" or \" From ...\").\n \nIf not problem like [CR] relevant phenomenon(Tb uses data for next mail as mail data of this mail in this case), next header is relevant?\n> From:<webmaster@goatrance.de>\n\nTb has problem8known bug) when header like next;\n> Subject: ...[CRLF]\n> [Htab or Space][some Spaces][CRLF]\n> [CRLF] <= separator of header and payload\nIn this case, Tb accesses uninitialized memory area because of \"space only folded line just before separator of header and payload\", so anything wrong can happen if data in uninitialize memory area is used as pointer to data.\nTb may search space after \"From:\", and may wrongly use \"From \" of \"From ...\" line(Unix Mbox mail separator) as mail data.", "creation_time": "2011-12-22T13:42:09Z", "attachment_id": null, "time": "2011-12-22T13:42:09Z", "text": "Internal rebuild-index was surely invoked on the copied offline-store file, because you didn't copy .msf file.\nIt looks Tb sends \"From \" line, even though only \"From ...\" line as Unix Mbox mail separator exists in mail folder file(even if excess \"From \" line is contained, this line and following excess lines till next \"From ...\" line is discarded by rebuild-index), and even though there is no escaped \"From ...\" line(\">From ...\" or \" From ...\").\n \nIf not problem like [CR] relevant phenomenon(Tb uses data for next mail as mail data of this mail in this case), next header is relevant?\n> From:<webmaster@goatrance.de>\n\nTb has problem8known bug) when header like next;\n> Subject: ...[CRLF]\n> [Htab or Space][some Spaces][CRLF]\n> [CRLF] <= separator of header and payload\nIn this case, Tb accesses uninitialized memory area because of \"space only folded line just before separator of header and payload\", so anything wrong can happen if data in uninitialize memory area is used as pointer to data.\nTb may search space after \"From:\", and may wrongly use \"From \" of \"From ...\" line(Unix Mbox mail separator) as mail data.", "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"creation_time": "2011-12-22T13:45:09Z", "raw_text": "Other headers without space after \":\".\n> X-Sender:<webmaster@goatrance.de>\n> X-Mailer:PHP Goabase Email Robot\n> X-List:Goabase * Parties and Peopl", "attachment_id": null, "time": "2011-12-22T13:45:09Z", "text": "Other headers without space after \":\".\n> X-Sender:<webmaster@goatrance.de>\n> X-Mailer:PHP Goabase Email Robot\n> X-List:Goabase * Parties and Peopl", "id": 5935004, "is_private": false, "count": 54, "tags": [], "bug_id": 667288, "author": "m-wada@usa.com", "creator": "m-wada@usa.com"}, {"creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de", "count": 55, "is_private": false, "tags": [], "id": 5935021, "bug_id": 667288, "raw_text": "In case of corrupt(=incompatible) mbox files,\nmy conclusion for now (in priority from top):\n\nTb should ...\n- use same/compatible mbox format for IMAP and other folders.\n- forum (and even bug) posters should never speak about manually moving/copying mail folder files around ;-) :-D\n(or at least refer to detailed consequences)\n- ask user about repair choices.\n- verbosely automatically repair them.\n- silently automatically repair them.\n- reject them by error message\n- silently ignore them.\n\nTb should NOT ...\n- forward any corrupt/erroneous data _silently_ to any other party e.g. IMAP server, local .eml file.\n- treat/change any corrupt/erroneous data _silently_ internally.", "creation_time": "2011-12-22T13:56:30Z", "text": "In case of corrupt(=incompatible) mbox files,\nmy conclusion for now (in priority from top):\n\nTb should ...\n- use same/compatible mbox format for IMAP and other folders.\n- forum (and even bug) posters should never speak about manually moving/copying mail folder files around ;-) :-D\n(or at least refer to detailed consequences)\n- ask user about repair choices.\n- verbosely automatically repair them.\n- silently automatically repair them.\n- reject them by error message\n- silently ignore them.\n\nTb should NOT ...\n- forward any corrupt/erroneous data _silently_ to any other party e.g. IMAP server, local .eml file.\n- treat/change any corrupt/erroneous data _silently_ internally.", "attachment_id": null, "time": "2011-12-22T13:56:30Z"}, {"raw_text": "(In reply to WADA from comment #53)\n> Tb has problem8known bug) when header like next;\n> > Subject: ...[CRLF]\n> > [Htab or Space][some Spaces][CRLF]\n> > [CRLF] <= separator of header and payload\nI believe, my '\"From\" as sender address in web-mailer + corrupt mail data'-problem is independent from those effects, even there are some [Htab]'s in my test data, but the original 63 emails were quite different, but all failed.\nSo here it is (new download from server after steps in comment 25)...", "creation_time": "2011-12-22T14:25:22Z", "time": "2011-12-22T14:25:22Z", "attachment_id": 583775, "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de", "text": "Created attachment 583775\nIMAP mbox after new download from server\n\n(In reply to WADA from comment #53)\n> Tb has problem8known bug) when header like next;\n> > Subject: ...[CRLF]\n> > [Htab or Space][some Spaces][CRLF]\n> > [CRLF] <= separator of header and payload\nI believe, my '\"From\" as sender address in web-mailer + corrupt mail data'-problem is independent from those effects, even there are some [Htab]'s in my test data, but the original 63 emails were quite different, but all failed.\nSo here it is (new download from server after steps in comment 25)...", "id": 5935072, "count": 56, "is_private": false, "tags": [], "bug_id": 667288}, {"bug_id": 667288, "id": 5935107, "tags": [], "count": 57, "is_private": false, "attachment_id": null, "time": "2011-12-22T14:40:44Z", "text": "Hey, was a heavy birth!\nThanks for your patience.\n\n+ don't forget the consequences of this bug, as they are ...\n- irresponsible Windows XP (~=crash) --> bug 667294\n- dataloss of all open data.", "raw_text": "Hey, was a heavy birth!\nThanks for your patience.\n\n+ don't forget the consequences of this bug, as they are ...\n- irresponsible Windows XP (~=crash) --> bug 667294\n- dataloss of all open data.", "creation_time": "2011-12-22T14:40:44Z", "author": "Ulf.Zibis@gmx.de", "creator": "Ulf.Zibis@gmx.de"}, {"author": "m-wada@usa.com", "creator": "m-wada@usa.com", "id": 5935161, "tags": [], "is_private": false, "count": 58, "bug_id": 667288, "raw_text": "(In reply to Ulf Zibis from comment #56)\n> Created attachment 583775\n> IMAP mbox after new download from server\n\nTwo identical mail data are contained in the file.\nIf they are split to two files, and if line of \"From \" only is removed from file for senond mail, differene was next only.\n++ First mail\n> From - Thu Dec 22 00:47:50 2011[CRLF]\n++ Second mail\n> From - Thu Dec 22 00:48:13 2011[CRLF]\n\n++ First 7 lines of second mail (\"From \" only line is seen)\n> From - Thu Dec 22 00:48:13 2011\n> X-Mozilla-Status: 0001\n> X-Mozilla-Status2: 00000000\n> From \n> X-Mozilla-Keys: nonjunk     <= note: excess spaces are delete before paste\n> Return-Path: <www-data@www.goatrance.de>\n\nDo you have two identical mails with different UID in the IMAP mail folder?\n(Show \"Order Received\" column. Shown value is UID of mail in IMAP folder if IMAP folder. If local mail folder, value is offset in local mail folder file)\nOr you have only one mail in the IMAP mail folder?", "creation_time": "2011-12-22T15:12:21Z", "attachment_id": null, "time": "2011-12-22T15:12:21Z", "text": "(In reply to Ulf Zibis from comment #56)\n> Created attachment 583775\n> IMAP mbox after new download from server\n\nTwo identical mail data are contained in the file.\nIf they are split to two files, and if line of \"From \" only is removed from file for senond mail, differene was next only.\n++ First mail\n> From - Thu Dec 22 00:47:50 2011[CRLF]\n++ Second mail\n> From - Thu Dec 22 00:48:13 2011[CRLF]\n\n++ First 7 lines of second mail (\"From \" only line is seen)\n> From - Thu Dec 22 00:48:13 2011\n> X-Mozilla-Status: 0001\n> X-Mozilla-Status2: 00000000\n> From \n> X-Mozilla-Keys: nonjunk     <= note: excess spaces are delete before paste\n> Return-Path: <www-data@www.goatrance.de>\n\nDo you have two identical mails with different UID in the IMAP mail folder?\n(Show \"Order Received\" column. Shown value is UID of mail in IMAP folder if IMAP folder. If local mail folder, value is offset in local mail folder file)\nOr you have only one mail in the IMAP mail folder?"}, {"creator": "Ulf.Zibis@gmx.de", "author": "Ulf.Zibis@gmx.de", "text": "(In reply to WADA from comment #58)\n> Do you have two identical mails with different UID in the IMAP mail folder?\nCorrect.\nAs I detailed in comment 25, I have copied the same original mail twice, so in result we have 2 duplicates, one uploaded before the compacting, and on after.", "attachment_id": null, "time": "2011-12-22T18:54:18Z", "raw_text": "(In reply to WADA from comment #58)\n> Do you have two identical mails with different UID in the IMAP mail folder?\nCorrect.\nAs I detailed in comment 25, I have copied the same original mail twice, so in result we have 2 duplicates, one uploaded before the compacting, and on after.", "creation_time": "2011-12-22T18:54:18Z", "bug_id": 667288, "tags": [], "is_private": false, "count": 59, "id": 5935816}, {"text": "Problem was simple.\nTb doesn't remove Unix Mbox mail separator line in local mail folder file upon IMAP upload, if some variants of the separator is used in local mail folder file.\ni.e. \"From ...\" line version of Bug 426651 for X-Mozilla-Keys:.\n\n++ Local mail folder file content\n\nFrom xyz                    <= A variant of Unix Mbox mail separator\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: tag1\nSubject: mail1\n(snip)\n\n++ IMAP offline-store file content after \"Copy from local mail folder\", \"Repair Folder\"(to force re-download).\n\nFrom - Fri Dec 23 09:17:29 2011 <= Place holder of Unix Mbox separator format\nX-Mozilla-Status: 0001          <= Place holder line no. 2\nX-Mozilla-Status2: 00000000     <= Place holder line no. 3\nFrom xyz                  <= Data sent from server == Tb sent to server upon copy\nX-Mozilla-Keys: tag1      <= Data sent from server == Tb sent to server upon copy\nSubject: mail1\n(snip)\n\nWhy I couldn't see above \"From ...\" line in my previous duplication test was;\n   I used Yahoo! IMAP in test like above instead of Gmail IMAP.\n   Yahoo! IMAP eated up this \"From ...\" line, as I stated before.\n\nConfirming.\n\nUnix Mbox Mail separator has many variants. For example,\n(a) \"From \"\n(b) \"From ...\"   (... = any non-space chars) \n(c) \"From ...\" + timestamp  (... = any non-space chars. Opera uses message-id) \n(d) \"From -\"   + timestamp  (A variant of (c) type. Tb writes this type.)\n(e) \"From ...\" + timestamp + comments  (... = any non-space chars) \nRebuild-Index of Tb uses rule of \"line starts with From+space\" for compatibility.\n\nIMAP copy of Tb perhaps looks all mail data including Unix Mbox mail separator and removes type (d) line only upon upload to IMAP in addition to removal of X-Mozilla-Status/Status2.\n\nWhy you always saw problem of Web Mailer on first mail is;\n  When multiple mails are selected at thread pane and copy is requested,\n    if copy target is local mail folder, copy is done in sorted order.\n    if copy target is imap folder, copy is done in reversed order.\nBecause mail with \"From \" line is second mail in your case, and sorted order is always ascending just after rebuild-index, second mail is appended first and first mail is appended second.\n              \nCompact of the local mail folder, Mail copy to other local mail folder, didn't alter this Unix Mbox mail separator line. So, manual removal of \"From \" line or manual format change of \"From \" line is needed in your case.\nHowever, proper way in your case is \"copy from IMAP folder to local mail folder\" instead of \"use IMAP offline-store file as local mail folder file\" which is never officially supported.\nBecause \"From \" line is escaped and is changed to \">From \" in local mail folder file, you can easily remove excess \"From \" by removal of \">From \" line, if server rejects \">From \" line in message header.", "attachment_id": null, "time": "2011-12-23T01:51:37Z", "raw_text": "Problem was simple.\nTb doesn't remove Unix Mbox mail separator line in local mail folder file upon IMAP upload, if some variants of the separator is used in local mail folder file.\ni.e. \"From ...\" line version of Bug 426651 for X-Mozilla-Keys:.\n\n++ Local mail folder file content\n\nFrom xyz                    <= A variant of Unix Mbox mail separator\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nX-Mozilla-Keys: tag1\nSubject: mail1\n(snip)\n\n++ IMAP offline-store file content after \"Copy from local mail folder\", \"Repair Folder\"(to force re-download).\n\nFrom - Fri Dec 23 09:17:29 2011 <= Place holder of Unix Mbox separator format\nX-Mozilla-Status: 0001          <= Place holder line no. 2\nX-Mozilla-Status2: 00000000     <= Place holder line no. 3\nFrom xyz                  <= Data sent from server == Tb sent to server upon copy\nX-Mozilla-Keys: tag1      <= Data sent from server == Tb sent to server upon copy\nSubject: mail1\n(snip)\n\nWhy I couldn't see above \"From ...\" line in my previous duplication test was;\n   I used Yahoo! IMAP in test like above instead of Gmail IMAP.\n   Yahoo! IMAP eated up this \"From ...\" line, as I stated before.\n\nConfirming.\n\nUnix Mbox Mail separator has many variants. For example,\n(a) \"From \"\n(b) \"From ...\"   (... = any non-space chars) \n(c) \"From ...\" + timestamp  (... = any non-space chars. Opera uses message-id) \n(d) \"From -\"   + timestamp  (A variant of (c) type. Tb writes this type.)\n(e) \"From ...\" + timestamp + comments  (... = any non-space chars) \nRebuild-Index of Tb uses rule of \"line starts with From+space\" for compatibility.\n\nIMAP copy of Tb perhaps looks all mail data including Unix Mbox mail separator and removes type (d) line only upon upload to IMAP in addition to removal of X-Mozilla-Status/Status2.\n\nWhy you always saw problem of Web Mailer on first mail is;\n  When multiple mails are selected at thread pane and copy is requested,\n    if copy target is local mail folder, copy is done in sorted order.\n    if copy target is imap folder, copy is done in reversed order.\nBecause mail with \"From \" line is second mail in your case, and sorted order is always ascending just after rebuild-index, second mail is appended first and first mail is appended second.\n              \nCompact of the local mail folder, Mail copy to other local mail folder, didn't alter this Unix Mbox mail separator line. So, manual removal of \"From \" line or manual format change of \"From \" line is needed in your case.\nHowever, proper way in your case is \"copy from IMAP folder to local mail folder\" instead of \"use IMAP offline-store file as local mail folder file\" which is never officially supported.\nBecause \"From \" line is escaped and is changed to \">From \" in local mail folder file, you can easily remove excess \"From \" by removal of \">From \" line, if server rejects \">From \" line in message header.", "creation_time": "2011-12-23T01:51:37Z", "bug_id": 667288, "is_private": false, "count": 60, "tags": [], "id": 5936877, "creator": "m-wada@usa.com", "author": "m-wada@usa.com"}, {"raw_text": "FYI.\n\n\"use IMAP offline-store file as local mail folder file\" is impossible in next case.\n- offline-store file size > limitation of file size of local mail folder file\n  current file size limitation : 4GB(Win), 2GB(Linux, Mac OS X)\n  If offline-store file, 64bits integer is used for offset in file,\n  thus, practically, there is no limitation in file size.\n  So, unless user splits file by external utilities, file can't be used.\n\n\"use IMAP offline-store file as local mail folder file\" always produces this bug's problem, if mails are uploaded again to IMAP server,\nbecause,\n  as you already know, \"place holder in IMAP offline-store file\" is always\n  From+Space after Compact of IMAP folder of offline-use=on,\nand because,\n  there is no way to alter Unix Mbox mail separator in Tb's local mail folder\n  file once generated by Tb or someone.", "creation_time": "2011-12-23T03:03:01Z", "text": "FYI.\n\n\"use IMAP offline-store file as local mail folder file\" is impossible in next case.\n- offline-store file size > limitation of file size of local mail folder file\n  current file size limitation : 4GB(Win), 2GB(Linux, Mac OS X)\n  If offline-store file, 64bits integer is used for offset in file,\n  thus, practically, there is no limitation in file size.\n  So, unless user splits file by external utilities, file can't be used.\n\n\"use IMAP offline-store file as local mail folder file\" always produces this bug's problem, if mails are uploaded again to IMAP server,\nbecause,\n  as you already know, \"place holder in IMAP offline-store file\" is always\n  From+Space after Compact of IMAP folder of offline-use=on,\nand because,\n  there is no way to alter Unix Mbox mail separator in Tb's local mail folder\n  file once generated by Tb or someone.", "creator": "m-wada@usa.com", "author": "m-wada@usa.com", "attachment_id": null, "time": "2011-12-23T03:03:01Z", "tags": [], "count": 61, "is_private": false, "id": 5936959, "bug_id": 667288}, {"raw_text": "FYI.\nCurrently available recovery procedure from excess \"From \" line in IMAP folder which was generated by your \"copy of offline-store file as local mail folder file\" + Tb's this bug is : Utilizing Tb's bug 708941.\n\n(1) \"Repair Folder\" of the IMAP folder.\n    => All mail data is downloaded again.\n       \"From \" line is written in offline-store file as top line of mail data. \n(2) Compact the IMAP folder, until all \"From \" lines at top is eaten by Tb.\n    => Due to bug 708941, excess \"From \" line is used as \"place holder\" of mail\n       in IMAP offline-store file by Tb.\n(3) Copy all mails to local mail folder.\n    => Tb writes Unix Mbox mail separator to local mail folder\n       in standard format for Tb.\n       From - Sat Dec 24 02:38:40 2011\n    => Excess \"From \" is not written in escaped format of \">From \", because\n       there is no excess \"From \" in Tb's offline-store file due to bug 708941.\n(4) Delete all mails in the IMAP folder, and Compact.\n(5) Copy all mails in the local mail folder to the IMAP folder.\n    => Because Unix Mbox mail separator is standard format of Tb,\n       this bug won't occur.\n    => Because there is no excess \"From \" line nor \">From \" line,\n       garbled data is not sent to IMAP server.", "creation_time": "2011-12-24T00:40:03Z", "author": "m-wada@usa.com", "time": "2011-12-24T00:40:03Z", "attachment_id": null, "creator": "m-wada@usa.com", "text": "FYI.\nCurrently available recovery procedure from excess \"From \" line in IMAP folder which was generated by your \"copy of offline-store file as local mail folder file\" + Tb's this bug is : Utilizing Tb's bug 708941.\n\n(1) \"Repair Folder\" of the IMAP folder.\n    => All mail data is downloaded again.\n       \"From \" line is written in offline-store file as top line of mail data. \n(2) Compact the IMAP folder, until all \"From \" lines at top is eaten by Tb.\n    => Due to bug 708941, excess \"From \" line is used as \"place holder\" of mail\n       in IMAP offline-store file by Tb.\n(3) Copy all mails to local mail folder.\n    => Tb writes Unix Mbox mail separator to local mail folder\n       in standard format for Tb.\n       From - Sat Dec 24 02:38:40 2011\n    => Excess \"From \" is not written in escaped format of \">From \", because\n       there is no excess \"From \" in Tb's offline-store file due to bug 708941.\n(4) Delete all mails in the IMAP folder, and Compact.\n(5) Copy all mails in the local mail folder to the IMAP folder.\n    => Because Unix Mbox mail separator is standard format of Tb,\n       this bug won't occur.\n    => Because there is no excess \"From \" line nor \">From \" line,\n       garbled data is not sent to IMAP server.", "id": 5938083, "tags": [], "is_private": false, "count": 62, "bug_id": 667288}, {"creation_time": "2019-07-22T01:11:11Z", "raw_text": "Seem like pretty obscure bug. WADA suggests some workarounds in the last few comment.", "text": "Seem like pretty obscure bug. WADA suggests some workarounds in the last few comment.", "time": "2019-07-22T01:11:11Z", "attachment_id": null, "count": 63, "is_private": false, "tags": [], "id": 14249056, "bug_id": 667288, "creator": "gds@chartertn.net", "author": "gds@chartertn.net"}]}}}