{"bugs": {"686123": {"comments": [{"creation_time": "2011-09-10T14:56:00Z", "is_private": false, "bug_id": 686123, "id": 5712556, "author": "benjamin.lerner@gmail.com", "text": "Created attachment 559691\nClick the menu item to crash TB\n\nWhile working on an extension, using only scriptable methods from JS I managed to crash TB hard, despite a JS try/catch block.\n\nIf you uncomment the setWindow call in overlay.js, the crash is avoided.", "count": 0, "creator": "benjamin.lerner@gmail.com", "tags": [], "attachment_id": 559691, "raw_text": "While working on an extension, using only scriptable methods from JS I managed to crash TB hard, despite a JS try/catch block.\n\nIf you uncomment the setWindow call in overlay.js, the crash is avoided.", "time": "2011-09-10T14:56:00Z"}, {"attachment_id": 559692, "tags": [], "creator": "jonathan.protzenko@gmail.com", "creation_time": "2011-09-10T15:05:56Z", "is_private": false, "raw_text": "Previous xpi had a wrong structure.", "time": "2011-09-10T15:05:56Z", "count": 1, "text": "Created attachment 559692\nTools > Crash TB\n\nPrevious xpi had a wrong structure.", "author": "jonathan.protzenko@gmail.com", "bug_id": 686123, "id": 5712563}, {"attachment_id": null, "tags": [], "creator": "vseerror@lehigh.edu", "creation_time": "2011-09-10T15:33:14Z", "is_private": false, "raw_text": "(keyword + severity)\n\none of these? https://crash-stats.mozilla.com/query/query?product=Thunderbird&version=ALL%3AALL&range_value=3&range_unit=days&date=09%2F10%2F2011+08%3A29%3A23&query_search=signature&query_type=contains&query=URL&reason=&build_id=&process_type=any&hang_type=any&do_query=1", "time": "2011-09-10T15:33:14Z", "author": "vseerror@lehigh.edu", "count": 2, "text": "(keyword + severity)\n\none of these? https://crash-stats.mozilla.com/query/query?product=Thunderbird&version=ALL%3AALL&range_value=3&range_unit=days&date=09%2F10%2F2011+08%3A29%3A23&query_search=signature&query_type=contains&query=URL&reason=&build_id=&process_type=any&hang_type=any&do_query=1", "bug_id": 686123, "id": 5712583}, {"attachment_id": null, "raw_text": "I don't think it has anything to do with parsing URLs -- the intial crash I saw was with a completely valid URL, obtained by nsIMsgDBView::GetURIForViewIndex(some number).  And when I uncomment the setWindow line in the xpi, the crash goes away, even with the invalid \"mailbox://anything\" URL that's currently there.  I think the crash has to do with the fact that in http://mxr.mozilla.org/comm-central/source/mailnews/base/src/nsMessenger.cpp#518, nsMessenger::OpenURL, it calls AddMsgUrlToNavigateHistory, which dereferences mMsgWindow, which has never been set and is therefore null.", "time": "2011-09-10T17:01:46Z", "tags": [], "author": "benjamin.lerner@gmail.com", "text": "I don't think it has anything to do with parsing URLs -- the intial crash I saw was with a completely valid URL, obtained by nsIMsgDBView::GetURIForViewIndex(some number).  And when I uncomment the setWindow line in the xpi, the crash goes away, even with the invalid \"mailbox://anything\" URL that's currently there.  I think the crash has to do with the fact that in http://mxr.mozilla.org/comm-central/source/mailnews/base/src/nsMessenger.cpp#518, nsMessenger::OpenURL, it calls AddMsgUrlToNavigateHistory, which dereferences mMsgWindow, which has never been set and is therefore null.", "count": 3, "creator": "benjamin.lerner@gmail.com", "creation_time": "2011-09-10T17:01:46Z", "is_private": false, "bug_id": 686123, "id": 5712641}, {"creator": "vseerror@lehigh.edu", "author": "vseerror@lehigh.edu", "count": 4, "text": "Ben, like https://crash-stats.mozilla.com/report/index/6da366de-f9c3-4234-979f-640372110905 ?", "bug_id": 686123, "id": 5763046, "creation_time": "2011-10-06T11:53:28Z", "is_private": false, "time": "2011-10-06T11:53:28Z", "attachment_id": null, "raw_text": "Ben, like https://crash-stats.mozilla.com/report/index/6da366de-f9c3-4234-979f-640372110905 ?", "tags": []}, {"creator": "benjamin.lerner@gmail.com", "creation_time": "2011-10-06T13:37:25Z", "is_private": false, "attachment_id": null, "tags": [], "text": "Possibly, yeah -- that crash is from an older version of TB than I used (I tested on 5 or 6, whichever was current a few weeks ago, and that crash is from TB3.0.4), so the line numbers are a bit different.  Also, the crash I create in my test extension doesn't require stack frames 2-4 of this trace; it just jumps straight to the call to OpenURL, and then into AddMsgToUrlNavigateHistory, and then into oblivion when it dereferences mMsgWindow.  So it's probably crashing on the same bug in this trace as in attachment 559692 above, but I suspect that there's another bug lurking in that trace: somehow, it must have created an incomplete nsIMessenger.  Reading through nsMsgDBView, the messenger being used on line 1025 comes from a weak ref stored in the nsMsgDBView, which was initialized in either Init or CopyDBView...but since neither of those are on the stack trace, I can't tell where it came from.  It looks like both of those initializers are ok in and of themselves, but there's not enough information to tell whether the messenger that was passed in was improperly initialized.", "count": 5, "author": "benjamin.lerner@gmail.com", "bug_id": 686123, "id": 5763181, "raw_text": "Possibly, yeah -- that crash is from an older version of TB than I used (I tested on 5 or 6, whichever was current a few weeks ago, and that crash is from TB3.0.4), so the line numbers are a bit different.  Also, the crash I create in my test extension doesn't require stack frames 2-4 of this trace; it just jumps straight to the call to OpenURL, and then into AddMsgToUrlNavigateHistory, and then into oblivion when it dereferences mMsgWindow.  So it's probably crashing on the same bug in this trace as in attachment 559692 above, but I suspect that there's another bug lurking in that trace: somehow, it must have created an incomplete nsIMessenger.  Reading through nsMsgDBView, the messenger being used on line 1025 comes from a weak ref stored in the nsMsgDBView, which was initialized in either Init or CopyDBView...but since neither of those are on the stack trace, I can't tell where it came from.  It looks like both of those initializers are ok in and of themselves, but there's not enough information to tell whether the messenger that was passed in was improperly initialized.", "time": "2011-10-06T13:37:25Z"}, {"tags": [], "raw_text": "nsMessenger::AddMsgUrlToNavigateHistory(nsACString_internal const&)\n\nbp-7df65635-3e86-4caf-94ab-d02902111006\nEXCEPTION_ACCESS_VIOLATION_READ\n0x0\n0\txul.dll\tnsMessenger::AddMsgUrlToNavigateHistory\tmailnews/base/src/nsMessenger.cpp:503\n1\txul.dll\tnsMessenger::OpenURL\tmailnews/base/src/nsMessenger.cpp:529\n2\txul.dll\tNS_InvokeByIndex_P\txpcom/reflect/xptcall/src/md/win32/xptcinvoke.cpp:102\n3\txul.dll\tXPCWrappedNative::CallMethod\tjs/src/xpconnect/src/xpcwrappednative.cpp:2334\n4\txul.dll\tXPC_WN_CallMethod\tjs/src/xpconnect/src/xpcwrappednativejsops.cpp:1629\n5\tmozjs.dll\tjs::InvokeKernel\tjs/src/jsinterp.cpp:630 \n\nonly 3 other examples in crash-stats from last two months.\nbp-04e7f018-0786-4250-a3b9-82f5a2110831\nbp-7e8b9069-5624-4d03-8a0f-cec042110826\nbp-2bc7fde7-649d-43e4-94d2-6bc2c2110813", "attachment_id": null, "time": "2011-10-06T14:23:08Z", "creation_time": "2011-10-06T14:23:08Z", "is_private": false, "bug_id": 686123, "id": 5763263, "count": 6, "text": "nsMessenger::AddMsgUrlToNavigateHistory(nsACString_internal const&)\n\nbp-7df65635-3e86-4caf-94ab-d02902111006\nEXCEPTION_ACCESS_VIOLATION_READ\n0x0\n0\txul.dll\tnsMessenger::AddMsgUrlToNavigateHistory\tmailnews/base/src/nsMessenger.cpp:503\n1\txul.dll\tnsMessenger::OpenURL\tmailnews/base/src/nsMessenger.cpp:529\n2\txul.dll\tNS_InvokeByIndex_P\txpcom/reflect/xptcall/src/md/win32/xptcinvoke.cpp:102\n3\txul.dll\tXPCWrappedNative::CallMethod\tjs/src/xpconnect/src/xpcwrappednative.cpp:2334\n4\txul.dll\tXPC_WN_CallMethod\tjs/src/xpconnect/src/xpcwrappednativejsops.cpp:1629\n5\tmozjs.dll\tjs::InvokeKernel\tjs/src/jsinterp.cpp:630 \n\nonly 3 other examples in crash-stats from last two months.\nbp-04e7f018-0786-4250-a3b9-82f5a2110831\nbp-7e8b9069-5624-4d03-8a0f-cec042110826\nbp-2bc7fde7-649d-43e4-94d2-6bc2c2110813", "author": "vseerror@lehigh.edu", "creator": "vseerror@lehigh.edu"}, {"author": "vseerror@lehigh.edu", "count": 7, "text": "retested. resulting crash bp-0e465a52-912d-424f-aa92-676832120708\n\nsomewhat rare. all these examples have only testpilot installed\nbp-9c2569fb-fe46-4783-ad80-688472120614\nbp-d732ca6c-2d47-4977-a05b-4211a2120707\nbp-cf3c9769-8516-44c3-8575-994842120616 startup\nbp-999247a4-545f-4426-8fc0-bf1302120622\n\nno correlations, no comments", "id": 6453560, "bug_id": 686123, "raw_text": "retested. resulting crash bp-0e465a52-912d-424f-aa92-676832120708\n\nsomewhat rare. all these examples have only testpilot installed\nbp-9c2569fb-fe46-4783-ad80-688472120614\nbp-d732ca6c-2d47-4977-a05b-4211a2120707\nbp-cf3c9769-8516-44c3-8575-994842120616 startup\nbp-999247a4-545f-4426-8fc0-bf1302120622\n\nno correlations, no comments", "time": "2012-07-08T16:32:06Z", "creator": "vseerror@lehigh.edu", "creation_time": "2012-07-08T16:32:06Z", "is_private": false, "attachment_id": null, "tags": []}, {"text": "Removing myslef on all the bugs I'm cced on. Please NI me if you need something on MailNews Core bugs from me.", "count": 8, "author": "ludovic@hirlimann.net", "bug_id": 686123, "id": 10776322, "raw_text": "Removing myslef on all the bugs I'm cced on. Please NI me if you need something on MailNews Core bugs from me.", "time": "2015-09-25T12:49:10Z", "creator": "ludovic@hirlimann.net", "creation_time": "2015-09-25T12:49:10Z", "is_private": false, "attachment_id": null, "tags": []}, {"author": "vseerror@lehigh.edu", "count": 9, "text": "Ben, can you still reproduce or still have the addon which caused this?\n\nStill rare, average only one per week\n\nbp-51e724f2-db60-403e-a968-262a10190506\n\n0       xul.dll\tnsMessenger::AddMsgUrlToNavigateHistory(nsTSubstring<char> const&)\tcomm/mailnews/base/src/nsMessenger.cpp:442\tcontext\n1\txul.dll\tnsMessenger::OpenURL(nsTSubstring<char> const&)\tcomm/mailnews/base/src/nsMessenger.cpp:471\tcfi\n2\txul.dll\tnsMsgDBView::LoadMessageByViewIndex(unsigned int)\tcomm/mailnews/base/src/nsMsgDBView.cpp:1228\tcfi\n3\txul.dll\tnsMsgGroupView::LoadMessageByViewIndex(unsigned int)\tcomm/mailnews/base/src/nsMsgGroupView.cpp:1056\tcfi\n4\txul.dll\tnsMsgDBView::SelectionChanged()\tcomm/mailnews/base/src/nsMsgDBView.cpp:1321\tcfi\n5\txul.dll\tNS_InvokeByIndex\txpcom/reflect/xptcall/md/win32/xptcinvoke_asm_x86_msvc.asm:54\tcfi", "bug_id": 686123, "id": 14112281, "raw_text": "Ben, can you still reproduce or still have the addon which caused this?\n\nStill rare, average only one per week\n\nbp-51e724f2-db60-403e-a968-262a10190506\n\n0       xul.dll\tnsMessenger::AddMsgUrlToNavigateHistory(nsTSubstring<char> const&)\tcomm/mailnews/base/src/nsMessenger.cpp:442\tcontext\n1\txul.dll\tnsMessenger::OpenURL(nsTSubstring<char> const&)\tcomm/mailnews/base/src/nsMessenger.cpp:471\tcfi\n2\txul.dll\tnsMsgDBView::LoadMessageByViewIndex(unsigned int)\tcomm/mailnews/base/src/nsMsgDBView.cpp:1228\tcfi\n3\txul.dll\tnsMsgGroupView::LoadMessageByViewIndex(unsigned int)\tcomm/mailnews/base/src/nsMsgGroupView.cpp:1056\tcfi\n4\txul.dll\tnsMsgDBView::SelectionChanged()\tcomm/mailnews/base/src/nsMsgDBView.cpp:1321\tcfi\n5\txul.dll\tNS_InvokeByIndex\txpcom/reflect/xptcall/md/win32/xptcinvoke_asm_x86_msvc.asm:54\tcfi", "time": "2019-05-12T14:57:26Z", "creator": "vseerror@lehigh.edu", "creation_time": "2019-05-12T14:57:26Z", "is_private": false, "attachment_id": null, "tags": []}, {"time": "2019-05-12T15:40:29Z", "attachment_id": null, "raw_text": "Yes -- :protz' addon attached above instantly crashes TB60.6.1.  I just installed it, ran it, and submitted a crash trace.", "tags": [], "creator": "benjamin.lerner@gmail.com", "author": "benjamin.lerner@gmail.com", "count": 10, "text": "Yes -- :protz' addon attached above instantly crashes TB60.6.1.  I just installed it, ran it, and submitted a crash trace.", "id": 14112295, "bug_id": 686123, "creation_time": "2019-05-12T15:40:29Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "vseerror@lehigh.edu", "is_private": false, "creation_time": "2019-05-12T16:07:01Z", "raw_text": "Thanks. So bp-2bb4ac11-dc15-4380-a7b8-4504d0190512\t2019-05-12 15:39:22 and bp-9786f305-2d9e-44d3-9272-23bf60190512\n\nI missed that we have the add-on attached - and so a testcase! \nDoes this put the finger on the cause?", "time": "2019-05-12T16:07:01Z", "author": "vseerror@lehigh.edu", "text": "Thanks. So bp-2bb4ac11-dc15-4380-a7b8-4504d0190512\t2019-05-12 15:39:22 and bp-9786f305-2d9e-44d3-9272-23bf60190512\n\nI missed that we have the add-on attached - and so a testcase! \nDoes this put the finger on the cause?", "count": 11, "bug_id": 686123, "id": 14112309}, {"creation_time": "2021-10-31T11:51:27Z", "is_private": false, "creator": "vseerror@lehigh.edu", "tags": [], "attachment_id": null, "id": 15635389, "bug_id": 686123, "count": 12, "text": "The testcase addon won't install - manifest?", "author": "vseerror@lehigh.edu", "time": "2021-10-31T11:51:27Z", "raw_text": "The testcase addon won't install - manifest?"}, {"attachment_id": 9248538, "tags": [], "creator": "john@thunderbird.net", "is_private": false, "creation_time": "2021-10-31T12:14:59Z", "raw_text": "Updated version of the crasher add-on. It adds a browser_action_button \"Crash Me\" to Thunderbirds main toolbar.\n\nYou should restart TB once after installing the add-on, because crashing TB directly removed the button from the toolbar for me (maybe some xulstore has not finished saving the new icon before the crash happend).", "time": "2021-10-31T12:14:59Z", "author": "john@thunderbird.net", "count": 13, "text": "Created attachment 9248538\ncrashtb_v2.xpi\n\nUpdated version of the crasher add-on. It adds a browser_action_button \"Crash Me\" to Thunderbirds main toolbar.\n\nYou should restart TB once after installing the add-on, because crashing TB directly removed the button from the toolbar for me (maybe some xulstore has not finished saving the new icon before the crash happend).", "bug_id": 686123, "id": 15635396}]}}, "comments": {}}