{"comments": {}, "bugs": {"687075": {"comments": [{"tags": [], "attachment_id": null, "creation_time": "2011-09-16T16:23:17Z", "is_private": false, "creator": "u408661@disabled.tld", "time": "2011-09-16T16:23:17Z", "raw_text": "Initially from the last modified timestamp to the time of eviction, eventually we would like to have it from the initial fetch time.", "id": 5720262, "bug_id": 687075, "author": "u408661@disabled.tld", "text": "Initially from the last modified timestamp to the time of eviction, eventually we would like to have it from the initial fetch time.", "count": 0}, {"creator": "u408661@disabled.tld", "count": 1, "text": "Created attachment 561781\npatch\n\nNot sure how I feel about this, even though it's really the only way to get the statistic we want here. Are we OK with increasing the amount of disk I/O to get this number? It's probably not as big an issue on mobile (since the real I/O bottleneck on mobile is writing), but still worth thinking about.", "author": "u408661@disabled.tld", "id": 5731169, "bug_id": 687075, "is_private": false, "creation_time": "2011-09-22T16:58:10Z", "time": "2011-09-22T16:58:10Z", "raw_text": "Not sure how I feel about this, even though it's really the only way to get the statistic we want here. Are we OK with increasing the amount of disk I/O to get this number? It's probably not as big an issue on mobile (since the real I/O bottleneck on mobile is writing), but still worth thinking about.", "attachment_id": 561781, "tags": []}, {"attachment_id": 561781, "tags": [], "creator": "jduell.mcbugs@gmail.com", "creation_time": "2011-09-22T18:49:00Z", "is_private": false, "raw_text": "Review of attachment 561781:\n-----------------------------------------------------------------\n\n::: netwerk/cache/nsDiskCacheDevice.cpp\n@@ +188,5 @@\n>          // entry not in use, just delete storage because we're enumerating the records\n> +        nsDiskCacheEntry * diskEntry = mCacheMap->ReadDiskCacheEntry(mapRecord);\n> +        if (diskEntry)\n> +            Telemetry::Accumulate(Telemetry::DISK_CACHE_ENTRY_LIFETIME,\n> +                SecondsFromPRTime(PR_Now()) - diskEntry->mLastModified);\n\nI assume this is on an async thread, so the extra I/O isn't necessarily a problem, per se.   But we should make sure before we land something like this.  But how to measure?  Meh.  It's tricky--hard to measure the overall system perf hit from doing a little more I/O.\n\nMichal, thoughts?", "time": "2011-09-22T18:49:00Z", "count": 2, "text": "Comment on attachment 561781\npatch\n\nReview of attachment 561781:\n-----------------------------------------------------------------\n\n::: netwerk/cache/nsDiskCacheDevice.cpp\n@@ +188,5 @@\n>          // entry not in use, just delete storage because we're enumerating the records\n> +        nsDiskCacheEntry * diskEntry = mCacheMap->ReadDiskCacheEntry(mapRecord);\n> +        if (diskEntry)\n> +            Telemetry::Accumulate(Telemetry::DISK_CACHE_ENTRY_LIFETIME,\n> +                SecondsFromPRTime(PR_Now()) - diskEntry->mLastModified);\n\nI assume this is on an async thread, so the extra I/O isn't necessarily a problem, per se.   But we should make sure before we land something like this.  But how to measure?  Meh.  It's tricky--hard to measure the overall system perf hit from doing a little more I/O.\n\nMichal, thoughts?", "author": "jduell.mcbugs@gmail.com", "bug_id": 687075, "id": 5731531}, {"tags": [], "time": "2011-09-22T18:50:17Z", "attachment_id": null, "raw_text": "Taras, who are these I/O experts who've recently joined us?", "bug_id": 687075, "id": 5731537, "creation_time": "2011-09-22T18:50:17Z", "is_private": false, "creator": "jduell.mcbugs@gmail.com", "author": "jduell.mcbugs@gmail.com", "text": "Taras, who are these I/O experts who've recently joined us?", "count": 3}, {"count": 4, "text": "(In reply to Jason Duell (:jduell) from comment #3)\n> Taras, who are these I/O experts who've recently joined us?\n\nDavid Teller is one, Vlad is starting in 2 weeks.\n\nWhy aren't you getting the last-modified time from the filesystem?", "author": "taras.mozilla@glek.net", "creator": "taras.mozilla@glek.net", "creation_time": "2011-09-22T18:53:34Z", "is_private": false, "bug_id": 687075, "id": 5731557, "raw_text": "(In reply to Jason Duell (:jduell) from comment #3)\n> Taras, who are these I/O experts who've recently joined us?\n\nDavid Teller is one, Vlad is starting in 2 weeks.\n\nWhy aren't you getting the last-modified time from the filesystem?", "attachment_id": null, "time": "2011-09-22T18:53:34Z", "tags": []}, {"time": "2011-09-22T18:59:21Z", "raw_text": "(In reply to Taras Glek (:taras) from comment #4)\n> Why aren't you getting the last-modified time from the filesystem?\n\nBecause the cache data may be in a block file where the last-modified time in the fs may or may not apply to the entry we care about.", "attachment_id": null, "tags": [], "creator": "u408661@disabled.tld", "text": "(In reply to Taras Glek (:taras) from comment #4)\n> Why aren't you getting the last-modified time from the filesystem?\n\nBecause the cache data may be in a block file where the last-modified time in the fs may or may not apply to the entry we care about.", "count": 5, "author": "u408661@disabled.tld", "bug_id": 687075, "id": 5731573, "creation_time": "2011-09-22T18:59:21Z", "is_private": false}, {"bug_id": 687075, "id": 5731585, "creation_time": "2011-09-22T19:02:01Z", "is_private": false, "creator": "taras.mozilla@glek.net", "author": "taras.mozilla@glek.net", "text": "(In reply to Nick Hurley from comment #5)\n> (In reply to Taras Glek (:taras) from comment #4)\n> > Why aren't you getting the last-modified time from the filesystem?\n> \n> Because the cache data may be in a block file where the last-modified time\n> in the fs may or may not apply to the entry we care about.\n\nMight make sense to special-case that to cut overhead.", "count": 6, "tags": [], "time": "2011-09-22T19:02:01Z", "attachment_id": null, "raw_text": "(In reply to Nick Hurley from comment #5)\n> (In reply to Taras Glek (:taras) from comment #4)\n> > Why aren't you getting the last-modified time from the filesystem?\n> \n> Because the cache data may be in a block file where the last-modified time\n> in the fs may or may not apply to the entry we care about.\n\nMight make sense to special-case that to cut overhead."}, {"author": "u408661@disabled.tld", "count": 7, "text": "(In reply to Taras Glek (:taras) from comment #6)\n> Might make sense to special-case that to cut overhead.\n\nOriginally I thought it might, but then I remembered some of the other cache telemetry bugs I filed (specifically bug 687077 and bug 687078). For those, we're going to have to do this exact same I/O at the exact same time. So I guess the question becomes, are these 3 pieces of data worth having the extra I/O for? (Not a question specifically for you, Taras, but one that would be nice to have your input on.)", "creator": "u408661@disabled.tld", "is_private": false, "creation_time": "2011-09-22T20:39:24Z", "bug_id": 687075, "id": 5731920, "attachment_id": null, "raw_text": "(In reply to Taras Glek (:taras) from comment #6)\n> Might make sense to special-case that to cut overhead.\n\nOriginally I thought it might, but then I remembered some of the other cache telemetry bugs I filed (specifically bug 687077 and bug 687078). For those, we're going to have to do this exact same I/O at the exact same time. So I guess the question becomes, are these 3 pieces of data worth having the extra I/O for? (Not a question specifically for you, Taras, but one that would be nice to have your input on.)", "time": "2011-09-22T20:39:24Z", "tags": []}, {"bug_id": 687075, "id": 5731934, "author": "mcmanus@ducksong.com", "text": "you can always sample 1 in 16 or somesuch..", "count": 8, "time": "2011-09-22T20:42:47Z", "raw_text": "you can always sample 1 in 16 or somesuch..", "creation_time": "2011-09-22T20:42:47Z", "is_private": false, "creator": "mcmanus@ducksong.com", "tags": [], "attachment_id": null}, {"time": "2012-10-08T22:12:50Z", "raw_text": "Not getting to this any time soon", "author": "u408661@disabled.tld", "count": 9, "text": "Not getting to this any time soon", "id": 6709261, "bug_id": 687075, "attachment_id": null, "tags": [], "creator": "u408661@disabled.tld", "is_private": false, "creation_time": "2012-10-08T22:12:50Z"}, {"author": "bug-husbandry-bot@mozilla.bugs", "text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "count": 10, "creator": "bug-husbandry-bot@mozilla.bugs", "is_private": false, "creation_time": "2017-09-13T18:40:43Z", "id": 12658984, "bug_id": 687075, "attachment_id": null, "raw_text": "Bulk change to priority: https://bugzilla.mozilla.org/show_bug.cgi?id=1399258", "time": "2017-09-13T18:40:43Z", "tags": []}]}}}