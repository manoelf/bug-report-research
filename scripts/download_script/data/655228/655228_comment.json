{"bugs": {"655228": {"comments": [{"count": 0, "author": "bugs@pettay.fi", "time": "2011-05-06T10:36:37Z", "is_private": false, "id": 5453106, "creator": "bugs@pettay.fi", "raw_text": "jamesr ask on #whatwg why scroll event doesn't have deltaX/Y or offset values.\nI think offset might not make too much sense since those are available\nin other APIs and scroll event is async so offset values might not be right.\nBut deltaX/Y could be useful. Web page could detect the direction of\nscrolling and also how much was scrolled.\n\nOf course, if we add such experimental properties, those should be\nprefixed with moz.", "attachment_id": null, "creation_time": "2011-05-06T10:36:37Z", "tags": [], "text": "jamesr ask on #whatwg why scroll event doesn't have deltaX/Y or offset values.\nI think offset might not make too much sense since those are available\nin other APIs and scroll event is async so offset values might not be right.\nBut deltaX/Y could be useful. Web page could detect the direction of\nscrolling and also how much was scrolled.\n\nOf course, if we add such experimental properties, those should be\nprefixed with moz.", "bug_id": 655228}, {"count": 1, "time": "2011-05-06T11:18:37Z", "text": "jamesr, I remembered it wrong. Several scrolls may cause just one scroll.", "creator": "bugs@pettay.fi", "raw_text": "jamesr, I remembered it wrong. Several scrolls may cause just one scroll.", "id": 5453144, "author": "bugs@pettay.fi", "is_private": false, "bug_id": 655228, "attachment_id": null, "creation_time": "2011-05-06T11:18:37Z", "tags": []}, {"time": "2011-05-06T11:20:31Z", "author": "bugs@pettay.fi", "count": 2, "is_private": false, "id": 5453148, "raw_text": "er, Several scrolls may cause just one scroll event.", "creator": "bugs@pettay.fi", "creation_time": "2011-05-06T11:20:31Z", "tags": [], "attachment_id": null, "text": "er, Several scrolls may cause just one scroll event.", "bug_id": 655228}, {"text": "And it seems that also webkit batches scrolls and fire only one scroll event\nin cases like\nfor (var i = 0; i < 500; ++i) {\n  window.scrollBy(0, 1);\n}\n\nOpera seems to dispatch scroll event for each step in that case,\nbut also it dispatched scroll event asynchronously.", "raw_text": "And it seems that also webkit batches scrolls and fire only one scroll event\nin cases like\nfor (var i = 0; i < 500; ++i) {\n  window.scrollBy(0, 1);\n}\n\nOpera seems to dispatch scroll event for each step in that case,\nbut also it dispatched scroll event asynchronously.", "creator": "bugs@pettay.fi", "time": "2011-05-06T11:35:05Z", "count": 3, "bug_id": 655228, "tags": [], "creation_time": "2011-05-06T11:35:05Z", "attachment_id": null, "id": 5453165, "author": "bugs@pettay.fi", "is_private": false}, {"author": "bugs@pettay.fi", "is_private": false, "id": 5453172, "attachment_id": 530596, "tags": [], "creation_time": "2011-05-06T11:41:19Z", "bug_id": 655228, "count": 4, "time": "2011-05-06T11:41:19Z", "creator": "bugs@pettay.fi", "raw_text": "", "text": "Created attachment 530596\na testcase"}, {"time": "2011-05-06T11:49:51Z", "author": "bugs@pettay.fi", "count": 5, "is_private": false, "id": 5453180, "raw_text": "I was told that IE9 behaves like Gecko and Webkit in that testcase.\n\nSo, scroll event could collect all the changes to deltaX/Y values.", "creator": "bugs@pettay.fi", "creation_time": "2011-05-06T11:49:51Z", "tags": [], "attachment_id": null, "text": "I was told that IE9 behaves like Gecko and Webkit in that testcase.\n\nSo, scroll event could collect all the changes to deltaX/Y values.", "bug_id": 655228}, {"attachment_id": null, "creation_time": "2011-05-06T13:36:27Z", "tags": [], "bug_id": 655228, "author": "roc@ocallahan.org", "is_private": false, "id": 5453308, "creator": "roc@ocallahan.org", "raw_text": "So what is the behavior of this delta? It just returns the difference in scrollTop since the last onscroll fired?", "text": "So what is the behavior of this delta? It just returns the difference in scrollTop since the last onscroll fired?", "count": 6, "time": "2011-05-06T13:36:27Z"}, {"time": "2011-05-06T13:48:52Z", "count": 7, "text": "Yes. And if there is pending scroll event when scrolling happens, the\nnew delta values should be added to the delta values of the pending event.", "raw_text": "Yes. And if there is pending scroll event when scrolling happens, the\nnew delta values should be added to the delta values of the pending event.", "creator": "bugs@pettay.fi", "id": 5453324, "is_private": false, "author": "bugs@pettay.fi", "bug_id": 655228, "tags": [], "creation_time": "2011-05-06T13:48:52Z", "attachment_id": null}, {"id": 8516053, "count": 8, "time": "2014-03-11T00:26:59Z", "author": "21@vingtetun.org", "is_private": false, "text": "Created attachment 8388892\nscroll.events.delta.patch\n\nThis patch implements mozDeltaX, mozDeltaY, mozOffsetLeft, mozOffsetTop on a scroll event.\n\nI added the offsets since my understanding is that even if they are available via other APIs, reading those can generate some reflows.\n\nBut I have no strong opinions on deltas versus offsets, so feel free to pick which one you want.", "bug_id": 655228, "creator": "21@vingtetun.org", "raw_text": "This patch implements mozDeltaX, mozDeltaY, mozOffsetLeft, mozOffsetTop on a scroll event.\n\nI added the offsets since my understanding is that even if they are available via other APIs, reading those can generate some reflows.\n\nBut I have no strong opinions on deltas versus offsets, so feel free to pick which one you want.", "attachment_id": 8388892, "creation_time": "2014-03-11T00:26:59Z", "tags": []}, {"creation_time": "2014-03-11T01:38:46Z", "tags": [], "attachment_id": null, "bug_id": 655228, "author": "bugs@pettay.fi", "is_private": false, "id": 8516269, "raw_text": "Hmm, our policy for prefixes has changed since filing this bug.\n\nNeed to bring this to webapps wg or whatwg.", "creator": "bugs@pettay.fi", "text": "Hmm, our policy for prefixes has changed since filing this bug.\n\nNeed to bring this to webapps wg or whatwg.", "time": "2014-03-11T01:38:46Z", "count": 9}, {"raw_text": "\n>@@ -806,16 +809,18 @@ nsEventDispatcher::CreateEvent(mozilla::\n>   if (aEventType.LowerCaseEqualsLiteral(\"beforeunloadevent\"))\n>     return NS_NewDOMBeforeUnloadEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"pagetransition\"))\n>     return NS_NewDOMPageTransitionEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"domtransaction\"))\n>     return NS_NewDOMDOMTransactionEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"scrollareaevent\"))\n>     return NS_NewDOMScrollAreaEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>+  if (aEventType.LowerCaseEqualsLiteral(\"scrollevent\"))\n>+    return NS_NewDOMScrollEvent(aDOMEvent, aOwner, aPresContext, nullptr);\nNo new entries here. document.createEvent is deprecated. Event interfaces should have constructors.\n\n\n\n\n>diff --git a/dom/interfaces/events/nsIDOMScrollEvent.idl b/dom/interfaces/events/nsIDOMScrollEvent.idl\n>new file mode 100644\n>--- /dev/null\n>+++ b/dom/interfaces/events/nsIDOMScrollEvent.idl\n>@@ -0,0 +1,28 @@\n>+/* -*- Mode: IDL; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */\n>+/* This Source Code Form is subject to the terms of the Mozilla Public\n>+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n>+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n>+\n>+#include \"nsIDOMUIEvent.idl\"\n>+\n>+[scriptable, builtinclass, uuid(3203fed4-a472-11e3-a8dc-3c970e9f4238)]\n>+interface nsIDOMScrollEvent : nsIDOMUIEvent\nNo need to add this interface. .webidl is enough.\n\n\n>+interface ScrollEvent : UIEvent\n>+{\n>+  readonly attribute double mozOffsetLeft;\n>+  readonly attribute double mozOffsetTop;\n>+  readonly attribute double mozDeltaX;\n>+  readonly attribute double mozDeltaY;\nI think we should try to get this spec'ed and then just use non-prefixed attributes.\nWant to email to webapps wg or to whatwg? Or should I?\n\n>+\n>+  [Throws]\n>+  void initScrollEvent(DOMString type,\n>+                       boolean canBubble,\n>+                       boolean cancelable,\n>+                       WindowProxy? view,\n>+                       long detail,\n>+                       double aOffsetLeft,\n>+                       double aOffsetTop,\n>+                       double aDeltaX,\n>+                       double aDeltaY);\ninit*Event methods are deprecated and shouldn't be added to new event interfaces.\nHowever, new events should have constructors.", "creator": "bugs@pettay.fi", "tags": [], "creation_time": "2014-03-17T02:10:26Z", "attachment_id": 8388892, "text": "Comment on attachment 8388892\nscroll.events.delta.patch\n\n\n>@@ -806,16 +809,18 @@ nsEventDispatcher::CreateEvent(mozilla::\n>   if (aEventType.LowerCaseEqualsLiteral(\"beforeunloadevent\"))\n>     return NS_NewDOMBeforeUnloadEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"pagetransition\"))\n>     return NS_NewDOMPageTransitionEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"domtransaction\"))\n>     return NS_NewDOMDOMTransactionEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>   if (aEventType.LowerCaseEqualsLiteral(\"scrollareaevent\"))\n>     return NS_NewDOMScrollAreaEvent(aDOMEvent, aOwner, aPresContext, nullptr);\n>+  if (aEventType.LowerCaseEqualsLiteral(\"scrollevent\"))\n>+    return NS_NewDOMScrollEvent(aDOMEvent, aOwner, aPresContext, nullptr);\nNo new entries here. document.createEvent is deprecated. Event interfaces should have constructors.\n\n\n\n\n>diff --git a/dom/interfaces/events/nsIDOMScrollEvent.idl b/dom/interfaces/events/nsIDOMScrollEvent.idl\n>new file mode 100644\n>--- /dev/null\n>+++ b/dom/interfaces/events/nsIDOMScrollEvent.idl\n>@@ -0,0 +1,28 @@\n>+/* -*- Mode: IDL; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */\n>+/* This Source Code Form is subject to the terms of the Mozilla Public\n>+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n>+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n>+\n>+#include \"nsIDOMUIEvent.idl\"\n>+\n>+[scriptable, builtinclass, uuid(3203fed4-a472-11e3-a8dc-3c970e9f4238)]\n>+interface nsIDOMScrollEvent : nsIDOMUIEvent\nNo need to add this interface. .webidl is enough.\n\n\n>+interface ScrollEvent : UIEvent\n>+{\n>+  readonly attribute double mozOffsetLeft;\n>+  readonly attribute double mozOffsetTop;\n>+  readonly attribute double mozDeltaX;\n>+  readonly attribute double mozDeltaY;\nI think we should try to get this spec'ed and then just use non-prefixed attributes.\nWant to email to webapps wg or to whatwg? Or should I?\n\n>+\n>+  [Throws]\n>+  void initScrollEvent(DOMString type,\n>+                       boolean canBubble,\n>+                       boolean cancelable,\n>+                       WindowProxy? view,\n>+                       long detail,\n>+                       double aOffsetLeft,\n>+                       double aOffsetTop,\n>+                       double aDeltaX,\n>+                       double aDeltaY);\ninit*Event methods are deprecated and shouldn't be added to new event interfaces.\nHowever, new events should have constructors.", "bug_id": 655228, "time": "2014-03-17T02:10:26Z", "author": "bugs@pettay.fi", "count": 10, "is_private": false, "id": 8540333}]}}, "comments": {}}