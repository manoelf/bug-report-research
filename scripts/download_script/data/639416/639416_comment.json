{"comments": {}, "bugs": {"639416": {"comments": [{"time": "2011-03-07T04:47:56Z", "id": 5326472, "is_private": false, "bug_id": 639416, "creation_time": "2011-03-07T04:47:56Z", "raw_text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.15) Gecko/20110303 Firefox/3.6.15 ( .NET CLR 3.5.30729; .NET4.0C)\nBuild Identifier: ChatZilla 0.9.86-rdmsoft [XULRunner 1.9.2.13/20101203074205]\n\nThe BNC I use (Geekbouncer, a semi-public cluster of ZNC servers - If anyone asks, this is the Atom server), uses a virtual channel called \"~#bnc\" (yes, the tilde is the first character) to keep track of users on the same bouncer server, make announcements, etc. This server is un-partable in cZ (not sure if that's another issue altogether, but I'd imagine not), and contains a list of all the ZNC users on that server. All of these users are prefixed with \"?\", including the client. The client doesn't show up in the userlist, and this causes things to go terribly, terribly wrong. The output window breaks (similar to the problems with Gecko 2 apps and cZ, but with the header and view background), the userlist occasionally breaks, and lots of other things.\n\nTL;DR: Chatzilla doesn't play nice with bouncers. \n\nReproducible: Sometimes\n\nSteps to Reproduce:\n1. Set up an account on Geekbouncer.co.uk (If you can, ask to be put on Atom in #geekbouncer on InfinityIRC) - This may take a while.\n2. Join the Atom server as instructed. You should automatically be put into the channel ~#bnc.\n3. Wait a while. Try doing things like hiding the tab, /part -ing, etc.\n4. Watch stuff start to go FUBAR.\nActual Results:  \nThings just stop working. Usually, [Att. 1 - BMO won't let me upload attachments in the initial post] gets sent to the tab every time I switch to the ~#bnc view. Later, the output window breaks (similar to the problems with Gecko 2 apps and cZ, but with the header and view background), the userlist occasionally breaks, and lots of other things.\n\nExpected Results:  \ncZ should work just fine, despite the massive number of things the bouncer does that IRC doesn't really support.\n\nSilver@Moznet/J. Ross devised a little /eval command that seems to have fixed it, along with the rest of the /eval abuse we were giving to my client. \n\n/eval this.users[\"hmmwhatsthisdo\"] = new CIRCChanUser(this, \"hmmwhatsthisdo\")\n\nReplace hmmwhatsthisdo with your moznet nickname.\n\nAnyone who wants to test this bug on the same server that I'm experiencing this issue will need to set up an account on a bouncer that uses a partyline module to lock users into a virtual channel. An example of this is the Atom server at Geekbouncer.co.uk. Go there, follow the instructions, and make sure you get your account assigned to the Atom server (this may take some asking nicely).", "tags": [], "author": "hmmwhatsthisdo@gmail.com", "count": 0, "text": "User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.15) Gecko/20110303 Firefox/3.6.15 ( .NET CLR 3.5.30729; .NET4.0C)\nBuild Identifier: ChatZilla 0.9.86-rdmsoft [XULRunner 1.9.2.13/20101203074205]\n\nThe BNC I use (Geekbouncer, a semi-public cluster of ZNC servers - If anyone asks, this is the Atom server), uses a virtual channel called \"~#bnc\" (yes, the tilde is the first character) to keep track of users on the same bouncer server, make announcements, etc. This server is un-partable in cZ (not sure if that's another issue altogether, but I'd imagine not), and contains a list of all the ZNC users on that server. All of these users are prefixed with \"?\", including the client. The client doesn't show up in the userlist, and this causes things to go terribly, terribly wrong. The output window breaks (similar to the problems with Gecko 2 apps and cZ, but with the header and view background), the userlist occasionally breaks, and lots of other things.\n\nTL;DR: Chatzilla doesn't play nice with bouncers. \n\nReproducible: Sometimes\n\nSteps to Reproduce:\n1. Set up an account on Geekbouncer.co.uk (If you can, ask to be put on Atom in #geekbouncer on InfinityIRC) - This may take a while.\n2. Join the Atom server as instructed. You should automatically be put into the channel ~#bnc.\n3. Wait a while. Try doing things like hiding the tab, /part -ing, etc.\n4. Watch stuff start to go FUBAR.\nActual Results:  \nThings just stop working. Usually, [Att. 1 - BMO won't let me upload attachments in the initial post] gets sent to the tab every time I switch to the ~#bnc view. Later, the output window breaks (similar to the problems with Gecko 2 apps and cZ, but with the header and view background), the userlist occasionally breaks, and lots of other things.\n\nExpected Results:  \ncZ should work just fine, despite the massive number of things the bouncer does that IRC doesn't really support.\n\nSilver@Moznet/J. Ross devised a little /eval command that seems to have fixed it, along with the rest of the /eval abuse we were giving to my client. \n\n/eval this.users[\"hmmwhatsthisdo\"] = new CIRCChanUser(this, \"hmmwhatsthisdo\")\n\nReplace hmmwhatsthisdo with your moznet nickname.\n\nAnyone who wants to test this bug on the same server that I'm experiencing this issue will need to set up an account on a bouncer that uses a partyline module to lock users into a virtual channel. An example of this is the Atom server at Geekbouncer.co.uk. Go there, follow the instructions, and make sure you get your account assigned to the Atom server (this may take some asking nicely).", "attachment_id": null, "creator": "hmmwhatsthisdo@gmail.com"}, {"attachment_id": 517343, "creator": "hmmwhatsthisdo@gmail.com", "author": "hmmwhatsthisdo@gmail.com", "count": 1, "text": "Created attachment 517343\nThis is the error that's getting spammed to the ~#bnc view after switching to its tab.", "is_private": false, "raw_text": "", "bug_id": 639416, "creation_time": "2011-03-07T04:54:45Z", "tags": [], "time": "2011-03-07T04:54:45Z", "id": 5326484}, {"attachment_id": null, "is_private": false, "tags": [], "creator": "bugzilla-mozilla-20000923@james-ross.co.uk", "creation_time": "2011-03-07T13:22:49Z", "bug_id": 639416, "raw_text": "For those working on the code, the problem we traced at least some of the brokeness back to was the ~#bnc channel's users collection - it had a key for the real user (without questionmark) but the value was undefined. Almost anything that did any enumeration of users or tried to find the client's user subsequently fell over.", "id": 5326943, "time": "2011-03-07T13:22:49Z", "author": "bugzilla-mozilla-20000923@james-ross.co.uk", "text": "For those working on the code, the problem we traced at least some of the brokeness back to was the ~#bnc channel's users collection - it had a key for the real user (without questionmark) but the value was undefined. Almost anything that did any enumeration of users or tried to find the client's user subsequently fell over.", "count": 2}, {"text": "OK, so, in order to get cZ from the \"blank log\" phase to a working state, one must do the /eval string mentioned above, then /sync-output. It throws \"[ERROR]\tTypeError: existingUser is undefined\" into that view, but appears to start working nonetheless.", "count": 3, "author": "hmmwhatsthisdo@gmail.com", "creator": "hmmwhatsthisdo@gmail.com", "attachment_id": null, "id": 5328870, "time": "2011-03-08T00:38:18Z", "tags": [], "bug_id": 639416, "creation_time": "2011-03-08T00:38:18Z", "raw_text": "OK, so, in order to get cZ from the \"blank log\" phase to a working state, one must do the /eval string mentioned above, then /sync-output. It throws \"[ERROR]\tTypeError: existingUser is undefined\" into that view, but appears to start working nonetheless.", "is_private": false}, {"creation_time": "2011-03-09T05:08:36Z", "bug_id": 639416, "raw_text": "This also happens to me on my ChatZilla on XULRunner install.\n\n(speaking as a GeekBouncer admin) If it turns out that you don't end up being force-joined into the partyline channel, typing /raw JOIN ~#bnc will make you join it. We do have to stay under the connection limit, so don't moan if you don't end up on Atom, Core, or some other server which force-joins you.\n\nYou could also set up your own ZNC install <http://en.znc.in/>, load the partyline module, and /raw JOIN ~#somechan. Some shell services also have ZNC preinstalled, saving you of the pain of setting it up on your own system.", "tags": [], "is_private": false, "time": "2011-03-09T05:08:36Z", "id": 5332355, "creator": "moz@vovo.id.au", "attachment_id": null, "count": 4, "text": "This also happens to me on my ChatZilla on XULRunner install.\n\n(speaking as a GeekBouncer admin) If it turns out that you don't end up being force-joined into the partyline channel, typing /raw JOIN ~#bnc will make you join it. We do have to stay under the connection limit, so don't moan if you don't end up on Atom, Core, or some other server which force-joins you.\n\nYou could also set up your own ZNC install <http://en.znc.in/>, load the partyline module, and /raw JOIN ~#somechan. Some shell services also have ZNC preinstalled, saving you of the pain of setting it up on your own system.", "author": "moz@vovo.id.au"}, {"attachment_id": null, "creator": "hmmwhatsthisdo@gmail.com", "author": "hmmwhatsthisdo@gmail.com", "text": "This is still happening on 0.9.86.1, by the way.", "count": 5, "is_private": false, "tags": [], "creation_time": "2011-05-14T22:11:55Z", "bug_id": 639416, "raw_text": "This is still happening on 0.9.86.1, by the way.", "id": 5470610, "time": "2011-05-14T22:11:55Z"}, {"time": "2011-05-20T19:14:05Z", "id": 5483344, "raw_text": "Also, the /eval command seems to have lost it's effectiveness. It seems to work once in a blue moon, but not as well as it did before .9.86.1.", "bug_id": 639416, "creation_time": "2011-05-20T19:14:05Z", "tags": [], "is_private": false, "text": "Also, the /eval command seems to have lost it's effectiveness. It seems to work once in a blue moon, but not as well as it did before .9.86.1.", "count": 6, "author": "hmmwhatsthisdo@gmail.com", "creator": "hmmwhatsthisdo@gmail.com", "attachment_id": null}, {"attachment_id": null, "is_private": false, "raw_text": "Still present in 0.9.89. The eval hack no longer works, client responds with\n[ERROR]\tTypeError: existingUser is undefined\n\nWhen I switch to one of the channel tabs, the following error appears:\nInternal error dispatching command \u201cset-current-view\u201d.\n[23:33]\t[ERROR]\tTypeError: cuser is undefined @ <chrome://chatzilla/content/static.js> 2507\nThe funny thing is that this message only appears in one of the affected tabs. When I applied the workaround described below, the error messages moved to a different channel tab.\n\nIt seems the problem is that variable \u201ccuser\u201d does not initialize on the previous line:\nvar cuser = client.currentObject.users[o.parent.me.canonicalName];\nin function updateTitle (obj)\n\nAlso, a different error appears in the error console:\nthis.users[p] is undefined\nchrome://chatzilla/content/lib/js/irc.js\nLine 2886\n\nI hope this information at least helps people to find a solution using a search engine, because these error messages were apparently never written down anywhere.\n\nWORKAROUND:\nIn my case, the original cause of the problem is a possible bug in ZNC. For some reason, the bouncer doesn't send my nickname in the list of nicknames along with the others. Simply leaving and joining the channel again resolves the problem.", "bug_id": 639416, "creation_time": "2012-12-26T22:58:12Z", "creator": "honza.hron@post.cz", "tags": [], "author": "honza.hron@post.cz", "time": "2012-12-26T22:58:12Z", "id": 6945837, "text": "Still present in 0.9.89. The eval hack no longer works, client responds with\n[ERROR]\tTypeError: existingUser is undefined\n\nWhen I switch to one of the channel tabs, the following error appears:\nInternal error dispatching command \u201cset-current-view\u201d.\n[23:33]\t[ERROR]\tTypeError: cuser is undefined @ <chrome://chatzilla/content/static.js> 2507\nThe funny thing is that this message only appears in one of the affected tabs. When I applied the workaround described below, the error messages moved to a different channel tab.\n\nIt seems the problem is that variable \u201ccuser\u201d does not initialize on the previous line:\nvar cuser = client.currentObject.users[o.parent.me.canonicalName];\nin function updateTitle (obj)\n\nAlso, a different error appears in the error console:\nthis.users[p] is undefined\nchrome://chatzilla/content/lib/js/irc.js\nLine 2886\n\nI hope this information at least helps people to find a solution using a search engine, because these error messages were apparently never written down anywhere.\n\nWORKAROUND:\nIn my case, the original cause of the problem is a possible bug in ZNC. For some reason, the bouncer doesn't send my nickname in the list of nicknames along with the others. Simply leaving and joining the channel again resolves the problem.", "count": 7}, {"attachment_id": null, "creator": "honza.hron@post.cz", "author": "honza.hron@post.cz", "count": 8, "text": "I have just noticed that the bug also breaks automatic nick completion, tab key actually works like a tab key does in most applications and switches focus to different parts of the window.", "is_private": false, "raw_text": "I have just noticed that the bug also breaks automatic nick completion, tab key actually works like a tab key does in most applications and switches focus to different parts of the window.", "creation_time": "2012-12-26T23:06:39Z", "bug_id": 639416, "tags": [], "time": "2012-12-26T23:06:39Z", "id": 6945850}]}}}