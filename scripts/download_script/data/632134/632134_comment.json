{"bugs": {"632134": {"comments": [{"text": "In particular, they include string16.h, which includes <string> which at least on my mac nukes those defines.", "creation_time": "2011-02-07T20:04:22Z", "is_private": false, "raw_text": "In particular, they include string16.h, which includes <string> which at least on my mac nukes those defines.", "id": 5260918, "bug_id": 632134, "time": "2011-02-07T20:04:22Z", "tags": [], "creator": "bzbarsky@mit.edu", "count": 0, "author": "bzbarsky@mit.edu", "attachment_id": null}, {"attachment_id": null, "time": "2011-02-08T06:16:03Z", "is_private": false, "author": "cjones.bugs@gmail.com", "count": 1, "tags": [], "creator": "cjones.bugs@gmail.com", "bug_id": 632134, "id": 5262404, "raw_text": "This doesn't affect 4.0 because\n - malloc et al. are #define'd to their fallible variants\n - we use jemalloc on windows so heap mismatches aren't a problem\n\nPost-4.0, we'll want to fix this because we might want to have allocation-tracking hooks in mozalloc.  It's also a potential danger for new code running on non-libxul windows that might hand out malloc'd pointers to other dlls, since with mozalloc, malloc et al. have been spec'd to make that kosher.\n\n<cstdlib> in gcc 4.4's STL undef's malloc et al.  I see some uses of libc malloc in my linux tree.  (Output edited.)  The libs annotated BAD are not expected to use libc malloc.  \"???\" I'm not sure.  Unannotated is expected.\n\n$ find -name '*.a' -exec echo {} \\; -exec nm -u {} \\; | egrep -e '(U malloc|.*\\.a)' | uniq\nBAD ./docshell/build/libdocshell.a\n                 U malloc\nBAD ./parser/htmlparser/src/libhtmlpars.a\n                 U malloc\n??? ./parser/expat/lib/libmozexpat_s.a\n                 U malloc\n./media/libogg/src/libogg.a\n                 U malloc\n./media/libtheora/lib/libtheora.a\n                 U malloc\n./media/libsydneyaudio/src/libsydneyaudio.a\n                 U malloc\n./media/libvpx/libvpx.a\n                 U malloc\n./media/libnestegg/src/libnestegg.a\n                 U malloc\n./media/libvorbis/lib/libvorbis.a\n                 U malloc\n./nsprpub/pr/src/libnspr4.a\n                 U malloc\n./nsprpub/lib/libc/src/libplc4.a\n                 U malloc\n??? ./xpcom/glue/standalone/libxpcomglue.a\n                 U malloc\n./xpcom/glue/nomozalloc/libxpcomglue_s_nomozalloc.a\n                 U malloc\nBAD ./layout/build/libgklayout.a\n                 U malloc\nBAD ./js/jetpack/libjetpack_s.a\n                 U malloc\n./js/src/editline/libeditline.a\n                 U malloc\n??? ./js/src/xpconnect/wrappers/libxpcwrappers_s.a\n                 U malloc\n??? ./js/src/xpconnect/src/libxpconnect_s.a\n                 U malloc\n./js/src/libjs_static.a\n                 U malloc\n./js/jsd/libjsd.a\n                 U malloc\n??? ./extensions/spellcheck/src/libspellchecker.a\n                 U malloc\n./extensions/spellcheck/hunspell/src/libhunspell_s.a\n                 U malloc\nBAD ./uriloader/exthandler/libexthandler_s.a\n                 U malloc\n./gfx/harfbuzz/src/libmozharfbuzz.a\n                 U malloc\n./gfx/cairo/libpixman/src/libmozlibpixman.a\n                 U malloc\n./gfx/cairo/cairo/src/libmozcairo.a\n                 U malloc\n./gfx/angle/libangle.a\n                 U malloc\n./gfx/qcms/libmozqcms.a\n                 U malloc\n./nss/softokn/libsoftokn.a\n                 U malloc\n./nss/dbm/libdbm.a\n                 U malloc\n./toolkit/crashreporter/google-breakpad/src/client/linux/handler/libexception_handler_s.a\n                 U malloc\nBAD ./toolkit/xre/libxulapp_s.a\n                 U malloc\n./widget/src/xremoteclient/libxremote_client_s.a\n                 U malloc\n./ipc/chromium/libchromium_s.a\n                 U malloc\nBAD ./netwerk/build/libnecko.a\n                 U malloc\n??? ./netwerk/protocol/http/libnkhttp_s.a\n                 U malloc\nBAD ./netwerk/base/src/libneckobase_s.a\n                 U malloc\n./jpeg/libmozjpeg.a\n                 U malloc\n./modules/libreg/standalone/libmozregsa_s.a\n                 U malloc\n./modules/libimg/png/libmozpng.a\n                 U malloc\n??? ./modules/libpr0n/decoders/libimgdecoders_s.a\n                 U malloc\nBAD ./modules/libpr0n/build/libimglib2.a\n                 U malloc\n./modules/libbz2/src/libbz2.a\n                 U malloc\n./modules/libbz2/src/libhostbz2.a\n                 U malloc\n./modules/zlib/src/libmozz.a\n                 U malloc\n./modules/zlib/standalone/libmozz_s.a\n                 U malloc\n./modules/libmar/src/libmar.a\n                 U malloc\n./modules/libmar/src/libhostmar.a\n                 U malloc", "creation_time": "2011-02-08T06:16:03Z", "text": "This doesn't affect 4.0 because\n - malloc et al. are #define'd to their fallible variants\n - we use jemalloc on windows so heap mismatches aren't a problem\n\nPost-4.0, we'll want to fix this because we might want to have allocation-tracking hooks in mozalloc.  It's also a potential danger for new code running on non-libxul windows that might hand out malloc'd pointers to other dlls, since with mozalloc, malloc et al. have been spec'd to make that kosher.\n\n<cstdlib> in gcc 4.4's STL undef's malloc et al.  I see some uses of libc malloc in my linux tree.  (Output edited.)  The libs annotated BAD are not expected to use libc malloc.  \"???\" I'm not sure.  Unannotated is expected.\n\n$ find -name '*.a' -exec echo {} \\; -exec nm -u {} \\; | egrep -e '(U malloc|.*\\.a)' | uniq\nBAD ./docshell/build/libdocshell.a\n                 U malloc\nBAD ./parser/htmlparser/src/libhtmlpars.a\n                 U malloc\n??? ./parser/expat/lib/libmozexpat_s.a\n                 U malloc\n./media/libogg/src/libogg.a\n                 U malloc\n./media/libtheora/lib/libtheora.a\n                 U malloc\n./media/libsydneyaudio/src/libsydneyaudio.a\n                 U malloc\n./media/libvpx/libvpx.a\n                 U malloc\n./media/libnestegg/src/libnestegg.a\n                 U malloc\n./media/libvorbis/lib/libvorbis.a\n                 U malloc\n./nsprpub/pr/src/libnspr4.a\n                 U malloc\n./nsprpub/lib/libc/src/libplc4.a\n                 U malloc\n??? ./xpcom/glue/standalone/libxpcomglue.a\n                 U malloc\n./xpcom/glue/nomozalloc/libxpcomglue_s_nomozalloc.a\n                 U malloc\nBAD ./layout/build/libgklayout.a\n                 U malloc\nBAD ./js/jetpack/libjetpack_s.a\n                 U malloc\n./js/src/editline/libeditline.a\n                 U malloc\n??? ./js/src/xpconnect/wrappers/libxpcwrappers_s.a\n                 U malloc\n??? ./js/src/xpconnect/src/libxpconnect_s.a\n                 U malloc\n./js/src/libjs_static.a\n                 U malloc\n./js/jsd/libjsd.a\n                 U malloc\n??? ./extensions/spellcheck/src/libspellchecker.a\n                 U malloc\n./extensions/spellcheck/hunspell/src/libhunspell_s.a\n                 U malloc\nBAD ./uriloader/exthandler/libexthandler_s.a\n                 U malloc\n./gfx/harfbuzz/src/libmozharfbuzz.a\n                 U malloc\n./gfx/cairo/libpixman/src/libmozlibpixman.a\n                 U malloc\n./gfx/cairo/cairo/src/libmozcairo.a\n                 U malloc\n./gfx/angle/libangle.a\n                 U malloc\n./gfx/qcms/libmozqcms.a\n                 U malloc\n./nss/softokn/libsoftokn.a\n                 U malloc\n./nss/dbm/libdbm.a\n                 U malloc\n./toolkit/crashreporter/google-breakpad/src/client/linux/handler/libexception_handler_s.a\n                 U malloc\nBAD ./toolkit/xre/libxulapp_s.a\n                 U malloc\n./widget/src/xremoteclient/libxremote_client_s.a\n                 U malloc\n./ipc/chromium/libchromium_s.a\n                 U malloc\nBAD ./netwerk/build/libnecko.a\n                 U malloc\n??? ./netwerk/protocol/http/libnkhttp_s.a\n                 U malloc\nBAD ./netwerk/base/src/libneckobase_s.a\n                 U malloc\n./jpeg/libmozjpeg.a\n                 U malloc\n./modules/libreg/standalone/libmozregsa_s.a\n                 U malloc\n./modules/libimg/png/libmozpng.a\n                 U malloc\n??? ./modules/libpr0n/decoders/libimgdecoders_s.a\n                 U malloc\nBAD ./modules/libpr0n/build/libimglib2.a\n                 U malloc\n./modules/libbz2/src/libbz2.a\n                 U malloc\n./modules/libbz2/src/libhostbz2.a\n                 U malloc\n./modules/zlib/src/libmozz.a\n                 U malloc\n./modules/zlib/standalone/libmozz_s.a\n                 U malloc\n./modules/libmar/src/libmar.a\n                 U malloc\n./modules/libmar/src/libhostmar.a\n                 U malloc"}, {"id": 5262405, "raw_text": "Not an IPC thing, but STL.  I'm still the right guy for this bug.", "is_private": false, "creation_time": "2011-02-08T06:16:50Z", "text": "Not an IPC thing, but STL.  I'm still the right guy for this bug.", "tags": [], "creator": "cjones.bugs@gmail.com", "time": "2011-02-08T06:16:50Z", "count": 2, "bug_id": 632134, "attachment_id": null, "author": "cjones.bugs@gmail.com"}]}}, "comments": {}}