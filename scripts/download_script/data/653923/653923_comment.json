{"bugs": {"653923": {"comments": [{"is_private": false, "time": "2011-04-30T15:03:44Z", "author": "matt@mattmccutchen.net", "count": 0, "id": 5441289, "creation_time": "2011-04-30T15:03:44Z", "tags": [], "attachment_id": null, "raw_text": "I get an \"Invalid OCSP signing certificate in OCSP response\" error when I try to visit https://www.doodle.com/ in Firefox 4.0.  The server's certificate chain looks like this:\n\nEntrust.net Secure Server Certification Authority (built-in)\n(99:A6:9B:E6:1A:FE:88:6B:4D:2B:82:00:7C:B8:54:FC:31:7E:15:39)\n  DigiCert Global CA\n  (25:B7:8E:B9:36:A4:00:CE:34:13:1D:9A:6D:E8:BE:A0:4B:34:76:07)\n    *.doodle.com\n    (C0:12:6C:83:39:53:97:E1:07:7F:C1:66:7A:D9:8B:7B:93:6D:5D:88)\n\nIt turns out I had disabled all trust bits on the Entrust.net Secure Server CA but enabled the SSL trust bit on the DigiCert Global CA.  The trust bit on the DigiCert Global CA is enough to accept the server's certificate if security.OCSP.require is off.  However, for some reason, it is not enough to accept the OCSP response, which is signed by the DigiCert Global CA itself (not a designated responder).  If I re-enable the SSL trust bit on the Entrust.net Secure Server CA, then NSS accepts the OCSP response.\n\nI thought that when Firefox is in the mode \"Validate a certificate if it specifies an OCSP server\", once it successfully verifies an SSL server certificate against a trusted (intermediate or root) CA, it would accept an OCSP response from the same CA or an OCSP responder designated by the CA without further reference to trust bits.  This looks like an NSS misbehavior, but I guess it could also be an OCSP server misconfiguration.", "creator": "matt@mattmccutchen.net", "bug_id": 653923, "text": "I get an \"Invalid OCSP signing certificate in OCSP response\" error when I try to visit https://www.doodle.com/ in Firefox 4.0.  The server's certificate chain looks like this:\n\nEntrust.net Secure Server Certification Authority (built-in)\n(99:A6:9B:E6:1A:FE:88:6B:4D:2B:82:00:7C:B8:54:FC:31:7E:15:39)\n  DigiCert Global CA\n  (25:B7:8E:B9:36:A4:00:CE:34:13:1D:9A:6D:E8:BE:A0:4B:34:76:07)\n    *.doodle.com\n    (C0:12:6C:83:39:53:97:E1:07:7F:C1:66:7A:D9:8B:7B:93:6D:5D:88)\n\nIt turns out I had disabled all trust bits on the Entrust.net Secure Server CA but enabled the SSL trust bit on the DigiCert Global CA.  The trust bit on the DigiCert Global CA is enough to accept the server's certificate if security.OCSP.require is off.  However, for some reason, it is not enough to accept the OCSP response, which is signed by the DigiCert Global CA itself (not a designated responder).  If I re-enable the SSL trust bit on the Entrust.net Secure Server CA, then NSS accepts the OCSP response.\n\nI thought that when Firefox is in the mode \"Validate a certificate if it specifies an OCSP server\", once it successfully verifies an SSL server certificate against a trusted (intermediate or root) CA, it would accept an OCSP response from the same CA or an OCSP responder designated by the CA without further reference to trust bits.  This looks like an NSS misbehavior, but I guess it could also be an OCSP server misconfiguration."}, {"tags": [], "creation_time": "2011-06-22T23:50:51Z", "attachment_id": null, "bug_id": 653923, "author": "brian@briansmith.org", "is_private": false, "id": 5549830, "raw_text": "This will require four test cases. I am working on the infrastructure for this testing in bug 663733.\n\nTest Case 1:\n\nCreate a cert chain: Root (no trust bits) -> Intermediate (trusted for SSL) -> EE. Sign OCSP response for EE with Intermediate. Verify that a good response returns \"good\" and that a revoked response returns \"revoked\".\n\nTest Case 2:\nCreate another cert chain: Root (no trust bits) -> Intermediate (trusted for SSL) -> Delegated Responder (w/ correct extended key usage, no trust bits). Sign OCSP response for EE with Delegated responder. Verify that a good response returns \"good\" and that a revoked response returns \"revoked.\"", "creator": "brian@briansmith.org", "text": "This will require four test cases. I am working on the infrastructure for this testing in bug 663733.\n\nTest Case 1:\n\nCreate a cert chain: Root (no trust bits) -> Intermediate (trusted for SSL) -> EE. Sign OCSP response for EE with Intermediate. Verify that a good response returns \"good\" and that a revoked response returns \"revoked\".\n\nTest Case 2:\nCreate another cert chain: Root (no trust bits) -> Intermediate (trusted for SSL) -> Delegated Responder (w/ correct extended key usage, no trust bits). Sign OCSP response for EE with Delegated responder. Verify that a good response returns \"good\" and that a revoked response returns \"revoked.\"", "time": "2011-06-22T23:50:51Z", "count": 1}, {"id": 8655585, "is_private": false, "time": "2014-04-13T18:30:12Z", "author": "adam@alphapapa.net", "count": 2, "bug_id": 653923, "text": "I don't know if this is happening because of changes due to Heartbleed, but today I cannot access anything from cdn.mozilla.net because of this error:\n\nInvalid OCSP signing certificate in OCSP response.\n(Error code: sec_error_ocsp_invalid_signing_cert)\n\nI don't think I should have to turn off OCSP validation to install Firefox addons.\n\nI don't know if this is a bug in Firefox or in Mozilla's CDN certificate setup, so I've no idea what product to set this to.", "tags": [], "creation_time": "2014-04-13T18:30:12Z", "attachment_id": null, "raw_text": "I don't know if this is happening because of changes due to Heartbleed, but today I cannot access anything from cdn.mozilla.net because of this error:\n\nInvalid OCSP signing certificate in OCSP response.\n(Error code: sec_error_ocsp_invalid_signing_cert)\n\nI don't think I should have to turn off OCSP validation to install Firefox addons.\n\nI don't know if this is a bug in Firefox or in Mozilla's CDN certificate setup, so I've no idea what product to set this to.", "creator": "adam@alphapapa.net"}, {"is_private": false, "time": "2014-04-14T22:13:09Z", "author": "brian@briansmith.org", "count": 3, "id": 8660771, "tags": [], "creation_time": "2014-04-14T22:13:09Z", "attachment_id": null, "raw_text": "(In reply to Adam Porter from comment #2)\n> I don't know if this is happening because of changes due to Heartbleed, but\n> today I cannot access anything from cdn.mozilla.net because of this error:\n> \n> Invalid OCSP signing certificate in OCSP response.\n> (Error code: sec_error_ocsp_invalid_signing_cert)\n> \n> I don't think I should have to turn off OCSP validation to install Firefox\n> addons.\n> \n> I don't know if this is a bug in Firefox or in Mozilla's CDN certificate\n> setup, so I've no idea what product to set this to.\n\nYour issue is different than what this bug is about. Please file a new bug. In the new bug, please list the steps you took that resulted in the error, so that we can reproduce the problem. Thanks!", "creator": "brian@briansmith.org", "bug_id": 653923, "text": "(In reply to Adam Porter from comment #2)\n> I don't know if this is happening because of changes due to Heartbleed, but\n> today I cannot access anything from cdn.mozilla.net because of this error:\n> \n> Invalid OCSP signing certificate in OCSP response.\n> (Error code: sec_error_ocsp_invalid_signing_cert)\n> \n> I don't think I should have to turn off OCSP validation to install Firefox\n> addons.\n> \n> I don't know if this is a bug in Firefox or in Mozilla's CDN certificate\n> setup, so I've no idea what product to set this to.\n\nYour issue is different than what this bug is about. Please file a new bug. In the new bug, please list the steps you took that resulted in the error, so that we can reproduce the problem. Thanks!"}]}}, "comments": {}}