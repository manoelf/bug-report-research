{"comments": {}, "bugs": {"1645016": {"comments": [{"attachment_id": 9155914, "bug_id": 1645016, "creator": "mcoman@mozilla.com", "text": "Created attachment 9155914\nrec of the issue.gif\n\n**[Notes]:**\n- This issue seems to be intermittent since I have managed to reproduce it only on 3 Firefox profiles from a total of 5.\n\n**[Affected versions]:**\n- Firefox Release 72.0 - Build ID: 20200103162918 \n- Firefox Release 73.0.1 - Build ID: 20200217142647 \n- Firefox Release 74.0 - Build ID: 20200309095159 \n- Firefox Release 75.0 - Build ID: 20200403170909 \n- Firefox Release 76.0 - Build ID: 20200429185419\n- Firefox Release 77.0.1 - Build ID: 20200602222727\n\n**[Affected Platforms]:**\n- Windows 10 x64\n- macOS 10.15\n- Ubuntu 18.04 x64\n\n**[Prerequisites]:**\n- Have a Firefox en-US locale build installed.\n- Have a Firefox profile older than 17 weeks. In order to do that you can change the creation date from the \"times.json\" file that can be found in the current profile folder.\n- Have the following pref in the \"about:config\" page:\n\t- \"browser.newtabpage.activity-stream.asrouter.providers.snippets\" pref value set to \"{\"id\":\"snippets\",\"enabled\":true,\"type\":\"remote\",\"url\":\"https://snippets.cdn.mozilla.net/%STARTPAGE_VERSION%/%NAME%/%VERSION%/%APPBUILDID%/%BUILD_TARGET%/%LOCALE%/%CHANNEL%/%OS_VERSION%/experiment-202007-hvmt/%DISTRIBUTION_VERSION%/\",\"updateCycleInMs\":14400000}\".\n\t- \"browser.search.region\" pref value must not be set to \"US\".\n\n**[Steps to reproduce]:**\n1. Open the browser with the profile from prerequisites.\n2. Open a new tab and click the \"Set Firefox as Default\" button from the snippet displayed under the in-content search bar.\n3. Open a new tab and observe the displayed sections .\n\n**[Expected result]:**\n- The following sections are displayed:\n\t- \"In-content Search Bar\"\n\t- \"Top Sites\"\n\t- \"Recommended by Pocket\" (if available)\n\t- \"Highlights\"\n\t\n**[Actual result]:**\n- The \"Set Firefox to Default\" snippet is still displayed under the in-content \"Search Bar\".\n\n**[Notes]:**\n- The impression ping is also displayed in the \"Browser Console\" when the snippet is displayed for the second time.\n- This might be a preloading issue considering the fact that the snippet is displayed only on the first opened tab and the \"Set Firefox to Default\" snippets are blocked in the \"about:newtab#devtools\" page right after the \"Set Firefox as Default\" button is clicked.\n- This issue is also reproducible is the snippet is removed from the \"Dismiss\" button.\n- Attached a screen recording of the issue.", "time": "2020-06-11T12:13:15Z", "is_private": false, "count": 0, "id": 14876081, "raw_text": "**[Notes]:**\n- This issue seems to be intermittent since I have managed to reproduce it only on 3 Firefox profiles from a total of 5.\n\n**[Affected versions]:**\n- Firefox Release 72.0 - Build ID: 20200103162918 \n- Firefox Release 73.0.1 - Build ID: 20200217142647 \n- Firefox Release 74.0 - Build ID: 20200309095159 \n- Firefox Release 75.0 - Build ID: 20200403170909 \n- Firefox Release 76.0 - Build ID: 20200429185419\n- Firefox Release 77.0.1 - Build ID: 20200602222727\n\n**[Affected Platforms]:**\n- Windows 10 x64\n- macOS 10.15\n- Ubuntu 18.04 x64\n\n**[Prerequisites]:**\n- Have a Firefox en-US locale build installed.\n- Have a Firefox profile older than 17 weeks. In order to do that you can change the creation date from the \"times.json\" file that can be found in the current profile folder.\n- Have the following pref in the \"about:config\" page:\n\t- \"browser.newtabpage.activity-stream.asrouter.providers.snippets\" pref value set to \"{\"id\":\"snippets\",\"enabled\":true,\"type\":\"remote\",\"url\":\"https://snippets.cdn.mozilla.net/%STARTPAGE_VERSION%/%NAME%/%VERSION%/%APPBUILDID%/%BUILD_TARGET%/%LOCALE%/%CHANNEL%/%OS_VERSION%/experiment-202007-hvmt/%DISTRIBUTION_VERSION%/\",\"updateCycleInMs\":14400000}\".\n\t- \"browser.search.region\" pref value must not be set to \"US\".\n\n**[Steps to reproduce]:**\n1. Open the browser with the profile from prerequisites.\n2. Open a new tab and click the \"Set Firefox as Default\" button from the snippet displayed under the in-content search bar.\n3. Open a new tab and observe the displayed sections .\n\n**[Expected result]:**\n- The following sections are displayed:\n\t- \"In-content Search Bar\"\n\t- \"Top Sites\"\n\t- \"Recommended by Pocket\" (if available)\n\t- \"Highlights\"\n\t\n**[Actual result]:**\n- The \"Set Firefox to Default\" snippet is still displayed under the in-content \"Search Bar\".\n\n**[Notes]:**\n- The impression ping is also displayed in the \"Browser Console\" when the snippet is displayed for the second time.\n- This might be a preloading issue considering the fact that the snippet is displayed only on the first opened tab and the \"Set Firefox to Default\" snippets are blocked in the \"about:newtab#devtools\" page right after the \"Set Firefox as Default\" button is clicked.\n- This issue is also reproducible is the snippet is removed from the \"Dismiss\" button.\n- Attached a screen recording of the issue.", "creation_time": "2020-06-11T12:13:15Z", "author": "mcoman@mozilla.com", "tags": []}, {"id": 14878497, "count": 1, "creation_time": "2020-06-12T12:33:31Z", "tags": [], "author": "mcoman@mozilla.com", "raw_text": "After further investigation, we observed that this issue is also reproducible if the snippet is removed from the \"Dismiss\" button. Considering this I am changing the issue's title to reflect this.", "bug_id": 1645016, "attachment_id": null, "is_private": false, "creator": "mcoman@mozilla.com", "text": "After further investigation, we observed that this issue is also reproducible if the snippet is removed from the \"Dismiss\" button. Considering this I am changing the issue's title to reflect this.", "time": "2020-06-12T12:33:31Z"}, {"tags": [], "author": "tcinotto@mozilla.com", "creation_time": "2020-06-12T16:35:19Z", "raw_text": "Hi Giorgos can you help us look into this issue? I consider this a blocker for the experiment as we won't be respecting our user's wishes.", "id": 14878963, "count": 2, "is_private": false, "time": "2020-06-12T16:35:19Z", "text": "Hi Giorgos can you help us look into this issue? I consider this a blocker for the experiment as we won't be respecting our user's wishes.", "creator": "tcinotto@mozilla.com", "bug_id": 1645016, "attachment_id": null}, {"id": 14882448, "count": 3, "author": "giorgos@mozilla.com", "tags": [], "creation_time": "2020-06-15T08:25:01Z", "raw_text": "This is indeed not handled correctly. \n\nDismissing (i.e. blocking) a snippet or never displaying again after user takes action is something that's handled by Message Router and not by Snippets. \n\nI defer to Andrei for more information.\n\nBug 1645370 seems related", "bug_id": 1645016, "attachment_id": null, "is_private": false, "creator": "giorgos@mozilla.com", "time": "2020-06-15T08:25:01Z", "text": "This is indeed not handled correctly. \n\nDismissing (i.e. blocking) a snippet or never displaying again after user takes action is something that's handled by Message Router and not by Snippets. \n\nI defer to Andrei for more information.\n\nBug 1645370 seems related"}, {"id": 14883518, "count": 4, "author": "andrei.br92@gmail.com", "tags": [], "creation_time": "2020-06-15T19:58:47Z", "raw_text": "", "bug_id": 1645016, "attachment_id": 9156807, "is_private": false, "creator": "andrei.br92@gmail.com", "time": "2020-06-15T19:58:47Z", "text": "Created attachment 9156807\nBug 1645016 - Clear preloaded about:newtab from blocked snippets"}, {"attachment_id": null, "bug_id": 1645016, "text": ":andreio are you working on this, or should the priority/severity be revised?", "time": "2021-01-26T16:16:26Z", "creator": "dave.hunt@gmail.com", "is_private": false, "count": 5, "id": 15234311, "raw_text": ":andreio are you working on this, or should the priority/severity be revised?", "creation_time": "2021-01-26T16:16:26Z", "author": "dave.hunt@gmail.com", "tags": []}, {"attachment_id": null, "bug_id": 1645016, "creator": "andrei.br92@gmail.com", "time": "2021-01-27T09:57:04Z", "text": "This ended up not getting fixed because it was an experiment in release and we couldn't change much there.\nI'll update the patch and get it reviewed.", "is_private": false, "id": 15235722, "count": 6, "raw_text": "This ended up not getting fixed because it was an experiment in release and we couldn't change much there.\nI'll update the patch and get it reviewed.", "tags": [], "author": "andrei.br92@gmail.com", "creation_time": "2021-01-27T09:57:04Z"}, {"raw_text": "Pushed by aoprea@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/2d3ba442aee4\nClear preloaded about:newtab from blocked snippets r=k88hudson", "tags": [], "author": "pulsebot@bots.tld", "creation_time": "2021-02-04T17:01:04Z", "id": 15249397, "count": 7, "creator": "pulsebot@bots.tld", "time": "2021-02-04T17:01:04Z", "text": "Pushed by aoprea@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/2d3ba442aee4\nClear preloaded about:newtab from blocked snippets r=k88hudson", "is_private": false, "attachment_id": null, "bug_id": 1645016}, {"count": 8, "id": 15250475, "raw_text": "https://hg.mozilla.org/mozilla-central/rev/2d3ba442aee4", "tags": ["bugherder"], "author": "btara@mozilla.com", "creation_time": "2021-02-05T09:39:17Z", "attachment_id": null, "bug_id": 1645016, "creator": "btara@mozilla.com", "time": "2021-02-05T09:39:17Z", "text": "https://hg.mozilla.org/mozilla-central/rev/2d3ba442aee4", "is_private": false}]}}}